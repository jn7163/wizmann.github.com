<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Maerlyn's Rainbow</title><link href="http://wizmann.tk/" rel="alternate"></link><link href="http://wizmann.tk/feeds/wizmann.atom.xml" rel="self"></link><id>http://wizmann.tk/</id><updated>2016-11-11T22:04:13+08:00</updated><entry><title>Moscaæºç é˜…è¯»</title><link href="http://wizmann.tk/mosca.html" rel="alternate"></link><updated>2016-11-11T22:04:13+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-11-11:mosca.html</id><summary type="html">&lt;h2&gt;å…ˆåœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘å¿ƒè¡€æ¥æ½®çœ‹äº†çœ‹ä¸€ä¸ªæ¯”è¾ƒæœ‰åçš„å¼€æºMQTT broker â€”â€” Moscaã€‚ä¸è¯»ä¸çŸ¥é“ï¼Œè¯»å®Œæ‰æç„¶å¤§æ‚Ÿ â€”â€” è¿™æ˜¯å•¥ç ´ç©æ„ï¼ˆå“ˆå“ˆï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæˆ‘æ˜¯nodejsçš„è¶…çº§åˆå­¦è€…ï¼Œæ‰€ä»¥æœ¬æ–‡ä¼šæ¯”è¾ƒæµ…æ˜¾ï¼Œå¹¶ä¸”åªå…³æ³¨big pictureï¼Œä¸é™·å…¥ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå…ˆè§„å®šå‡ ä¸ªç¼©å†™ï¼Œè®©åé¢è¡Œæ–‡æ—¶å°‘æ‰“ä¸€ç‚¹å­—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MQ - MessageQueue&lt;/li&gt;
&lt;li&gt;Asco - Ascoltatori&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Ascoltatori - å¬è€…&lt;/h2&gt;
&lt;p&gt;Ascoltatoriæ˜¯ä¸€ä¸ªæ„å¤§åˆ©è¯­å•è¯ï¼Œç¿»è¯‘æˆè‹±æ–‡å°±æ˜¯listenerã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œä¸¥é‡åæ§½ä½œè€…å–åå­—çš„æ–¹å¼ï¼Œmoscaè¿™ç§çŸ­å°çš„å¤–è¯­å•è¯æˆ‘ä»¬æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½ è¯´ascoltatoriè¿™ä¹ˆé•¿çš„æ„å¤§åˆ©è¯­å•è¯ï¼Œä½ è®©æˆ‘ä»¬æ€ä¹ˆè®°ã€‚    &lt;br /&gt;
å·®è¯„ï¼Œé€€æ¬¾ï¼Œé‚®è´¹ä¹Ÿè¦é€€ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ascoæ¨¡å—çš„ä½œç”¨æ˜¯æä¾›ä¸€ä¸ªä¸€è‡´çš„MQçš„æŠ½è±¡ï¼Œä¾›ä¸Šå±‚brokerä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬åªåˆ†æåŸºäºRedisçš„å®ç°ï¼ŒåŸå› æ˜¯Redisæˆ‘ç›¸å¯¹æ¯”è¾ƒç†Ÿæ‚‰ï¼ŒåŠŸèƒ½ä¹Ÿæ¯”è¾ƒç®€å•ã€‚&lt;/p&gt;
&lt;h3&gt;æ¥å£åˆ†æ&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;RedisAscoltatore&lt;/code&gt;æœ‰ä¸‰ä¸ªåŠæ¥å£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;subscribe&lt;/li&gt;
&lt;li&gt;unsubscribe&lt;/li&gt;
&lt;li&gt;publish&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‰©ä¸‹çš„é‚£åŠä¸ªæ˜¯æ¨¡å—çš„æ„é€ å‡½æ•°ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«åˆ†ææ¥å£çš„åŠŸèƒ½åŠå…¶å®ç°ã€‚&lt;/p&gt;
&lt;h3&gt;Subscribeæ¥å£&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;this._sub&lt;/code&gt;æ˜¯&lt;code&gt;RedisAscoltatore&lt;/code&gt;ç”¨æ¥subscribeçš„è¿æ¥ã€‚é¦–å…ˆæˆ‘ä»¬è¦å‘MQè®¢é˜…æŒ‡å®šçš„topicã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åæˆ‘ä»¬è¦åœ¨æœ¬åœ°ç»´æŠ¤ä¸€ä¸ª&lt;code&gt;topic&lt;/code&gt;åˆ°&lt;code&gt;callback&lt;/code&gt;sçš„æ˜ å°„å…³ç³»ã€‚å› ä¸ºMoscaæ˜¯ä¸€ä¸ªbrokerï¼Œéœ€è¦å°†end userè®¢é˜…çš„topicçš„å†…å®¹å®Œæ•´çš„å‘é€åˆ°ç”¨æˆ·é‚£é‡Œå»ï¼Œæ¯ä¸€ä¸ªç”¨æˆ·åœ¨Ascoé‡Œï¼Œç”¨ä¸€ä¸ªcallbackå‡½æ•°æ¥ä»£è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·å¯ä»¥è®¢é˜…ä¸€ä¸ªç‰¹å®šçš„topicï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªpatternæ¥è®¢é˜…ä¸€ç³»åˆ—çš„topicã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/public/16-11-10/27730251.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå³ä¸Šæ–¹çš„clientè®¢é˜…äº†&lt;code&gt;h?llo&lt;/code&gt;ï¼ˆç›¸å½“äºregexä¸­çš„&lt;code&gt;h.llo&lt;/code&gt;ï¼‰ã€‚å³ä¸‹æ–¹çš„clientè®¢é˜…äº†&lt;code&gt;h[abcde]llo&lt;/code&gt;ã€‚è€Œå·¦è¾¹çš„clientå‘&lt;code&gt;hello&lt;/code&gt; topicå‘å¸ƒäº†ä¸€ä¸ªæ¶ˆæ¯ã€‚æ­¤æ—¶å³è¾¹çš„ä¸¤ä¸ªclientéƒ½æ”¶åˆ°äº†è¿™æ¡æ¶ˆæ¯ï¼Œå…¶ä¸­pmessageä»£è¡¨è¿™æ¡æ¶ˆæ¯æ˜¯æœ‰patternçš„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨äº†clientè®¢é˜…çš„pattern topicï¼Œè€Œç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨äº†è¿™æ¡æ¶ˆæ¯çš„å®é™…topicï¼Œæœ€åä¸€ä¸ªå‚æ•°æ˜¯æ¶ˆæ¯çš„æ­£æ–‡ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åœ¨ç»´æŠ¤topic-clientåˆ—è¡¨æ—¶ï¼Œåªéœ€è¦ç»´æŠ¤pattern topicï¼ˆæ²¡æœ‰patternçš„topicå¯ä»¥è§†åšåªåŒ¹é…å½“å‰topicçš„patterï¼‰ã€‚å½“æœ‰æ¶ˆæ¯åˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨pattern topicæ˜ å°„åˆ°clientsï¼Œä¹‹åå†è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡ŒAscoä½¿ç”¨äº†ä¸€ä¸ªå«åš&lt;a href="https://github.com/davedoesdev/qlobber"&gt;&lt;code&gt;qlobber&lt;/code&gt;&lt;/a&gt;çš„åº“ï¼Œå®ƒä½¿ç”¨Trieæ ‘å¯¹topicè¿›è¡ŒåŒ¹é…ã€‚æˆ‘ä»¬åœ¨ä¸Šæ–‡å·²ç»è¯´åˆ°ï¼ŒAscoæ˜¯ä¸€ä¸ªç»Ÿä¸€åŒ–çš„MQæŠ½è±¡å±‚ï¼Œæ‰€ä»¥åœ¨ä¸åŒçš„MQä¸­æ‰€ä½¿ç”¨çš„ä¸åŒçš„patternï¼Œæˆ‘ä»¬éƒ½éœ€è¦å°†å…¶ç»Ÿä¸€æˆåŒä¸€ç§è¯­æ³•è¿›è¡ŒåŒ¹é…ã€‚è€Œqlobberï¼Œåœ¨Ascoä¸­è¢«å°è£…æˆ&lt;code&gt;RedisAscoltatore&lt;/code&gt;ï¼Œå°±æ˜¯ç”¨æ¥ç»Ÿä¸€ä¸åŒçš„è¯­æ³•çš„ã€‚&lt;/p&gt;
&lt;h3&gt;Unsubscribeæ¥å£&lt;/h3&gt;
&lt;p&gt;æœ‰è®¢é˜…å°±æœ‰é€€è®¢ï¼Œè¿™ä¸ªæ¥å£ä¸ä¸Šé¢çš„æ˜¯å¯¹åº”çš„å…³ç³»ã€‚æˆ‘ä»¬åªéœ€è¦å°†è®¢é˜…çš„é¡ºåºåè¿‡æ¥åšä¸€éå°±å¯ä»¥äº†ã€‚è¿™ä¸ªå‡½æ•°ç›¸å¯¹ç®€å•ï¼Œå°±ä¸å¤šè¯´äº†ã€‚&lt;/p&gt;
&lt;h3&gt;Publishæ¥å£&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œçš„publishï¼Œä»£è¡¨æ˜¯ç”¨æˆ·çš„publishçš„æ“ä½œã€‚ç”¨æˆ·æ•°æ®åœ¨â€œå»MQç‰¹è‰²åŒ–â€ä¹‹åï¼Œä¼šç»ç”±&lt;code&gt;this._client&lt;/code&gt;å‘å¸ƒåˆ°ç›¸åº”çš„redisæœåŠ¡ã€‚æœ€åè°ƒç”¨ç”¨æˆ·çš„callbackã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå†åä¸€ä¸ªæ§½ï¼Œä¸ºå•¥è®¢é˜…è¿æ¥å«&lt;code&gt;this._sub&lt;/code&gt;ï¼Œå‘å¸ƒè¿æ¥å«&lt;code&gt;this._client&lt;/code&gt;ã€‚éš¾é“ä½ ä¸é€ pub/subæ‰æ˜¯çœŸæ­£çš„å¯¹åº”å—ï¼Ÿ&lt;/p&gt;
&lt;h3&gt;æ„é€ å‡½æ•°&lt;/h3&gt;
&lt;p&gt;æ„é€ å‡½æ•°è™½ç„¶è¯´æ˜¯â€œåŠä¸ªæ¥å£â€ï¼Œä½†æ˜¯ä»£ç é‡å’Œé‡è¦æ€§ï¼Œå´é«˜äºä¸Šé¢çš„æ¥å£ã€‚å› ä¸ºredisçš„pub/subæ¨¡å‹æ˜¯å•å·¥çš„ï¼Œéœ€è¦ä¸¤ä¸ªè¿æ¥æ‰å¯ä»¥å®Œæˆã€‚æ‰€ä»¥ä¸¤æ¡è¿æ¥éœ€è¦å•ç‹¬åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;h4&gt;this._startPub&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä»ç®€å•çš„å¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¤ªç®€å•äº†ï¼Œæ²¡çš„å¯è¯´ã€‚å°±æ˜¯æ‹‰ä¸€æ¡ç”µè¯çº¿ï¼ŒæˆåŠŸäº†ä¹‹åæ”¹ä¸€ä¸‹çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;æ²¡äº†ã€‚&lt;/p&gt;
&lt;h4&gt;this._startSub&lt;/h4&gt;
&lt;p&gt;è¿™ä¸ªæ¯”pubè¦å¤æ‚ä¸€ç‚¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æ‹‰ä¸€æ¡åˆ°redisçš„ç”µè¯çº¿ï¼ˆè¿æ¥ï¼‰ã€‚ä¹‹åæ³¨å†Œæ¶ˆæ¯åˆ°æ¥æ—¶çš„å›è°ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹è¿™ä¸ªå›è°ƒæ˜¯æ€æ ·çš„æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¿˜æ˜¯â€œå»MQç‰¹è‰²åŒ–â€ï¼Œå°†Redisçš„patternè¯­æ³•åŒ–å½’æˆAscoçš„å†…éƒ¨è¯­æ³•ã€‚å†é€šè¿‡patternå–å‡ºç›¸åº”çš„callbacksï¼Œå°†æ¶ˆæ¯é€šè¿‡callbacksä¼ é€’ç»™ç›¸åº”çš„ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¡¥å……ä¸€ä¸‹ï¼Œ&lt;code&gt;(sub, topic, payload)&lt;/code&gt;ä¸‰ä¸ªå‚æ•°å¦‚æœå‘½åä¸º&lt;code&gt;(pattern, topic, payload)&lt;/code&gt;å…¶å®ä¼šæ›´æ¸…æ™°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç±»å…¶å®åŸç†ä¸Šå¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯ç”±äºå…¶éœ€è¦å°†ä¸åŒMQçš„patternè½¬æ¢ä¸ºç»Ÿä¸€çš„è¯­æ³•ï¼Œæ‰€ä»¥åœ¨ä¸­é—´åŠ äº†ä¸€å±‚ï¼Œå¯¼è‡´å¤æ‚æ€§çš„æå‡ã€‚å¦‚æœæˆ‘ä»¬åªåšä¸€ä¸ªä¸“ç”¨çš„brokerï¼Œä»£ç å…¶å®å¯ä»¥å†™çš„æ›´æ˜æœ—çš„ã€‚&lt;/p&gt;
&lt;h2&gt;Mosca - è‹è‡&lt;/h2&gt;
&lt;p&gt;ä¸Mosquitoç›¸å¯¹ï¼ŒMoscaæ˜¯è‹è‡çš„æ„æ€ã€‚Moscaæ˜¯Ascoçš„ä¸Šå±‚å°è£…ï¼Œä¸å…¶ä¸€èµ·ç»„æˆäº†ä¸€ä¸ªMQTT brokerï¼Œä¸end userç›´æ¥äº¤äº’ã€‚&lt;/p&gt;
&lt;p&gt;MQçš„å•ä¸€èŒè´£æ˜¯è´Ÿè´£æ¶ˆæ¯çš„å‘å¸ƒ/è®¢é˜…ï¼ŒMoscaåœ¨å…¶ä¸Šæ·»åŠ äº†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨çº¿ç¦»çº¿çŠ¶æ€æ£€æµ‹&lt;/li&gt;
&lt;li&gt;ç¦»çº¿æ¶ˆæ¯çš„æ”¯æŒ&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯æŒä¹…åŒ–&lt;/li&gt;
&lt;li&gt;ä¸€äº›æƒé™æ£€æµ‹æ¥å£&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»Moscaçš„å·¥ä½œæµç¨‹å‡ºå‘ï¼Œä¸»è¦å…³æ³¨ç¦»çº¿æ¶ˆæ¯å’Œå®¢æˆ·ç«¯æŒä¹…åŒ–è¿™ä¸¤ä¸ªbrokerä¸­éå¸¸é‡è¦çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;h3&gt;æŒä¹…åŒ–&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯åªçœ‹Redisçš„å®ç°ã€‚å…¶å®Rediså¹¶ä¸æ˜¯çœŸæ­£çš„æŒä¹…åŒ–ï¼Œä¸è¿‡who caresã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„æŒä¹…åŒ–å°±åŒ…æ‹¬äº†ç¦»çº¿æ¶ˆæ¯å’Œå®¢æˆ·ç«¯æŒä¹…åŒ–ä¸¤ä¸ªæ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;ç¦»çº¿æ¶ˆæ¯ä½¿ç”¨&lt;code&gt;packet:{client_id}&lt;/code&gt;ä¸ºkeyè¿›è¡Œä¿å­˜ï¼Œå½“ç”¨æˆ·ç¦»çº¿æ—¶ï¼Œbrokerä¼šå°†æ¶ˆæ¯å…ˆä¿å­˜åœ¨redisä¸­ï¼Œå½“ç”¨æˆ·é‡æ–°ä¸Šçº¿æ—¶ï¼Œå°±å°†ä¿å­˜å¥½çš„æ¶ˆæ¯ä¸€å£æ°”æ¨é€è¿‡å»ã€‚&lt;/p&gt;
&lt;p&gt;å®¢æˆ·ç«¯æŒä¹…åŒ–ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚å®¢æˆ·ç«¯åœ¨brokerä¸­çš„çŠ¶æ€æ˜¯å…¶è®¢é˜…çš„topicï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œbrokerä¼šä¸€ç›´ä¿å­˜ç”¨æˆ·æ‰€è®¢é˜…çš„topicï¼Œä»¥ä¾¿ä¿å­˜ç”¨æˆ·çš„ç¦»çº¿ä¿¡æ¯ã€‚å½“brokeræ‰ç”µæˆ–é‡å¯æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»æŒä¹…åŒ–å±‚å°†ç”¨æˆ·çš„çŠ¶æ€é‡æ–°loadåˆ°å†…å­˜ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨&lt;code&gt;client:sub:{client_id}&lt;/code&gt;ä¸ºkeyè¿›è¡Œä¿å­˜ã€‚&lt;/p&gt;
&lt;h3&gt;æ•´ä½“å·¥ä½œæµç¨‹&lt;/h3&gt;
&lt;p&gt;åœ¨Moscaå¯åŠ¨æ—¶ï¼Œå…ˆä¼šæ³¨å†Œä¸€äº›äº‹ä»¶ï¼Œæ¯”å¦‚â€œç”¨æˆ·ç™»å½•â€ï¼Œâ€œç”¨æˆ·ä¸‹çº¿â€ï¼Œâ€œç”¨æˆ·è®¢é˜…â€ç­‰ã€‚è¿™äº›æ¶ˆæ¯ç”±é…ç½®æ–‡ä»¶å†³å®šæ˜¯å¦ä¸‹å‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§è®¾è®¡æ˜¯ä¸ºäº†æ–¹ä¾¿brokerçš„scale outï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªMQä¸Šé¢éƒ¨ç½²å¤šä¸ªbrokerï¼Œè¿™äº›brokeré€šè¿‡MQçš„&lt;code&gt;$SYS&lt;/code&gt;ä¿¡é“è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;å½“Moscaå¯åŠ¨å®Œæˆåï¼Œæˆ‘ä»¬åƒä¸Šé¢ä¸€æ ·ï¼Œé‡ç‚¹å…³æ³¨brokerçš„ä¸‰ä¸ªé‡è¦äº‹ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;subscribe&lt;/li&gt;
&lt;li&gt;publish&lt;/li&gt;
&lt;li&gt;unsubscribe&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™äº›äº‹ä»¶ç†è®ºä¸Šæ˜¯Ascoçš„å°è£…ï¼Œæ·»åŠ äº†æƒé™æ§åˆ¶æ¥å£ã€æ›´å¤æ‚çš„äº‹ä»¶ï¼Œå½“ç„¶è¿˜æœ‰æŒä¹…åŒ–çš„æ”¯æŒã€‚ä¾‹å¦‚&lt;code&gt;subscribe&lt;/code&gt;äº‹ä»¶ï¼Œé™¤äº†è°ƒç”¨Ascoä¹‹å¤–ï¼Œè¿˜å°†ç”¨æˆ·çš„è¿™æ¬¡è®¢é˜…è®°å½•åœ¨äº†æŒä¹…å±‚é‡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;publish&lt;/code&gt;äº‹ä»¶åˆ™æ˜¯å…ˆå°†æ•°æ®åŒ…å­˜æ”¾åœ¨æŒä¹…å±‚ï¼Œå†è°ƒç”¨Ascoçš„publishå‡½æ•°ã€‚&lt;code&gt;unsubscribe&lt;/code&gt;ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚&lt;/p&gt;
&lt;h3&gt;è¡¥ä¸€å¼ ç»“æ„å›¾&lt;/h3&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/public/16-11-11/55787779.jpg" /&gt;&lt;/p&gt;
&lt;h3&gt;Moscaçš„å¯æ‰©å±•æ€§&lt;/h3&gt;
&lt;p&gt;æ ¹æ®æˆ‘æµ…è–„çš„ç†è§£ï¼ŒMoscaæ˜¯å¯ä»¥æ”¯æŒscale outçš„ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨åŒä¸€ä¸ªMQï¼ˆæˆ–åŒä¸€ä¸ªMQæŠ½è±¡ï¼‰ä¸Šéƒ¨ç½²å¤šä¸ªMoscaï¼Œä»¥æœåŠ¡æ›´å¤šçš„ç”¨æˆ·ã€‚ä½†æ˜¯ä¸€ä¸ªç”¨æˆ·å¿…é¡»ä¸¥æ ¼å¯¹åº”ä¸€ä¸ªshardï¼Œå¦åˆ™ä¼šå‡ºç°æ¶ˆæ¯çš„é‡å¤ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥åœ¨Clientç«¯è§£å†³ï¼Œä½†æ˜¯ä¸åº”è¯¥æ˜¯ä¸€ç§å¸¸æ€ï¼Œåªåº”è¯¥åœ¨ç”¨æˆ·è¿ç§»æˆ–è€…æ¯”è¾ƒå¤§çš„ç³»ç»Ÿå˜åŠ¨çš„æ—¶å€™æ‰å‡ºç°ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºMoscaçš„æŒä¹…åŒ–å±‚æ˜¯ä»¥Clientä¸ºKeyçš„ï¼Œæ‰€ä»¥ä¸æ”¯æŒå¤šMQçš„æ¨¡å¼ã€‚MQçš„æ‰©å±•éœ€è¦ç”±MQè‡ªå·±æ¥å®Œæˆï¼Œå¯¹å¤–æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æŠ½è±¡å³å¯ã€‚ä¸è¿‡è¿™ç§åŠŸèƒ½ï¼Œå¹¶ä¸è¢«æ‰€æœ‰MQæ‰€æ”¯æŒã€‚&lt;/p&gt;
&lt;h2&gt;Disclaimer&lt;/h2&gt;
&lt;p&gt;çœŸæ˜¯nodejså°ç™½ä»¥åŠMQå°ç™½ï¼Œä¸Šé¢è¯´çš„å“ªé‡Œä¸å¯¹ï¼Œè¯·å¸®å¿™æå‡ºæ¥ã€‚å¼ºçƒˆå»ºè®®ä¸è¦ä»¥æœ¬æ–‡ä¸­çš„ä»»ä½•è§‚ç‚¹ä¸åŠ æµ‹è¯•çš„åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒå½“ä¸­å»ã€‚&lt;/p&gt;</summary><category term="mosca"></category><category term="mq"></category><category term="message queue"></category></entry><entry><title>æ€»ç»“ - phxrpcä»£ç é˜…è¯»(8)</title><link href="http://wizmann.tk/phxrpc-8.html" rel="alternate"></link><updated>2016-10-23T15:50:44+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-23:phxrpc-8.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;è¿™åº”è¯¥æ˜¯phxrpcä»£ç é˜…è¯»ç³»åˆ—æ­£æ–‡çš„æœ€åä¸€ç¯‡ã€‚é€šè¿‡é˜…è¯»ä»£ç ï¼Œå‘ç°äº†è‡ªå·±åœ¨çŸ¥è¯†ä¸Šçš„è‹¥å¹²ä¸è¶³ã€‚&lt;/p&gt;
&lt;p&gt;ä¸´æ¸Šç¾¡é±¼ï¼Œä¸å¦‚é€€è€Œç»“ç½‘ã€‚æ¥ä¸‹æ¥å¯èƒ½ä¼šåœ¨ç½‘ç»œç¼–ç¨‹æ–¹é¢å†ä¸‹ä¸€ç‚¹å·¥å¤«ã€‚è¯·å¤§å®¶æœŸå¾…ä¸‹ä¸€ä¸ªç³»åˆ—å§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…¶å®çœŸæ²¡äººè¯»ï¼Œæˆ‘å°±æ˜¯åœ¨éª—è‡ªå·±ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;å…ˆè¡¥å……ä¸€ç‚¹ - ä»£ç ç”Ÿæˆ&lt;/h2&gt;
&lt;p&gt;protobufå¹¶ä¸åŒ…å«RPCçš„å®ç°ï¼Œä½†æ˜¯å®ƒå¯ä»¥å£°æ˜rpcã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éœ€è¦å®ç°RPCæ¥å£ï¼Œæ¥å®ç°é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;phxrpcä½¿ç”¨protoæ–‡ä»¶æ¥å®šä¹‰æ¥å£ï¼Œç„¶åè§£æå¹¶ä½¿ç”¨ä»£ç æ¨¡æ¿è¿›è¡Œç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬ä¸è®¨è®ºä»£ç ç”Ÿæˆçš„ç»†èŠ‚ï¼Œå› ä¸ºpbå®åœ¨å¤ªè¿‡æµè¡Œï¼Œä»£ç ç”Ÿæˆçš„æ–¹æ³•ä¹Ÿæœ‰ä¸å°‘çš„æµæ´¾ã€‚å¹¶ä¸”ç”¨C++æ¥åšä»£ç ç”Ÿæˆï¼ŒçœŸå¿ƒä¸æ˜¯æˆ‘çš„èœã€‚&lt;/p&gt;
&lt;p&gt;æƒ³äº†è§£æ›´å¤šï¼Œå¯ä»¥å‚è€ƒ&lt;a href="http://codemacro.com/2014/08/31/protobuf-rpc/"&gt;è¿™ç¯‡åšå®¢&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2&gt;å·¥ä½œæµç¨‹ - å®¢æˆ·ç«¯&lt;/h2&gt;
&lt;p&gt;å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„é€šä¿¡æœ‰å¦‚ä¸‹çš„ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿æ¥å°‘&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å°‘&lt;/li&gt;
&lt;li&gt;é€šä¿¡çš„ä¸»åŠ¨æ–¹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæ‰€æœ‰çš„ç½‘ç»œäº¤äº’ç›¸å…³çš„å†…å®¹å¯ä»¥æ‰˜ç®¡ç»™ç½‘ç»œåº“ä¸­çš„åç¨‹ã€‚æ¯ä¸ªåç¨‹ä¸»åŠ¨è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œä¸»åŠ¨æ”¾å¼ƒCPUæ—¶é—´ï¼Œå°†æ§åˆ¶æƒäº¤è¿˜ç»™ä¸»æ§åˆ¶æµçš„epollã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åç¨‹ä¸­ä¸èƒ½æœ‰CPUå¯†é›†çš„è¿ç®—ï¼Œå¹¸å¥½é¢å¯¹å¼€å‘è€…ï¼Œphxrpcå¹¶ä¸æš´éœ²å†…éƒ¨å‡½æ•°ï¼Œè€Œæ˜¯å°†CPUå¯†é›†çš„è¿ç®—åˆ†é…ç»™å·¥ä½œçº¿ç¨‹æ¥å®Œæˆã€‚&lt;/p&gt;
&lt;h2&gt;å·¥ä½œæµç¨‹ - æœåŠ¡ç«¯&lt;/h2&gt;
&lt;p&gt;æœåŠ¡å™¨çš„é€šä¿¡æœ‰ä»¥ä¸‹çš„ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿æ¥å¤š&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å¤š&lt;/li&gt;
&lt;li&gt;é€šä¿¡çš„è¢«åŠ¨æ–¹&lt;/li&gt;
&lt;li&gt;å“åº”æ—¶é—´æ•æ„Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œè¯´ä¸€ä¸‹å“åº”æ—¶é—´çš„é—®é¢˜ï¼Œå“åº”æ—¶é—´æ˜¯å’Œè´Ÿè½½å¤šå¯¹åº”çš„ã€‚å®¢æˆ·ç«¯ä¸€èˆ¬åªè´Ÿè´£å‘è¯·æ±‚ï¼Œå…¶å“åº”æ—¶é—´å¹¶ä¸åœ¨æ•´ä¸ªç³»ç»Ÿä¸­å ä¸»å¯¼åœ°ä½ï¼Œæ¢å¥è¯è¯´ï¼Œå®¢æˆ·ç«¯å‘è¯·æ±‚æ˜¯å®Œå…¨æœ‰ä¸»åŠ¨æƒçš„ã€‚è€ŒæœåŠ¡ç«¯è´Ÿè´£å“åº”è¯·æ±‚ï¼Œéœ€è¦ç»è¿‡CPUè¿ç®—ï¼Œæˆ–è€…æœ‰ä¸€äº›æœåŠ¡çš„çº§è”æˆ–æ‰‡å‡ºæ“ä½œï¼Œæ‰€ä»¥å“åº”æ—¶é—´æ˜¯ä¸å¯æ§çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç”±ä¸Šé¢æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼ŒæœåŠ¡å™¨ç«¯è‚¯å®šéœ€è¦ä¸å®¢æˆ·ç«¯ä¸åŒçš„ç­–ç•¥æ¥å¤„ç†è¿æ¥ä¸å“åº”ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æ¥&lt;strong&gt;åŒæ­¥&lt;/strong&gt;acceptè¯·æ±‚ï¼Œè¿™ä¸ªçº¿ç¨‹å¤§éƒ¨åˆ†çš„æ—¶é—´éƒ½blockåœ¨&lt;code&gt;accept()&lt;/code&gt;é‡Œï¼Œè´Ÿè½½æ¯”è¾ƒä½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨acceptåˆ°fdåï¼Œå°†å…¶å‹å…¥åˆ°è°ƒåº¦å™¨ä¸­ã€‚ä¹‹åfdä¼šhangåœ¨IOå¾ªç¯ä¸Šï¼Œç›´åˆ°æœ‰è¯·æ±‚åˆ°æ¥ã€‚ä¸æ­¤åŒæ—¶ï¼Œåç¨‹ä¼šè°ƒåº¦å…¶å®ƒçš„fdã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ±‚åˆ°æ¥åï¼ŒIOçº¿ç¨‹ä¼šæŠŠè¯·æ±‚åŠ å…¥é˜Ÿåˆ—ä¸­ï¼ŒæŠŠè‡ªå·±ä»epollè°ƒåº¦ä¸­åˆ é™¤ã€‚ä¹‹åå°±å¼€å§‹ç¡è§‰è§‰ã€‚ç¡é†’äº†ä¹‹åï¼Œå‘ç°å“åº”æ²¡åˆ°ç¢—é‡Œæ¥ï¼Œå°±shutdownè¿æ¥ã€‚(æˆ‘è§‰å¾—è¿™é‡Œåº”è¯¥åŠ å…¥é‡è¯•ï¼Œä¾‹å¦‚ä¸‰æ¬¡å¤±è´¥å†æ–­çº¿)&lt;/p&gt;
&lt;p&gt;å¦‚æœå“åº”æ¥äº†ï¼Œå…ˆä¼šè°ƒç”¨ä¸€ä¸ªæ¿€æ´»fdçš„æ“ä½œï¼Œå°†å“åº”æ”¾åˆ°å°è£…fdçš„ç»“æ„ä½“ä¸­ï¼Œå†å°†è‡ªå·±æ”¾å›åˆ°epollè°ƒåº¦ï¼Œæœ€åé¡ºæ‰‹ç»™epollå‘ä¸€ä¸ªä¿¡å·ã€‚å½“fdå¯å†™æ—¶ï¼Œå†æŠŠå“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºphxrpcä½¿ç”¨çš„é€šä¿¡åè®®æ˜¯HTTPï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘åˆ†åŒ…çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2&gt;å¯èƒ½çš„æ”¹è¿›&lt;/h2&gt;
&lt;h3&gt;è°ƒåº¦å™¨çš„è¶…æ—¶&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nfds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;epoll_wait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epoll_fd_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_task_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ®µè°ƒåº¦å™¨ä¸­çš„ä»£ç ï¼Œç”Ÿç”Ÿçš„æŠŠIOå¤ç”¨æ¨¡å‹æ”¹æˆäº†è½®è¯¢ã€‚çŒœæµ‹è¿™æ˜¯ä¸ºäº†ç…§é¡¾è¶…æ—¶å®šæ—¶å™¨ï¼Œä½†å®é™…ä¸Šè¿™ä¸ªå¹¶æ— å¿…è¦ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code&gt;timerfd&lt;/code&gt;å’Œ&lt;code&gt;eventfd&lt;/code&gt;æ¥å–ä»£å®šæ—¶å™¨ã€‚ä½†æ˜¯è¿™åªæ˜¯ä¸€ç§çŒœæµ‹ï¼Œè¿™ç§å†™æ³•å¯èƒ½ä¹Ÿæ˜¯æœ‰æ€§èƒ½ä¸Šçš„è€ƒè™‘å§ã€‚&lt;/p&gt;
&lt;h3&gt;ä»£ç é£æ ¼&lt;/h3&gt;
&lt;p&gt;ä»£ç é£æ ¼å¯èƒ½æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ³›çš„é—®é¢˜ï¼Œä½†æ˜¯phxrpcçš„ä»£ç æˆ‘èƒ½æ˜æ˜¾çš„æ„Ÿè§‰åˆ°ç¼–ç é£æ ¼çš„ä¸åŒã€‚ä»¥åŠå…ƒç´ å±‚æ¬¡ä¸æ˜æœ—ï¼Œä¸Šä¸‹çº§æ¨¡å—ç›¸äº’è€¦åˆçš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h3&gt;æ²¡æœ‰æµ‹è¯•ï¼æ²¡æœ‰æµ‹è¯•ï¼æ²¡æœ‰æµ‹è¯•ï¼&lt;/h3&gt;
&lt;p&gt;å› ä¸ºphxrpcæ²¡æœ‰æµ‹è¯•ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä¸¥é‡æ€€ç–‘è¿™å°±æ˜¯ä¸€ä¸ªç©ç¥¨çš„é¡¹ç›®ï¼Œæ²¡æœ‰ï¼ˆæˆ–æš‚æ—¶æ²¡æœ‰ï¼‰åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šè¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰å¯èƒ½çš„è¯ï¼Œè¯·åŠ ä¸Šæ€§èƒ½æµ‹è¯•ï¼è¯·åŠ ä¸ŠåŠŸèƒ½æµ‹è¯•ï¼è¯·åŠ ä¸Šæ€§åŠŸèƒ½æµ‹è¯•ï¼&lt;/p&gt;
&lt;h2&gt;å†™åœ¨åé¢&lt;/h2&gt;
&lt;p&gt;æ—¶é—´ä»“ä¿ƒï¼Œæ°´å¹³æœ‰é™ã€‚å†™ç‚¹ä¸œè¥¿ï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ äº¤æµã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘å†™çš„å“ªé‡Œä¸å¯¹ï¼Œ99%çš„é”…å½’æˆ‘å‚»é€¼ï¼Œ1%çš„é”…å½’phxrpcä»£ç æ²¡å†™æµ‹è¯•ã€‚æ¬¢è¿å¤§å®¶å¤šåšè‡ªæˆ‘æ‰¹è¯„ã€‚&lt;/p&gt;
&lt;p&gt;å¥½å•¦å¥½å•¦ï¼Œå°±åˆ°è¿™é‡Œå§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-23/91802175.jpg" /&gt;&lt;/p&gt;</summary><category term="phxrpc"></category><category term="rpc"></category></entry><entry><title>RPC - phxrpcä»£ç é˜…è¯»(7)</title><link href="http://wizmann.tk/phxrpc-7.html" rel="alternate"></link><updated>2016-10-22T23:03:36+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-22:phxrpc-7.html</id><summary type="html">&lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;çœ‹äº†è¿™ä¹ˆä¹…ä»£ç ï¼Œç»ˆäºæˆ‘ä»¬è¦æ¥è¿‘phxrpcçš„æ ¸å¿ƒéƒ¨åˆ†äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å‡ºäººæ„æ–™çš„æ˜¯ï¼Œrpcéƒ¨åˆ†å¹¶æ²¡æœ‰è¿‡å¤šçš„æ¦‚å¿µå’Œmagic trickã€‚è€Œä¸”å› ä¸ºucontextå·²ç»è¢«å°è£…å¥½äº†ï¼Œæ‰€ä»¥åœ¨rpcé‡Œçš„æ“ä½œï¼Œå¯ä»¥å®Œå…¨æŒ‰ç…§åŒæ­¥çš„å†™æ³•æ¥æï¼Œå¼€å‘è€…ä»¬ä¸éœ€è¦åˆ‡æ¢åŒæ­¥å¼‚æ­¥çš„æ€ç»´æ¨¡å¼ï¼Œå°±å¯ä»¥åœ¨åº•å±‚çš„å°è£…ä¹‹ä¸Šï¼Œåšè‡ªå·±æƒ³åšçš„äº‹äº†ã€‚&lt;/p&gt;
&lt;h2&gt;çº¿ç¨‹å®‰å…¨(?)çš„é˜Ÿåˆ— - ThreadQueue&lt;/h2&gt;
&lt;p&gt;æˆ‘ä¸çŸ¥é“å¼€å‘è€…ä¸ºå•¥è¦èµ·&lt;code&gt;ThdQueue&lt;/code&gt;è¿™æ ·ä»¤äººè¿·æƒ‘çš„åå­—ï¼Œè¿™ç§è¯¡å¼‚çš„å‘½åé£æ ¼è´¯ç©¿äº†æ•´ä¸ªä»£ç ã€‚å’‹ä¸€çœ‹è¿™ä¸ªç±»æ˜¯maintainä¸€å †çº¿ç¨‹çš„ï¼Œç±»ä¼¼äºçº¿ç¨‹æ± ï¼Œä½†å…¶å®è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ª&lt;code&gt;BlockingQueue&lt;/code&gt;çš„å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åï¼Œè¿™ä¸ªé˜Ÿåˆ—æœ‰ä¸‰ç§æ“ä½œï¼Œ&lt;code&gt;push&lt;/code&gt;ã€&lt;code&gt;pluck&lt;/code&gt;å’Œ&lt;code&gt;break_out&lt;/code&gt;ã€‚pushæ“ä½œä¸ç”¨å¤šè¯´ï¼Œpluckå¯¹åº”çš„æˆ‘ä»¬æ‰€ç†è§£çš„popæ“ä½œï¼Œå³ä»é˜Ÿåˆ—ä¸­å¼¹å‡ºå…ƒç´ ï¼ˆpluckè¿™ä¸ªè¯è²Œä¼¼æ˜¯ä»grpcé‡Œé¢æ¥çš„ï¼Œé‚£æˆ‘å°±ä¸åæ§½äº†ï¼Œæ¯•ç«ŸGoogleçˆ¸çˆ¸ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ›´ä»¤äººç–‘æƒ‘çš„æ˜¯&lt;code&gt;break_out&lt;/code&gt;è¿™ä¸ªæ“ä½œã€‚ä»ä»£ç æ¥çœ‹ï¼Œåƒæ˜¯æ¸…ç©ºé˜Ÿåˆ—ï¼Œå¹¶ä¸”åœ¨dtorä¸­ä¹Ÿæ˜¾å¼çš„è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æœ‰ä»¥ä¸‹çš„å‡ ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ï¼Œ&lt;code&gt;break_out_&lt;/code&gt;æ˜¯ä¸€ä¸ªboolå˜é‡ï¼Œä¸”åœ¨ä¸åŒçº¿ç¨‹é—´å…±äº«ï¼Œé—®é¢˜åœ¨äºè¿™ä¸ªå˜é‡å¯èƒ½è¢«cacheä½ï¼Œç›´æ¥è®¿é—®å¯èƒ½ä¼šé€ æˆéé¢„æœŸçš„ç»“æœï¼Œå¯èƒ½éœ€è¦&lt;code&gt;volitaile&lt;/code&gt;ï¼Œæˆ–è€…åœ¨&lt;code&gt;pluck&lt;/code&gt;å‡½æ•°é‡ŒåŠ ä¸€ä¸ªmem barrierã€‚&lt;/p&gt;
&lt;p&gt;äºŒæ¥ï¼Œåœ¨ææ„å‡½æ•°ä¸­è°ƒç”¨&lt;code&gt;break_out_&lt;/code&gt;ï¼Œæœ‰å¯èƒ½çš„ä¸€ç§æƒ…å†µæ˜¯æœ‰å…¶å®ƒçº¿ç¨‹è¿˜åœ¨&lt;code&gt;pluck&lt;/code&gt;å‡½æ•°ä¸­ï¼Œè€Œ&lt;code&gt;ThdQueue&lt;/code&gt;å¯¹è±¡å·²ç»è¢«ææ„äº†ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¿æ‹…è¿™ç§ä¸å®‰å…¨è¡Œä¸ºçš„åæœï¼ˆæ­¤å¤„æœ‰å¹¿å‘Šï¼šå¤§é“æ£å­åŒ»é™¢æ…ä¸»ä»»ï¼Œå¼ å§å»äº†éƒ½è¯´å¥½ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°åªåœ¨ç»“æŸè¿›ç¨‹æ—¶ä½¿ç”¨ï¼Œå…¶å®å†™çš„ç³™ä¸€ç‚¹ä¹Ÿæ— æ‰€è°“ï¼Œå› ä¸ºæ¯•ç«Ÿçº¿ä¸ŠæœåŠ¡æ˜¯æ²¡æœ‰â€œé€€å‡ºâ€è¿™ç§çŠ¶æ€çš„ã€‚å½“æˆ‘ä»¬è¦æ¸…ç©ºé˜Ÿåˆ—æ—¶ï¼Œå·²ç»ä¸éœ€è¦å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¹‹åç›´æ¥&lt;code&gt;kill -9&lt;/code&gt;å°±å¥½ï¼Œä¸ä¼šè§¦å‘å¤šçº¿ç¨‹çš„å‘ã€‚ä¸è¿‡ï¼Œè¿™é‡Œæˆ‘è§‰å¾—åº”è¯¥è¿˜æ˜¯è¦åŠ å°å¿ƒã€‚&lt;/p&gt;
&lt;h2&gt;UThreadCaller&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªç ´ç±»è®©æˆ‘çœ‹äº†ä¸€å°æ—¶ï¼Œåˆ†æå®ƒçš„keepaliveæ˜¯æ€ä¹ˆå®ç°çš„ã€‚ç»“æœå‘ç°è¿™ä¸ªç±»è¢«æ²¡æœ‰è¢«è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;GGã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-22/54117736.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;ä¸€ä¸ªè¶…çº§æ–‡ä»¶ - HshaServer&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸çŸ¥é“ä¸ºå•¥å¼€å‘è€…è¦æŠŠè¿™ä¹ˆå¤šæ–‡ä»¶å†™ä¸€å—ï¼Œæ‹†å¼€ä¸å¥½å—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;DataFlow&lt;/h3&gt;
&lt;p&gt;DataFlowåŒ…å«äº†Requestå’ŒResponseä¸¤ä¸ªQueueï¼Œè¿˜é™„åŠ äº†å…¥é˜Ÿçš„æ—¶é—´æˆ³å’Œä¸€ä¸ªargså‚æ•°æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;h3&gt;HshaServerStat&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªç»Ÿè®¡ç±»ã€‚ä¼šåœ¨åå°æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œçº¦æ¯ä¸€ç§’æ‰“å°ä¸€æ¬¡ç»Ÿè®¡æ—¥å¿—ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç±»é‡Œæœ‰ä¸€ä¸ªæŠ€å·§ï¼Œåœ¨&lt;code&gt;CallFunc()&lt;/code&gt;å‡½æ•°ä¸­ï¼Œæ¯ä¸€ç§’å¾ªç¯ä¸€æ¬¡å¹¶æ²¡æœ‰ä½¿ç”¨sleepå®¶æ—çš„å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨selectçš„è¶…æ—¶ã€‚è€Œæ˜¯ä½¿ç”¨äº†&lt;code&gt;condtional variable&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;std::condition_variable::wait_for&lt;/code&gt;å‡½æ•°ï¼Œå®è´¨æ˜¯å°±æ˜¯å¸¦è¶…æ—¶çš„ç­‰å¾…ã€‚è€Œè¿™é‡Œï¼Œåœ¨ä¸€èˆ¬çŠ¶æ€ä¸‹ï¼Œæ˜¯æ²¡æœ‰çº¿ç¨‹ä¼šnotifyçš„ï¼Œæ‰€ä»¥wait_forå‡½æ•°ä¼šç¡æ»¡1sã€‚ä½†æ˜¯åœ¨é€€å‡ºæ—¶ï¼Œä¼šæ˜¾å¼çš„notifyç»Ÿè®¡çº¿ç¨‹ï¼Œç ´åç­‰å¾…çŠ¶æ€ï¼Œä½¿ç»Ÿè®¡çº¿ç¨‹é€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;wait_for&lt;/code&gt;å‡½æ•°çš„å…·ä½“ç”¨æ³•ï¼Œå¯ä»¥å‚è€ƒ&lt;a href="http://en.cppreference.com/w/cpp/thread/condition_variable/wait_for"&gt;æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„&lt;code&gt;HshaServerQos&lt;/code&gt;ä¹Ÿæ˜¯ä¸€æ ·çš„æ€è·¯ï¼ŒQoså³â€œQuality of serviceâ€ã€‚&lt;/p&gt;
&lt;h3&gt;Workerå’ŒWorkerPool&lt;/h3&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªç±»å…¶å®æ˜¯ä¸€ä¸ªå’Œä¸€å †çš„å…³ç³»ï¼Œä¸è¿‡ç”±äºè¿™é‡Œçš„è¯¡å¼‚çš„å†™æ³•ï¼Œå¯¼è‡´ä¸€ä¸ªä¾èµ–ä¸€å †ï¼Œä¸€å †è°ƒç”¨ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;WorkerPoolæ˜¯ä¸€ä¸ªå…¨å±€çš„çº¿ç¨‹æ± ï¼Œé‡Œé¢æœ‰çº¿ç¨‹ï¼ˆåºŸè¯ï¼‰ï¼Œè¾“å…¥è¾“å‡ºé˜Ÿåˆ—ï¼ŒDisipatcherå’Œè°ƒåº¦å™¨ã€‚æ‰€ä»¥Workerè¦åè¿‡æ¥ä¾èµ–WorkerPoolé‡Œé¢çš„æ•°æ®ã€‚é€ æˆäº†å¾ˆå¤§çš„è€¦åˆæ€§ã€‚&lt;/p&gt;
&lt;p&gt;Workerä»è¾“å…¥é˜Ÿåˆ—ä¸­è·å–ä¿¡æ¯ï¼Œå¹¶ä¸”ä½¿ç”¨&lt;code&gt;dispatcher&lt;/code&gt;è¿›è¡ŒCPUå¯†é›†çš„å¤„ç†ï¼ˆæˆ‘è§‰å¾—&lt;code&gt;dispatcher&lt;/code&gt;è¿™ä¸ªåå­—èµ·çš„ä¹Ÿæœ‰é—®é¢˜ï¼‰ã€‚ä¹‹åå°†ç»“æœæ”¾å…¥è¾“å‡ºé˜Ÿåˆ—ï¼Œç”±åé¢çš„&lt;code&gt;HshaServerIO::ActiveSocketFunc&lt;/code&gt;é©±åŠ¨åç¨‹åº“è¿›è¡Œä¹‹åçš„IOæ“ä½œã€‚&lt;/p&gt;
&lt;h3&gt;å®Œæˆè°ƒåº¦å™¨ - HshaServerIO&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç±»çš„ä¸»è¦ä½œç”¨å°±æ˜¯è¡¥å…¨è°ƒåº¦å™¨ç¼ºå°‘çš„å‡½æ•°ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªIOçš„å·¥ä½œå‡½æ•°&lt;code&gt;HshaServerIO::IOFunc&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è°ƒåº¦å™¨çš„å·¥ä½œæµç¨‹å‰é¢å·²ç»è¯´è¿‡äº†ï¼Œæˆ‘ä»¬ç°åœ¨å°±ä»æ›´å…·ä½“åŒ–çš„å®ç°ä¸Šæ¥é˜…è¯»ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;HshaServerIO :: AddAcceptedFd&lt;/code&gt;ï¼Œè¿™ä¸ªå‡½æ•°ç”±å¤–éƒ¨è°ƒç”¨ï¼Œä¼ å…¥å·²ç»acceptçš„fdï¼Œä¹‹å&lt;code&gt;HshaServerIO::HandlerAcceptedFd&lt;/code&gt;å°†è¿™ä¸ªfdï¼Œå’ŒIOå·¥ä½œå‡½æ•°&lt;code&gt;IOFunc&lt;/code&gt;ä¸€èµ·æ”¾å…¥è°ƒåº¦å™¨ä¸­è¿›è¡Œè°ƒåº¦ã€‚&lt;/p&gt;
&lt;p&gt;å·¥ä½œå‡½æ•°&lt;code&gt;IOFunc&lt;/code&gt;åªè´Ÿè´£å°†è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ï¼Œè€Œå¹¶ä¸è´Ÿè´£ä»è¾“å‡ºé˜Ÿåˆ—ä¸­å–å‡ºå“åº”ã€‚è¿™ä¸ªäº‹æƒ…ç”±&lt;code&gt;HshaServerIO::ActiveSocketFunc&lt;/code&gt;è´Ÿè´£ã€‚&lt;/p&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼Œåœ¨è°ƒåº¦å™¨çš„å·¥ä½œå¾ªç¯ä¸­ï¼Œ&lt;code&gt;epoll_wait&lt;/code&gt;ä¸­ç­‰å¾…çš„åªæœ‰åœ¨è¿›è¡ŒIOçš„ä¸¤ç§fdï¼Œä¸€æ˜¯è¯»è¿˜æ²¡è¯»å®Œçš„ï¼ŒäºŒæ˜¯å†™è¿˜æ²¡å†™å®Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿›è¡Œå®ŒCPUæ“ä½œçš„fdï¼Œç”±&lt;code&gt;active_socket_func_&lt;/code&gt;å‡½æ•°é‡æ–°æ¿€æ´»ï¼Œå‘å®¢æˆ·ç«¯å†™å›å“åº”ã€‚æ‰€ä»¥è¿™ä¸ªå‡½æ•°åº”è¯¥å«&lt;code&gt;activate_socket_with_resp_func_&lt;/code&gt;æ›´åˆé€‚ä¸€äº›ã€‚ï¼ˆè‡³å°‘ç¬¬ä¸€ä¸ªå•è¯å¾—æ˜¯ä¸ªåŠ¨è¯å¥½ä¸ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;åé¢çš„keepaliveçš„å¤„ç†ä¹Ÿæ˜¯éå¸¸æµ…æ˜¾çš„ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚&lt;/p&gt;
&lt;h3&gt;å¤šçº¿ç¨‹IO - HshaServerUnitå’ŒHshaServer&lt;/h3&gt;
&lt;p&gt;å‰é¢æˆ‘ä»¬è¯´äº†ä¸å°‘åç¨‹çš„äº‹ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬ä¸ä½¿ç”¨å¤šçº¿ç¨‹å¸¦æ¥çš„çº¢åˆ©ã€‚æˆ–è€…è‡³å°‘åœ¨æ€§èƒ½ä¸ç¬¦åˆé¢„æœŸçš„æ—¶å€™ï¼Œç”¨å¤šçº¿ç¨‹æ¥tuningä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;HashServerUnitåŒ…è£…äº†ä¸€ç»„çº¿ç¨‹ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªIOçº¿ç¨‹å’Œè‹¥å¹²CPUçº¿ç¨‹ã€‚æˆ‘ä»¬åœ¨HshaServerä¸­ï¼Œè¿˜å¯ä»¥é…ç½®å¤šä¸ªUnitï¼Œä½¿å¾—æˆ‘ä»¬æœ‰å¤šä¸ªIOçº¿ç¨‹ï¼Œå……åˆ†æ¦¨å¹²CPUå’ŒIOçš„æ¯ä¸€æ»´æ±—æ°´ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ‰‹é‡Œä¹Ÿæ²¡æœ‰æµ‹è¯•æ•°æ®ï¼Œä¹Ÿå°±ä¸èƒ½æ›´è¯¦ç»†çš„æ¥è¯´é…ç½®æœåŠ¡å‚æ•°çš„ç­–ç•¥ã€‚ä½†æ˜¯æ— è´£ä»»çŒœæµ‹ï¼ŒIOçº¿ç¨‹åº”è¯¥ä¸è¶…è¿‡3ä¸ªã€‚CPUçº¿ç¨‹æ•°ç›®åº”è¯¥ç•¥å¤šäºCPUæ ¸æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;ä¸€ä¸ªç‹¬ç«‹çš„Acceptor&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;HshaServerAcceptor&lt;/code&gt;ç±»ç›¸å¯¹æ¯”è¾ƒç‹¬ç«‹ï¼Œå®ƒæ˜¯ç”¨æ¥æ¥å—è®¿é—®è¯·æ±‚ã€‚æ˜¯ä¸»çº¿ç¨‹çš„å·¥ä½œå¾ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ¯”è¾ƒå¥‡æ€ªçš„æ˜¯ï¼Œ&lt;code&gt;LoopAccept&lt;/code&gt;å‡½æ•°è®¾ç½®äº†CPUäº²å’Œæ€§ã€‚ä½¿å¾—æ§åˆ¶çº¿ç¨‹åªåœ¨CPU0ä¸Šè¿è¡Œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="kt"&gt;cpu_set_t&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;CPU_ZERO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;CPU_SET&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;pid_t&lt;/span&gt; &lt;span class="n"&gt;thread_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sched_setaffinity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;thread_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…·ä½“åŸå› æœ‰å¾…æ¢è®¨ï¼Œå¯èƒ½æ˜¯å’Œä¸­æ–­äº²å’Œæ€§æœ‰å…³ã€‚&lt;/p&gt;
&lt;h2&gt;å†™åœ¨åé¢&lt;/h2&gt;
&lt;p&gt;æ€»ç®—å›«å›µåæ£çš„æŠŠè¿™RPCè¯»å®Œäº†ï¼Œå…¶å®è¿™é‡Œè¿˜æ˜¯æœ‰å¥½å¤šç–‘é—®çš„ã€‚ä½†æ˜¯ç”±äºphxrpcçš„æ–‡æ¡£å®åœ¨æ˜¯ã€‚ã€‚ã€‚åŸºæœ¬ç®—æ˜¯æ²¡æœ‰å§ã€‚æ‰€ä»¥å¯èƒ½è¿˜è¦å»Githubä¸Šæä¸€æ³¢Issueã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼ŒçœŸçš„æ„Ÿè§‰è‡ªå·±æ‡‚çš„è¿˜æ˜¯å¤ªå°‘ã€‚ç®€ç›´è¯ä¸¸ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜éœ€è¦æ›´åŠ åŠªåŠ›æ‰å¥½ã€‚&lt;/p&gt;</summary><category term="phxrpc"></category><category term="rpc"></category></entry><entry><title>éé˜»å¡TCPæµå’ŒHttpClient - phxrpcä»£ç é˜…è¯»(6)</title><link href="http://wizmann.tk/phxrpc-6.html" rel="alternate"></link><updated>2016-10-19T00:03:12+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-19:phxrpc-6.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;å…¶å®è¿™ç‚¹ä¸œè¥¿æœ‰ç‚¹é¸¡è‚‹ã€‚å› ä¸ºTCPæµåœ¨å‰é¢å·²ç»è®²è¿‡ï¼Œéš¾ç‚¹åœ¨äºâ€œæµâ€å’Œâ€œæµç¼“å†²åŒºâ€éƒ¨åˆ†ã€‚è€ŒHttpClientåªæ˜¯TCPæµçš„ä¸€ä¸ªåº”ç”¨ï¼Œä»£ç ä¸å¤šï¼Œä¸”é‡ç‚¹åœ¨äºHTTPåè®®çš„è°ƒæ•™ä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡å› ä¸ºå‰é¢æœ‰å†™é˜»å¡TCPæµï¼Œè¿˜æ˜¯å‰åå‘¼åº”ï¼ŒæŠŠéé˜»å¡TCPæµä¹Ÿå°å°çš„è®²è§£ä¸€ä¸‹ã€‚é¡ºä¾¿é¥¶ä¸€æ®µHttpClientçš„è®²è§£ï¼Œç®—æ˜¯å……å®ä¸€ä¸‹å†…å®¹å§ã€‚&lt;/p&gt;
&lt;h2&gt;éé˜»å¡TCPæµç¼“å†²åŒº - &lt;code&gt;UThreadTcpStreamBuf&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªå…¶å®æ²¡å•¥å¯è®²çš„ï¼Œä¼ å…¥ä¸€ä¸ª&lt;code&gt;socket&lt;/code&gt;ï¼Œç„¶åè¯»å†™åˆ†åˆ«è°ƒç”¨&lt;code&gt;UThreadRecv&lt;/code&gt;å’Œ&lt;code&gt;UThreadSend&lt;/code&gt;ï¼ŒIOå¤ç”¨å’Œåç¨‹åˆ‡æ¢çš„å¤æ‚æ“ä½œéƒ½è¢«å°è£…åœ¨é‡Œé¢äº†ã€‚å‰©ä¸‹çš„æ“ä½œéƒ½ç”±åŸºç±»å‡½æ•°æ¥è§£å†³ã€‚&lt;/p&gt;
&lt;h2&gt;éé˜»å¡TCPæµ - &lt;code&gt;UThreadTcpStream&lt;/code&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¡®å®æ²¡å•¥å¯è¯´çš„ï¼Œä½ ä»¬è‡ªå·±å»è¯»ä»£ç å§ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;éé˜»å¡TCPæµå’Œé˜»å¡TCPæµçš„åŒºåˆ«æ˜¯~~å®ƒä¸é˜»å¡~~ï¼Œåœ¨é˜»å¡TCPæµä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥çš„æ˜¯ä¸€ä¸ªTCPæµï¼Œè€Œéé˜»å¡TCPæµä¼ å…¥çš„æ˜¯ä¸€ä¸ªåç¨‹è°ƒåº¦å™¨å’Œä¸€ä¸ªTCPæµã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œä¸€ä¸ªé˜»å¡æµè‡ªç„¶ä¼šå æ»¡ä¸€ä¸ªçº¿ç¨‹çš„IOå’ŒCPU â€”â€” åœ¨é˜»å¡æµIOè¯»å†™æ—¶ï¼ŒCPUç©ºé—²ï¼›åœ¨CPUå¿™æ—¶ï¼ŒIOç©ºé—²ã€‚&lt;/p&gt;
&lt;p&gt;è€Œéé˜»å¡æµä¼šå°†è‡ªå·±IO waitçš„æ—¶é—´æ‰˜ç®¡ç»™epollï¼ŒæŠŠå‰©ä¸‹çš„æ—¶é—´ç”¨äºCPUè®¡ç®—ï¼ˆå’Œä¸€äº›overheadä¸Šï¼‰ã€‚æ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹å¯ä»¥handleå¤šä¸ªsocketï¼Œåç¨‹è°ƒåº¦å™¨å°±æ˜¯å¿…é¡»çš„äº†ã€‚ä¹‹åçš„è¯»å†™æ“ä½œå°±äº¤ç”±æˆ‘ä»¬å‰é¢è®¨è®ºè¿‡çš„epollå’Œucontextåç¨‹æ¥å…±åŒå®Œæˆäº†ã€‚&lt;/p&gt;
&lt;h2&gt;HttpClient&lt;/h2&gt;
&lt;p&gt;å…¶å®è¿™é‡Œåˆ†æHttpClientçš„æ„ä¹‰ä¸æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºHttpæ¯•ç«Ÿæ˜¯ä¸€ä¸ªæˆç†Ÿçš„åè®®ï¼Œç„¶åç›¸åº”çš„è®¾ç½®å«ä¹‰è™½ç„¶æ˜ç¡®ï¼Œä½†æ˜¯æ”¾åˆ°ç›¸åº”çš„ä¸Šä¸‹æ–‡ä¸­åˆ†ææ¯”è¾ƒå¥½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡åšæ–‡&lt;a href="https://www.byvoid.com/blog/http-keep-alive-header"&gt;ã€ŠHTTPåè®®å¤´éƒ¨ä¸Keep-Aliveæ¨¡å¼è¯¦è§£ã€‹&lt;/a&gt;ä¸­æœ‰ä¸€éƒ¨åˆ†èƒŒæ™¯çŸ¥è¯†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç®€å•äº†è§£ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h3&gt;åœ¨HttpDispatcherä¸­ä½¿ç”¨çš„ä¸€ä¸ªå°æŠ€å·§&lt;/h3&gt;
&lt;p&gt;åœ¨&lt;code&gt;http_dispatcher.h&lt;/code&gt;æ–‡ä»¶ä¸­ï¼Œä½œè€…ä½¿ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒæ–°å¥‡çš„æŠ€å·§ï¼šâ€œ&lt;a href="http://tipsandtricks.runicsoft.com/Cpp/MemberFunctionPointers.html"&gt;Function Pointers to Member Functions&lt;/a&gt;â€ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;typedef&lt;/span&gt; &lt;span class="nt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Dispatcher&lt;/span&gt;&lt;span class="o"&gt;::*&lt;/span&gt;&lt;span class="nt"&gt;URIFunc_t&lt;/span&gt;&lt;span class="o"&gt;)(&lt;/span&gt;&lt;span class="nt"&gt;const&lt;/span&gt; &lt;span class="nt"&gt;HttpRequest&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nt"&gt;request&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;HttpResponse&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nt"&gt;response&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™è¡Œä»£ç çš„æ„æ€æ˜¯ï¼Œä¸ºä¸€ä¸ªå‚æ•°ä¸º&lt;code&gt;(const HttpRequest&amp;amp;, HttpResponse*)&lt;/code&gt;ä¸”è¿”å›å€¼ä¸º&lt;code&gt;int&lt;/code&gt;çš„å‡½æ•°å£°æ˜ä¸€ä¸ªåˆ«å&lt;code&gt;URIFunc_t&lt;/code&gt;ï¼Œå¹¶ä¸”è¿™ä¸ªå‡½æ•°ï¼Œä¸€å®šæ˜¯&lt;code&gt;Dispatcher&lt;/code&gt;ç±»çš„æˆå‘˜å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½è¿˜æ˜¯æ­£å¸¸çš„æ ·å­ï¼Œè¯­æ³•ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è§çš„ç±»å‹ã€‚ä½†æ˜¯ä¸‹é¢è¿™ç§å†™æ³•ï¼Œç¡®å®æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è§ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;if (uri_func_map_.end() != iter) {
    ret = (dispatcher_.*iter-&amp;gt;second)(request, response);
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œçš„&lt;code&gt;(dispatcher_.*iter-&amp;gt;second)&lt;/code&gt;ï¼Œ&lt;code&gt;iter-&amp;gt;second&lt;/code&gt;æ˜¯ä»mapä¸­æ‹¿å‡ºæ¥çš„ï¼Œåœ¨&lt;code&gt;dispatcher_&lt;/code&gt;å¯¹è±¡ä¸­çš„æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆã€‚æˆ‘ä»¬ä½¿ç”¨æ˜Ÿå·è§£å¼•ç”¨ï¼Œå†æŠŠå®ƒå’Œ&lt;code&gt;dispatcher_&lt;/code&gt;å¯¹è±¡æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œåƒæ­£å¸¸è°ƒç”¨æˆå‘˜å‡½æ•°ä¸€æ ·è°ƒç”¨å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h2&gt;è²Œä¼¼å†™çš„æœ‰ç‚¹å°‘ï¼Œå†é¥¶ä¸€æ®µå§ - epollæµ‹è¯•æœåŠ¡ç«¯/å®¢æˆ·ç«¯&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ç¿»ç¯‡å›åˆ°&lt;code&gt;network&lt;/code&gt;æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œçœ‹ä¸€ä¸‹&lt;code&gt;test_epoll_[server|client].[h|cpp]&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3&gt;epollæµ‹è¯•å®¢æˆ·ç«¯&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬è¯»å–å‘½ä»¤è¡Œå‚æ•°ï¼Œæ–°å»ºä¸€ä¸ªè°ƒåº¦å™¨ï¼Œç”±å‚æ•°å†³å®šè°ƒåº¦å™¨çš„wokeråç¨‹æ•°é‡ã€‚ä¹‹åæ–°å»º&lt;code&gt;UThreadEpollArgs_t&lt;/code&gt;ï¼ŒæŠŠè°ƒåº¦å™¨æŒ‡é’ˆå¡è¿›å»ã€‚å†ä¹‹åæŠŠ&lt;code&gt;echoclient&lt;/code&gt;å·¥ä½œå‡½æ•°å’Œ&lt;code&gt;args&lt;/code&gt;å‚æ•°æ”¾ç”±è°ƒåº¦å™¨ä¸­è¿›è¡Œè°ƒåº¦ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å·¥ä½œå‡½æ•°&lt;code&gt;echoclient&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å·¥ä½œå‡½æ•°çš„ç¬¬ä¸€æ­¥æ˜¯ç”³è¯·ä¸€ä¸ªsocket fdï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;int fd = ::socket(AF_INET, SOCK_STREAM, IPPROTO_IP);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œæˆ‘è§£é‡Šä¸€ä¸‹æœ€åä¸€ä¸ªå‚æ•°&lt;code&gt;IPPROTO_IP&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In the in.h file, the comment says: Dummy protocol for TCP.    &lt;br /&gt;
This constant has the value 0. It's actually an automatic choice depending on socket type and family.    &lt;br /&gt;
If you use it, and if the socket type is SOCK_STREAM and the family is AF_INET, then the protocol will automatically be TCP (exactly the same as if you'd used IPPROTO_TCP). Buf if you use IPPROTO_IP together with AF_INET and SOCK_RAW, you will have an error, because the kernel cannot choose a protocol automatically in this case.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªå‚æ•°çš„æ„ä¹‰æ˜¯å‘Šè¯‰å†…æ ¸ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªé€‰é¡¹çš„è¯ï¼Œä½ ç‰¹ä¹ˆçˆ±ç”¨å“ªä¸ªåè®®å°±ç”¨å“ªä¸ªå§ã€‚æ‰€ä»¥æœ‰ä¸€äº›æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šç›´æ¥æŠŠæœ€åä¸€ä¸ªå‚æ•°å†™æˆ0ï¼Œè¿™å°±æ˜¯&lt;code&gt;IPPROTO_IP&lt;/code&gt;å®çš„å­—é¢å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ª&lt;a href="http://stackoverflow.com/questions/24590818/what-is-the-difference-between-ipproto-ip-and-ipproto-raw"&gt;é—®é¢˜&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åé¢çš„æµç¨‹éå¸¸ç®€å•ï¼Œå…ˆæ¥æ”¶serverå‘æ¥çš„æ¬¢è¿ä¿¡æ¯ï¼Œä¹‹åping pongåæ¬¡ï¼Œå‘é€â€œquitâ€åŒ…åç»“æŸåç¨‹ã€‚&lt;/p&gt;
&lt;h3&gt;epollæµ‹è¯•æœåŠ¡ç«¯&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åŒºåˆ«ä¸å¤§ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå®¢æˆ·ç«¯åœ¨ä¸€å¼€å§‹åªæœ‰ä¸€ä¸ªåç¨‹ã€‚ä¹‹ååœ¨acceptè¿æ¥æ—¶ï¼Œä¼šä¸»åŠ¨æ–°å»ºå·¥ä½œåç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè§£é‡Šä¸€ä¸‹&lt;code&gt;listen(fd, backlog)&lt;/code&gt;å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°&lt;code&gt;backlog&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;backlogæ„ä¸ºå†…æ ¸ä¸ºç›¸åº”å¥—æ¥å­—æ’é˜Ÿçš„æœ€å¤§è¿æ¥ä¸ªæ•°ã€‚å†…æ ¸ä¸ºä»»ä½•ä¸€ä¸ªç»™å®šçš„ç›‘å¬å¥—æ¥å­—ç»´æŠ¤ä¸¤ä¸ªé˜Ÿåˆ—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœªå®Œæˆè¿æ¥é˜Ÿåˆ—(incomplete connection queue)        &lt;br /&gt;
å·²ç”±æŸä¸ªå®¢æˆ·å‘å‡ºå¹¶åˆ°è¾¾æœåŠ¡å™¨ï¼Œè€ŒæœåŠ¡å™¨æ­£åœ¨ç­‰å¾…å®Œæˆç›¸åº”çš„TCPä¸‰è·¯æ¡æ‰‹è¿‡ç¨‹ã€‚è¿™äº›å¥—æ¥å­—å¤„äºSYN_RCVDçŠ¶æ€&lt;/li&gt;
&lt;li&gt;å·²å®Œæˆè¿æ¥é˜Ÿåˆ—(completed connection queue)     &lt;br /&gt;
æ¯ä¸ªå·²å®ŒæˆTCPä¸‰è·¯æ¡æ‰‹è¿‡ç¨‹çš„å®¢æˆ·å¯¹åº”å…¶ä¸­ä¸€é¡¹ã€‚è¿™äº›å¥—æ¥å­—å¤„äºESTABLISHEDçŠ¶æ€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“é˜Ÿåˆ—æ»¡æ—¶ï¼ŒTCPä¼šå¿½ç•¥æ”¹åˆ†èŠ‚ï¼Œä½†æ˜¯ä¸å‘é€RSTã€‚æœåŠ¡ç«¯ä¼šæœŸæœ›å®¢æˆ·ç«¯é‡å‘SYNï¼Œé‡‡ç”¨æ­£å¸¸çš„é‡ä¼ æœºåˆ¶æ¥å¤„ç†&lt;/p&gt;
&lt;p&gt;é˜Ÿåˆ—çš„çœŸå®å¤§å°å¾€å¾€æ¯”è®¾å®šbacklogå€¼è¦å¤§ä¸€äº›ï¼ˆ~1.5å€ï¼‰&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»§ç»­çœ‹å·¥ä½œå‡½æ•°&lt;code&gt;echoaccept&lt;/code&gt;ã€‚ç¬¬ä¸€æ­¥æ˜¯æ–°å»ºä¸€ä¸ª&lt;code&gt;UThreadSocket_t&lt;/code&gt;å¯¹è±¡ï¼Œç”¨æ¥ç›‘å¬acceptäº‹ä»¶ã€‚å½“æœ‰æ–°çš„è¿æ¥è¿›å…¥æ—¶ï¼Œæˆ‘ä»¬å°±å°†æ–°çš„è¿æ¥ï¼Œä»¥åŠè¿æ¥æ‰€ç”¨çš„å·¥ä½œå‡½æ•°&lt;code&gt;echoserver&lt;/code&gt;åŠ å…¥åˆ°è°ƒåº¦å™¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;echoserver&lt;/code&gt;å‡½æ•°é¦–å…ˆå‘é€ä¸€ä¸ªæ¬¢è¿ä¿¡æ¯ï¼Œä¹‹åå°±å’Œå®¢æˆ·ç«¯æ‰“èµ·ä¹’ä¹“çƒæ¥ï¼Œç›´åˆ°å®¢æˆ·ç«¯å‘æ¥quitï¼Œå°±ç»“æŸè¿™ä¸ªå·¥ä½œåç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœå‘ç”Ÿäº†ä¸€ä¸ªå­—ç¬¦ä¸²æ‹†æˆä¸¤åŠå‘çš„ç°è±¡ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªåŒ…æ˜¯â€œblahblahquitqâ€ï¼Œä¹‹åä¸€ä¸ªåŒ…æ˜¯â€œuitâ€ï¼Œé‚£ä¹ˆè¿™ä¸ªåç¨‹æ°¸è¿œå°±ä¸ä¼šåœæ­¢äº†ã€‚ç”±äºTCPæ˜¯ä¸€ä¸ªæµåè®®ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯æ¯ä¸€æ¬¡recvå›æ¥çš„ä¿¡æ¯éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„â€œåŒ…â€ã€‚ä¸åšä¸å¿…è¦çš„å‡è®¾ï¼Œä¸ç»™è‡ªå·±æ‰¾éº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡å› ä¸ºè¿™é‡Œping pongçš„æ¶ˆæ¯éƒ½æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥å¼ºè¡Œè®¤ä¸ºæ¯ä¸€ä¸ªåŒ…éƒ½åŒ…å«ç€ä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ã€‚å½“ç„¶ï¼Œè¿™ç§å‡è®¾ä¹Ÿæ˜¯æ— æ„ä¹‰çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¦ç•™æ„phxrpcåœ¨çœŸæ­£çš„ç”Ÿäº§ç¯å¢ƒï¼Œæ˜¯æ€æ ·å¤„ç†è¿™ç§â€œç²˜åŒ…â€çš„é—®é¢˜çš„ã€‚&lt;/p&gt;
&lt;h2&gt;å†™åœ¨æœ€å&lt;/h2&gt;
&lt;p&gt;ä¸Šä¸€å¼ å¥³ç¥çš„å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-19/89151689.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;æ²¡å•¦~&lt;/p&gt;</summary><category term="phxrpc"></category></entry><entry><title>ä½¿ç”¨epollé©±åŠ¨ucontext - phxrpcä»£ç é˜…è¯»(5)</title><link href="http://wizmann.tk/phxrpc-5.html" rel="alternate"></link><updated>2016-10-17T01:28:40+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-17:phxrpc-5.html</id><summary type="html">&lt;h2&gt;ç”¨pipeå«é†’ä½  â€” EpollNotifier&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;class EpollNotifier&lt;/code&gt;ç±»å‹å°è£…äº†ä¸€ä¸ªä½¿ç”¨pipeä¼ é€’ä¿¡å·çš„Notifierç±»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Run()&lt;/code&gt;å‡½æ•°ï¼ˆå…¶å®æˆ‘è§‰å¾—å«Registeræˆ–Activateä¼šæ›´å¥½ï¼‰é¦–å…ˆå£°æ˜äº†ä¸¤ä¸ªå•å‘çš„pipeï¼š&lt;code&gt;pipe_fds_&lt;/code&gt;ï¼Œä»&lt;a href="http://man7.org/linux/man-pages/man2fpipe.2.html"&gt;æ–‡æ¡£&lt;/a&gt;ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“&lt;code&gt;pipe_fds_[0]&lt;/code&gt;æ˜¯è¯»ç®¡é“ï¼Œè€Œ&lt;code&gt;pipe_fds_[1]&lt;/code&gt;æ˜¯å†™ç®¡é“ã€‚è¿™é‡Œæœ‰ä¸€ä¸ç‚¹åç›´è§‰ï¼Œå°±æ˜¯pipeæ‹¿äº†ä¸¤ä¸ªfdï¼Œä½†æ˜¯ä»æ—§æ˜¯å•å·¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-16/2335602.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°†è¯»fdè®¾ä¸º&lt;code&gt;O_NONBLOCK&lt;/code&gt;ä»¥ä¾›epollè°ƒåº¦ï¼Œæœ€åå°†&lt;code&gt;Func()&lt;/code&gt;å‡½æ•°ä¼ å…¥&lt;code&gt;scheduler_&lt;/code&gt;ä¸­ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œè·‘ä¸ªé¢˜ï¼Œæƒ³èµ·äº†å½“å¹´æˆ‘å¤§ä¸€çš„æ—¶å€™ä¸Šè¿‡çš„é€šä¿¡å¯¼è®ºçš„é€‰ä¿®è¯¾ã€‚é‚£ä¼šæˆ‘è¿˜æ²¡æœ‰æ²‰è¿·ä»£ç ï¼Œè¿˜æ˜¯ä¸€ä¸ªç§¯æä¹è§‚å¥½å¥½å­¦ä¹ çš„æ–°æ—¶ä»£å¤§å­¦ç”Ÿã€‚è‡ªä»å¼€å§‹å†™äº†ä»£ç ï¼Œäººå°±è¶Šæ¥è¶ŠåºŸç‰©äº†ï¼Œè¿å¥³æœ‹å‹éƒ½æ‰¾ä¸åˆ°äº†ã€‚     &lt;br /&gt;
å¹´è½»äººä»¬å•Šï¼Œæœ‰é¥­è¾™å¹²ç‚¹å•¥éƒ½è¡Œï¼Œåƒä¸‡åˆ«å†™ç å•Šã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;Func()&lt;/code&gt;å‡½æ•°åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œå°±æ˜¯ä»ç®¡é“é‡Œå°è¯•pollä¸€æ®µæ•°æ®ï¼Œæ‹¿åˆ°æ•°æ®åç›´æ¥æ‰”æ‰ã€‚å› ä¸ºç®¡é“é‡Œä¼ æ¥çš„æ•°æ®å¹¶æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œè¿™æ ·è®¾è®¡çš„ä¸»è¦æ„ä¹‰åœ¨äºå”¤é†’epollã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä»&lt;code&gt;Notify()&lt;/code&gt;å‡½æ•°ä¸­çœ‹å‡ºï¼Œä¼ å…¥ç®¡é“çš„æ˜¯ä¸€ä¸ªå­—ç¬¦"a"ã€‚&lt;/p&gt;
&lt;h2&gt;è°ƒåº¦å™¨ç±» â€” UThreadEpollScheduler&lt;/h2&gt;
&lt;p&gt;è°ƒè¯•å™¨ç±»åœ¨åˆå§‹åŒ–æ—¶ï¼Œå£°æ˜äº†åç¨‹æ ˆçš„å¤§å°ä»¥åŠè°ƒè¯•å™¨æ‰€è°ƒåº¦çš„æœ€å¤§ä»»åŠ¡æ•°ã€‚ä¸è¿‡è¿™ä¸ªæœ€å¤§ä»»åŠ¡æ•°æ˜¯ä¸€ä¸ªâ€œè½¯çº¿â€ï¼Œå› ä¸ºåœ¨æœ€æ–°çš„Linuxå†…æ ¸ä¸­ï¼Œepollä½¿ç”¨åŠ¨æ€å†…å­˜ç®¡ç†fdï¼Œ&lt;code&gt;epoll_create&lt;/code&gt;ä¸­çš„&lt;code&gt;size&lt;/code&gt;å‚æ•°å·²ç»å¤±å»äº†ä½œç”¨ã€‚è€Œåé¢&lt;code&gt;epoll_wait&lt;/code&gt;ä¸­çš„&lt;code&gt;max_event&lt;/code&gt;å‚æ•°åªæ˜¯æ¯æ¬¡è¿”å›çš„æœ€å¤ševentæ•°ï¼Œä¹Ÿå°±æ˜¯å¦‚æœæˆ‘ä»¬å‘è°ƒåº¦å™¨ä¸­åŠ å…¥äº†è¶…è¿‡é™åˆ¶çš„fdï¼Œä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆæ¶åŠ£çš„åæœã€‚ï¼ˆå‚è€ƒ&lt;a href="http://man7.org/linux/man-pages/man2/epoll_create.2.html"&gt;epollæ–‡æ¡£&lt;/a&gt;å’Œ&lt;a href="http://man7.org/linux/man-pages/man2/epoll_wait.2.html"&gt;epoll_waitæ–‡æ¡£&lt;/a&gt;ï¼‰&lt;/p&gt;
&lt;h3&gt;è®©äººæä¸æ‡‚çš„Instanceå‡½æ•°&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥åƒä¸€ä¸ªSingletonçš„å®ç°ï¼Œä½†æ˜¯æ˜æ˜&lt;code&gt;UThreadEpollScheduler&lt;/code&gt;ç±»çš„æ„é€ å‡½æ•°æ˜¯publicçš„ã€‚ä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°åƒæ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œä½†å®ƒåˆä¸æ˜¯ä¸€ä¸ªå•ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å…¶å®ƒçš„ä»£ç ä¸­ï¼Œä¹Ÿæ²¡æœ‰è°ƒç”¨ä¸ªå‡½æ•°çš„åœ°æ–¹ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªå‡½æ•°æ˜¯å¼€å‘è€…å¿˜è®°åˆ äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-16/85921046.jpg" /&gt;&lt;/p&gt;
&lt;h3&gt;è¿œå¤æ™ºæ…§ â€” CreateSocket&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°å…¶å®æ²¡å•¥å¯è¯´çš„ï¼Œç®—æ˜¯å¯¹&lt;code&gt;UThreadSocket_t&lt;/code&gt;æ„é€ çš„å°è£…ï¼Œä½†æ˜¯è¿™é‡Œé¢æœ‰ä¸€ä¸ªå°æŠ€å·§ï¼Œå°±æ˜¯&lt;code&gt;calloc&lt;/code&gt;çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;calloc&lt;/code&gt;çš„ä½œç”¨æ˜¯å‘å†…æ ¸ç”³è¯·ä¸€æ®µæ ˆç©ºé—´ï¼ˆå’Œ&lt;code&gt;malloc&lt;/code&gt;è¡Œä¸ºä¸€è‡´ï¼‰ï¼Œç„¶åå°†è¿™ä¸€æ®µå†…å­˜æ¸…0ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ªäººæ„Ÿè§‰è¿™æ ·åšçš„ç›®çš„æ˜¯é˜²æ­¢æŒ‡é’ˆæ²¡æœ‰åˆå§‹åŒ–å¸¦æ¥çš„ä¸€ç³»åˆ—è¯¡å¼‚çš„é—®é¢˜ã€‚æŠŠæŒ‡é’ˆæ¸…é›¶ï¼Œå¯ä»¥è®©é—®é¢˜åœ¨ç¬¬ä¸€æ—¶é—´å‡ºç°ï¼Œæ–¹ä¾¿å‡ºé”™æ—¶çš„è°ƒè¯•ã€‚ä½†æ˜¯æˆ‘è§‰å¾—è¿˜æ˜¯ç”¨æµ‹è¯•è¦†ç›–è¿™ç§é—®é¢˜å·²ç»å¥½ï¼Œå› ä¸ºç©ºæŒ‡é’ˆåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½æ˜¯å¯¼è‡´è¯¡å¼‚è¡Œä¸ºçš„æºå¤´ã€‚&lt;/p&gt;
&lt;h3&gt;è·‘ â€” Run&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Run()&lt;/code&gt;å‡½æ•°æ˜¯è°ƒåº¦å™¨çš„æ ¸å¿ƒå‡½æ•°ï¼ˆå½“ç„¶å•¦ï¼‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªå¾ªç¯è·å–eventï¼Œç”¨é€‚å½“çš„åç¨‹å¤„ç†eventã€‚&lt;/p&gt;
&lt;p&gt;å‡½æ•°çš„ä¸€å¼€å§‹ï¼Œå…ˆè°ƒç”¨&lt;code&gt;ConsumeTodoList()&lt;/code&gt;å‡½æ•°ï¼Œå°†åˆ—è¡¨ä¸­çš„åç¨‹å…¨éƒ¨æ¿€æ´»ï¼Œå¹¶hangåœ¨epollä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åè¿›å…¥ä¸€ä¸ªâ€œæ­»å¾ªç¯â€ï¼Œé€šè¿‡&lt;code&gt;epoll_wait&lt;/code&gt;å°†æœ‰æ•°æ®å¯è¯»çš„fdå–å‡ºï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„åç¨‹è¿›è¡Œå¤„ç†ã€‚è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼Œ&lt;code&gt;epoll_wait&lt;/code&gt;çš„è¶…æ—¶æ—¶é—´æ˜¯å†™æ­»çš„4msï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨&lt;code&gt;next_timeout&lt;/code&gt;ç»™å‡ºçš„ä¸‹æ¬¡è¶…æ—¶æ—¶é—´ã€‚è¿™æ˜¯å› ä¸ºè¿™é‡Œæ”¯æŒäº†â€œactive socketâ€ï¼Œå³æœåŠ¡å™¨å¯¹æ´»åŠ¨è¿æ¥æ“ä½œï¼Œä¾‹å¦‚å‘é€å“åº”ç”šè‡³æ–°å»ºä¸€ä¸ªsocketã€‚&lt;/p&gt;
&lt;p&gt;åé¢çš„&lt;code&gt;handler_accepted_fd_func_&lt;/code&gt;å’Œ&lt;code&gt;active socket&lt;/code&gt;æ˜¯ç±»ä¼¼çš„ï¼Œä¸è¿‡è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å¤„ç†å·²ç»å»ºç«‹å¥½çš„è¿æ¥ï¼Œä¸ºå…¶åˆ†é…ç›¸åº”çš„åç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œç”±æ­¤å¯è§ï¼Œè¿™ä¸ªå¾ªç¯å³æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œåˆæ˜¯è½®è¯¢çš„ã€‚ç„¶è€Œè¿™ä¸¤ç§æ¨¡å‹ï¼Œå±…ç„¶èƒ½å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œï¼ŒçœŸæ˜¯ä»¤äººå°è±¡æ·±åˆ»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-16/4157866.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„&lt;code&gt;DealwithTimeout&lt;/code&gt;å‡½æ•°å¤„ç†äº†ä¸€ä¸‹è¶…æ—¶çš„åç¨‹ï¼Œå¹¶ä¸”æ›´æ–°äº†&lt;code&gt;next_timeout&lt;/code&gt;å˜é‡ã€‚ç„¶è€Œè¿™ä¸ªå˜é‡å› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-16/4157866.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;Pollæ¥Pollå» â€” ä¸€å †epollå‡½æ•°çš„å°è£…&lt;/h2&gt;
&lt;h3&gt;UThreadPoll(1)&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;UThreadPoll&lt;/code&gt;å‡½æ•°æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯pollå•ä¸ªsocketï¼Œå¦å¤–ä¸€ä¸ªæ˜¯pollä¸€å †socketã€‚æˆ‘ä»¬å…ˆä»å•ä¸ªsocketçš„çœ‹èµ·ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥æ˜¯æ³¨å†Œä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œç¬¬äºŒæ­¥å°†è¿™ä¸ªsocketæ”¾åˆ°epollçš„ç›‘å¬åˆ—è¡¨ä¸Šã€‚ä¹‹åè°ƒç”¨yieldï¼ŒæŠŠæ§åˆ¶æƒäº¤è¿˜ç»™ä¸»æ§åˆ¶æµã€‚&lt;/p&gt;
&lt;p&gt;å½“epollæ”¶åˆ°ç›¸åº”çš„äº‹ä»¶æ—¶ï¼Œä¸»æ§åˆ¶æµä¼šå°†æ§åˆ¶æƒäº¤è¿˜ç»™åç¨‹ï¼Œåç¨‹å°†socketä»epollç›‘å¬åˆ—è¡¨ä¸­ç§»é™¤ï¼Œä¹‹åè¿›è¡Œåé¢çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä½“çš„å·¥ä½œæµå¯ä»¥å‚è€ƒä¸‹å›¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="image" src="http://7lrx26.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-10-16%2021.33.48.png" /&gt;&lt;/p&gt;
&lt;h3&gt;UThreadPoll(2) - è¾¹ç¼˜è§¦å‘å’Œæ°´å¹³è§¦å‘&lt;/h3&gt;
&lt;p&gt;epollæœ‰ä¸¤ç§è§¦å‘æ¨¡å¼ï¼Œè¾¹ç¼˜è§¦å‘(edge-trigger, ET)å’Œæ°´å¹³è§¦å‘(level-trigger, LT)ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•è§£é‡Šä¸€ä¸‹epollçš„è¿™ä¸¤ç§è§¦å‘æ¨¡å¼ã€‚ETæ„å‘³ç€åªè¦æœ‰fdå¯è¯»æˆ–å¯å†™ï¼Œ&lt;code&gt;epoll_wait&lt;/code&gt;å°±è¿”å›è¿™ä¸ªfdï¼Œè€ŒLTæ„å‘³ç€å½“ä¸”ä»…å½“fdç”±â€œä¸å¯è¯»å˜ä¸ºå¯è¯»â€æˆ–ç”±â€œä¸å¯å†™å˜ä¸ºå¯å†™â€æ—¶ï¼Œ&lt;code&gt;epoll_wait&lt;/code&gt;æ‰ä¼šè¿”å›ã€‚ï¼ˆè¿™æœ‰å¯èƒ½å‡ºç°æ‰€è°“çš„â€œç²˜åŒ…â€ç°è±¡ï¼Œè¯¦è§&lt;a href="http://man7.org/linux/man-pages/man7/epoll.7.html"&gt;è¿™é‡Œ&lt;/a&gt;ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡å¬åˆ°â€œç²˜åŒ…â€è¿™ä¸ªè¯ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºè¿™æ˜¯å•¥å¥½åƒçš„ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ„å‘³ç€ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨LTæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ¸…ç†å¹²å‡€fdä¸­çš„æ•°æ®ï¼Œå³åªè¦å¯è¯»ï¼Œå°±ä¸€ç›´è¯»ï¼›åªè¦å¯å†™ï¼Œå°±ä¸€ç›´å†™ã€‚å¦åˆ™å°±ä¼šå‡ºç°é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ETæ¨¡å¼ã€‚å¹¶ä¸”æˆ‘ä»¬åˆ©ç”¨äº†ETçš„ç‰¹æ€§å®ç°äº†â€œç›‘å¬å¤šä¸ªfdï¼Œè¿”å›æœ€æ—©å“åº”çš„é‚£ä¸€ä¸ªâ€ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ªepoll fdï¼ˆç®€ç§°å†…éƒ¨epollï¼‰ï¼Œå°†åˆ—è¡¨ä¸­çš„æ‰€æœ‰socketæ”¾åˆ°é‡Œé¢ç›‘å¬ã€‚ä¹‹åå°†è¿™ä¸ªsocket fdæ”¾åˆ°&lt;code&gt;list[0]-&amp;gt;epollfd&lt;/code&gt;æ‰€å¯¹åº”çš„epollï¼ˆç®€ç§°å¤–éƒ¨epollï¼Œé€šå¸¸æ˜¯ä¸»å·¥ä½œå¾ªç¯çš„é‚£ä¸ªepollï¼‰ç›‘å¬åˆ—è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å½“åˆ—è¡¨ä¸­çš„socketæœ‰è¿”å›æ—¶ï¼Œå†…éƒ¨çš„epollä¼šè¿”å›ä¸€ä¸ª&lt;code&gt;EPOLLIN&lt;/code&gt;äº‹ä»¶ï¼Œå¤–éƒ¨çš„epollæ¥æ”¶åˆ°è¿™ä¸ªäº‹ä»¶åï¼Œè¿›è¡Œåç¨‹åˆ‡æ¢ï¼Œå›åˆ°å½“å‰å‡½æ•°ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€æ­¥æˆ‘ä»¬&lt;code&gt;epoll_wait&lt;/code&gt;å†…éƒ¨çš„epoll fdï¼Œå› ä¸ºæˆ‘ä»¬ç¡®å®šæ­¤æ—¶ä¸€å®šæœ‰å¯æ“ä½œçš„fdï¼Œæ‰€ä»¥æˆ‘ä»¬å°†&lt;code&gt;epoll_wait&lt;/code&gt;çš„timeoutå‚æ•°è®¾ä¸º0ã€‚ä¹‹åæˆ‘ä»¬å°†è¿”å›çš„fdçš„&lt;code&gt;waited_events&lt;/code&gt;å‚æ•°å¡«å¥½ï¼Œæœ€åè¿”å›æ“ä½œæˆåŠŸçš„fdçš„æ•°ç›®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°æ¯”è¾ƒç»•ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªå¥½æ¶ˆæ¯ â€”â€” è¿™ä¸ªå‡½æ•°ä¹Ÿæ²¡æœ‰è¢«å…¶å®ƒåœ°æ–¹è°ƒç”¨è¿‡ã€‚ä¸è¿‡è¿™ç§&lt;code&gt;cascaded epoll&lt;/code&gt;çš„æŠ€å·§ç¡®å®æ˜¯è®©äººè€³ç›®ä¸€æ–°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-16/4157866.jpg" /&gt;&lt;/p&gt;
&lt;h3&gt;å»¶æ—¶æ‰§è¡Œ - UThreadWait&lt;/h3&gt;
&lt;p&gt;å‰©ä¸‹çš„å‡ ä¸ªå‡½æ•°åŸºæœ¬éƒ½æ˜¯æ— è„‘å°è£…ï¼Œé¡ºç€çœ‹ä¸€éä»£ç åŸºæœ¬å°±çŸ¥é“æ˜¯å•¥æ„æ€äº†ã€‚ä¸è¿‡&lt;code&gt;UThreadWait&lt;/code&gt;è¿™ä¸ªå‡½æ•°æ¯”è¾ƒæœ‰æ„æ€ï¼Œå¯ä»¥ç”¨æ¥å¤ä¹ ä¸€ä¸‹&lt;code&gt;uthread + epoll&lt;/code&gt;çš„å·¥ä½œæµç¨‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;UThreadWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UThreadSocket_t&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;timeout_ms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uthread_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scheduler&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;GetCurrUThread&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scheduler&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;AddTimer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout_ms&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scheduler&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;YieldTask&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scheduler&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;RemoveTimer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timer_id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é¦–å…ˆï¼Œè·å–å½“å‰uthreadçš„IDï¼Œå½“æˆ‘ä»¬è°ƒç”¨&lt;code&gt;Resume()&lt;/code&gt;å‡½æ•°æ—¶ï¼Œè®©ä»£ç çŸ¥é“æˆ‘ä»¬è¦è¿”å›åˆ°å“ªä¸ªåç¨‹ä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å‘è°ƒåº¦å™¨ä¸­æ·»åŠ ä¸€ä¸ªå®šæ—¶å™¨ã€‚ä¹‹å&lt;code&gt;Yield()&lt;/code&gt;ï¼Œç¦»å¼€å½“å‰åç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»å·¥ä½œå¾ªç¯è¿è¡Œåˆ°è¶…æ—¶æ—¶é—´åï¼Œä¼šåœ¨è¿™ä¸ªåç¨‹æ‰“ä¸Šä¸€ä¸ªâ€œè¶…æ—¶â€æ ‡ç­¾ï¼Œç„¶å&lt;code&gt;Resume()&lt;/code&gt;åˆ‡æ¢å›è¿™ä¸ªåç¨‹ä¸Šæ¥ã€‚&lt;/p&gt;
&lt;p&gt;å‰©ä¸‹çš„å·¥ä½œï¼Œå°±äº¤ç”±åç¨‹å†…éƒ¨ç»‘å®šçš„å‡½æ•°æ¥è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;h2&gt;å†™åœ¨æœ€å&lt;/h2&gt;
&lt;p&gt;åœ¨ç½‘ç»œç¼–ç¨‹æ–¹é¢ï¼ŒçœŸå¿ƒæ˜¯ä¸€ä¸ªåˆå­¦è€…ã€‚å¾ˆå¤šç”¨è¯å¯èƒ½ä¸æ°å½“ï¼Œä¹Ÿæœ‰ä¸€äº›æ˜¯è‡ªå·±ç”Ÿé€ çš„ã€‚å¤§å®¶é˜…è¯»çš„æ—¶å€™ï¼Œå°½é‡ä»¥ä»£ç å’Œæ›´ä¸“ä¸šçš„æœ¯è¯­ä¸ºå‡†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå› ä¸ºåœ¨è¡Œæ–‡ä¸­ï¼Œå¯èƒ½è¿½æ±‚äº†è¿‡å¤šçš„é€—æ¯”æ„Ÿï¼Œå¯¹åŸä»£ç è°ƒä¾ƒäº†å‡ å¥ã€‚å¹¶æ²¡æœ‰ä»€ä¹ˆæ¶æ„ï¼Œå¦‚æœå“ªé‡Œè¯´çš„ä¸å¯¹ï¼Œæ¬¢è¿æ‹ç –ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="image" src="http://7lrx26.com1.z0.glb.clouddn.com/IMG_20161017_012107.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ä½›ç¥–ä¿ä½‘ï¼Œæ°¸æ— Bugã€‚&lt;/p&gt;</summary><category term="phxrpc"></category><category term="ucontext"></category><category term="epoll"></category></entry><entry><title>ucontext - phxrpcä»£ç é˜…è¯»(4)</title><link href="http://wizmann.tk/phxrpc-4.html" rel="alternate"></link><updated>2016-10-13T23:45:24+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-13:phxrpc-4.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;å›½åº†å‡æœŸè¿‡åŠï¼Œphxrpcçš„ä»£ç é˜…è¯»å¤§æ¦‚è¦å°å°å‘Šä¸€æ®µè½å•¦ã€‚å› ä¸ºè¿™ä¸¤å¤©è¿˜è¦è¯»å·¥ä½œç›¸å…³çš„ä»£ç ï¼Œä»¥åŠæœ€åå‡ å¤©è¿˜æœ‰ä¸€æ¬¡çŸ­é€”æ—…è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥éé˜»å¡TCPæµå¯èƒ½è¦ç•™åˆ°ä¸‹ä¸€ç¯‡äº†ï¼Œè¿™ä¸€ç¯‡åªæ¶‰åŠéé˜»å¡TCPæµä½¿ç”¨åˆ°çš„ucontextåç¨‹åº“ï¼ŒåŠå…¶ä½¿ç”¨çš„ä¸€äº›æ¡†æ¶ä»£ç ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;161013æ›´æ–°ï¼šè¿™ç‚¹ç ´ä¸œè¥¿å†™åˆ°ä»Šå¤©æ‰å†™å®Œï¼ŒGGã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;ä»€ä¹ˆæ˜¯ucontext&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;"Subroutines are special cases of ... coroutines." â€“Donald Knuth.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œä»€ä¹ˆæ˜¯çº¿ç¨‹ã€‚çº¿ç¨‹æ˜¯è¿›ç¨‹å†…ä¸€æ¡æ‰§è¡Œæµçš„çŠ¶æ€ï¼ŒåŒ…å«äº†ç¡¬ä»¶çŠ¶æ€ï¼ˆç¡¬ä»¶è®¡æ•°å™¨ï¼Œå¯„å­˜å™¨ï¼Œæ¡ä»¶ç ç­‰ï¼‰å’Œå †æ ˆä¸­çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹é€šå¸¸åªæœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£ã€‚å½“çº¿ç¨‹è¿”å›æ—¶ï¼Œçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿç»“æŸäº†ã€‚æ‰€ä»¥ï¼Œé€šå¸¸çº¿ç¨‹çš„æ‰§è¡Œç”±å†…æ ¸è°ƒåº¦ã€‚&lt;/p&gt;
&lt;p&gt;åç¨‹çš„å®šä¹‰ä¸çº¿ç¨‹ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç¡¬ä»¶çŠ¶æ€+å †æ ˆçš„çŠ¶æ€ç»„åˆã€‚ä½†æ˜¯ä¸çº¿ç¨‹ä¸åŒçš„æ˜¯ï¼Œåç¨‹å¯ä»¥æœ‰å¤šä¸ªå‡ºå£ã€‚å¯ä»¥é€šè¿‡yieldæ¥æš‚åœè‡ªå·±ï¼Œè°ƒç”¨å…¶å®ƒåç¨‹ã€‚å†æ¬¡å¯åŠ¨æ—¶ï¼Œä¼šä»ä¸Šæ¬¡æŒ‚èµ·çš„åœ°æ–¹ç»§ç»­è¿è¡Œã€‚&lt;/p&gt;
&lt;h2&gt;phxrpcä¸­çš„ucontext&lt;/h2&gt;
&lt;p&gt;phxrpcæä¾›äº†systemå’Œboostä¸¤ç§ucontextçš„å®ç°ï¼Œæ‰€ä»¥æä¾›äº†ä¸€ä¸ª&lt;code&gt;uthread_context_base&lt;/code&gt;çš„åŸºç±»ã€‚å…¶å®åœ¨è¿™é‡Œæˆ‘æ˜¯æœ‰ä¸€ç‚¹æ€€ç–‘è™šå‡½æ•°çš„æ€§èƒ½çš„ï¼Œä¸è¿‡å¥½åœ¨åç¨‹çš„åˆ‡æ¢ä»¥åŠç½‘ç»œIOæ“ä½œè¿˜æ˜¯æ¯”è¾ƒè€—æ€§èƒ½çš„ï¼Œæ‰€ä»¥è™šå‡½æ•°å¤šå‡ºæ¥çš„å‡ æ¬¡å†…å­˜å¯»å€ä¹Ÿå¹¶éä¸èƒ½æ¥å—ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åªçœ‹&lt;code&gt;uthread_context_system&lt;/code&gt;è¿™ä¸ªä½¿ç”¨ç³»ç»Ÿucontextåº“çš„å®ç°ã€‚&lt;/p&gt;
&lt;h3&gt;åç¨‹ä¸Šä¸‹æ–‡ï¼š&lt;code&gt;UThreadContext&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç±»æ˜¯åç¨‹ä¸Šä¸‹æ–‡çš„è™šåŸºç±»ï¼Œæ‰€ä»¥ä»£ç å¾ˆå°‘ã€‚å¹¶ä¸”ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¥½è§£é‡Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;void Make(UThreadFunc_t func, void * args)&lt;/code&gt;å‡½æ•°æ˜¯&lt;code&gt;makecontext()&lt;/code&gt;çš„å°è£…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bool Resume()&lt;/code&gt;å’Œ&lt;code&gt;bool Yield()&lt;/code&gt;æ˜¯&lt;code&gt;swapcontext&lt;/code&gt;çš„å°è£…ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ªäººæ„Ÿè§‰è¿™ä¸ªç±»æ‹†åˆ†æˆä¸€ä¸ªå·¥å‚ç±»ï¼ˆä¼ å…¥ä¸€ä¸ªCreateä»¿å‡½æ•°ï¼‰å’Œä¸€ä¸ªä¸Šä¸‹æ–‡åŸºç±»ä¼šæ›´æ¸…æ¥šä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;h3&gt;ä½¿ç”¨ç³»ç»Ÿucontextåº“çš„åç¨‹ä¸Šä¸‹æ–‡ï¼š&lt;code&gt;UThreadContextSystem&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨phxrpcçš„æ–‡æ¡£ä¸­ï¼Œè¯´æ˜ä½¿ç”¨ç³»ç»ŸåŸç”Ÿçš„ucontextåº“çš„æ€§èƒ½è¦å·®äºboostç‰ˆæœ¬çš„ã€‚ä½†æ˜¯ä»æ•°æ®ä¸Šæ¥çœ‹å¾®ä¹å…¶å¾®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä»è¿™ä¸ªç‰ˆæœ¬çœ‹èµ·ï¼ŒåŠ›æ±‚ä¸¾ä¸€åä¸‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;UThreadContextSystem&lt;/code&gt;åœ¨æ„é€ å‡½æ•°ä¸­ä¼ å…¥äº†åç¨‹æ ˆå¤§å°ï¼Œåç¨‹è¦æ‰§è¡Œçš„å‡½æ•°ï¼ˆåŠå‚æ•°ï¼‰ï¼Œåç¨‹æ‰§è¡Œåçš„å›è°ƒï¼Œä»¥åŠè°ƒè¯•ç”¨çš„&lt;code&gt;need_stack_protect&lt;/code&gt; flagã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡éƒ½ç»´æŠ¤äº†ä¸¤ä¸ªcontextï¼Œ&lt;code&gt;main_context&lt;/code&gt;ç”¨æ¥è¡¨ç¤ºä¸»ç¨‹åºæ‰§è¡Œæµçš„ä¸Šä¸‹æ–‡ï¼Œè€Œ&lt;code&gt;context_&lt;/code&gt;åˆ™ç”¨æ¥è¡¨ç¤ºåç¨‹çš„ä¸Šä¸‹æ–‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;main_context&lt;/code&gt;æ˜¯&lt;code&gt;static thread_local&lt;/code&gt;ä¿®é¥°çš„ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªé™æ€å˜é‡åœ¨æ¯ä¸€ä¸ªçº¿ç¨‹ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªã€‚æ‰§è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸Šçš„ä¸åŒåç¨‹ï¼Œéƒ½ä¼šåˆ‡æ¢/è¢«åˆ‡æ¢åˆ°è¿™ä¸ªä¸Šä¸‹æ–‡ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;Resume()&lt;/code&gt;å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ¿€æ´»åç¨‹ä¸Šä¸‹æ–‡ï¼Œå¹¶å°†ä¸»ç¨‹åºæ‰§è¡Œæµçš„ä¸Šä¸‹æ–‡ä¿å­˜åœ¨&lt;code&gt;main_context&lt;/code&gt;ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;Yield()&lt;/code&gt;å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°†ä¸»ç¨‹åºæ‰§è¡Œæµçš„ä¸Šä¸‹æ–‡æ¿€æ´»ï¼Œå°†åç¨‹ä¸Šä¸‹æ–‡ä¿å­˜å›&lt;code&gt;context_&lt;/code&gt;ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„&lt;code&gt;UThreadFuncWrapper()&lt;/code&gt;å€¼å¾—æˆ‘ä»¬ç‰¹åˆ«å…³æ³¨ã€‚è¿™ä¸ªå‡½æ•°åŒ…è£…äº†æˆ‘ä»¬çš„å·¥ä½œå‡½æ•°&lt;code&gt;uc-&amp;gt;func_&lt;/code&gt;ï¼Œå¹¶ä¸”å°†&lt;code&gt;this&lt;/code&gt;æŒ‡é’ˆä¼ è¿›å»ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ å…¥æŒ‡é’ˆæ—¶ï¼Œè¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªæŠ€å·§ã€‚é¦–å…ˆæˆ‘ä»¬å°†æŒ‡é’ˆå¼ºè½¬ä¸º&lt;code&gt;uintptr_t&lt;/code&gt;ï¼Œè¿™ä¸ªæ˜¯ç¼–è¯‘å™¨å†…ç½®çš„ä¸€ä¸ª&lt;code&gt;typeof&lt;/code&gt;ï¼Œæ„åœ¨å°†æŒ‡é’ˆç±»å‹æ— æŸå¤±çš„è½¬ä¸ºæ•´å‹ã€‚ä¹‹åï¼Œå°†ä¸€ä¸ª&lt;code&gt;uintptr_t&lt;/code&gt;æ‹†ä¸ºä¸¤ä¸ª&lt;code&gt;uint32_t&lt;/code&gt;ã€‚æœ€åï¼Œåœ¨wrapperå‡½æ•°ä¸­ï¼Œå°†è¿™ä¸¤ä¸ª&lt;code&gt;uint32_t&lt;/code&gt;æ‹¼å›æˆä¸€ä¸ªæŒ‡é’ˆç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;åˆçœ‹è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å°±æœ‰è¿™æ ·çš„ç–‘é—®ï¼šâ€œè¿™ç‰¹ä¹ˆä¸æ˜¯æœ‰ç—…ä¹ˆï¼Ÿâ€ ä½†æ˜¯ï¼ŒæŠ˜è…¾è‡ªç„¶æœ‰æŠ˜è…¾çš„é“ç†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;When this context is later activated (using setcontext(3) or swapcontext()) the function func is called, and passed the series of integer (int) arguments that follow argc; the caller must specify the number of these arguments in argc.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»å®˜æ–¹çš„æ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç”¨åœ¨&lt;code&gt;setcontext&lt;/code&gt;ä¸­çš„å‡½æ•°ï¼Œåªæ”¯æŒintç±»å‹çš„å‚æ•°ï¼Œå¹¶ä¸”éœ€è¦æˆ‘ä»¬æ˜¾å¼å£°æ˜å‚æ•°çš„æ•°ç›®ã€‚è¿™é‡Œä¸€å®šè¦å°å¿ƒï¼Œå› ä¸ºå˜é•¿å‚æ•°åˆ—è¡¨å¹¶ä¸èƒ½æœ‰å¾ˆå¼ºçš„ç¼–è¯‘æœŸæ£€æŸ¥æ”¯æŒï¼Œæå‡ºUBæˆ–core dumpæ¥å°±éå¸¸éš¾æŸ¥ã€‚&lt;/p&gt;
&lt;h3&gt;ucontextä¸­ä½¿ç”¨çš„æ ˆå†…å­˜ï¼š&lt;code&gt;UThreadStackMemory&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;ucontextåç¨‹æ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå¤šä¸ªä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥å°±è¦é…å¤‡å¤šä¸ªæ ˆç©ºé—´ã€‚è¿™é‡Œçš„æ ˆå¤§å°æˆ‘ä»¬æ˜¯å¯ä»¥æ‰‹åŠ¨ç®¡ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®ç¨‹åºçš„å®é™…æƒ…å†µæ¥è°ƒæ•´æ ˆå¤§å°ï¼Œä»¥èŠ‚çœå†…å­˜ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å†…å­˜çš„ç”³è¯·å¹¶ä¸æ˜¯ä½¿ç”¨&lt;code&gt;malloc&lt;/code&gt;æˆ–è€…&lt;code&gt;new&lt;/code&gt;è¿™ç§æ¯”è¾ƒé«˜å±‚æ¬¡çš„å†…å­˜æ“ä½œå‡½æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨çš„&lt;code&gt;mmap&lt;/code&gt;ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚æ•°æ§åˆ¶ç”³è¯·å‡ºçš„å†…å­˜çš„æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;æ ˆå†…å­˜æœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¿æŠ¤å’Œéä¿æŠ¤ã€‚ä¿æŠ¤æ¨¡å¼ç”¨äºè°ƒè¯•ï¼Œä¼šåœ¨æ­£å¸¸æ ˆå†…å­˜çš„ä¸¤ç«¯ï¼Œå„ç”³è¯·ä¸€ä¸ªé¡µå¤§å°çš„ä¿æŠ¤å†…å­˜ã€‚æ­£å¸¸æ ˆå†…å­˜çš„æƒé™æ˜¯è¯»å†™ï¼š&lt;code&gt;PROT_READ | PROT_WRITE&lt;/code&gt;ï¼Œè€Œä¿æŠ¤å†…å­˜çš„æƒé™æ˜¯ç¦æ­¢è®¿é—®ï¼š&lt;code&gt;PROT_NONE&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•è¯•å›¾è®¿é—®è¿™å—å†…å­˜çš„è¯·æ±‚ï¼Œéƒ½ä¼šè§¦å‘æ®µé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨éä¿æŠ¤çš„è¿è¡Œæ¨¡å¼ä¸‹ï¼Œæ ˆå†…å­˜è¿˜ä¼šä½¿ç”¨&lt;code&gt;MAP_ANONYMOUS | MAP_PRIVATE&lt;/code&gt;è¿˜è¿›è¡Œä¿æŠ¤ã€‚&lt;code&gt;MAP_ANONYMOUS&lt;/code&gt;è¡¨æ˜è¿™æ®µå†…å­˜æ˜¯åŒ¿åçš„ï¼Œå³ä¸å ç”¨fdï¼Œä¹Ÿæ— éœ€è¿›è¡Œå†™å›æ“ä½œï¼Œä½¿mmapçš„è¡Œä¸ºç±»ä¼¼äºmallocã€‚&lt;code&gt;MAP_PRIVATE&lt;/code&gt;æ„ä¸ºè¿™æ®µå†…å­˜ä¸ä¼šè¢«å…¶å®ƒè¿›ç¨‹è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ç§æœ‰çš„å†™æ—¶å¤åˆ¶æ˜ å°„ã€‚ï¼ˆè™½ç„¶æ²¡æ‰¾åˆ°ç›¸å…³èµ„æ–™ï¼Œä½†æ˜¯æ„Ÿè§‰è¿™ä¸¤ä¸ªé…ç½®ç‰ºç‰²äº†å¯è°ƒè¯•æ€§æ¥è·å–æ›´å¥½çš„æ€§èƒ½ï¼‰&lt;/p&gt;
&lt;h3&gt;ucontextçš„è¿è¡Œæ—¶ï¼š&lt;code&gt;UThreadRuntime&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç±»å…¶å®å¾ˆç®€å•ï¼Œä½†æ˜¯ç”±äºä»£ç çš„å‘½åè¿‡äºæ„è¯†æµï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“æŠŠäººç»•æ™•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª&lt;code&gt;UThreadRuntime&lt;/code&gt;ä»£è¡¨ç€ä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œç€çš„Nä¸ªucontextä¸Šä¸‹æ–‡ã€‚ä¸Šä¸‹æ–‡ä¿¡æ¯ä¿å­˜åœ¨&lt;code&gt;std::vector&amp;lt;ContextSlot&amp;gt; context_list_&lt;/code&gt;ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;slotæ˜¯å¯ä»¥å¤ç”¨çš„ï¼Œ&lt;code&gt;first_done_item_&lt;/code&gt;è®°å½•ç€å·²æ‰§è¡Œå®Œçš„contextçš„ä¸‹æ ‡ï¼Œç„¶åslotä¸­çš„&lt;code&gt;next_done_item&lt;/code&gt;è®°å½•ç€ä¸‹ä¸€ä¸ªæ‰§è¡Œå®Œçš„contextçš„ä¸‹æ ‡ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™å°±æ˜¯ç±»ä¼¼ä¸€ä¸ªâ€œè„æ± â€çš„è®¾è®¡ã€‚ä¸è¿‡è¿™ä¸ªå‘½åå•Šï¼Œä¸€ç‚¹éƒ½ä¸èµ›è‰‡ã€‚&lt;/p&gt;
&lt;p&gt;å‰©ä¸‹çš„ä»£ç åŸºæœ¬å°±æ˜¯&lt;code&gt;UThreadContext&lt;/code&gt;çš„æ— è„‘å°è£…äº†ã€‚éœ€è¦å“ªä¸ªåç¨‹å¼€å§‹å·¥ä½œå°±&lt;code&gt;Resume&lt;/code&gt;å“ªä¸ªåç¨‹ï¼Œéœ€è¦æš‚åœå°±è°ƒç”¨&lt;code&gt;Yield&lt;/code&gt;ã€‚ç»“æŸåï¼Œè°ƒç”¨å›è°ƒå‡½æ•°ï¼ŒæŠŠè¿è¡Œå®Œçš„åç¨‹å¾€è„æ± ä¸€æ‰”ï¼Œå®Œæ´»ã€‚&lt;/p&gt;
&lt;h2&gt;å†™åœ¨æœ€å&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬åˆ†æäº†phxrpcå¯¹ucontextåç¨‹åº“çš„å°è£…ï¼Œä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°±æ¥æ­£å¼çœ‹ä¸€çœ‹ucontextæ˜¯å¦‚ä½•ä¸IOå¤šè·¯å¤ç”¨çš„æŠ€æœ¯è¿æ¥åœ¨ä¸€èµ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åä¸Šå‡ å¼ çš‚ç‰‡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-13/31415098.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-13/1208386.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-13/97556242.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-13/44196833.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-13/20763058.jpg" /&gt;&lt;/p&gt;</summary><category term="phxrpc"></category><category term="ucontext"></category><category term="åç¨‹"></category></entry><entry><title>æ‰“é€ ä½ çš„ä¸“å±é”®ç›˜ â€” ErgoDone</title><link href="http://wizmann.tk/ergodone.html" rel="alternate"></link><updated>2016-10-05T21:38:58+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-05:ergodone.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½èƒ½é¢„è­¦ï¼šè¿™æ˜¯æœ€æ²¡æœ‰æŠ€æœ¯å«é‡çš„ä¸€ç¯‡åšå®¢ï¼Œæ— å…³äººå‘˜å¯ä»¥æ’¤ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;éƒ¨åˆ†å›¾ç‰‡æ¥è‡ªç½‘ç»œï¼Œä¾µåˆ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªåä¸€å‡æœŸï¼Œäº²æ‰‹DIYäº†ä¸€æŠŠé”®ç›˜ã€‚å½“ç„¶ï¼Œæˆ‘åªæå®šäº†ç„Šæ¥éƒ¨åˆ†ï¼ŒæŠŠä¸åŒçš„ç»„ä»¶æ‹¼åœ¨äº†ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç„Šæ¥çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå­¦ä¹ åˆ°äº†ä¸€äº›æ–°çŸ¥è¯†ã€‚å†™åœ¨è¿™é‡Œï¼Œè®°å½•ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;h2&gt;ErgoDoneä»‹ç»&lt;/h2&gt;
&lt;p&gt;ErgoDoneæ˜¯è‘—åå¼€æºç¡¬ä»¶ErgoDoxçš„ä¸­å›½ç‰¹è‰²ç‰ˆæœ¬ï¼Œç²¾ç®€äº†ä¸€äº›ç¡¬ä»¶ä»¥æ§åˆ¶æˆæœ¬ã€‚æ€»ä½“ä»·æ ¼åœ¨500RMBå·¦å³ï¼Œæ˜¯å·¥è–ªé˜¶çº§è£…é€¼ç•Œçš„ä¸€é¢—æ–°æ˜Ÿã€‚&lt;/p&gt;
&lt;p&gt;Ergodoxçš„ä¸€ä¸ªç‰ˆæœ¬ï¼š
&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-2/41980975.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ErgoDoneæ˜æ˜¾å°±å±Œä¸äº†è®¸å¤šï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-5/28663395.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;é”®ç›˜ä¸»æ§&lt;/h2&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-2/32662639.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ErgoDoneä½¿ç”¨äº†Arduino pro microåšä¸ºä¸»æ§ï¼ŒåŸºä¸­ä½¿ç”¨äº†mega32u4åšä¸ºèŠ¯ç‰‡ï¼Œæä¾›äº†æ¨¡æ‹ŸUSBè¾“å…¥è®¾å¤‡çš„ç›¸å…³å‡½æ•°ï¼ˆåŒ…æ‹¬é”®ç›˜ã€é¼ æ ‡ï¼‰ã€‚ç½‘ä¸Šæœ‰è®¸å¤šç°æˆçš„èŒƒä¾‹ï¼Œç”¨è¿™æ¬¾èŠ¯ç‰‡ï¼ˆä»¥åŠå¦ä¸€ç‰ˆä½¿ç”¨mega32u4çš„Arduinoå¼€å‘ç‰ˆï¼ŒArduino Leonardoï¼‰åˆ¶ä½œä½“æ„Ÿé¼ æ ‡ï¼ˆæ­é…é™€èºä»ªï¼‰ã€æ¸¸æˆæ‘‡æ†ï¼ˆæ­é…ç›¸å…³ç¡¬ä»¶ï¼‰ä»¥åŠå„ç§ä¸“ç”¨è¾“å…¥è®¾å¤‡ã€‚&lt;/p&gt;
&lt;p&gt;Arduino pro microæ·˜å®ä»·ä¸åˆ°20å—é’±ï¼Œç›¸å¯¹æ¥è¯´ç®—æ˜¯éå¸¸è¶…å€¼äº†ã€‚&lt;/p&gt;
&lt;h2&gt;ç„Šæ¥&lt;/h2&gt;
&lt;p&gt;ç”±äºæœ¬äººç®—æ˜¯èœçš„æŠ è„šçš„ä¸šä½™é€‰æ‰‹ï¼Œåœ¨è¿™ä¸ªé”®ç›˜ä¸Šçš„ä¸»è¦å·¥ä½œå°±æ˜¯ç„Šæ¥ã€‚ç„¶è€Œï¼Œå°±åœ¨ç„Šæ¥è¿™æ ·ä¸€ä»¶ç›¸å¯¹ç®€å•çš„å·¥ä½œä¸Šï¼Œæˆ‘ä¹Ÿæ˜¯è¸©äº†ä¸å°‘å‘ã€‚&lt;/p&gt;
&lt;h3&gt;MiniUSBè½¬MicroUSB&lt;/h3&gt;
&lt;p&gt;åœ¨ErgoDoneçš„è®¾è®¡ä¸­ï¼Œæ•´å—é”®ç›˜çš„ä¾›ç”µï¼Œéƒ½æ˜¯é€šè¿‡MiniUSBçº¿æ¥å®Œæˆçš„ã€‚ç„¶è€Œï¼Œpro microçš„æ¥å£æ˜¯MicroUSBçš„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè½¬æ¢å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-2/388124.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;MiniUSBï¼Œä¿—ç§°Tå£USBã€‚å…¶ä¸­æœ‰äº”é¢—çº¿ï¼Œä»£è¡¨ä¾›ç”µï¼ŒD+ï¼ŒD-ï¼ŒIDä¸æ¥åœ°ã€‚&lt;/p&gt;
&lt;p&gt;MicroUSBå°±æ˜¯ç°åœ¨å¸‚é¢ä¸Šç»å¤§å¤šæ•°å®‰å“æ‰‹æœºçš„å……ç”µ/æ•°æ®æ¥å£ã€‚å…¶ä¸­çš„çº¿åºä¸MiniUSBä¸­çš„ç±»ä¼¼ï¼Œåªæ˜¯å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨IDçº¿ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç„Šæ¥é”®ç›˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®Œæˆä¸€ä¸ªè‡ªåˆ¶MicroUSBæ¥å£ï¼ŒæŠŠå¯¼çº¿è¿æ¥åˆ°MicroUSBå¤´ä¸Šå»ã€‚è¿™ä¸ªä»»åŠ¡ç›¸å¯¹éš¾åº¦é«˜ä¸€äº›ï¼Œä¸è¿‡æˆ‘ä»¬ä¹Ÿæœ‰å·æ‡’çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºMicroUSBçº¿å®åœ¨è¿‡äºæµè¡Œï¼Œç°åœ¨æ— è®ºè°æ‰‹é‡Œéƒ½ä¼šæœ‰é‚£ä¹ˆä¸¤ä¸‰æ¡ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‹†æ‰æ‰‹æœºå……ç”µçº¿çš„MicroUSBå…¬å¤´ï¼ŒæŠŠå…¶ä¸­çš„çº¿å¼•å‡ºæ¥ï¼Œè¿åˆ°åº”è¯¥è¿çš„ä½ç½®ä¸Šï¼Œå°±å¯ä»¥æ­£å¸¸çš„ä½¿ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ çš„MicroUSBçº¿æ˜¯è‰¯å¿ƒå‚å®¶å‡ºäº§çš„è¯ï¼Œå…¶ä¸­ä¼šæœ‰å››é¢—çº¿ï¼šçº¢ç»¿ç™½é»‘ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¢ï¼šä¾›ç”µï¼Œ5V&lt;/li&gt;
&lt;li&gt;ç»¿ï¼šData+&lt;/li&gt;
&lt;li&gt;ç™½ï¼šData-&lt;/li&gt;
&lt;li&gt;é»‘ï¼šæ¥åœ°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ErgoDoneè¿™é‡Œï¼Œæˆ‘ä»¬ä¸éœ€è¦æ¥åœ°çº¿ä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œã€‚ç„¶ååœ¨ç„Šæ¥çš„æ—¶å€™è¦æ³¨æ„çº¿ä¸è¦ç•™çš„è¿‡é•¿ï¼Œå¦åˆ™ä¼šå¾ˆéš¾çœ‹ï¼ˆä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ï¼‰ã€‚&lt;/p&gt;
&lt;h3&gt;ä¸€äº›æ‰“ç£¨å·¥ä½œ&lt;/h3&gt;
&lt;p&gt;ErgoDoneçš„ä¸¤ç‰‡é”®ç›˜æ˜¯é€šè¿‡3.5mmçš„éŸ³é¢‘çº¿è¿æ¥çš„ï¼Œç„¶åéŸ³é¢‘æ¥å£ä¸å‡ºæ„æ–™çš„æ¯”å¤–å£³é¢„ç•™çš„æ¥å£è¦åšä¸€äº›ã€‚æ‰€ä»¥ä¸€äº›æ‰“ç£¨å·¥ä½œæ˜¯å¿…é¡»çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ¨èæ‰“ç£¨ç¥å™¨ â€”â€” ç£¨åˆ€çŸ³ã€‚å¥½çš„ç£¨åˆ€çŸ³æœ‰ç²—ç»†ä¸¤é¢ï¼Œæ–¹ä¾¿æ§åˆ¶ç²’åº¦ï¼ŒåŒæ—¶æ‰“ç£¨çš„æ•ˆç‡ä¹Ÿæ¯”è¾ƒé«˜ã€‚å¦‚æœçœŸçš„å•¥éƒ½æ²¡æœ‰ï¼Œå¯ä»¥å¼ºè¡Œè¯•ä¸€æ³¢æŒ‡ç”²é’³ä¸Šé¢çš„å°æŒ«ã€‚&lt;/p&gt;
&lt;h3&gt;å«æ˜Ÿè½´çš„å®‰è£…&lt;/h3&gt;
&lt;p&gt;å¯ä»¥å‚è€ƒ&lt;a href="http://tieba.baidu.com/p/3703634467"&gt;è¿™ç¯‡å¸–å­&lt;/a&gt;ï¼Œä¸Šé¢å·²ç»è¯´çš„å¾ˆå¥½äº†ï¼Œæˆ‘å°±ä¸é‡å¤äº†ã€‚è®°å¾—é‡è¦çš„ä¸€ç‚¹æ˜¯è¦æŠŠé’¢ä¸å…¥æ‰£ï¼Œå¦åˆ™å¯èƒ½ä¼šå¡é”®ä»€ä¹ˆçš„ã€‚æƒ…å†µå…è®¸ï¼Œè¿˜å¯ä»¥åŠ ä¸€ç‚¹æ¶¦æ»‘è„‚ï¼Œè®©æ‘©æ“¦åŠ›å°ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;h3&gt;ç„Šè½´&lt;/h3&gt;
&lt;p&gt;ç„Šè½´ç›¸å¯¹æ˜¯æœ€ç®€å•çš„ä¸€æ­¥äº†ï¼Œå› ä¸ºç„Šç‚¹çš„è·ç¦»è¶³å¤Ÿè¿œï¼Œè€Œä¸”ä¹Ÿè¶³å¤Ÿå¤§ã€‚åªæ˜¯æ³¨æ„åˆ«åœ¨ç„Šç›˜ä¸Šåœç•™å¤ªå¤šæ—¶é—´ï¼ŒæŠŠç„Šç›˜å¼„æ‰äº†å°±å¥½ã€‚&lt;/p&gt;
&lt;h3&gt;é£çº¿ä¸TDD&lt;/h3&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ”¾åœ¨ä¸€èµ·å†™çš„åŸå› æ˜¯å› ä¸ºè¿™ä¸¤ä¸ªæŠ€æœ¯éƒ½éœ€è¦ä¸€æ ·å·¥å…· â€”â€” ä¸‡ç”¨è¡¨ã€‚å½“ç„¶è¿™é‡Œåªæ˜¯ç”¨æ¥æµ‹è¿é€šæ€§çš„ï¼Œæ‰€ä»¥å¦‚æœä½ æ„¿æ„æŠ˜è…¾ï¼Œè‡ªå·±ç”¨å‘å…‰äºŒçº§ç®¡è‡ªå·±æä¸€æŠŠä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æ“ä½œä¸å½“ï¼Œä¸å°å¿ƒæŠŠç„Šç›˜æä¸‹æ¥äº†ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥è¡¥æ•‘å‘¢ã€‚ç­”æ¡ˆæ˜¯é£çº¿ï¼Œå°±æ˜¯ä¸å€ŸåŠ©ç”µè·¯æ¿ä¸Šçš„ç”µè·¯ï¼Œè€Œæ˜¯æ˜¾å¼çš„ç”¨å¯¼çº¿æ¥å¯¼é€šæŸä¸¤ä¸ªæˆ–å¤šä¸ªç®¡è„šã€‚&lt;/p&gt;
&lt;p&gt;ErgoDoneç”±äºæ˜¯å¯¹ç§°çš„ä¸¤å—ï¼Œæ‰€ä»¥åœ¨ç„Šå´©äº†ä¹‹åï¼Œå¯ä»¥ä¾æ ·æ‰¾ä¸€ä¸ªå¯ç”¨çš„ç„Šç›˜æ¥æ‰¾å¯ä»¥é£çº¿çš„ç„Šç‚¹ã€‚å¦‚æœæ‰‹é‡Œåªæœ‰ä¸€å—æ¿å­è€Œä¸”æƒ…å†µä¸å…è®¸çš„è¯ï¼Œå°±åªå¥½åœ¨ç„Šä¹‹å‰ï¼Œå°¤å…¶æ˜¯æ¯”è¾ƒé«˜éš¾åº¦çš„æ“ä½œä¹‹å‰ï¼Œå…ˆç•™å¥½plan Bï¼Œæƒ³æƒ³ä¸‡ä¸€æç ¸äº†æœ‰æ²¡æœ‰å›æ»šæ–¹æ¡ˆï¼ˆè›¤ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;TDDï¼Œåˆç§°æµ‹è¯•é©±åŠ¨å¼€å‘ã€‚å°±æ˜¯åœ¨ç„Šå®Œä¸€éƒ¨åˆ†ä¹‹åï¼Œç«‹åˆ»è¿›è¡Œæµ‹è¯•ã€‚æ¯”å¦‚é›†æˆç”µè·¯æˆ–è€…ä¸»æ§ï¼Œåœ¨ç„Šå®Œä¹‹åï¼Œä¸€å®šè¦ç”¨ä¸‡ç”¨è¡¨ç¡®è®¤ä¸€ä¸‹æ˜¯ä¸æ˜¯æœ‰ç›¸ä¸´ç®¡è„šçŸ­è·¯çš„æƒ…å†µã€‚åœ¨äºŒæç®¡ç„Šå®Œä¹‹åï¼Œç”¨é•Šå­æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥è§¦å‘ç›¸åº”çš„æŒ‰é”®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªåŠæˆå“ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-2/35993621.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;å¯¹é”®ç›˜ç¼–ç¨‹&lt;/h2&gt;
&lt;p&gt;è¿™ç§DIYé”®ç›˜çš„ä¸€å¤§å¥½å¤„å°±æ˜¯å¯ä»¥è‡ªå®šä¹‰é…åˆ—ï¼Œé€šè¿‡Fné”®åšä¸€äº›å¾ˆfancyçš„äº‹æƒ…ã€‚æ¯”å¦‚è§¦å‘ç»„åˆé”®ï¼Œæˆ–è€…æ˜¯å½•åˆ¶ä¸€äº›å®ã€‚å¯¹äºç¨‹åºå‘˜å’Œä¸€äº›æ¸¸æˆç©å®¶æ¥è¯´ï¼Œè¿™ä¸ªåŠŸèƒ½æ˜¯éå¸¸å¸å¼•äººçš„ã€‚&lt;/p&gt;
&lt;h3&gt;æˆ‘çš„é…åˆ—&lt;/h3&gt;
&lt;p&gt;é»˜è®¤å±‚ï¼šhttp://www.keyboard-layout-editor.com/#/gists/a9278a768f78adf9d7b019b883678390&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-5/11486899.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;Fnå±‚ï¼šhttp://www.keyboard-layout-editor.com/#/gists/79ad8e6c4ac70cfad1ed400355e960a7&lt;/p&gt;
&lt;p&gt;å³æ‰‹çš„é‚£å †Fnå¯¹åº”ç€0~9ä¸Šé¢çš„ç¬¦å·&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-5/90976851.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;Vimå±‚ï¼šhttp://www.keyboard-layout-editor.com/#/gists/950dc52b3b27c24601661f2fd43a6d69&lt;/p&gt;
&lt;p&gt;æ¨¡ä»¿vim/bashæ˜ å°„äº†ä¸€äº›å¿«æ·é”®&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-5/92544582.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;é­”æ”¹å±‚ï¼šhttp://www.keyboard-layout-editor.com/#/gists/8bb13d2439c542a06d99e17fca3a234b&lt;/p&gt;
&lt;p&gt;ç”¨æ¥é­”æ”¹/åˆ›é€ ä¸€äº›ä¸å­˜åœ¨çš„é”®ä½å’Œç»„åˆ&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-5/28220231.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;é£ŸæŒ‡å¤šå‡ºæ¥çš„å››ä¸ªé”®åˆ†åˆ«å¯¹åº”ç€å››ç§æ‹¬å·&lt;code&gt;&amp;lt;&amp;gt;(){}[]&lt;/code&gt;ã€‚åœ¨ç¼–ç¨‹ä¸­ä¼šæ¯”è¾ƒå¸¸ç”¨åˆ°ã€‚&lt;/p&gt;
&lt;h3&gt;é­”æ”¹ä¸¾ä¾‹&lt;/h3&gt;
&lt;p&gt;åœ¨é£ŸæŒ‡çš„æ‰©å……é”®ä½ä¸­ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ªä¸å­˜åœ¨çš„é”®ä½ç»„åˆï¼š&lt;code&gt;&amp;lt;(&lt;/code&gt;å’Œ&lt;code&gt;&amp;gt;)&lt;/code&gt;ã€‚å³åœ¨é»˜è®¤çŠ¶æ€ä¸‹ï¼Œè¾“å…¥&lt;code&gt;()&lt;/code&gt;ï¼›åœ¨ShiftçŠ¶æ€ä¸‹ï¼Œè¾“å…¥&lt;code&gt;&amp;lt;&amp;gt;&lt;/code&gt;ã€‚è¿™ç§è®¾è®¡å¹¶æ²¡æœ‰ç›´æ¥çš„è§£å†³æ–¹æ¡ˆã€‚å¯¹äºåœ†æ‹¬å·çš„è¾“å…¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»„åˆé”®å®ã€‚è€ŒShiftè¾“å…¥å°–æ‹¬å·ï¼Œåˆ™éœ€è¦ä¸€äº›æŠ€å·§ã€‚&lt;/p&gt;
&lt;p&gt;å¹¸å¥½ä¹‹å‰å·²ç»æœ‰äººæå‡ºå¹¶è§£å†³äº†&lt;a href="https://github.com/tmk/tmk_keyboard/wiki/FAQ-Keymap#esc-and--on-a-key"&gt;ç±»ä¼¼çš„é—®é¢˜&lt;/a&gt;ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯å°†Shiftæ”¹æˆâ€œFn+Shiftâ€ï¼Œåœ¨æŒ‰ä¸‹Shiftçš„åŒæ—¶ï¼Œåˆ‡æ¢åˆ°ä¸€ä¸ªæ–°çš„å±‚ä¸Šã€‚æ–°çš„å±‚ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç»„åˆé”®å®è¾“å…¥å°–æ‹¬å·ã€‚è€Œå‰©ä¸‹çš„é”®ä½ï¼Œæˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºé€æ˜ã€‚å½“ä½ æŒ‰ä¸‹å…¶å®ƒçš„é”®æ—¶ï¼Œä¸å¹³æ—¶æŒ‰ä¸‹Shiftæ²¡æœ‰åŒºåˆ«ã€‚&lt;/p&gt;
&lt;h2&gt;æœ€ç»ˆçš„ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// Generated by TKG at 2016-10-05 22:35:43&lt;/span&gt;

&lt;span class="cp"&gt;#include &amp;quot;keymap_common.h&amp;quot;&lt;/span&gt;

&lt;span class="cp"&gt;#define KEYMAP_TKG( \&lt;/span&gt;
&lt;span class="cp"&gt;    K0A, K0B, K0C, K0D, K0E, K0F, K0G, K0H, K0I, K0J, K0K, K0L, K0M, K0N, \&lt;/span&gt;
&lt;span class="cp"&gt;    K1A, K1B, K1C, K1D, K1E, K1F, K1G, K1H, K1I, K1J, K1K, K1L, K1M, K1N, \&lt;/span&gt;
&lt;span class="cp"&gt;    K2A, K2B, K2C, K2D, K2E, K2F,           K2I, K2J, K2K, K2L, K2M, K2N, \&lt;/span&gt;
&lt;span class="cp"&gt;    K3A, K3B, K3C, K3D, K3E, K3F, K3G, K3H, K3I, K3J, K3K, K3L, K3M, K3N, \&lt;/span&gt;
&lt;span class="cp"&gt;    K4A, K4B, K4C, K4D, K4E,                     K4J, K4K, K4L, K4M, K4N, \&lt;/span&gt;
&lt;span class="cp"&gt;         K5B, K5C, K5D, K5E, K5F, K5G, K5H, K5I, K5J, K5K, K5L, K5M  \&lt;/span&gt;
&lt;span class="cp"&gt;) { \&lt;/span&gt;
&lt;span class="cp"&gt;    { KC_##K0A, KC_##K0B, KC_##K0C, KC_##K0D, KC_##K0E, KC_##K0F, KC_##K0G, KC_##K0H, KC_##K0I, KC_##K0J, KC_##K0K, KC_##K0L, KC_##K0M, KC_##K0N }, \&lt;/span&gt;
&lt;span class="cp"&gt;    { KC_##K1A, KC_##K1B, KC_##K1C, KC_##K1D, KC_##K1E, KC_##K1F, KC_##K1G, KC_##K1H, KC_##K1I, KC_##K1J, KC_##K1K, KC_##K1L, KC_##K1M, KC_##K1N }, \&lt;/span&gt;
&lt;span class="cp"&gt;    { KC_##K2A, KC_##K2B, KC_##K2C, KC_##K2D, KC_##K2E, KC_##K2F, KC_NO,    KC_NO,    KC_##K2I, KC_##K2J, KC_##K2K, KC_##K2L, KC_##K2M, KC_##K2N }, \&lt;/span&gt;
&lt;span class="cp"&gt;    { KC_##K3A, KC_##K3B, KC_##K3C, KC_##K3D, KC_##K3E, KC_##K3F, KC_##K3G, KC_##K3H, KC_##K3I, KC_##K3J, KC_##K3K, KC_##K3L, KC_##K3M, KC_##K3N }, \&lt;/span&gt;
&lt;span class="cp"&gt;    { KC_##K4A, KC_##K4B, KC_##K4C, KC_##K4D, KC_##K4E, KC_NO,    KC_NO,    KC_NO,    KC_NO,    KC_##K4J, KC_##K4K, KC_##K4L, KC_##K4M, KC_##K4N }, \&lt;/span&gt;
&lt;span class="cp"&gt;    { KC_NO,    KC_##K5B, KC_##K5C, KC_##K5D, KC_##K5E, KC_##K5F, KC_##K5G, KC_##K5H, KC_##K5I, KC_##K5J, KC_##K5K, KC_##K5L, KC_##K5M, KC_NO    }  \&lt;/span&gt;
&lt;span class="cp"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;#ifdef KEYMAP_SECTION_ENABLE&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;uint8_t&lt;/span&gt; &lt;span class="n"&gt;keymaps&lt;/span&gt;&lt;span class="p"&gt;[][&lt;/span&gt;&lt;span class="n"&gt;MATRIX_ROWS&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;MATRIX_COLS&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;__attribute__&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;section&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.keymap.keymaps&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="cp"&gt;#else&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;uint8_t&lt;/span&gt; &lt;span class="n"&gt;keymaps&lt;/span&gt;&lt;span class="p"&gt;[][&lt;/span&gt;&lt;span class="n"&gt;MATRIX_ROWS&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;MATRIX_COLS&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;PROGMEM&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="cp"&gt;#endif&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KEYMAP_TKG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;GRV&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;HOME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;END&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;BSPC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TAB&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;LBRC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;RBRC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;O&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;P&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;BSLS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;ESC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;             &lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;SCLN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;QUOT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;FN3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;FN7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FN8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;COMM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;DOT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SLSH&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  \
        &lt;span class="n"&gt;LCTL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;LGUI&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;LALT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;DEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;                     &lt;span class="n"&gt;MINS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;EQL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  \
             &lt;span class="n"&gt;LCTL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SPC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FN4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PSCR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;CAPS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PAUS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ENT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FN1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LGUI&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KEYMAP_TKG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;F1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;F6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;F10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN21&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN23&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN24&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;             &lt;span class="n"&gt;FN26&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN27&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN28&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN29&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;                    &lt;span class="n"&gt;VOLU&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;VOLD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;MPRV&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;MPLY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;MNXT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
             &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KEYMAP_TKG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;END&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PGUP&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;INS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;HOME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PGDN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;          &lt;span class="n"&gt;LEFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;DOWN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;UP&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;RGHT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;DEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FIND&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;                    &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
             &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KEYMAP_TKG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;          &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;FN9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FN10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
        &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;                    &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
             &lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;BSPC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TRNS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="cp"&gt;#ifdef KEYMAP_SECTION_ENABLE&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;uint16_t&lt;/span&gt; &lt;span class="n"&gt;fn_actions&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;__attribute__&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;section&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.keymap.fn_actions&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="cp"&gt;#else&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;uint16_t&lt;/span&gt; &lt;span class="n"&gt;fn_actions&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;PROGMEM&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="cp"&gt;#endif&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_LAYER_MOMENTARY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_LAYER_MOMENTARY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_LAYER_MODS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LGUI&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_SPACE&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LGUI&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_TAB&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_LAYER_TOGGLE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_9&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_COMMA&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_DOT&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LCTL&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;MOD_LSFT&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;MOD_LALT&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;MOD_LGUI&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_7&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_8&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_9&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACTION_MODS_KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MOD_LSFT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KC_0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æˆæœ¬ç»Ÿè®¡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;PCBæ¿ + å¤–å£³ = 220 RMB ï¼ˆå·²åŠ é‚®è´¹ï¼‰&lt;/li&gt;
&lt;li&gt;è½´ + å¹³è¡¡æ  + ç¯ = 100 RMB ï¼ˆåŒ…é‚®ï¼‰&lt;/li&gt;
&lt;li&gt;é”®å¸½ = 119RMB ï¼ˆåŒ…é‚®ï¼‰&lt;/li&gt;
&lt;li&gt;åˆè®¡ï¼š440RMB&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»çš„çœ‹æ¥ï¼Œè¿™ä¸ªå¤åˆ»ç‰ˆæœ¬ï¼Œæ¯”å›½å¤–åŠ¨è¾„ä¸Šç™¾åˆ€çš„ç‰ˆæœ¬æ›´æœ‰å¸å¼•åŠ›ã€‚ä¸è¿‡é«˜å¤§ä¸Šç¨‹åº¦è¿˜æ˜¯ç•¥é€Šä¸€ç­¹ã€‚&lt;/p&gt;
&lt;p&gt;ErgoDoneï¼Œè®©ä½ é‡æ–°å®šï¼ˆå­¦ï¼‰ä¹‰ï¼ˆä¹ ï¼‰æ‰“å­—ã€‚&lt;/p&gt;</summary><category term="ot"></category><category term="ergodone"></category><category term="keyboard"></category></entry><entry><title>é˜»å¡TCPæµ - phxrpcä»£ç é˜…è¯»(3)</title><link href="http://wizmann.tk/phxrpc-3.html" rel="alternate"></link><updated>2016-10-03T22:22:14+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-10-03:phxrpc-3.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;phxrpcçš„æµï¼ˆ&lt;code&gt;stream&lt;/code&gt;å’Œ&lt;code&gt;streambuf&lt;/code&gt;ï¼‰ä¸ç½‘ç»œè®¿é—®å…¶å®æ˜¯è€¦åˆåœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥æœ¬æ–‡å¯ä»¥ç»“åˆç€ç¬¬ä¸€ç¯‡ç¬”è®°ä¸€èµ·æ¥çœ‹ã€‚è™½ç„¶æˆ‘éå¸¸æƒ³åæ§½è¿™ç§å¼ºè€¦åˆæ€§çš„è®¾è®¡ï¼Œä½†æ˜¯æˆ‘å†³å®šè¿˜æ˜¯å¥½å¥½ç†è§£phxrpcçš„è®¾è®¡ä¹‹åã€‚ã€‚ã€‚æ”’ä¸€æ³¢å¤§çš„ï¼šï¼‰&lt;/p&gt;
&lt;h2&gt;BlockTcpStreamBuf&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;class BlockTcpStreamBuf&lt;/code&gt;ç»§æ‰¿è‡ª&lt;code&gt;BaseTcpStreamBuf&lt;/code&gt;ã€‚å…¶ä¸­é‡å†™äº†&lt;code&gt;precv&lt;/code&gt;å’Œ&lt;code&gt;psend&lt;/code&gt;ä¸¤ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æŒæœ‰äº†ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦(file descriptor)ï¼š&lt;code&gt;socket_&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;precv&lt;/code&gt;å’Œ&lt;code&gt;psend&lt;/code&gt;ç›´æ¥è°ƒç”¨äº†&lt;code&gt;&amp;lt;sys/socket.h&amp;gt;&lt;/code&gt;ä¸­çš„&lt;code&gt;recv(2)&lt;/code&gt;å’Œ&lt;code&gt;send(2)&lt;/code&gt;ï¼Œå¹¶æ²¡æœ‰å…¶å®ƒæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç»œç›¸å…³çš„æ“ä½œï¼Œåˆ™ç”±&lt;code&gt;class BlockTcpStream&lt;/code&gt;æ¥è´Ÿè´£ã€‚&lt;code&gt;BlockTcpStreamBuf&lt;/code&gt;åªè´Ÿè´£IOéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BaseTcpUtils&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SetNonBlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sockfd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;BaseTcpUtils&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SetNoDelay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sockfd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sockfd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;phxrpc&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LOG_ERR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;set nonblock fail&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sockfd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨&lt;code&gt;BlockTcpStream&lt;/code&gt;æŠŠfdä¼ é€’ç»™&lt;code&gt;BlockTcpStreambuf&lt;/code&gt;ä¹‹å‰ï¼Œéœ€è¦æŠŠfdè®¾ç½®ä¸º&lt;code&gt;block&lt;/code&gt;çš„ã€‚è€Œè¿™æ®µä»£ç æœ€å¤§çš„æ§½ç‚¹å°±æ˜¯è¿™ä¸ª&lt;code&gt;SetNonBlock&lt;/code&gt;å‡½æ•°ï¼Œå’Œä¸‹é¢çš„&lt;code&gt;set nonblock fail&lt;/code&gt;æ—¥å¿—ï¼ˆæƒ³ä¸€æƒ³ï¼‰ã€‚å®Œå…¨è®©äººæ‘¸ä¸åˆ°å¤´è„‘ï¼Œè¾¾åˆ°ä¸€è„¸æ‡µé€¼çš„æœ€é«˜å¢ƒç•Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-3/87163832.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº&lt;code&gt;recv&lt;/code&gt;å’Œ&lt;code&gt;send&lt;/code&gt;å‡½æ•°æ˜¯&lt;code&gt;block&lt;/code&gt;çš„ï¼Œæ‰€ä»¥åœ¨è¯»å–ã€å†™å…¥ç¼“å†²åŒºæ—¶ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„æ•°æ®å¯è¯»æˆ–æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å¯å†™ï¼Œåˆ™è¯»å–å†™å…¥æ“ä½œä¼šé˜»å¡ä½ã€‚&lt;/p&gt;
&lt;h2&gt;BlockTcpStream&lt;/h2&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘åˆæƒ³åä¸ªæ§½äº†ï¼Œä¸ºå•¥åœ¨è¿™é‡ŒæŠŠTCP Serverå’ŒClientçš„å·¥ä½œæµæ··ä¸ºä¸€è°ˆã€‚æˆ‘è§‰å¾—è‡³å°‘åº”è¯¥ä»å‘½åä¸ŠåŒºåˆ†ä¸€ä¸‹ï¼Œå¦åˆ™æå®¹æ˜“è¯¯ç”¨ã€‚&lt;/p&gt;
&lt;h3&gt;TCPçš„å·¥ä½œæµç¨‹&lt;/h3&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-3/92621506.jpg" /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å›¾ç‰‡æ¥æºï¼šUNIXç½‘ç»œç¼–ç¨‹å·ä¸€ï¼šå¥—æ¥å­—ç¼–ç¨‹ 4.2èŠ‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒTCPçš„æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„å·¥ä½œæµç¨‹æ˜¯ä¸åŒçš„ï¼Œç›¸å¯¹æ¥è¯´ï¼Œå®¢æˆ·ç«¯çš„ç¨‹åºè¦ç®€å•ä¸€äº›ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BlockTcpStream&lt;/code&gt;ä¸­ï¼Œå®¢æˆ·ç«¯åº”ç”¨çš„å‡½æ•°åªæœ‰&lt;code&gt;BlockTcpUtils::Open&lt;/code&gt;ï¼Œè€ŒæœåŠ¡ç«¯çš„&lt;code&gt;BlockTCPUtils::Listen&lt;/code&gt;å‡½æ•°åŒ…æ‹¬äº†&lt;code&gt;bind()&lt;/code&gt;å’Œ&lt;code&gt;listen()&lt;/code&gt;ä¸¤ä¸ªæ“ä½œï¼Œè€Œ&lt;code&gt;accept()&lt;/code&gt;åˆ™éœ€è¦å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h3&gt;SO_REUSEADDR&lt;/h3&gt;
&lt;p&gt;åœ¨æœåŠ¡ç«¯çš„&lt;code&gt;Listen()&lt;/code&gt;å‡½æ•°ä¸­ï¼Œphxrpcä½¿ç”¨äº†&lt;code&gt;SO_REUSEADDR&lt;/code&gt;é€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹çš„æ„åœ¨é€šçŸ¥å†…æ ¸ï¼šå¦‚æœç«¯å£å¿™ï¼Œä½†æ˜¯TCPçŠ¶æ€ä½äº&lt;code&gt;TIME_WAIT&lt;/code&gt;æ—¶ï¼Œå¯ä»¥é‡ç”¨ç«¯å£ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå¥—æ¥å­—å…¶å®æ˜¯ä¸€ä¸ª&lt;code&gt;ï¼ˆåè®®ï¼Œæºåœ°å€ï¼Œæºç«¯å£ï¼Œç›®æ ‡åœ°å€ï¼Œç›®æ ‡ç«¯å£ï¼‰&lt;/code&gt;äº”å…ƒç»„ã€‚&lt;code&gt;SO_REUSEADDR&lt;/code&gt;æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é‡ç”¨æºåœ°å€å’Œæºç«¯å£ã€‚å½“ç„¶æ­¤æ—¶çš„é£é™©åœ¨äºå¦‚æœè¯¥åŸå¥—æ¥å­—å‘é€äº†ä¸€äº›é”™è¯¯çš„æ•°æ®ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„TCPå·¥ä½œæµå°±ä¼šäº§ç”Ÿé”™ä¹±ã€‚ä½†æ˜¯ç”±äºTCPçš„å®ç°ä¸­ï¼Œé€šè¿‡éšæœºçš„æ¶ˆæ¯åºå·è§„é¿äº†è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œçš„é£é™©å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;SO_REUSEADDR&lt;/code&gt;çš„å¥½å¤„æ˜¯ï¼Œåœ¨æœåŠ¡ç«¯ç¨‹åºå´©æºƒå’Œé€€å‡ºæ—¶ï¼ˆå¯¹äºä¸€èˆ¬çš„æœåŠ¡ç«¯ç¨‹åºæ¥è¯´ï¼Œå´©æºƒå’Œé€€å‡ºæ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼‰ï¼Œå¯ä»¥ç«‹å³é‡å¯ï¼Œè€Œä¸éœ€è¦ç­‰å¾…2MSLæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬è¦é—®äº†ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦ç­‰å¾…2MSLæ—¶é—´å‘¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-3/33186679.jpg" /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å›¾ç‰‡æ¥æºï¼šEffective TCP/IP 3.8èŠ‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;TCPæ‹†é™¤è¿æ¥ä½¿ç”¨äº†å››æ¬¡æ¡æ‰‹çš„æœºåˆ¶ï¼Œè€Œä¸»åŠ¨å…³é—­è¿æ¥çš„ä¸€æ–¹åœ¨å‘é€å®Œæœ€åä¸€ä¸ªACKä¹‹åï¼Œéœ€è¦ç­‰å¾…2MSLçš„æ—¶é—´ã€‚è¿™å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ï¼Œå½“æœåŠ¡å™¨é‡å¯åï¼Œå‡ºç°&lt;code&gt;Address already in use&lt;/code&gt;çš„æŠ¥é”™ä¿¡æ¯ï¼Œéœ€è¦é¢å¤–ç­‰å¾…å¤§çº¦1~4åˆ†é’Ÿçš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;ç©¶å…¶åŸå› ï¼ŒTIME-WAITçŠ¶æ€çš„æ„å›¾åœ¨äºé¿å…ä¸»åŠ¨å…³é—­è¿æ¥çš„ä¸€ç«¯æœ€åä¸€ä¸ªACKå‘é€å¤±è´¥ã€‚æ­¤æ—¶ï¼Œä¸»æœº1å·²ç»å®Œå…¨å…³é—­ï¼Œè€Œä¸»æœº2å› ä¸ºæ²¡æœ‰æ”¶åˆ°FINåŒ…çš„ACKï¼Œå¤„äºåŠå…³é—­çŠ¶æ€ã€‚æ­¤æ—¶ä¸»æœº2å‘ä¸»æœº1å‘é€çš„ä»»ä½•ä¿¡æ¯ï¼ˆå¦‚å»¶è¿Ÿçš„ACKåŒ…ç­‰ï¼‰éƒ½åªä¼šæ”¶åˆ°RSTï¼Œå¯¼è‡´è¿æ¥çš„å¼‚å¸¸å…³é—­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§„é¿è¿™ä¸ªé—®é¢˜ï¼Œä¸»åŠ¨å…³é—­ç«¯éœ€è¦ç­‰å¾…2MSLæ—¶é—´ã€‚ä¸€ä¸ªMSLæ˜¯ç»™æœ€åçš„ACKåŒ…ï¼Œè€Œå¦å¤–ä¸€ä¸ªMSLï¼Œæ˜¯ä¸ºäº†ç­‰å¾…è¢«åŠ¨å…³é—­ç«¯é‡æ–°å‘é€FINåŒ…ã€‚å¦‚æœåœ¨TIME_WAITæœŸé—´æ”¶åˆ°äº†å¯¹ç«¯çš„æ•°æ®åŒ…ï¼Œä¼šåˆ·æ–°TIME_WAITçŠ¶æ€çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼šEffective TCP/IP 3.8 3.9èŠ‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;IOå¤ç”¨ï¼šPoll&lt;/h3&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-3/84501111.jpg" /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å›¾ç‰‡æ¥æºï¼šUNIXç½‘ç»œç¼–ç¨‹å·ä¸€ï¼šå¥—æ¥å­—ç¼–ç¨‹ 6.2èŠ‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;IOå¤ç”¨æ˜¯æŒ‡å†…æ ¸åœ¨å‘ç°è¿›ç¨‹æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªIOæ¡ä»¶å°±ç»ªï¼Œå†…æ ¸å°±é€šçŸ¥è¿›ç¨‹ã€‚é€šå¸¸æ¥è®²ï¼Œå¸¸ç”¨çš„IOå¤ç”¨å‡½æ•°æœ‰&lt;code&gt;select()&lt;/code&gt;å’Œ&lt;code&gt;poll()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“&lt;code&gt;poll()&lt;/code&gt;è¿”å›åï¼Œæˆ‘ä»¬éœ€è¦éå†å…¶ä¸­çš„fdæ•°ç»„æ‰¾åˆ°å¯æ“ä½œçš„fdã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;pollfd&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="kt"&gt;int&lt;/span&gt;   &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;         &lt;span class="cm"&gt;/* file descriptor */&lt;/span&gt;
   &lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;     &lt;span class="cm"&gt;/* requested events */&lt;/span&gt;
   &lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="n"&gt;revents&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="cm"&gt;/* returned events */&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä»&lt;code&gt;events&lt;/code&gt;å’Œ&lt;code&gt;revents&lt;/code&gt;è·å¾—è¯¥fdçš„çŠ¶æ€ï¼Œä»è€Œåˆ¤åˆ«å¯è¯»ã€å¯å†™ã€è¶…æ—¶æˆ–å‡ºé”™ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨pollå‡½æ•°çš„IOå¤ç”¨èƒ½åŠ›ï¼Œè€Œæ˜¯æŠŠå®ƒåšä¸ºå¦ä¸€ä¸ªé˜»å¡IOè°ƒç”¨æ¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;BlockTcpUtils::Open&lt;/code&gt;å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†pollï¼Œç”¨æ¥ç›‘è§†ç›¸åº”çš„ï¼ˆä¸€ä¸ªï¼‰fdæ˜¯å¦å¯è¯»ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±éšå¼ï¼ˆä¸ºä»€ä¹ˆè¯´éšå¼å‘¢ï¼Œå› ä¸ºä»–ä»¬ä¸€ä¸å†™æ–‡æ¡£ï¼ŒäºŒä¸å†™æ³¨é‡Šï¼Œä¸€åˆ‡éƒ½æ˜¯æ½œè§„åˆ™ï¼‰è§„å®šäº†C/Säº¤äº’çš„åŸºæœ¬å·¥ä½œæµç¨‹ï¼šå½“C/Sè¿æ¥å»ºç«‹åï¼ŒServerç«¯è¦å…ˆè¯´è¯ï¼ŒClientç«¯æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åï¼Œæ‰å¯ä»¥è¿›è¡Œä¸‹é¢çš„æµç¨‹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Clientï¼šâ€œä¸ç®¡ä½ ä»¬ä¿¡ä¸ä¿¡ï¼Œæ˜¯Serverå…ˆåŠ¨çš„æ‰‹ã€‚â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…·ä½“ä¸ºä»€ä¹ˆå…ˆç”¨pollï¼Œå†æŠŠfdè®¾ä¸º&lt;code&gt;blocking&lt;/code&gt;çš„ï¼Œæˆ‘è¡¨ç¤ºäºŒè„¸æ‡µé€¼ã€‚åœ¨æˆ‘çš„å®éªŒä¸­ï¼Œå³ä½¿æŠŠpollåˆ æ‰ï¼Œæµ‹è¯•ä»£ç ä¹Ÿæ˜¯å¯ä»¥workçš„ã€‚å¯èƒ½åœ¨åé¢çš„ä»£ç é˜…è¯»ä¸­ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥è·å¾—è§£é‡Šå§ã€‚&lt;/p&gt;
&lt;p&gt;å’Œselectä¸€æ ·ï¼Œpollä¹Ÿå­˜åœ¨è¢«ä¸­æ–­çš„æƒ…å†µï¼Œåœ¨phxrpcçš„ä»£ç é‡Œï¼Œæˆ‘ä»¬ç»™äº†ä¸­æ–­â€œa second chanceâ€ã€‚å½“pollè¢«ä¸­æ–­åï¼Œä¼šé‡æ–°å†pollä¸€æ¬¡ï¼›å¦‚æœè¿™æ¬¡å†è¢«ä¸­æ–­ï¼Œåˆ™ç›´æ¥è¿”å›TIMEOUTã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// retry again for EINTR&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;pfd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout_ms&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;EINTR&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;errno&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;errno&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ETIMEDOUT&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å†™åœ¨æœ€å&lt;/h2&gt;
&lt;p&gt;ç”±äºè¿™ç¯‡æ–‡ç« ä¸­çš„çŸ¥è¯†ç‚¹æ¯”è¾ƒæ‚ï¼Œå†™ä½œçš„é¡ºåºä¹Ÿæ˜¯éšæœºçš„ã€‚æ‰€ä»¥è¿è´¯æ€§ä¸æ˜¯é‚£ä¹ˆå¼ºã€‚å¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå¿ç€ç‚¹å§æ‚¨å°±ã€‚&lt;/p&gt;
&lt;p&gt;å¿ä¸äº†çš„è¯ã€‚ã€‚ã€‚é‚£å°±ç•™è¨€äº¤æµå§~&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-10-3/42112021.jpg" /&gt;&lt;/p&gt;</summary><category term="phxrpc"></category><category term="tcpip"></category><category term="poll"></category><category term="socket"></category></entry><entry><title>å®šæ—¶å™¨ä»¥åŠå…¶å®ƒ - phxrpcé˜…è¯»ç¬”è®°(2)</title><link href="http://wizmann.tk/phxrpc-2.html" rel="alternate"></link><updated>2016-09-29T01:28:09+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-09-29:phxrpc-2.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;phxrpcä½¿ç”¨äº†åç¨‹(ucontext)å’ŒIOå¤ç”¨æŠ€æœ¯(epoll)æ¥å®ç°ç½‘ç»œé€šä¿¡ã€‚å®šæ—¶å™¨åœ¨å…¶ä¸­èµ·åˆ°äº†éå¸¸é‡è¦çš„ä½œç”¨ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥åˆ†æä¸€ä¸‹phxrpcçš„&lt;code&gt;timer.[h|cpp]&lt;/code&gt;ä¸­çš„ä»£ç ã€‚&lt;/p&gt;
&lt;h2&gt;system_clock vs steady_clock&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;system_clock&lt;/code&gt;å’Œ&lt;code&gt;steadly_clock&lt;/code&gt;éƒ½æ˜¯æ¥è‡ª&lt;code&gt;&amp;lt;chrono&amp;gt;&lt;/code&gt;åº“ï¼Œéƒ½æ˜¯ç”¨æ¥è·å–å½“å‰æ—¶é—´çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;system_clock&lt;/code&gt;ç”¨æ¥ä»ç³»ç»Ÿæ—¶é’Ÿè·å–æ—¶é’Ÿæ—¶é—´(wall clock time)ï¼Œè€Œ&lt;code&gt;steadly_clock&lt;/code&gt;è·å–çš„æ˜¯æ—¶é’Ÿtickï¼Œè€Œä¸”ä¿è¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ—¶é’Ÿtickæ•°ä¸ä¼šå˜å°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œå®é™…ä¸Šï¼Œåœ¨æŸäº›ç³»ç»Ÿä¸‹ï¼Œè¿™ä¸¤ä¸ªæ—¶é’Ÿçš„å®ç°æ˜¯ä¸€è‡´çš„ã€‚è¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒ&lt;a href="http://stackoverflow.com/questions/13263277/difference-between-stdsystem-clock-and-stdsteady-clock"&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šåœ¨clang++ 4.2.1, g++ 5.4 ä¸‹å®éªŒï¼Œè¿™ä¸¤ä¸ªæ—¶é’Ÿæ˜¯ä¸åŒçš„ã€‚æ‰€ä»¥ä¸ªäººè®¤ä¸ºåœ¨è¿™é‡Œæœ€å¥½ä¸è¦åšä»»ä½•æ— æ„ä¹‰çš„å‡è®¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;å‡ æ¯«ç§’çš„å®‰ç¡&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;Timer&lt;/span&gt; &lt;span class="o"&gt;::&lt;/span&gt; &lt;span class="n"&gt;MsSleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;time_ms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;timespec&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_sec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time_ms&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_nsec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time_ms&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;nanosleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;errno&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;EINTR&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œphxrpcä½¿ç”¨äº†&lt;code&gt;nanosleep&lt;/code&gt;å®ç°äº†é«˜ç²¾åº¦çš„sleepã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„è¿™é‡Œçš„ç”¨æ³•ï¼Œç”±äº&lt;code&gt;nanosleep&lt;/code&gt;å¯èƒ½è¢«ä¿¡å·ä¸­æ–­ï¼Œæ­¤æ—¶errnoè¢«è®¾ä¸º&lt;code&gt;EINTR&lt;/code&gt;ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œé¢å¤–çš„åˆ¤æ–­ã€‚å½“nanosleepè¢«ä¿¡å·ä¸­æ–­æ—¶ï¼Œä¼šæŠŠå‰©ä½™æ—¶é—´å†™å…¥ç¬¬äºŒä¸ªå‚æ•°æŒ‡å‘çš„&lt;code&gt;timespec&lt;/code&gt;å˜é‡ä¸­ï¼Œä¹‹åæˆ‘ä»¬å†æ¬¡è°ƒç”¨&lt;code&gt;nanosleep&lt;/code&gt;ï¼Œå°±å¯ä»¥æŠŠå‰©ä½™çš„æ—¶é—´å†ç¡ä¸€ä¸ªå›ç¬¼è§‰äº†ã€‚&lt;/p&gt;
&lt;h2&gt;å¯åˆ é™¤ä¼˜å…ˆé˜Ÿåˆ—&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªè®¾è®¡ä¸€é¢—èµ›è‰‡å•Šã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº&lt;code&gt;std::priority_queue&lt;/code&gt;ä»¥åŠå¤§å¤šæ•°æ‰‹å†™çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆåˆç§°å †ï¼Œheapï¼‰ã€‚ä¸€èˆ¬åªæœ‰&lt;code&gt;top()&lt;/code&gt;, &lt;code&gt;push()&lt;/code&gt;, &lt;code&gt;pop()&lt;/code&gt;è¿™ä¸‰ä¸ªæ“ä½œæ¥å£ï¼Œå¦‚æœæƒ³å®ç°åˆ é™¤æ“ä½œï¼Œå¤§å¤šæ•°æƒ…å†µï¼ˆä¸ºäº†å·æ‡’ï¼‰ä¼šæŠŠ&lt;code&gt;std::priority_queue&lt;/code&gt;æ›¿æ¢ä¸º&lt;code&gt;std::set&lt;/code&gt;ã€‚&lt;code&gt;std::set&lt;/code&gt;çš„å†…éƒ¨å®ç°æ˜¯å¹³è¡¡æ ‘ï¼ˆç¡®åˆ‡çš„è¯´ï¼Œçº¢é»‘æ ‘ï¼‰ï¼Œå¯ä»¥å®ç°è·å¾—æœ€å¤§æœ€å°å€¼ï¼ŒæŸ¥æ‰¾æŸä¸ªå€¼ï¼Œä»¥åŠåˆ é™¤æŸä¸ªå€¼çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯&lt;code&gt;std::priority_queue&lt;/code&gt;ï¼ˆæˆ–è€…ç”¨æ•°ç»„æˆ–vectorå®ç°çš„å †ï¼‰æ˜¯é¡ºåºå®¹å™¨(sequence containers)ï¼Œè€Œ&lt;code&gt;std::set&lt;/code&gt;æ˜¯å…³è”å®¹å™¨(associative containers)ã€‚ç›¸å¯¹æ¥è¯´ï¼Œç”±äºcacheçš„åŸå› ï¼Œé¡ºåºå®¹å™¨çš„æ€§èƒ½æ¯”å…³è”å®¹å™¨è¦å¥½ã€‚å½“ç„¶æˆ‘æ‰¯å¾—æœ‰ç‚¹è¿œäº†ã€‚å¯¹æ­¤æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»å‚è€ƒã€ŠEffective STLã€‹ä¸€ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å †æ˜¯å°æ ¹å †ï¼ŒæŒ‰è¶…æ—¶æ—¶é—´å¢åº&lt;/li&gt;
&lt;li&gt;å †ä¸­çš„å…ƒç´ æ˜¯socketæè¿°ç¬¦&lt;code&gt;UThreadSocket_t&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ ¹æ®æè¿°ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤å †ä¸­çš„ä»»æ„å…ƒç´ &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æœ‰æ¸…é†’çš„å¤´è„‘ï¼Œå°±ä¼šè®¤ä¸ºè¿™ä¸ªéœ€æ±‚æ˜¯ä¸å¥½å®ç°çš„ã€‚åˆ é™¤å †ä¸­å…ƒç´ å¹¶ä¸å¤æ‚ï¼Œåªéœ€è¦å°†å †ä¸­æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ°è¢«åˆ é™¤å…ƒç´ çš„ä½ç½®ä¸Šï¼Œç„¶åå†æ‰§è¡Œä¸€æ¬¡&lt;code&gt;heap_down()&lt;/code&gt;æ“ä½œå°±å¯ä»¥äº†ã€‚é—®é¢˜åœ¨äºæˆ‘ä»¬å¾ˆéš¾ç¡®å®šæŸä¸€ä¸ªå…ƒç´ çš„å…·ä½“ä½ç½®ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æƒ³ä¸€æƒ³ï¼Œå †ä¸­çš„æ•°æ®æ˜¯å¦‚ä½•ç»„ç»‡çš„ã€‚å¦‚æœæƒ³æ‰¾åˆ°æŸä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œé™¤äº†éå†ä¹‹å¤–ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶å®ƒçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™é‡Œphxrpcä½¿ç”¨äº†ä¸€ç§ä¾µå…¥å¼çš„æ‰‹æ®µï¼Œå°†ä¸‹æ ‡å†™å…¥å †ä¸­å…ƒç´ ã€‚ç„¶åå †å¤–æŒæœ‰æŒ‡é’ˆã€‚ç„¶ååœ¨ç»´æŠ¤å †æ€§è´¨çš„æ—¶å€™ï¼ŒåŒæ­¥æ›´æ–°å †ä¸­å…ƒç´ ï¼Œä½¿å…¶ä¸­ä¿å­˜çš„ä¸‹æ ‡ä¸å…¶åœ¨å †ä¸­çš„ä¸‹æ ‡ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æŒ‡é’ˆæ‹¿åˆ°ç›¸åº”å…ƒç´ çš„ä¸‹æ ‡ï¼Œåˆ é™¤æ“ä½œä¹Ÿå˜å¾—ç®€å•äº†èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆä¾µå…¥å¼å †ä¸‹æ ‡æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿä¸€æ¥æˆ‘ä»¬å¯¹äºå…ƒç´ çš„æŸ¥æ‰¾åªèƒ½æ ¹æ®å®¹å™¨å¤–æŒæœ‰çš„æŒ‡é’ˆæ¥è¿›è¡Œï¼Œå¹¶ä¸èƒ½åƒ&lt;code&gt;std::set&lt;/code&gt;é‚£æ ·é€šè¿‡æ¯”è¾ƒå…³ç³»æ¥æŸ¥æ‰¾ã€‚äºŒæ¥ä¾µå…¥å¼ä¸‹æ ‡éœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´ï¼Œå¯¹äºå°å‹å¯¹è±¡ä¼šé€ æˆå¯è§‚æ¯”ä¾‹çš„overheadã€‚åŒæ—¶å®¹å™¨å†…åªèƒ½æŒæœ‰å…ƒç´ æŒ‡é’ˆï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šä¼šå¸¦æ¥é¢å¤–çš„å¯»å€å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ï¼Œè¿™å¤§æ¦‚ä¹Ÿæ˜¯è®©å †æ”¯æŒåˆ é™¤çš„å”¯ä¸€æ–¹æ³•äº†ã€‚&lt;/p&gt;
&lt;h2&gt;å°å°åæ§½&lt;/h2&gt;
&lt;p&gt;è¿™æ®µä»£ç å†™çš„ï¼Œè²Œä¼¼è€¦åˆçš„å¤ªç´§äº†ä¸€ç‚¹ã€‚&lt;code&gt;class Timer&lt;/code&gt;å†…éƒ¨æä¾›çš„åŠŸèƒ½æœ‰&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¾—åˆ°å½“å‰æ—¶é—´&lt;/li&gt;
&lt;li&gt;nanosleep&lt;/li&gt;
&lt;li&gt;å°è£…&lt;code&gt;TimerObj&lt;/code&gt;ç±»&lt;/li&gt;
&lt;li&gt;ç»´æŠ¤ä¸€ä¸ªå®šæ—¶å™¨å †ï¼Œæä¾›&lt;code&gt;top()&lt;/code&gt;, &lt;code&gt;push()&lt;/code&gt;, &lt;code&gt;pop()&lt;/code&gt;, &lt;code&gt;erase()&lt;/code&gt;åŠŸèƒ½ï¼Œå¹¶ä¸”å¤§å¤šæ•°æ“ä½œéƒ½æ˜¯ç¡¬ç¼–ç çš„&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è‡³å°‘åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™å¹¶ä¸ç¬¦åˆâ€œé«˜å†…èšï¼Œä½è€¦åˆâ€ä»£ç é£æ ¼ã€‚&lt;/p&gt;
&lt;p&gt;ä½ é—®æˆ‘ä¸ºå•¥ä¸ç»™æ”¹æ”¹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å› ä¸ºä»–ä»¬æ²¡å†™æµ‹è¯•å•Šï¼&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-9-29/12309965.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;è¡¥å……&lt;/h2&gt;
&lt;p&gt;å…¶å®å¯¹äº&lt;code&gt;class Timer&lt;/code&gt;ï¼Œphxrpcæ˜¯æœ‰å†™æµ‹è¯•çš„(test_timer.cpp)ã€‚ä½†æ˜¯è¿™ä¸ªä»£ç å†™çš„å°±æ›´è¿·äº†ã€‚è¿™é‡Œå†åˆ†æä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹ï¼Œå…ˆåˆ›å»º100ä¸ªtimerï¼Œsleepæ—¶é—´éšæœºã€‚ç„¶åå°†50ä¸ªtimeræ”¾å…¥&lt;code&gt;need_remove&lt;/code&gt;æ•°ç»„ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åæ¯åˆ ä¸€ä¸ªtimerï¼Œå°±é…å¥—ç¡åˆ°è¶…æ—¶æ—¶é—´popä¸€ä¸ªtimerã€‚å¼¹å‡ºè¶…æ—¶timeråï¼Œå†åˆ¤æ–­ä¸€ä¸‹æ—¶é—´è¯¯å·®æ˜¯å¦è¶…è¿‡10msï¼Œå¦‚æœæ˜¯ï¼Œå°±æŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-9-29/43591449.jpg" /&gt;&lt;/p&gt;</summary><category term="RPC"></category><category term="STL"></category><category term="priority_queue"></category><category term="C++"></category><category term="phxrpc"></category></entry><entry><title>è‡ªå®šä¹‰ä½ çš„stream buffer - phxrpcé˜…è¯»ç¬”è®°(1)</title><link href="http://wizmann.tk/phxrpc-1.html" rel="alternate"></link><updated>2016-09-28T22:35:55+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2016-09-28:phxrpc-1.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/tencent-wechat/phxrpc"&gt;phxrpc&lt;/a&gt;æ˜¯å¾®ä¿¡å›¢é˜Ÿå¼€æºçš„ä¸€ä¸ªè½»é‡çº§RPCæ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¯¹RPCè¿™äº›ä¸œè¥¿äº†è§£ä¸å¤šï¼Œçœ‹åˆ°phxrpcçš„ä»£ç ç›¸å¯¹ç®€å•ï¼Œè€Œä¸”è¿˜åœ¨åˆæ­¥å¼€å‘é˜¶æ®µï¼ˆåœ¨æœ¬æ–‡å†™ä½œæ—¶ï¼Œç‰ˆæœ¬å·æ˜¯0.8ï¼‰ã€‚æ‰€ä»¥æƒ³è¯»ä¸€è¯»ï¼Œæé«˜ä¸€ä¸‹å§¿åŠ¿æ°´å¹³ã€‚&lt;/p&gt;
&lt;p&gt;å°±æ˜¯è¿™æ ·ã€‚&lt;/p&gt;
&lt;h2&gt;è‡ªå®šä¹‰stream buffer&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;network/socket_stream_base.[h|cpp]&lt;/code&gt;ä¸­çš„&lt;code&gt;class BaseTcpStreamBuf&lt;/code&gt;ç»§æ‰¿äº†&lt;code&gt;std::streambuf&lt;/code&gt;ï¼Œè‡ªå®šä¹‰äº†ä¸€ä¸ªæµç¼“å†²åŒºï¼Œç”¨äºæ¥æ”¶/å‘é€TCPæ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç”¨æ³•æ¯”è¾ƒæ–°é¢–ï¼ˆæˆ–è€…æ˜¯æˆ‘è§è¯†å°‘ï¼‰ï¼Œç½‘ä¸Šçš„èµ„æ–™ä¹Ÿä¸å¤šã€‚è¿™é‡Œç¿»è¯‘ä¸€ç¯‡&lt;a href="http://www.mr-edd.co.uk/blog/beginners_guide_streambuf"&gt;ä»‹ç»æ–‡ç« &lt;/a&gt;ï¼Œå­¦ä¹ ä¸€ä¸‹æ–°å§¿åŠ¿ã€‚&lt;/p&gt;
&lt;h2&gt;A beginner's guide to writing a custom stream buffer&lt;/h2&gt;
&lt;p&gt;æµ(streams)æ˜¯STLä¸­æä¾›çš„ä¸€ä¸ªé‡è¦çš„æŠ½è±¡æ¦‚å¿µã€‚è‘—åçš„â€œHello worldâ€ç¨‹åºï¼Œä¾¿æ˜¯ä½¿ç”¨äº†std::coutå°†å­—ç¬¦ä¸²å†™å…¥æ ‡å‡†è¾“å‡ºæµ(stdout)ã€‚&lt;/p&gt;
&lt;p&gt;æµå½“ç„¶å¯ä»¥åšæ¯”cin/coutæ›´æœ‰æ„æ€çš„äº‹ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šç ”ç©¶å¦‚ä½•æ‰©å±•C++æµï¼Œæ¥å®ç°è‡ªå®šä¹‰çš„æµç¼“å†²åŒº(stream buffer)ã€‚p.s. å»ºè®®æœ¬æ–‡çš„è¯»è€…è‡³å°‘è¦æœ‰åŸºç¡€çš„C++çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;C++æ ‡å‡†åº“ä¸ºç£ç›˜æ–‡ä»¶æ“ä½œæä¾›äº†åŸºç¡€çš„æ¥å£ï¼Œå¦‚&lt;code&gt;std::fstream&lt;/code&gt;ï¼Œ&lt;code&gt;std::ifstream&lt;/code&gt;å’Œ&lt;code&gt;std::ofstream&lt;/code&gt;ã€‚æˆ‘ä»¬è¿˜æœ‰&lt;code&gt;stringstream&lt;/code&gt;ï¼Œå¯ä»¥åƒæµä¸€æ ·æ“ä½œå­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ostringstream&lt;/span&gt; &lt;span class="n"&gt;oss&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;oss&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Hello, world!&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;oss&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;123&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;\\&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;oss&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä»&lt;code&gt;std::istringstream&lt;/code&gt;ä¸­ä½¿ç”¨&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;æ“ä½œç¬¦è¯»å–æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;Booståº“ä¸­çš„&lt;code&gt;lexical_cast&lt;/code&gt;æ­£æ˜¯ä½¿ç”¨äº†è¿™ç§æœºåˆ¶ï¼Œè®©ç”¨æˆ·å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„æ–¹å¼å°†ä¸€ä¸ªå¯¹è±¡(object)è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="n"&gt;boost&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;lexical_cast&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lexical_cast&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;5&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æµç¼“å†²åŒºæœ‰ç€å¾ˆå¼ºçš„çµæ´»æ€§ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒçš„â€œç¼“å†²å¹¶ä¼ è¾“å­—ç¬¦ï¼ˆä¸²ï¼‰â€éœ€æ±‚ï¼Œæ¯”å¦‚æ–‡ä»¶æ“ä½œã€å­—ç¬¦ä¸²æ“ä½œã€å‘½ä»¤è¡Œ(Console)æ“ä½œç­‰ã€‚æˆ‘ä»¬å¯ä»¥ä»ç½‘ç»œã€é—ªå­˜(Flash memory)ç­‰ä¸åŒè®¾å¤‡ï¼Œä½¿ç”¨åŒæ ·çš„æ¥å£è·å–æµå¼å­—ç¬¦ä¸²ã€‚â€œæµç¼“å†²åŒºâ€ä¸â€œæµâ€æ˜¯æ­£äº¤çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªç”±çš„äº¤æ¢ã€æ›´æ”¹(swap and change)æµæ‰€ä½¿ç”¨çš„ç¼“å†²åŒºï¼Œæˆ–è€…å°†å…¶é‡å®šå‘åˆ°å…¶å®ƒåœ°æ–¹ã€‚æˆ‘è®¤ä¸ºC++ä¸­çš„æµï¼Œæ­£æ˜¯â€œç­–ç•¥æ¨¡å¼â€(strategy design pattern)çš„ä¸€ä¸ªè‰¯å¥½èŒƒä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é‡å®šå‘æ ‡å‡†æ—¥å¿—æµ&lt;code&gt;std::clog&lt;/code&gt;åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²æµï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iomanip&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;sstream&amp;gt;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ostringstream&lt;/span&gt; &lt;span class="n"&gt;oss&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// Make clog use the buffer from oss&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streambuf&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;former_buff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;clog&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdbuf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;oss&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdbuf&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;clog&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;This will appear in oss!&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;oss&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;\\&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// Give clog back its previous buffer&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;clog&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdbuf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;former_buff&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸è¿‡ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªæµç¼“å†²åŒºå´æ˜¯æœ‰ä¸€ç‚¹trickyï¼Œæˆ–è€…è¯´æœ‰ä¸€ç‚¹å“äººï¼Œå°¤å…¶æ˜¯å½“ä½ ç¬¬ä¸€æ¬¡å°è¯•çš„æ—¶å€™ã€‚æ‰€ä»¥æœ¬æ–‡æ„åœ¨æä¾›ä¸€äº›æµç¼“å†²çš„å®ç°èŒƒä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æµç¼“å†²åŒºçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚æ‰€æœ‰çš„æµç¼“å†²åŒºç»§æ‰¿è‡ª&lt;code&gt;std::streambuf&lt;/code&gt;ï¼Œå¹¶ä¸”éœ€è¦è¦†ç›–ä¸€äº›è™šå‡½æ•°æ¥å®ç°è‡ªå®šä¹‰åŠŸèƒ½ã€‚&lt;code&gt;std::streambuf&lt;/code&gt;æ˜¯â€œé¡ºåºè¯»å–è®¾å¤‡â€çš„ä¸€ä¸ªæŠ½è±¡ï¼Œå³æˆ‘ä»¬å¯ä»¥ä»ä¸­é¡ºåºçš„è¯»å–å­—ç¬¦åºåˆ—ã€‚åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡å¡«(re-fill)ã€å†²æ´—(flush)ä»¥åŠæ¸…ç©º(empty)ä¸€ä¸ªç¼“å†²åŒºã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬å‘ä¸€ä¸ª&lt;code&gt;ostream&lt;/code&gt;ä¸­æ’å…¥æ•°æ®æ—¶ï¼Œæ•°æ®å°†ä¼šè¢«å†™å…¥ç¼“å†²åŒºä¸­çš„ä¸€ä¸ªæ•°ç»„ã€‚å½“æ•°ç»„ä¸Šæº¢(overflow)æ—¶ï¼Œæ•°ç»„ä¸­çš„æ•°æ®å°†ä¼šè¢«å†²æ´—(flush)åˆ°ç›®æ ‡æ¥å—è€…ï¼Œä¹‹åè¿™ä¸ªæ•°ç»„çš„çŠ¶æ€å°†ä¼šé‡ç½®ï¼Œä»¥ä¾¿å­˜å‚¨åç»­çš„å­—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä»ä¸€ä¸ª&lt;code&gt;istream&lt;/code&gt;ä¸­è·å–æ•°æ®æ—¶ï¼Œæ•°æ®ä»ç¼“å†²åŒºçš„æ•°ç»„ä¸­è¯»å‡ºã€‚å½“æ•°ç»„ä¸‹æº¢æ—¶(underflow)ï¼Œæ²¡æœ‰æ•°æ®å¯è¯»ï¼Œæˆ‘ä»¬ä¼šä»æ•°æ®æºé‡æ–°æ‹‰å–ä¿¡æ¯æ¥å¡«å……ç¼“å†²åŒºï¼Œä¹‹åè¿™ä¸ªæ•°ç»„çš„çŠ¶æ€ä¹Ÿå°†è¢«é‡ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨6ä¸ªæŒ‡é’ˆï¼Œæ¥ç»´æŠ¤ç¼“å†²åŒºçš„å†…éƒ¨çŠ¶æ€ã€‚è¾“å…¥å’Œè¾“å‡ºç¼“å†²å„ä½¿ç”¨3ä¸ªæŒ‡é’ˆã€‚&lt;/p&gt;
&lt;h3&gt;ç»´æŠ¤è¾“å‡ºç¼“å†²åŒºçš„çŠ¶æ€&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;put base pointer   &lt;br /&gt;
è¾“å‡ºåŸºæŒ‡é’ˆï¼Œç”¨æ¥æŒ‡å®šç¼“å†²åŒºå†…éƒ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¯ä»¥ä½¿ç”¨&lt;code&gt;std::streambuf::pbase()&lt;/code&gt;æ¥è·å–&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;put pointer   &lt;br /&gt;
è¾“å‡ºæŒ‡é’ˆï¼Œç”¨æ¥æŒ‡å‘å†…éƒ¨æ•°ç»„ä¸‹ä¸€ä¸ªå†™å…¥çš„åœ°å€ã€‚å¯ä»¥ä½¿ç”¨&lt;code&gt;std::streambuf::pptr()&lt;/code&gt;æ¥è·å–&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;end put pointer   &lt;br /&gt;
è¾“å‡ºå“¨å…µæŒ‡é’ˆï¼ŒæŒ‡å‘å†…éƒ¨æ•°ç»„æœ€åä¸€ä¸ªå†åé¢ä¸€ä¸ª(one-past-the-last-element)çš„åœ°å€ï¼ˆè¯‘æ³¨ï¼šç±»ä¼¼&lt;code&gt;std::vector::end()&lt;/code&gt;ï¼‰ã€‚å¯ä»¥ä½¿ç”¨&lt;code&gt;std::streambuf:epptr()&lt;/code&gt;æ¥è·å–&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="" src="http://i1.piimg.com/567571/630a89fe635e1635.png" /&gt;&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼ŒåŸºæŒ‡é’ˆå’Œå“¨å…µæŒ‡é’ˆä¸ä¼šæ”¹å˜ï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œä»¥è¾“å‡ºæŒ‡é’ˆç»´æŠ¤å†…éƒ¨çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h3&gt;ç»´æŠ¤è¾“å…¥ç¼“å†²åŒºçš„çŠ¶æ€&lt;/h3&gt;
&lt;p&gt;è¾“å…¥ç¼“å†²åŒºå’ŒçŠ¶æ€ç»´æŠ¤å’Œè¾“å‡ºç¼“å†²åŒºç±»ä¼¼ï¼Œæˆ‘ä»¬æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;end back pointer  &lt;br /&gt;
è¾“å…¥åŸºæŒ‡é’ˆï¼ŒæŒ‡å‘ç¼“å†²åŒºæ•°ç»„å†…çš„æœ€åä¸€ä¸ªå­—ç¬¦ã€‚å¯ä»¥ä½¿ç”¨&lt;code&gt;std::streambuf::eback()&lt;/code&gt;æ¥è·å–&lt;/li&gt;
&lt;li&gt;get pointer   &lt;br /&gt;
è¾“å…¥æŒ‡é’ˆï¼ŒæŒ‡å‘ç¼“å†²åŒºä¸‹ä¸€ä¸ªè¯»å–çš„å­—ç¬¦åœ°å€ã€‚å¯ä»¥ä½¿ç”¨&lt;code&gt;std::streambuf::gptr()&lt;/code&gt;æ¥è·å–&lt;/li&gt;
&lt;li&gt;end get pointer    &lt;br /&gt;
è¾“å…¥å“¨å…µæŒ‡é’ˆï¼Œæ‰¹å·å‘å†…éƒ¨æ•°ç»„æœ€åä¸€ä¸ªå†åé¢ä¸€ä¸ª(one-past-the-last-element)çš„åœ°å€ã€‚å¯ä»¥ä½¿ç”¨&lt;code&gt;std::streambuf::egptr()&lt;/code&gt;æ¥è·å–&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/16-9-27/33500590.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;åŒæ ·ï¼ŒåŸºæŒ‡é’ˆå’Œå“¨å…µæŒ‡é’ˆåœ¨æµç¼“å†²åŒºçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¹Ÿä¸ä¼šæ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºè¾“å…¥ç¼“å†²åŒºè¦æ”¯æŒ&lt;code&gt;putback()&lt;/code&gt;æ“ä½œï¼Œå³å°†è¯»å‡ºçš„å­—ç¬¦é‡æ–°æ”¾å›ç¼“å†²åŒºï¼Œæ‰€ä»¥è¾“å…¥ç¼“å†²åŒºæ¯”è¾“å‡ºç¼“å†²åŒºæ›´å¤æ‚ä¸€ç‚¹ã€‚é€šå¸¸æ¥è¯´ï¼Œ&lt;code&gt;putback()&lt;/code&gt;æ“ä½œæ”¯æŒæ”¾å›ä¸€ä¸ªå­—ç¬¦å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª&lt;code&gt;std::streambuf&lt;/code&gt;å¯ä»¥åŒæ—¶æ”¯æŒè¾“å…¥è¾“å‡ºä¸¤ç§æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æˆ‘åˆ†åˆ«å®ç°&lt;code&gt;std::istreambuf&lt;/code&gt;å’Œ&lt;code&gt;std::ostreambuf&lt;/code&gt;ã€‚&lt;code&gt;std::fstream&lt;/code&gt;æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ä¾‹å­ã€‚ä½†æ˜¯ï¼Œå®ç°ä¸€ä¸ªå…¨åŠŸèƒ½çš„ç¼“å†²åŒºç›¸å¯¹æ›´å¤æ‚ä¸€äº›ï¼Œæ‰€ä»¥æˆ‘å°±ä¸è¶Ÿæµ‘æ°´å•¦~ ï¼šï¼‰&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œæµç¼“å†²åŒºä¹Ÿå¯ä»¥æ”¯æŒå®½å­—ç¬¦(wide character)ã€‚&lt;code&gt;std::streambuf&lt;/code&gt;æ˜¯&lt;code&gt;std::basic_streambuf&amp;lt;char&amp;gt;&lt;/code&gt;çš„åˆ«åï¼Œå¦‚æœä½ éœ€è¦å®½å­—ç¬¦æµç¼“å†²åŒºï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;std::basic_streambuf&amp;lt;wchar_t&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3&gt;ä¾‹1ï¼šæ–‡ä»¶ç¼“å†²åŒº â€”â€” ä¸Cä»£ç é›†æˆ&lt;/h3&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬éœ€è¦è°ƒç”¨ä¸€ä¸ªå†å²æ‚ ä¹…çš„åº“ï¼Œä¸€ä¸ªæ–‡ä»¶æ“ä½œå‡½æ•°ä¼šè¿”å›ç»™ä¸€ä¸ª&lt;code&gt;FILE*&lt;/code&gt;æŒ‡é’ˆï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³ç”¨C++çš„æµæ¥å£æ¥è¯»å†™æ•°æ®ã€‚æˆ‘ä»¬å…ˆä»è¯»æ–‡ä»¶å¼€å§‹ï¼Œç”¨&lt;code&gt;std::istream&lt;/code&gt;åŒ…è£…&lt;code&gt;FILE*&lt;/code&gt;çš„è¯»æ“ä½œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;streambuf&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;FILE_buffer&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streambuf&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="n"&gt;FILE_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fptr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;buff_sz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;put_back&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;// overrides base class underflow()&lt;/span&gt;
        &lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;underflow&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="c1"&gt;// copy ctor and assignment not implemented;&lt;/span&gt;
        &lt;span class="c1"&gt;// copying not allowed&lt;/span&gt;
        &lt;span class="n"&gt;FILE_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;FILE_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;FILE_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;FILE_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fptr_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”±äºåŠŸèƒ½ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°æ„é€ å‡½æ•°ä»¥åŠ&lt;code&gt;underflow&lt;/code&gt;æ¥å£å°±å¯ä»¥å®ç°æˆ‘ä»¬çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æ„é€ å‡½æ•°æŒ‡å®šäº†è¯»å–æ–‡ä»¶çš„&lt;code&gt;FILE*&lt;/code&gt;æŒ‡é’ˆï¼Œä»¥åŠå†…éƒ¨ç¼“å†²æ•°ç»„çš„å¤§å°ã€‚æ•°ç»„å¤§å°ç”±ä¸¤ä¸ªå‚æ•°å†³å®šï¼š
&lt;em&gt; put-back area size       &lt;br /&gt;
&lt;/em&gt; buffer size&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;std::vector&amp;lt;char&amp;gt;&lt;/code&gt;åšä¸ºç¼“å†²åŒºåŸŸã€‚&lt;code&gt;put_back_&lt;/code&gt;å˜é‡ç”¨äºå­˜å‚¨"put-back"åŒºåŸŸçš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æ„é€ å‡½æ•°çš„å®ç°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;FILE_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;FILE_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fptr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;buff_sz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;put_back&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;fptr_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fptr&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;put_back&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;size_t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))),&lt;/span&gt;
    &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buff_sz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;front&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;setg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬å°†ç¼“å†²åŒºçš„å¸¸é‡è¿›è¡Œèµ‹å€¼ã€‚ä¹‹åä½¿ç”¨&lt;code&gt;std::streambuf::setg()&lt;/code&gt;æ¥åˆå§‹åŒ–è¾“å‡ºç¼“å†²åŒºã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;setg()&lt;/code&gt;çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨&lt;code&gt;eback()&lt;/code&gt;ï¼Œ&lt;code&gt;gptr()&lt;/code&gt;ï¼Œ&lt;code&gt;egptr()&lt;/code&gt;ä¸‰ä¸ªå†…éƒ¨æŒ‡é’ˆçš„å€¼ã€‚ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å°†å®ƒä»¬éƒ½æŒ‡å‘åŒä¸€ä¸ªåœ°å€ã€‚è¡¨æ˜bufferæ˜¯ç©ºçš„ï¼Œåœ¨ä¸‹ä¸€æ¬¡è¯»å–æ—¶ï¼Œä¼šé‡æ–°å¡«å……ç¼“å†²åŒºã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;underflow()&lt;/code&gt;ä¼šè¿”å›æ•°æ®æºä¸­å½“å‰çš„å­—ç¬¦ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¼šè¿”å›bufferä¸­çš„ä¸‹ä¸€ä¸ªå¯ç”¨å­—ç¬¦ã€‚ç„¶åå½“bufferä¸ºç©ºæ—¶ï¼Œ&lt;code&gt;underflow()&lt;/code&gt;åº”è¯¥é‡æ–°å¡«å……ç¼“å†²åŒºæ•°ç»„ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œå³ä»&lt;code&gt;FILE*&lt;/code&gt;ä¸­è¯»å–å­—ç¬¦ã€‚å½“ç¼“å†²åŒºé‡å¡«åï¼Œæˆ‘ä»¬éœ€è¦å†æ¬¡è°ƒç”¨&lt;code&gt;setg()&lt;/code&gt;æ›´æ–°æµç¼“å†²åŒºçš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ•°æ®æºä¸­çš„æ•°æ®è¯»å®Œ(depleted)åï¼Œ&lt;code&gt;underflow()&lt;/code&gt;ä¼šè¿”å›ä¸€ä¸ª&lt;code&gt;traits_type::eof()&lt;/code&gt;ã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œ&lt;code&gt;underflow()&lt;/code&gt;çš„è¿”å›å€¼æ˜¯&lt;code&gt;int_type&lt;/code&gt;ï¼Œè¿™ä¸ªå€¼è¶³å¤Ÿè£…ä¸‹&lt;code&gt;eof()&lt;/code&gt;ï¼ŒåŒæ—¶ä¹Ÿè¶³å¤Ÿè£…ä¸‹ä»»ä½•çš„å­—ç¬¦ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streambuf&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;FILE_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;underflow&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gptr&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;egptr&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="c1"&gt;// buffer not exhausted&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;to_int_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;gptr&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;front&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eback&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// true when this isn&amp;#39;t the first fill&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// Make arrangements for putback characters&lt;/span&gt;
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;memmove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;egptr&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;put_back_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// start is now the start of the buffer, proper.&lt;/span&gt;
    &lt;span class="c1"&gt;// Read from fptr_ in to the provided buffer&lt;/span&gt;
    &lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;fread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;fptr_&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="c1"&gt;// Set buffer pointers&lt;/span&gt;
    &lt;span class="n"&gt;setg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;to_int_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;gptr&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‡½æ•°çš„ç¬¬ä¸€è¡Œï¼Œé¦–å…ˆåˆ¤æ–­bufferæ˜¯å¦è€—å°½ã€‚å¦‚æœå¦ï¼Œåˆ™è¿”å›å½“å‰å­—ç¬¦ï¼Œå³&lt;code&gt;*gptr()&lt;/code&gt;ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¿›è¡Œé‡å¡«(re-fill)æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å›æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨æ„é€ å‡½æ•°ä¸­çš„å®ç°ï¼Œä¸‰ä¸ªçŠ¶æ€æŒ‡é’ˆå…¨éƒ½æŒ‡å‘ç¼“å†²åŒºçš„æœ«å°¾ã€‚å¦‚æœæˆ‘ä»¬è°ƒç”¨&lt;code&gt;underflow()&lt;/code&gt;æ—¶ï¼Œå‘ç°çŠ¶æ€æŒ‡é’ˆå¹¶éå¦‚æ­¤ï¼Œåˆ™è¯´æ˜ç¼“å†²åŒºå·²ç»è¢«å¡«å……äº†è‡³å°‘ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬è€ƒè™‘é‡å¡«æ“ä½œï¼Œæˆ‘ä»¬&lt;code&gt;memmove&lt;/code&gt;æœ€å&lt;code&gt;put_back_&lt;/code&gt;ä¸ªå­—ç¬¦åˆ°bufferçš„æœ«å°¾ï¼Œç”¨åš"put-back area"ã€‚ï¼ˆæˆ‘ä»¬ä¸ç”¨&lt;code&gt;memcopy&lt;/code&gt;å› ä¸ºæˆ‘ä»¬çš„bufferæ¯”è¾ƒå°ï¼Œ`memmove()çš„æ•ˆç‡ä¼šæ›´é«˜ä¸€äº›ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘æ³¨ï¼šå®é™…ä¸Šï¼Œ&lt;code&gt;memcopy&lt;/code&gt;ä¸&lt;code&gt;memmove&lt;/code&gt;å„æœ‰æ‰€é•¿ã€‚&lt;code&gt;memcopy&lt;/code&gt;ä¸éœ€è¦åˆ¤æ–­å†…å­˜overlapçš„æƒ…å†µï¼Œå³å¦‚æœæºåŒºé—´ä¸ç›®æ ‡åŒºé—´æœ‰é‡å ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœä¼šæ˜¯é”™çš„ã€‚è€Œ&lt;code&gt;memmove&lt;/code&gt;ç”±äºæ˜¯ç§»åŠ¨è¯­ä¹‰ï¼Œæ‰€ä»¥åœ¨ç§»åŠ¨æ­¥é•¿è¾ƒå°æ—¶ï¼Œå¯ä»¥åªæ“ä½œcacheã€‚æ‰€ä»¥äºŒè€…å„æœ‰æ‰€é•¿ï¼Œè¦æ ¹æ®å…·ä½“æƒ…å†µåˆ¤æ–­ä¼˜åŠ£ã€‚Stackoverflowä¸Šæœ‰æ›´è¯¦ç»†çš„&lt;a href="http://stackoverflow.com/questions/28623895/why-is-memmove-faster-than-memcpy"&gt;è®¨è®º&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å¤„ç†å®Œ"put-back area"ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨&lt;code&gt;fread()&lt;/code&gt;å‡½æ•°æ¥é‡å¡«ç¼“å†²åŒºäº†ã€‚å¦‚æœè¯»ä¸åˆ°æ•°æ®ï¼Œåˆ™æ„å‘³ç€æ–‡ä»¶å·²ç»è¯»åˆ°äº†ç»“å°¾ï¼ˆå½“ç„¶è¿™æ˜¯ä¸€ç§ç®€åŒ–æƒ…å†µï¼Œä½†åœ¨ç°å®ä¸­99.9%çš„è¯»å–å¤±è´¥éƒ½æ˜¯å› ä¸ºæ–‡ä»¶ç»“æŸï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;fread()&lt;/code&gt;æˆåŠŸè¯»å–æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬é€šçŸ¥streambufæ›´æ–°å†…éƒ¨çš„ä¸‰ä¸ªçŠ¶æ€æŒ‡é’ˆã€‚ä¹‹åè¿”å›bufferå½“å‰çš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯æˆ‘ä»¬çš„æµç¼“å†²åŒºçš„åŸºæœ¬å®ç°ï¼Œå¸Œæœ›è¿™å¹¶ä¸æ˜¯å¤ªéš¾ã€‚å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚ç‰¹åˆ«çš„æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ç¼“å†²åŒºé‡Œé¢è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœä½ æƒ³å®ç°å®ƒçš„è¯ï¼Œå¯ä»¥è¯•è¯•é‡å†™&lt;code&gt;std::streambuf::seekoff()&lt;/code&gt;å’Œ&lt;code&gt;std::streambuf::seekpos&lt;/code&gt;è™šæˆå‘˜å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°å†™ç¼“å†²åŒºã€‚ä¸è¿‡ï¼Œåœ¨ä½ ä»¬è¯»å®Œç¬¬ä¸‰ä¸ªä¾‹å­ä¹‹åï¼Œä½ ä»¬å°±å¯ä»¥è½»æ¾æ„‰å¿«çš„å®ç°è‡ªå·±çš„ç‰ˆæœ¬äº†ï¼Œä¸éª—ä½ ã€‚&lt;/p&gt;
&lt;h3&gt;ä¾‹2ï¼šè¯»å–å†…å­˜ä¸­çš„æ•°ç»„&lt;/h3&gt;
&lt;p&gt;æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨&lt;code&gt;std::istream&lt;/code&gt;åŒ…è£…å†…å­˜ä¸­çš„ä¸€ä¸ªåªè¯»æ•°ç»„ï¼Œå¹¶ä¸”æ ¼å¼åŒ–çš„è¿›è¡Œè¯»å…¥ã€‚è¿™ä¸ªä¾‹å­å’Œä¸Šä¸€ä¸ªä¾‹å­æœ‰ä¸€ç‚¹ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸€ä¸ªçœŸæ­£çš„ç¼“å†²æ•°ç»„ï¼Œä»æºæ•°ç»„ä¸€æ¬¡æ€§è¯»å–å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³è±¡ä¸­çš„å®ç°æ˜¯è¿™ä¸ªæ ·å¼å„¿çš„ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;char_array_buffer&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streambuf&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;setg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;underflow&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;  &lt;span class="n"&gt;gptr&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;egptr&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt;
                    &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;to_int_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;gptr&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½†æ˜¯ï¼Œè¿™å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ã€‚å› ä¸º&lt;code&gt;setg()&lt;/code&gt;å‡½æ•°åªæ¥å—éå¸¸é‡(non-const)æŒ‡é’ˆå‚æ•°ã€‚è¿™æ˜¾è€Œæ˜“è§ï¼Œå¦‚æœä¸€ä¸ªç¼“å†²åŒºä¸å¯å†™ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æä¾›"put-back"åŠŸèƒ½ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åŠ¨ä¸€åŠ¨æ‰‹è„šï¼Œé‡æ–°å®ç°ä¸€ä¸‹è¿™ä¸ªç±»ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;streambuf&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;char_array_buffer&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streambuf&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="nf"&gt;char_array_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;underflow&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="nf"&gt;uflow&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="nf"&gt;pbackfail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streamsize&lt;/span&gt; &lt;span class="n"&gt;showmanyc&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="c1"&gt;// copy ctor and assignment not implemented;&lt;/span&gt;
        &lt;span class="c1"&gt;// copying not allowed&lt;/span&gt;
        &lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;char_array_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;char_array_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;char_array_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;begin_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;end_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬é‡å†™äº†å‡ ä¸ªç§æœ‰å‡½æ•°ï¼Œè¿™äº›å‡½æ•°éƒ½æ˜¯ä»&lt;code&gt;std::streambuf&lt;/code&gt;ç»§æ‰¿è€Œæ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªæ„é€ å‡½æ•°éœ€è¦ç”¨æˆ·æŒ‡å®šèµ·æ­¢æŒ‡é’ˆï¼Œè€Œç¬¬äºŒä¸ªæ„é€ å‡½æ•°åªéœ€è¦æŒ‡å®šèµ·å§‹æŒ‡é’ˆï¼Œä¹‹åæˆ‘ä»¬ä¼šè°ƒç”¨&lt;code&gt;std::strlen()&lt;/code&gt;æ¥åˆ¤æ–­å­—ç¬¦ä¸²çš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;uflow()&lt;/code&gt;, &lt;code&gt;pbackfail()&lt;/code&gt;å’Œ&lt;code&gt;showmanyc()&lt;/code&gt;æ¥ç»´æŠ¤ç¼“å†²åŒºå†…éƒ¨çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯è°ƒç”¨&lt;code&gt;setg()&lt;/code&gt;ï¼Œå› ä¸ºbufferå¹¶ä¸å¯å†™ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬è¦æ‰‹åŠ¨ç»´æŠ¤&lt;code&gt;eback&lt;/code&gt;, &lt;code&gt;gptr&lt;/code&gt;, &lt;code&gt;egptr&lt;/code&gt;ä¸‰ä¸ªæŒ‡é’ˆã€‚åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œèµ‹å€¼ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;quot;char_array_buffer.hpp&amp;quot;&lt;/span&gt;

&lt;span class="cp"&gt;#include &amp;lt;functional&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cassert&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;

&lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;begin_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;end_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;begin_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;less_equal&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;begin_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;begin_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;end_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;begin_&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;strlen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;begin_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¹‹å‰æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;underflow()&lt;/code&gt;æ¥è·å–å½“å‰å­—ç¬¦ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬éœ€è¦ä½¿ç”¨&lt;code&gt;uflow()&lt;/code&gt;ã€‚å› ä¸º&lt;code&gt;uflow()&lt;/code&gt;éœ€è¦åŒæ—¶æ‰§è¡Œä¸¤æ­¥æ“ä½œï¼Œä¸€æ˜¯è·å–å½“å‰å­—ç¬¦ï¼ŒäºŒæ˜¯è®©&lt;code&gt;gptr()&lt;/code&gt;å‰è¿›ä¸€æ­¥ã€‚ä½†æ˜¯åˆå› ä¸ºç¼“å†²åŒºç”±æˆ‘ä»¬æ‰‹åŠ¨ç®¡ç†ï¼Œ&lt;code&gt;std::streambuf&lt;/code&gt;å¹¶ä¸èƒ½æ­£ç¡®çš„æ‰§è¡Œç®¡ç†æ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡å†™&lt;code&gt;uflow()&lt;/code&gt;è€Œä¸æ˜¯&lt;code&gt;underflow()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;:int_type&lt;/span&gt; &lt;span class="nt"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;:uflow&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;current_&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;end_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;to_int_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸‹ä¸€æ­¥æˆ‘ä»¬è¿˜è¦å®ç°&lt;code&gt;pbackfail()&lt;/code&gt;ã€‚å½“æˆ‘ä»¬è°ƒç”¨&lt;code&gt;std::istream::unget()&lt;/code&gt;æˆ–&lt;code&gt;std::istream::putback(ch)&lt;/code&gt;æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠå·²ç»è¯»å‡ºçš„æ•°æ®å†™å›æ•°ç»„ä¸­ã€‚ä½†æ˜¯ç”±äºæ•°ç»„æ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ¨¡æ‹Ÿè¿™ç§æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é»˜è®¤çš„å®ç°ä¸­&lt;code&gt;pbackfail()&lt;/code&gt;åªä¼šè¿”å›&lt;code&gt;traits_type::eof()&lt;/code&gt;ï¼Œè€Œåœ¨æˆ‘ä»¬çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœå†™å›æˆåŠŸï¼Œå°†ä¼šè¿”å›å†™å›çš„å­—ç¬¦ï¼Œä¸æˆåŠŸè¿”å›eofã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;pbackfail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;current_&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;begin_&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ch&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;to_int_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*--&lt;/span&gt;&lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨&lt;code&gt;FILE_buffer&lt;/code&gt;ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è€ƒè™‘é‡å†™&lt;code&gt;pbackfail()&lt;/code&gt;ï¼Œæ¥æä¾›åå‘æŸ¥æ‰¾ä»¥åŠï¼ˆç”¨å‰é¢çš„æ•°æ®ï¼‰é‡å¡«bufferçš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åä¸€ä¸ªé‡å†™çš„å‡½æ•°æ˜¯&lt;code&gt;showmanyc()&lt;/code&gt;ï¼Œè¿™ä¸ªå‡½æ•°è¢«&lt;code&gt;std::streambuf::in_avail()&lt;/code&gt;è°ƒç”¨ï¼Œä»¥åˆ¤æ–­å½“å‰æœ‰å¤šå°‘ä¸ªå­—ç¬¦å¯ä»¥è¿”å›ã€‚ç”±äºæˆ‘ä»¬æ¥ç®¡äº†çŠ¶æ€æŒ‡é’ˆï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¹Ÿè¦æˆ‘ä»¬è‡ªå·±æ¥å®ç°å•Šã€‚ï¼ˆè¯‘è€…ï¼šä¸ºä»€ä¹ˆè¦ç»™è‡ªå·±æ‰¾éº»çƒ¦ã€‚ã€‚ã€‚ï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streamsize&lt;/span&gt; &lt;span class="n"&gt;char_array_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;showmanyc&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;less_equal&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;end_&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;current_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”±æ­¤å¯è§ï¼Œæœ¬ä¾‹ä¸­çš„bufferæ¯”å‰é¢çš„è¦å¤æ‚ä¸€ç‚¹ç‚¹ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ¥ç®¡äº†çŠ¶æ€ç»´æŠ¤çš„å·¥ä½œã€‚è¿™ä½¿å¾—æˆ‘ä»¬æ›´å¥½çš„ç†è§£äº†&lt;code&gt;std::streambuf&lt;/code&gt;å†…éƒ¨æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;h3&gt;ä¾‹3ï¼šå¥é¦–å˜å¤§å†™çš„ç¼“å†²åŒº&lt;/h3&gt;
&lt;p&gt;æœ¬ä¾‹ä¸­æˆ‘ä»¬å°†è¦å®ç°ä¸€ä¸ªå°†å¥é¦–å­—ç¬¦å˜å¤§å†™çš„bufferã€‚å½“ç„¶æˆ‘ä»¬åªè€ƒè™‘æœ€åŸºæœ¬çš„æƒ…å†µï¼Œç§»æ¤åˆ°ä¸åŒçš„åŒºåŸŸå’Œè¯­è¨€ï¼Œå…¶å®æ˜¯å¾ˆçç¢çš„äº‹æƒ…ã€‚ï¼ˆè¯‘è€…ï¼šæ–‡å­—ç¼–ç å‘çš„äº²å¦ˆéƒ½ä¸è®¤äº†ï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;streambuf&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iosfwd&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;caps_buffer&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;streambuf&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ostream&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;buff_sz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;protected&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;do_caps_and_flush&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;overflow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;sync&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="c1"&gt;// copy ctor and assignment not implemented;&lt;/span&gt;
        &lt;span class="c1"&gt;// copying not allowed&lt;/span&gt;
        &lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;caps_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;caps_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;caps_buffer&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;cap_next_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ostream&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;sink_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œæˆ‘ä»¬éœ€è¦é‡å†™&lt;code&gt;overflow()&lt;/code&gt;å’Œ&lt;code&gt;sync()&lt;/code&gt;å‡½æ•°ã€‚&lt;code&gt;overflow()&lt;/code&gt;åœ¨è¾“å…¥ç¼“å†²åŒºæ»¡çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå¹¶ä¸”åœ¨æˆåŠŸæ—¶è¿”å›ä»»æ„éeofçš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sync()&lt;/code&gt;çš„ä½œç”¨æ˜¯æŠŠå½“å‰çš„bufferå†™å…¥ç›®æ ‡ï¼Œå³ä½¿å½“å‰bufferå¹¶æœªå¡«æ»¡ã€‚&lt;code&gt;std::flush()&lt;/code&gt;ä¼šè°ƒç”¨&lt;code&gt;sync()&lt;/code&gt;å‡½æ•°ï¼Œå½“å¤±è´¥æ—¶è¿”å›-1ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªè¾…åŠ©å‡½æ•°&lt;code&gt;do_caps_and_flush()&lt;/code&gt;ï¼Œç”¨æ¥å°†å°å†™å˜å¤§å†™ï¼Œå¹¶å†™å…¥&lt;code&gt;sink_&lt;/code&gt;è¾“å‡ºæµã€‚æˆ‘ä»¬å†å£°æ˜ä¸€ä¸ªå“¨å…µå˜é‡&lt;code&gt;cap_next_&lt;/code&gt;æ¥æ ‡è¯†ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦éœ€è¦å°å†™å˜å¤§å†™ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;quot;caps_buffer.hpp&amp;quot;&lt;/span&gt;

&lt;span class="cp"&gt;#include &amp;lt;cctype&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;ostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;functional&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cassert&amp;gt;&lt;/span&gt;

&lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ostream&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;buff_sz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;cap_next_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;sink_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buff_sz&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;sink_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;front&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;setp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;base&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;buffer_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// -1 to make overflow() easier&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;buffer_&lt;/code&gt;çš„æœ€å°å¯èƒ½å¤§å°æ˜¯1ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿåªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºè¿™é‡Œä¸éœ€è¦åƒè¾“å…¥ç¼“å†²åŒºä¸€æ ·çš„ç»´æŠ¤"put-back area"ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠ&lt;code&gt;buffer_&lt;/code&gt;çš„å¤§å°è®¾æˆ&lt;code&gt;buff_sz + 1&lt;/code&gt;ï¼Œè¿™æ ·æ˜¯ä¸ºäº†&lt;code&gt;overflow()&lt;/code&gt;è¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé¢å¤–çš„ç©ºé—´å­˜å‚¨å½“å‰çš„å­—ç¬¦ã€‚æœ€åå°†ç¼“å†²åŒºæ•°ç»„å’Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸€èµ·åˆ·æ–°åˆ°&lt;code&gt;ostream&lt;/code&gt;ä¸­ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;overflow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;int_type&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sink_&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;less_equal&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;pptr&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;epptr&lt;/span&gt;&lt;span class="p"&gt;()));&lt;/span&gt;
        &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pptr&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;pbump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;do_caps_and_flush&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;traits_type&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;eof&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¬¬ä¸€æ­¥æ˜¯æŠŠchå†™å…¥&lt;code&gt;buffer_&lt;/code&gt;ï¼Œå¹¶ä¸”ä½¿ç”¨&lt;code&gt;pbump(1)&lt;/code&gt;å°†&lt;code&gt;pptr()&lt;/code&gt;å‘å‰ç§»ä¸€ä½ã€‚ä¹‹åè°ƒç”¨&lt;code&gt;do_caps_and_flush()&lt;/code&gt;åšä¸€äº›è„æ´»ï¼Œä¹‹åè¿”å›ä¸€ä¸ªå­—ç¬¦å£°æ˜è°ƒç”¨æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sync()&lt;/code&gt;çš„å®ç°ä¹Ÿéå¸¸ç®€å•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;sync&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;do_caps_and_flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å†çœ‹ä¸€çœ‹&lt;code&gt;do_caps_and_flush()&lt;/code&gt;å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;caps_buffer&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;do_caps_and_flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pbase&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pptr&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;cap_next_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="nf"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;isalpha&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cap_next_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;toupper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

            &lt;span class="n"&gt;cap_next_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="kt"&gt;ptrdiff_t&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pptr&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pbase&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;pbump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sink_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pbase&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¹äºæœ¬ä¾‹æ¥è¯´ï¼Œå†…éƒ¨çš„ç¼“å†²åŒºå¹¶éå¿…è¦ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦æŠŠæ•°æ®å‘åˆ°&lt;code&gt;sink&lt;/code&gt;ä¸­ã€‚ä½†æ˜¯æˆ‘çš„è§‚ç‚¹æ˜¯ä¸€ä¸ªå†…éƒ¨bufferä»æœ‰å…¶ç”¨å¤„ã€‚&lt;/p&gt;
&lt;h3&gt;ä»‹ç» Boost IOStreams åº“&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯æµç¼“å†²åŒºçš„æ–°æ‰‹ï¼Œå¸Œæœ›ä½ å·²ç»å¯¹å®ƒæœ‰ä¸€ç‚¹ç‚¹äº†è§£äº†ã€‚æœ¬æ–‡ä¸­çš„ä¾‹å­éƒ½éå¸¸åŸºç¡€ï¼Œä½†æ˜¯ä½ å¯ä»¥ç”¨å®ƒä»¬åšæ›´å¤šæœ‰æ„æ€çš„äº‹æƒ…ã€‚ä½†æ˜¯å½“æˆ‘å®ç°æ›´å¤æ‚çš„æµç¼“å†²åŒºæ—¶ï¼Œé—®é¢˜çš„å¤æ‚åº¦å´ä¸Šå‡çš„å¾ˆå¿«ã€‚è¿™æ—¶æˆ‘å‘ç°äº†&lt;code&gt;Boost IOStreams&lt;/code&gt;åº“ï¼Œå®ƒä¸ºæ›´å¤æ‚çš„ç¼“å†²åŒºå’Œæµæä¾›äº†å¿…è¦çš„æ¡†æ¶æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;å®ƒå…è®¸ä½ è§£è€¦æ•°æ®æºï¼Œæ•°æ®è¾“å‡ºï¼Œè¿‡æ»¤å™¨ä»¥åŠå…¶å®ƒä¸€äº›æ¦‚å¿µã€‚åœ¨æˆ‘ä»¬çš„æœ€åä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç¡¬ç¼–ç æ•°æ®è¾“å‡ºåˆ°&lt;code&gt;std::ostream&lt;/code&gt;ä¸­ã€‚å¦‚æœæˆ‘ä»¬è¦è¾“å‡ºåˆ°ä¸€ä¸ªæ²¡æœ‰æµæ¥å£çš„ç±»å‘¢ï¼Ÿ&lt;code&gt;Boost IOStreams&lt;/code&gt;åº“æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œå°†ä¸€å¨ç´§è€¦åˆçš„ä»£ç åˆ†è§£æˆç‹¬ç«‹çš„æŠ½è±¡æ¦‚å¿µã€‚&lt;/p&gt;
&lt;h3&gt;æ‰©å±•é˜…è¯»&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The C++ Standard Library by Nicolai M. Josuttis&lt;/li&gt;
&lt;li&gt;The C++ Standard, BS ISO/IEC 14882:2003 (Second Edition)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.dinkumware.com/manuals/"&gt;Dinkum Compleat Reference online&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="System Design"></category><category term="RPC"></category><category term="streambuf"></category><category term="C++"></category><category term="phxrpc"></category></entry><entry><title>Code Golf - Heapify</title><link href="http://wizmann.tk/code-golf-heapify.html" rel="alternate"></link><updated>2015-08-01T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-08-01:code-golf-heapify.html</id><summary type="html">&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;heapify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;nth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can implement a "heapify" by only four lines of code. And the time complexity is &lt;code&gt;O(n)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Fancy, right? :)&lt;/p&gt;</summary><category term="code golf"></category></entry><entry><title>Using Set Cover to Optimize a Large-Scale Low Latency Distributed Graph</title><link href="http://wizmann.tk/using-set-cover-algorithm-to-optimize-a-large-scale-low-latency-distributed-graph.html" rel="alternate"></link><updated>2015-07-26T22:48:33+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-07-26:using-set-cover-algorithm-to-optimize-a-large-scale-low-latency-distributed-graph.html</id><summary type="html">&lt;h2&gt;Background&lt;/h2&gt;
&lt;p&gt;Linkedin (or other social networks, such as Facebook and G+) use the "social graph information" to show the social relationship between you and other members.&lt;/p&gt;
&lt;p&gt;Such as, "You and Mr.Obama share 10 mutual friends" or "You have 1,000 second-degree connections".&lt;/p&gt;
&lt;p&gt;This feature is very common for a social network. But where does it come from?&lt;/p&gt;
&lt;h2&gt;Basic API for Social Graph Information&lt;/h2&gt;
&lt;p&gt;The information about a social relationship can be get from three basic APIs.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Get Connections
"Who does member X know?"&lt;/li&gt;
&lt;li&gt;Get Shared Connections
"Who do I know in common with member Y?"&lt;/li&gt;
&lt;li&gt;Get Graph Distance
"What the graph distance between member Z and me?"&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Main Components for the System&lt;/h2&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/15-7-25/59618247.jpg" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Graph Database (Graph DB)&lt;/li&gt;
&lt;li&gt;Distributed Network Cache (NCS)&lt;/li&gt;
&lt;li&gt;Graph APIs&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Basic Algorithm for Social Graph&lt;/h2&gt;
&lt;p&gt;Because the problems of social graph share the same essence. Here we just talk about the "Graph Distance" problem.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/15-7-25/24130302.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;Graph DB&lt;/em&gt; stores all the relationship of the members. When we ask for the information of &lt;em&gt;second degree creation&lt;/em&gt;,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Firstly, the web server communicate with GraphDB to get all the 1st degree connections&lt;/li&gt;
&lt;li&gt;Secondly, web server communicate to GraphDB again to get all the 2nd degree connections&lt;/li&gt;
&lt;li&gt;At last, the web server will merge all the results from the GraphDB to make it sorted and unique.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To make the retrieval more effectively, we add a cache level called &lt;em&gt;NCS&lt;/em&gt; to cache the result we get from the GraphDB.&lt;/p&gt;
&lt;h2&gt;The Disadvantages of the Basic Algorithm&lt;/h2&gt;
&lt;p&gt;As we know, for a distributed system, there are shards, replica and load balancer to handle large amount of data and queries.&lt;/p&gt;
&lt;p&gt;Consider this scenario.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/15-7-25/4544395.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;Two queries are both ask for the data from shard 1 and shard 2.&lt;/p&gt;
&lt;p&gt;The first query (the green one) has to communicate with the database twice, and then do the merging to get the final results.&lt;/p&gt;
&lt;p&gt;And the second query (the red one) only has to talk to database once. And no de-duplicate is needed, because there's definitely no duplicate data in one single node of the database.&lt;/p&gt;
&lt;p&gt;We can make a conclusion that if we have a &lt;strong&gt;wise&lt;/strong&gt; load balancer, we can optimize our retrieval logic remarkably.&lt;/p&gt;
&lt;h2&gt;Set Cover Problem&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Given a set of elements {1,2,...,m} (called the universe) and a set S of n sets whose union equals the universe, the set cover problem is to identify the smallest subset of S whose union equals the universe. (Wikipedia)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This problem is similar to ours. The optimal algorithm for a load balancer is to find the minimal subsets of all sets which union equals to the ones that asked by the query input.&lt;/p&gt;
&lt;p&gt;It seems that we find the key to our problem. But this is NP-complete. There is no effective way to find the optimal solution.&lt;/p&gt;
&lt;p&gt;However, in practice, a greedy algorithm will actually do the trick. The rule of the greedy algorithm is to find the set which contains largest number uncovered elements.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/15-7-26/80102455.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;We finally find out that the social information and the relationship graph is &lt;strong&gt;not that difficult&lt;/strong&gt;. The basic concepts are quite easy. And the main work for the whole system is to use the cache to reduce the amount of calculation on the fly.&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://wizmann-pic.qiniudn.com/15-7-26/65691084.jpg" /&gt;&lt;/p&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;p&gt;This post is mainly based on this &lt;a href="https://www.usenix.org/conference/hotcloud13/workshop-program/presentations/wang"&gt;video&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.usenix.org/sites/default/files/conference/protected-files/wang_hotcloud13_slides.pdf"&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Special thanks to Linkedin for the sharing. :)&lt;/p&gt;</summary><category term="System Design"></category><category term="Linkedin"></category><category term="Social Network"></category></entry><entry><title>Workflowy full notes</title><link href="http://wizmann.tk/workflowy-full-notes.html" rel="alternate"></link><updated>2015-05-22T09:51:47+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-05-22:workflowy-full-notes.html</id><summary type="html">&lt;p&gt;Recently, I'm becoming a crazy fan of &lt;a href="workflwoy.com"&gt;workflowy&lt;/a&gt; because its ability to build a personal wiki concisely.&lt;/p&gt;
&lt;p&gt;However, there's only one thing bothers me that workflowy hide all the notes as the screenshot below, and it annoys me a lot.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXsAAAA+CAYAAADK3LtgAAAgAElEQVR4Ae2dD1BUV5b/PzEmTTKZZjIundGhDcY2xGk1DkoMxDiwI0pFDRk1+FMWS/nhjiRUicuvhMVSSjdSurWUpIIhKxbZSGGU0TGM7obEHXGdCGMCvY7Q44y0OtKME7onE7snCf0S4/3V7dd/HtAY4r8wyXtV3e++++4959zvve/cc8+97z7E1/Do/VCIRzuEuDxY2T4TYsF7Qhz4RIh/ahMi7Q9C9AbSHrYL8U+ecMbej4T450tCvHdeiMV/DsQrQpz2CnH6AyFmtQlxwCPE6Y/CNN5XwvllqOaUEP/wYd+4XiUg3+dCbLcJ8YhNiLRTQsyyCTH6tBB7OoRIOy/Ee5+o+Xo/75v/9HkhRr+n5pH5gr8Z7wkx42LftOIzIf5vmxD//ZkQ4nMhauxCPHpKiH/+oxDbO4RY/H6/9J8L8U82IWouCbH9z0LUnBZilobmxYtCxNkD5f1ciH+2CbHHp9L+vcRF85N10OsR4tHTEepDUfP259/7gRCPnBaiv1j9pBzy5VfaHj4TYvEpIU7L+tOGtdL7hEizqWnecwgx+qQQaWeE2OMRQtb79lNCbP9IiN9/KMT7gXYg2+Mmef8jIf7BJsR3TwrxDw4hfuUTQrYNWV+9GrpadgPCnwgx65QQv+/XxvzptPUr5T8pxKM2IWbYhIg7qbapAfX7uRDPvSfEd9uEeC8Szf4CaNrnxUtCPGIX4vLnQlRJHm1CzGjr+0wKTbkkb9nmD8tnTuY5LcSMsxHamobn7y/2bc+aW/6gbO//7BVCtvO0P2ruSr4BnIJ1Iu/+9xkh0i6p6S57hEh7T4hNHwhx2as+d/I5DukibRvQhjVstOXzR8vnUeoZWUafEM/ZhHjufSEWyLj3hZhxWoj/ls+f5tCW8XCHEAtcQozkm3ZchVfPQivQ/jtYOgrKTKBcAUbAjx+BHwO+qxA1AqK+BWXfgvYLGqDuhsl3AwoY7oAJ98HkEeH7D8h7X3BE3Q1RwTQjYM3DsPoe8Hkh5aJ6Y8IomH4PcAXy22HFZJipqbFJY+DtMUEi6vlsF6zqG4VPino1EDkCVv4Apv8JsrvACUy7G94xwkzJK3h8Duvfh9X3wYufQa3kI2mMgPaPINoQTKg5j4CHv625DgQlln2OK/COG/71j+AbBT97QL3ruQLRI6HjQzDcC9F9Mt2ii9vQHhQfzG0FCZl3JGwMFiWAp+djcI0E0wiINsP58Zq2ocHu4e8EMl6FVi94RkHUXfB/HoTK70B0oA2eDdK/2eeR8LPHBhIdUL/A9Hthr08t88AcA2Nk+/QpsP5PMOEuePYsRAtY+hCsuVfFQ7bj0DMj27QC+Q6Y8CDMCzxzq+Oh9TTk/gl+NrofnwDeCOCOfvciXBoMoFyCx3vCNw339JVBPpv/8REsfFBNE30vlI2BZzvhRWDS30H19/u25S/THsKcwfNXmHMBxpqhchRk/hFMo6AeyGyHLiuslDpEljNQRt+n8B+98JP7QKM6tGS/vmHfR/Afn8EvpoLxQ/iXS/Ds++CNUOSf/gDK+iuvK5DbDq2f+3U9rs/haZtamRO+H6GBRaAbMeoKVLTDvytgjoFJd8GLDpgaUNTRRpgsa6sXnraH+Y/r7ktNEapc41ywMh423g2Zv4ETd8E6qQwUyLZDTxSstsCK+6H1fXjRCRMeBr/eHQEbJ8KKz6HwHJRPVDuZ1nMw98/AnbDlwX6Nvq8YoaseNzx+HsZ+L/zgv/57ePEOtYNbagwkvQov2uEV+UTfBZXWodEPMbrOwC1vDw/AUyaoHAdjgdbLMDaglLt64EddattbMSGAfX9DYQRMvgeyO1TMZDFlHZvug9r71M533ncDhf8Unj0NJwJtc6Js1yLc0UyOhV98Dza3w6tKX8BkupRAh+S/Iw2QiVCgNQD6ZvFf9fTA43/oW7/SIJAd14qH+hpBEbL72+PTgfb5E9m2vgf1Y6DrA/h3N7RegLmyPCNg3URVmQXpdL4PLqnsYoIxwN1Q/hA864Ku0SrmwbtnnZDRAy4BP7EEYwc/P/AA/E/AEAmmks+AfN49d8IuA/h6oeceeKIX5pxRjafp34ayeJj0ObzuhuWnofNzeGIs/OLLtocgY8DfkUyE6d9SDUD/rREw9gE49h1QpDXxKWSfgqOyjBOAzyD6flh4D9whLX8NvW9EsL+F8FUX2idHFSNvj3L7qss6HPkPt/YwHDH6sjKd/SuM/fY3q017roZHV18Wr9uR/hup7G8HsDoPHQEdAR2B4YSAxtM8nMTSZdER0BHQEdARuJkI6Mr+ZqKp09IR0BHQERimCOjKfphWjC6WjoCOgI7AzURAV/Y3E02dlo6AjoCOwDBFQFf2w7RidLF0BHQEdARuJgK6sr+ZaOq0dAR0BHQEhikCurIfphWji6UjoCOgI3AzEdCV/c1EU6elI6AjoCMwTBEY9sre4+ygrcNzw/D5nB10uG6YzLAm4HM0Ur2vw78Xzu0X1IfL6fqKeN/+0t4wR08Hb1S/gUO+vvsVHD6XE9dXxPsrKG4Eltr26sPzDQBj+Cl7n4N9RStZNv9JHh03hokzFpBX1oDD1ciiMWMYM+D3CHnNfVutx+XCpf05O6gvWMCCgn04tPH+sKevgnLtY/64NKrlDmGAp3ER456sxBFsLj4XHU37qK7cxxf1QZ62LSxatJGm29XJeJqpLi6mPij7G/Mj4KVi+Ehec99y+zqoXLaS3aGCBgrsa2Pj/EVs6eiLcRCO0NnVSMGsNIoDdeHaN59xj23kWtl8jn0UbWzE5Wuj6LEn2eLw4NhdwMZGCZiLfYseY9m+wcHztRXw6KN5+Fn6mlg2LlL7CMQ9EkgXEvgWBJzVpI2bzzVE1jB181Z5MVuOBQwZZzVPDmjbAdkf29IPRx/NRYvIe6M/Nh6a8tJYNqASNWz9QSe1WbOYXx6obEclT45LY3eg3fRP7b/2dVBdUEmzx0PTskeYv8+Jp62Sgi3NyBI4KtN4LK/JH46cv4lF4x4LtCMX++Zfo67GBNNFpHQdkR4aF43jyeBDLSl4WiiaNYu8Jg+ufVlMTStW21Ek6r5m8h59cuAz4MdtPm84mtmyLI9918IvEt3bHDf8lH1UDGazGWt6KhbDeJ4/foF39yzHIjf5MYyn5O0znD9/Xv2dOUR2bL/tF33NFMyYytSpmt+MORS3KCjH1jJLGy/Ds/IIPm+DYu9uorxgJfOffJQxD01l8cZ6bC4v3e7BFaBU9FmLd9DSUkt5tfpADEr/JtzweVx4zRlkxNqo3t2Gy+XBkF7HqZM1ZBiNzH35OKdOneLUqeO8nNQPM8nfbaOhxY0huDFZQCbPsUrqnSaSzdr9BgcK7GzYQUtMJrkJg6Xz0bG7iC2ani8q1gy2BmzuIDM7+5oMJCeYwOfgmB0s1n4CDWQdjpHt5dAZzpzp+zu1P5v+zSSc6SsI+Ty4FAuZ6QaOVTbQ4fLgicnm8KnjbE8yEJNdx0l/XZ3k7U3WgQL6HDQ12fHJ3fG0h6uR8kYPloRYbeyAsK+jmmqHlfzlg+8GJhV5UXVbWHlHmTErjTTYAzuoKR5a6tuISbUSjYeOJifRCZYvsVOpAevW4wPq6sypOuYaI7TPAaW4sQhXUzUtxnRWJUVjyigknUYqv1ARDMLTaCHZ1EZpUSP9u99Bcnwl0Tdt18uuri56e3u55557GDtW7u93vUc0yfmbSZbW3u6mAUQM0dFEhfSJwb9t7MBEMWTvP8m2aaGEA5L0j/B1bGTB4nqcihevArZZj1Aem0lVoZoyJiGDzOz1WK0WTFHgaVrJ/AInMfs305eND8cbxax8rh4l42XezvVSlrWYNMdWaiqWM+mW7NvrpD5rFsW2wIO4YwFTdyTx8pkDPBMTg9yqFVMsJik4RnV7Yn+ktHAcNNuceO31OAxGvLYmmgwGzEnJWKIc1G45hnnVEZIMHWxZVAqb6lg/qR+unibKKh0klNTR/1YQZ+e+PLKKHWQcKlGj5IhhcYF/1NO0qJnubjeGnAJiDNCQVYRxEzR7u3EvmEp98NmPSafuSAXTvI2snF9Ai1utq6xZHrbuCWzsbDCo5Q0yludgWbVxNxr2dbAlbQ47zg0ktHbqGNZqo2MzOXS8ItBOfHSUz2dOKGMxc6aWMnf/GV5NjsVkkOLGEGMyqdv5GtU2rrZ5Dx3NNtyuJhq7DUxyHqOpyYDRksQ0M7SVl2NPKKRmkkJz0WIqrVXsWW7WSuIfMTWW1eNNryKj/61AStkZ5CwuRyk5Eni+PDQXLGZjmwfa5tPQ7cVry2KjVMrNOURvW0WbzYvdlsYj5QEiBgvZdftZP8nN7kXzKbPLulJoWTyL7qo9pPirRdZVsHI1YkaI0ty9CUEHDTuO4XXD4ofkBsGBI2ci/h3DDQlsOn6YVWb5eLThcDlwKV6w22jDgnVSoG4MBn8dKZhI3VRDjd2L0+nD9AWGUZDd7T7fFGX/8ssv85vf/CYk+6OPPspzzz0Xuv5yAek/86JIpSsbhPQtGo2BRqfgdDhwBLdn9XX7FfNg9D1Ny5iadUzu6hv50DyEUZZVbK/LQHE3UpDTQHJVFZmxJszdBWC0kp6eilU2QsWFy+2kofIY51zZfTsbTwf7SvNYW99NwvN1VK0y4yGWPcdNFGXlMWdWA89XVFCYau6zL3dk4WSsB0ebA4N1GtduP2aWH77Acj8hH20b08iyZ5IsO5ZBBh/B58nn3EdZUT2ObjcKRiqL8nC7Yyg5foSM5iLKlUzqsi1ERfnIsLpYsHYXS47kE7YJfbSVF9HgTaEu3RShKD4c+/JYtNZGwsuH2Twt0NtFWcmv2MNyn5N9a7PY0R1LxrYqMo1gNJlQ9i3Dm7CJ/ZsSMCh2ynNKUfJzsfr7GQsZ+YVMs9dTVguZqzKRA4AG5Rw75jzEjghSYMyIFNsvbqh4y43VLeTvOc4SbeNy7mZlTgtL6qroA4XBSGyof4xi0vpfcWm9ytrTlMesAljuL9gXVZadXaVFNDm7cWPAW15Eo9uNdfsp9lurKag3kHsoA6mKDOkW7HkF7Es/wBJNtXiaSik+ZiDjUFJEK9zTUUnO4jKcmXUcXmUJtNNoEgqr2JPvw1GdQ04tjM+uoCLVgMFkItpZSbVxLtur8rEYFGylWVSac1luUY0La3Y+hd12qssaMGeuIsNiwIOCbe0MHurTKwarI1bTvoJx/c9DrCvnbhbNL8PmVlBaZvFIdQqbCqHcDjGZNdTlW4jydVCeVYyvpI71/vZpIMbfEXqwbckj71hAzxTn0JxQyIGKBJxtduwtjTgVG8UzxrDW3w5iSNl6OEIH21/2r+ha83GT6wpevHhR/OM//uOAn4y/rqPnoFgYN1qMHq39xYulBw+KFYnxIj6+/2+mWNca/M6U/CzSCbEifooa19slOjs7RWd7u2htbQ+Ej4qdKxLF6NFxYt4LreEvyASF7dkr5sXNFju71Ije9g1iZh9ZVLniExeKDW/2BHJdFu0HN4h58aPF6Ph5YsObMnOvaN2QKOLmvSb8pHq7xJvr5om40aPFlIUbxN7WYN4g4wjn3laxJnGmeKFdU74IybRRl09sEDPj54mdnYFYSWNKvFh9IkijVxxdGCemrGsNfZ1LiE7x0sw4MW9vjxBdr4nZcfPEzjc3iNmj48TCF/aKg3tfEztf2CDWLJ3px21pqNxCXG7dIBIlPvGrRYiFEKJn7zwRN2W1eGmDLPMUsWJvl4ZfUOIecXTDTCGxnB0/U2zYu07MTFwjjva0ixcSA/LIpJffFAvjZooXgmUKFW2NmDIlwLf3qFgar2LV29srei+/6b9+qbNX+K+DLK91vg68+5Dr2unHTsI4pKPnTbF6imzbwQy94ujSOJG4oT2EVc9rs0XczJdEuOi9on1doohfcVRc7pU4xYulew+KNYmjxZQVL4mDB/eK1156QaxbvdBfL1PWnAi3cT8/2X4T+7apzpfEzNEzxbqX1vjb+sw1b4qgRNpydB1cLRLjZ4ulsq28tFesTpwpNrT3iBOr40Xc0qMBPl1i52xN3QUJ9B4VC+OCfHvE3nkyTZdaN71d4rVAHn9dBZtqMG+k81DrqrdHdLaeEC/NjhOJ6w6K1hMHxbpE9RlOfKFTxbm3XaxLnCLWaPWIhqfUAYmjp4g1gQbe27pBLF24Qqxes0JMGR0vVuxtFZ09QxFaQ/QrCN6wZf/JJ59E7KYGi4+YWBtpeoYDF54BxxYem7ULy/bj7FkSGG8+84w25ReHo8xYLOBpLmBZjp3k7ARcDbUcc1vJrjnApvRrWdgenNKqnraZX10qwedR/CMEOeyMCvuR/DI4q7OYU+rAmrmdtzctCblqpq1ahSWtnmbXcpaYzKRvO8ypzN2UFpeyNsuN6WQVqTfRreNz7CYvZxdR+cdJ78hj2e5MqkoMKIrWtaGWI/wpEcDZTEO3hcxkEz6XDZfRjNnnxmM04mncRa05FrPFgjVjPTXWcvK21ONIz8fiaqQ4ZxeKNRZDhMkpxd1AWa2V3LojbE7VmJd+1Fy8kZfGc23JvLwnm5ZlRRishWxOLaK5cQf13XKOxY5niQmDowkHZlZpP1LRv/b9lpWC4nXj9RrA6/F/ycjjcuOV7gavF0Vaof3zXde1j7aiBf7JPW12RXHjVhSK0x6jPDh0CiQwr9rDgVXh8RCeNipz8mi0bOX4pEZWLvOSX5Ptl9lgigqN/NSBg8Zd6XNQ3+TGWmIlWrFj9xqxmLzYFSPY97HLa8ZstmBNymbzXDMb15bTWJLMEpOT3Xl5NBisGMOeeI3456gtc5NUcoia/GkDcHLsXsT8UheZdXtIrUyjPCaZksJjlB1roLLRixLThNOXSrTioNlpwGzuN5+g4RQMKl4Pbq8BgyLtfPnlKZesJvk9L7yY/O7SYNrrPkeZsEwzYDGCwTKNackxRG9+GUvlc5TuSGPiLklZ8ePOgok0GMCYsJUjB5YQbLHulhbkWKq+oJiMIxWkTtvMngNy1NxMXpMNg9mM0WujsclOm82JZdVmlmiq+rplv8kZb1jZ33vvvRFFGiw+YuIIkY7GRrpR6F67iCLzEQpdOcx4riWiS8aQUsepPamBBhqoOBTVHSRpWwqp2lROwdpazsVksP1QCakmA16XCy/GgC9bFcLndeNR7FTOn0gpc3m5wkRZVi39PggFjOf5t4/4/dfm7BqOpxsw4sbrduAITjj6kthal0S014Ej+Cms6FQ2HcqkxAumm6N5/IK7mraQk7MD6bY3NGwkx+nAWrWVaKUJl2IkNTrkR/B//k3rKnU11+OIzSDVDO5GO15zLgnPLOHdSH2rz8qh5cbQMNuQvJW6zBayCoKV6KK5upSiUhsYU9h+pIYlEX1QJlKfr+BtcxImWxlvpW+mcJIJ07YqjEWzqI2NRWmspMmVxKSWZtyxS7BEwEtxt1G24DEMmfng7WbX4hn4n9+AOC2LZ6huHUMs2fuPf6l5nGCJBp6jsKzaRIXGM6Q4qskrfsufVHFD8vZtZJrDGt9gDk+a+pxvULrsOWqlv99YS8FKB67UOqxRXmq9EB2jUZTyG3ZRYTp0H6PJnUC+7JidcpWYheUJy9n8G9WJ11fWVCwWL7EBrWUwZfDytnRq04IfRvThbNpFUVEZ54ghs+YIFX38T2FqlvQSqpItJBmaKDXlU5JuxhxdxVbphjKMJ6a7nh0thWw3NmJTLGzyu3DC+YPANBYvoCEmm+WKgr10DjNKNWmK5zC1WF4bsJYc4Uj+rdCYUVjSU3FUG4jNruNAocXvJiybX4BScZhN0ldrMIYUvfz2VGO93T/XZY1upKDgDeoKTThsNmwtTTS73bgXT6XeGEtCwjSs1iSG0M9pCn37gjes7OVk7JQpUzh9+nRIanl9Q5O0vjaqq+WTEEtGZjRN1S0UVtVw8pRq5yi2ItIKoOLINhLkc2DQWGyKtFwNGLyN5MxYS4uaJSQb7gbWzmkIX8fm8vbxzVi6d1NcUEm9Tap1I0mrqjicm0qMvYCy2Gz2HyhUVwTJnIqNovkbwx2PtB5iOtiYtoBd5/ozDLNSQ+MpOf4rBm3HniaWzcjiWLBzkJlCfuhYMg8dp6LvjDC+tiLSshqwPL+V7IZSmrBjN6RSkhCNz3EMh8FMfsgqDoxQQtajD6fNhaI4cMr5kQYHsenTMPnaKJi1gPoBvZzayU2Sgy1TOhVV4Guz+a0jKaqnuYyCSifT5sZwzm7BGhPuZPogIVdNZeX4y6nIj4lSS2OthD6BrYePc7LEQeX8OZSVN5DRfI7Y9BRC6lJaxQXFVL9lx8t4rLkVFCY7yCmzsvX4EfxzknIp5tSNpB75lX+irQ9v7cV14C2zR1uSSQ7qIk8bG4uOYZw7F+NbdqwpCg21dnL35w+csPY0kpf2HLakEjZZqilzKNjPxZBdYSXK00KT04hFmqGBww+NnHQOXHucdtyKF4fTRXdLE25LPgnRcjnkVLKO9W97BhK2HufwJJnZzJKqCvA1IWH2H65Gigp2oyQnYez2kmAN2rLBBMGzi30FORS3eP0ffpVc6hvkTKyRlJrjnDwJttJZLC6rJMXaiNtSyLQQKRdNGwvYWH+McxhISHierfkWGhYZSKo5xYF02YPLpZgzqM09xeFnIvToQTGus66C2QecjSZ1ItznUufwjTF9DD+Z3tdWSbXLSqzBR1JJPkqTl2NlO2g0WEmYlk6Gw0aDdT8nK6x0715LudfKoDAOEOA2R9ws15H00Z85c0Zct69eI0jnztkifuZqsXCK9MH2iJ7Ap9lVf16v6Dm6WsTHrxZHe1R/rCarENL/GDdbvNbf6djbKtZNiRcrQo5l6aceLaRP0+9t63pNLF24Wrywc50/f8hn37pGJCauE0e7ekRPT+DX+aZYMSVRbPgSvvTeztf8cxFTVkf2h4bL0Ct6urpEl/wF+Kw72qled/WIyxFdg5dFZ9dlIXo7xQsz48WKo51i79J4EbfwNfHmmikibuFejQ9W9anOfi0wKeFn3CPeXJMo4uITRdzogG+894RYPSVRrDna9YXl7m3V+M4DBfH77BM3iGtBdLmnUxxcPUXEL90rOnt6RPvOeSIucYMIuk4vy3r2z5fMFi+FndbSiS9a3zwqThxcHfLZ+/2qcq5h52oxe+ZMMXPmFP+8T3yiDM8Us5fu1Pi9w2jLuZUvj7cmf2+72LkwXsTN2ynaOwM++85W8cLsOBG/cGfE8l/ulPMXvaJ1zRSRuOGEaJXljl8tDu5dIeLjV4ijgfYuZWuX8z4L3wz73UWv6Ny7QkyJmyIS4+LEPH89XhZvLowTM19oFV3BNtrT6feLzw425KDIfXzngcjgM6NtEsH0gXPv5R7R/tpCET9ljXizq0d0ybkhObcVrJeuvYG5tjixsN+kRc+JN8XRVnk/4LOXbSs+Xqx47QWxdLasn0S1nqeodTVz9moRmsboI8f11pWKT+KanWLnSwdFl5DX0m8fJ+Li5E/14Qevp4Sely7x2rx4MfuF18QKvy4a+PB1+edUXhBH5XzG6ESx7kSo8vpIPhwubtiyD/ZNN2TJB4nIsxwOl7lIryqBjR0QZVLdHa59LJi6FjmgCh5ZU6WFbiRj/ymqklUL0uNopttg8fvogukinX1t1ezuTqBwT7LqHzUvZ8+B5eDaR0uZtFTDh9JdS9aMkD0UuBFLbjhJOORz0tToxJKeHF5B43yDtYuKsUlf4PZ0zRAxnC0cisJkDsxR+FxEGwwYY2IxR3SFBHNFY/FnCfiPDLEsqdqPyWajOkchqUrD0+fB6ZErXsLWI5hI31pFdvMCdhkySQ2NAsAYo7F2jMaQLznI+Uud5XLaxeWYt9aQL9doOqopa/Bi3WQlRmkir9xJelVdaClrdEIGSYYG3opNISVk1kuO0UxLT8XXJutftWYVhx230UKM0oYjKp2qTakES+i1l1NQ7cQnF7sMGGhcD95qqX3ORkqX5VAb9Tz7969ikrdavWGcxvr9NXjnZzEnzc72V7eyROPWiPZXVnDljRHrqhrqzHZs5Tn+dyOSNMat1+3FYAquRpPko7AsqaDi2AyyGmLISJCVpWIQZTJhNgVNaoO6xFaV6Dr+fTTlLWB3Sg2vLjETpdgoL2vBkJqJxehFLt8ku47s4OjGnEyGFVpsVjKSgzKobE3J6Zh8TVQGpXDbcSgxpBi9NDhNrKoo9K+m8t/22ijNa8Ddf5Div3kddeVpY1/lLnbZFLpbqmnK3YzqfZPvM9RwID/gxllUhG/TATZPk26cGPUZ9XlQLNlsXWVhl2aFZrAY8mxOz8ZaXEzWc0b/SpwSv6tBm2L4hIffS1WWdEq2VrEpRdvApctgCUcuXeLSpUucP5RJTEwG+8/L69+FFL1cqtiyrwWscwNL9AYHOmraNt69cFgd8g+ezH/HMD6Xt/28VP6Xzu8nQ6MQtdl93Y1UFi9mxkOPsWzjPpqbqlmW9hyNlk0cqluO5pnXZrv54WgzSn05x2Lz2Zyi0R6KG4fbiFkuaA8dPjp2FbOrO5YEYwM5eftwRnzYQhmuL6B4cdrtIdrRCflUbM1AKZ/DxBlrsSVtY1NwxtrnYHdeAW8ZrIzv3kFOadM1Xljx4fC/gZWC301unEZScjLJgV9KgjnkBrk+wfvnkvMSeaTNyKHRvIm3D61Xl7lqk0Wnsu3wIUrMjaydNZX5Rdd649qE2VNNuSOBwsKA8eGnJddtK8RYA+u6A/Slq6yoQWF8AuzKKcb/wrGW900Je3E55fxToCGYUlhfVUJyRzGzJs6i1JnOtpJpgb7TR1tlHqW2GKyxNkpzttB8jR1OPPYmHIZJ+PsEgwlrSriuklPkBPJNPNx2Gm2QsnU/J8+/y57NYcPHYDQTazZjjo1FzuFHy4UI8tr/PorsVyexqmI90yIKJOc7qsnLKsVvGlrz2bw8FlveDNIq+7+GfhPLcwOkbpplfwMy9MtqJlWuvubt6NAAABA2SURBVPG19Y33+UJLxr1edRJW8Ybj/CtkXI1UH4OE7cnh1QQ+J80tTgwGdZK0r82hYeFz4XC48LntuOQkp+aW4nXSIieMg1ahz+FXWJH0vVyvf+B3mXS8UU5Z2VoWy9lC6fOvWTXQf6vhETEYNY2Kd38V8da1I704qvPIazRRcijX38H4nE00tikotkpasLA91Ot4aKvOIavMRUbNEaqS7BTML2O3vQQUdcJTrlBQDwW32xh5RBNMEjwbQHE7sNk6iDJF4fO56D6m8s4M8lYUZF16FCPWFCuut3KYv3ITVestNBblsMOWwKZDdWQq5cxfkEWaayt1VcuZFOWirdmBYnfixYxBcVDf7MUiV5EooLQUkfbkllAdKt5zuA0Rx2FBadXzUPF2NVNb7WDS1kNsXT5w5UqIaPQ08vecJGl3McXVNrwsCd0KBxS8bVvIWWsjaXtgvsEj35B14PE2UWkzMKkkPKzxNG8hK6sWQ+5+Dm8207hyEdUNDrJRsJel8WhlqLLwuhUs6WFO1wwpLlqa20iQ68x9HryOBnbZtbwVfB4PHgViElIwO+rJSoOtVflE1+aRU+tk7vYjVKU6KJ6fxeL5bl7es5VnzHKxlw2n0oxLMUCUF9s+GyRUYDU0I+fQ8mZ1+JWtXz7FyznFxBeKPdS6siznVTliH3AodO+YxUO75GqgwAq1BQ/R4F+5ICfzj7C539xYkISsg5y8HbS4YfzcEuq2W2jIymHZSidWm0LMkkiaIZj7qzsPQ2UfCQwn1QtmUKr14QCqG0dO0KZQd2YPSV4FU0Im2X2W+blo2LhYXfkQM5eXg4qmPxv54k5WFg3SE2LNxT86DqZxt7B7hzs8LFY82L2QELw/4BzNpGc2s+eZ/MDKlFqysswcijRhNyDvTYhw2djdoJBZU6e6SyRJVxNlz+2i2xBLSkkN/nkxGe+xUVuvkBlaHmmi4lep6rIyQwwZm2p43r9XhfQW2CnLCr4ieW05TZMySDKWUrz4WCihIWY8Sbnb1OWmnibyZuTQZs2kcP9JlkyTk8lvULZbwdtYTq0zne1HtgfcH+s5vF8hq6iFbu9yJuGisTSLHXaFmLmrkB4sy7RMktJjMDSAwbqKbfJlrABnxV5OXsDDEhLmRgKmZ6iKuFQpEtFopi2v4kgkfSOTK26adh3DKF/CCy4xxkl9aQ4NbgPjM7ZSEnBR+leGVDdiLDxEXWB55JJX32UJHhob5eqSKmoyg4rGS8vaLAbxPvQVNDaJ9IRKdqxdQGjpgiEGa0ohz/u3v3DxxqIZrHUlkVtyhJpnLETJFwjL6zF072ZLg4/smiNsS5c1YabicA0sKqfFqfCM2YCzvoDFcqZ/fLbqIrSkkiknhaWyNyaRv61QfWHRj4ccGYSk6CvnTb3SuHEi0DUOtrBAOhGtqaRmmslfkklqQJ8kHdjO2pXFNJpy2a8dSUeg/VVF3SEnDr4q5t8UvnI3ytoOC9nyIfmmFHoI5ZQ+9H6vLIRyRXSvh+7qgduOwDUq6xq3bruYOsPBEdCV/eDY6Hd0BHQEdAS+NggMvwnarw20ekF0BHQEdASGDwK6sh8+daFLoiOgI6AjcMsQ0JX9LYNWJ6wjoCOgIzB8EBi2yv5sF/yoSwVKG+YqnP0LvPKnQXfv9b9j8p/a7QaGD966JN8wBFq74NWPb7zQPR/DOzeBzo1LolP4W0Vg2Cr7/oC6PJBrh4mtsPyPIPuBiO9tKGq65Q5459P+VK59fdYNr18eJM1VqPhfeDq4ydkgyb5U9Mcw57fX6LS+FLEhJv4Cnr6/wBgbtF8dIr0hJvP1wquXoOsm0x0i+2snU+BHJ+HpHmi/AKNa4Z0rahbPBzD1XRin+Y06CaM01/Je9geRWZhGwmYHnL1WuXvh6d9CD9B6DnL/otLyeeHp/4XHbZD9Bzj4AfRcgcJWGPMujDkZNogic9djdQTCCAy7dfa+v8LTv4eOz9WXwMd9AGXfAcOd8JNYKL8PokeoD+XBj2H1t8KF8Xgh9yx4YuCtuyC3A9ZYYGXEN+DC+WTol52wWW7wNKFvfOhqBCy1wFP3hGJuOOBTwHmbF75+Ec8oI7w1ASbcZDMg6h74sRey7VA+EaYPo5bn+Qg674T6UdD6PkyIgZkB+aJHwalRfav6Ffmdnodhdf+2cBVescO23r7pvQKSWuXGHuFDflHw14+ouze80w0e2a4/hfwPYWlgtwyuQJcBfv0DzS4PV8FzJ9ROBfMfIT9MUg/pCFwTgZv8SF+T15BuRn0b3p4Ox0bDpNFw4YfwhHwb83PovAyvdsPmc+pDMeGuAMmr8MuL8PgZMJmhPAp6RsFbcfD6WXj6HJwNWGqRhOj6ExR+CrXj4YEICdrPqZbdD34L/+/Dvgn+sx2e7oLn7fAjG0z9bV8r7pfnYGqr+nvcHh5t9LhhYie4PoKHpJX2LlRohumvt6vW4iu/VS24UUFr+yrktmrSXoXnbZrrK/DK71R+kuaczrA1fU2en8Kz0mJsg5RO6OxniXb1wJxWGNcKE3+jcU0E5NncBc+2w+Ot8PTFyKOusQ9ApRFyHZHv90X29l21fwATTDD9KvzXZ7Due9fJewSsngwXEuCpkbBGhh+DD2bAB4/BqXEgO71fy3BA0cttbf71Q5j+Heh6H07cCdPvDvN3/RV+GGg/2T0gR0id8tWlwJOriNs8MgyLpof+xhAYdsq+P36+KyD3dqo0QfRIiL4LJhmh0go/vhukNf+sDXK98G9TYMcDEH0V1l+E6O/C25Ph7xVIskFhYHjch8cV2PYneMoMYwdBY/J49aHdHWnr/hFw4kNYPRH+Zyo85YN/CbiC5ChlvRdqE+DUdKi+H/7rryr3B2Lg12PBeB+cfwwuPQYFmlGK3OPlnYvQej+cl8oiASYPIp+2PO+ch1dGwFvT4VICTP8r5Ev/AHBNnnfDz6bD+R/AgMFNL+RehIUT4cJ0eMsEm89qOrWAktw1GX5tBU8P/HIQF9rk78P0j+BFTcemlf+2h6/CUSWg4D8BTzQ8FXz1NiCMrMcftatuliHJNxJWfhv+o7uvIv6lC8x/19egOCsVPCrPF10g96fTbulh+jb873S1/dQ+AF0emBQLD4+AsX8H03sh/2JfPkOSUU/0jUNgGA2m+2Iv96fp9MAPP4AtY+Bfnf0atAFqrTA5ClY8BJX3qfl7PvV/e4At94DnU/DcobpfFvrAE0FZ+z6BE1dhVyB/XymGdjUpJqyIf2yAbZ+p+aKkcv4MXv8Aou+HyWNg8tBIEn0nKHfCltGaIfwX5b0KBz+CpyYEFMpIKJsCviF0Etci3XMZOu+BnwQ6o7GjYLITTnwGD8vR1Qj4e9kZSyIGmDQCuiQGGgs1RH8kLL0X1n8AGzWdW+j+7Q6MgI3BSrkb3v7OEASQxkQ7bAsmvQt+9ihM1+A8fSyMbYdXPlY7cd9l2NwL5f1cQg8/CB88qBL68fQgwfBZWvbSZy/fvJ70fVitwIlLMPGiun+TbCPVli/RRsKk9dA3DIFhp+x9H8PTdugQqoI8JhuyG14cBcfkMFhW0BXVZeDfj+9umPctyD0DHf1cDzKp7zNwSktXWrmahzFYz8pn4LoTTBHuBdN80VnOJ0Q8vgX142HzJXj8PIz9NmwZD7JDGMphujegQIeSWKa5Cl1X4AltWUbeuCLwSMV9p0aWkSpeTukaC7jS+uCn5R9BdpMBPD618/6y20fICdS5LpWo4T51JBHJ9RaB7c2LGgFbJkfw2Ws5GODfxsDc38MECxx0wASzOhrVJvuisLTs/+cRVbH7jYcrMPkyrLDCEwqkONQ5rC+io9/XERh2yl76NHc9Cr4eWCVdDyNU/26nG+Z6w7tRygnc0GFQ84SuAwHZcWSegSfGRVb0MpnhDpWmT3YUX6Ck+tMfyrW0gndJa+4K/PwC5J6DUz/QKM5rERlEnj59xVXwBjs5ObQfCU4NNr5P5XeAYGwkK/tavDX3oiVDj1oPwc7WdRV+fJ2tR7mq4q5hMeTgZDP87/cDyUf0dYkMmchtSvjwGCi/DMvlXNL98Ovr6JXkXNU7H4DzI2i9AhvHw0+/Bev/BBulq+w7N38y/TbBo7O5zQgMok5usxRadlJh9dFm6s2x90PtxMDvYZgewZr++e/g6U74ZS9IP2v2GYj+/sChs5ad7FzGfgad15jA1ab/MmG5bO/Zc4HJyJEw/VsgrbNQ8UaA8ml4AtUzRBkeuBPaAt++kHMWrUHlPgJ+ch/88v2Af/kKbLark9khua+D5wNGmNALBwPzDWf/DJ0GeCI4QR4iPrRA+ycw9jvXOeIYCQ/cHfhdZ2czNClvMNWn8HonFP4V/l7uGvyh6lsf8tJTuRxTTuB/Av/uBpcBVoxR55VmPgimHsj8ENZ9P4yjnGhu/VSdxP25nDeSCxd6wu3rBkukZ/8bR2BYPi5+pSeXJN4RRrdHTnaeD1xfhfYISxYXPgT8SfWndgp4Yiz8bHSYRsTQPeryzRf/DPPGREgh16VLt5LcjVbyPA9jLoDsfI4NmMnsmz86Gp7oUVeoyDvSQv63h8MP5wP3w9JLkPSeWtanxkFtcIfavqTCVyPgp7GQeQF+1A1j74O/vxuC75DNfAhWOyDlXdVNMjkGqjUW5WA83/kdZEoiQl3ymvKeuty1fDIslaOtByG3E16UVvldsOXhwIR2cFQRlvCaIdkJ//tnsOX+ayb7m73p+Rh+fgle/AtERatLJGdKt9VlKLwAP+yBnzwAq78H00O9foTi3gO1D8FcN9Rrl15+Cj/vhlb/ZsLw4h/UFWiSxy+7wDke1n0M6z3w1H3w4kX46ajBFx9E4KxHfU0RGH67XsolgKfgqICfTIBd31VXd8z9ECrHBKziq1B4HsqmDuKeuQKvX4BCmedRWHith0pWrLSizqgTm6u//TWt6eFQrCtQYgfXGNj1RZ3acJD3KpT8Bl7/VO1Mgy4/uW5eGiLadfNRBmiwwtHfw3/dDT8do84l9S9Gu5x/ugSuGPhFJONCk0G+4Pb4+33X2cslua/IznYczLwDXvkDvPIZ/MIKYzV59aCOQH8Ehp+y7y/hDVzLV8yjpetkCDSkxVnYBRO+DwVDWZExBJp6kjACcn345gugxMCWmKHVSTi3HtIR0BG4UQS+1sr+RsHR8+sI6AjoCHxdEBh+E7RfF2T1cugI6AjoCAwjBHRlP4wqQxdFR0BHQEfgViGgK/tbhaxOV0dAR0BHYBghoCv7YVQZuig6AjoCOgK3CgFd2d8qZHW6OgI6AjoCwwgBXdkPo8rQRdER0BHQEbhVCOjK/lYhq9PVEdAR0BEYRgjoyn4YVYYuio6AjoCOwK1CQFf2twpZna6OgI6AjsAwQkBX9sOoMnRRdAR0BHQEbhUCurK/VcjqdHUEdAR0BIYRArqyH0aVoYuiI6AjoCNwqxDQlf2tQlanqyOgI6AjMIwQ0JX9MKoMXRQdAR0BHYFbhYCu7G8VsjpdHQEdAR2BYYSAruyHUWXoougI6AjoCNwqBHRlf6uQ1enqCOgI6AgMIwT+P72V2fgx+MkgAAAAAElFTkSuQmCC" /&gt;&lt;/p&gt;
&lt;p&gt;Luckily we can always find a way to get around those limitations. Here I recommand the "Stylish", which is a powerful tool to manipulate the CSS style of the page.&lt;/p&gt;
&lt;p&gt;Just simpliy add these line to Stylish, and everything will be there as your wish.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;DIV&lt;/span&gt;&lt;span class="nc"&gt;.notes&lt;/span&gt; &lt;span class="nt"&gt;DIV&lt;/span&gt;&lt;span class="nc"&gt;.content&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="cp"&gt;!important&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;overflow&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;visible&lt;/span&gt; &lt;span class="cp"&gt;!important&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;display&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;block&lt;/span&gt; &lt;span class="cp"&gt;!important&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="Alt text" src="data:image/png;base64,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" /&gt;&lt;/p&gt;</summary><category term="css"></category><category term="stylish"></category><category term="front-end development"></category></entry><entry><title>ç”¨C++å®ç°ä¸€ä¸ªé€šç”¨çš„sortå‡½æ•°</title><link href="http://wizmann.tk/a-common-sorting-function-with-cpp.html" rel="alternate"></link><updated>2015-04-25T11:17:01+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-04-25:a-common-sorting-function-with-cpp.html</id><summary type="html">&lt;h2&gt;é—®é¢˜&lt;/h2&gt;
&lt;p&gt;ç”¨C++å®ç°ä¸€ä¸ªå°½å¯èƒ½é€šç”¨çš„sortå‡½æ•°&lt;/p&gt;
&lt;h2&gt;åˆ†æ&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªé€šç”¨çš„sortå‡½æ•°åº”è¯¥åŒ…å«ä»¥ä¸‹è¦ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®å®å¯ä»¥æ’åº(LOL)&lt;/li&gt;
&lt;li&gt;å¯ä»¥åº”å¯¹C-style arrayå’ŒC++-style containerçš„æ’åºéœ€æ±‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥åº”ç”¨äºä»»æ„random access container&lt;/li&gt;
&lt;li&gt;å¯ä»¥ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ’åºå‡½æ•° / ä»¿å‡½æ•° / lambdaå‡½æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å®ç°&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†ä¸stdä¸­çš„é€šç”¨å‡½æ•°åšåŒºåˆ«ï¼Œè¿™é‡Œçš„å‘½åè§„åˆ™ï¼ŒåŒ…æ‹¬ç±»å‹ä¸å‡½æ•°ï¼Œéƒ½åœ¨å‰é¢åŠ äº†"my"ä»¥ç¤ºåŒºåˆ«ã€‚å¯èƒ½ä¸æ ‡å‡†çš„å‘½åæ³•æœ‰å‡ºå…¥ï¼Œæ‰€ä»¥ä»…åšç¤ºä¾‹ç”¨ã€‚&lt;/p&gt;
&lt;h3&gt;æ€è·¯&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt; æ‹·è´ä»£ç æ˜¯æ„šè ¢çš„è¡Œä¸ºã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…è¯´ï¼Œ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; å¯¹äºåŒä¸€é’Ÿå®ç°ï¼Œå°½é‡ä½¿ç”¨åŒä¸€ä»½ä»£ç ã€‚ &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢C++ Templatesï¼Œå¯¹äºä¸åŒç±»å‹ä¸éœ€æ±‚çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç”Ÿæˆå¤šä»½ä»£ç çš„åŠ³åŠ¨æ”¾å¿ƒçš„äº¤ç»™ç¼–è¯‘å™¨ã€‚å¹¶ä¸”ï¼ŒTemplatesçš„ä»£ç ç”Ÿæˆæ˜¯åœ¨ç¼–è¯‘æœŸå®Œæˆçš„ï¼Œå³ä¸ä¼šé€ æˆé¢å¤–çš„ä»£ç è†¨èƒ€ï¼ˆå¦‚æœä½ å§¿åŠ¿æ­£ç¡®çš„è¯ï¼‰ï¼Œä¹Ÿä¸€èˆ¬ä¸ä¼šé€ æˆé¢å¤–çš„è¿è¡Œæ—¶å¼€é”€ã€‚&lt;/p&gt;
&lt;h3&gt;å‡½æ•°åŸå‹&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬æ¨¡ä»¿std::sortæ¥è¿›è¡Œå¼€å‘ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;template&amp;lt; class It, class Compare &amp;gt;
void sort(It first, It last, Compare comp );
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä»è¿­ä»£å™¨/æŒ‡é’ˆè·å¾—å…ƒç´ ç±»å‹&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬è¦å¤„ç†Cé£æ ¼çš„æ•°ç»„ä¸C++ç½‘ç»œçš„å®¹å™¨ã€‚é¦–å…ˆè¦ä»è¿­ä»£å™¨/æŒ‡é’ˆ&lt;code&gt;It&lt;/code&gt;ä¸­è·å¾—å…ƒç´ ç±»å‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;It&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;myiter_traits&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;It&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;value_type&lt;/span&gt; &lt;span class="n"&gt;value_type&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;myiter_traits&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;*&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="n"&gt;value_type&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªå®ç°éå¸¸ç®€å•ï¼Œä¸åšèµ˜è¿°ã€‚&lt;/p&gt;
&lt;h3&gt;å®ç°mysortå‡½æ•°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;FUNC&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;mysort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;FUNC&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mypartition&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;mysort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;mysort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;mysortå‡½æ•°æœ¬ä½“å¹¶ä¸éš¾ç†è§£ï¼Œè¿™é‡Œé‡ç‚¹è®¨è®ºä¸€ä¸‹æ¨¡æ¿çš„æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºè¿­ä»£å™¨ä¸éœ€è¦ç§»åŠ¨ï¼Œæ‰€ä»¥å£°æ˜ä¸ºconst referenceã€‚åˆç”±äºæˆ‘ä»¬éœ€è¦å…¼å®¹å„ç§ä¸åŒç±»å‹çš„æ’åºæ–¹æ³•ï¼ˆå‡½æ•°ã€ä»¿å‡½æ•°ã€lambdaã€std::functionç­‰ï¼‰ï¼Œæ‰€ä»¥ä¸å¯¹&lt;code&gt;FUNC&lt;/code&gt;ç±»å‹è¿›è¡Œé™åˆ¶ï¼Œå³æ‰€æœ‰å¯ä»¥è¢«callçš„ç±»å‹éƒ½å¯ä»¥åšä¸ºæ¨¡æ¿å‚æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;å®ç°mypartitionå‡½æ•°&lt;/h3&gt;
&lt;p&gt;å¿«é€Ÿæ’åºçš„çµé­‚å°±æ˜¯å¿«é€Ÿåˆ’åˆ†ã€‚å¦‚æœå¤„ç†å¾—å½“ï¼Œquick sortå¯ä»¥è§†ä½œä¸€ä¸ªç¨³å®šçš„æ’åºå‡½æ•°ï¼›å¦åˆ™ï¼Œä¸€ç»„æ„é€ ï¼ˆä¸å¿…è¦ç²¾å¿ƒæ„é€ ï¼‰çš„æ•°æ®å°±å¯ä»¥æŠŠquick sortå˜æˆ"slow sort"ã€‚&lt;/p&gt;
&lt;h4&gt;å¯èƒ½ä¼šä¸Šquick sorté€€åŒ–çš„æ•°æ®&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;åŸºæœ¬ä¸€è‡´çš„æ•°æ®   &lt;br /&gt;
e.g. &lt;code&gt;1, 1, 1, 1 ... 1, 1&lt;/code&gt; or &lt;code&gt;1, 1, ... 2, 2, ... 3, 3&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æœ‰åºæˆ–åŸºæœ¬æœ‰åºçš„æ•°æ®  &lt;br /&gt;
e.g. &lt;code&gt;1, 2, ... 5, 6&lt;/code&gt; or &lt;code&gt;6, 5, ... 2, 1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;è§£å†³æ€è·¯&lt;/h4&gt;
&lt;p&gt;å¯¹äºæœ‰å¤§é‡é‡å¤çš„æ•°æ®ï¼Œæˆ‘ä»¬åœ¨å¤„ç†æ—¶è¦æ³¨æ„å¹³å‡åˆ†é…è¿™äº›é‡å¤æ•°æ®ã€‚å³ï¼Œå¯¹äºä¸pivotç›¸ç­‰çš„æ•°æ®ï¼Œå°½é‡ä¿è¯ä¸€åŠæ”¾åœ¨å·¦é¢ï¼Œä¸€åŠæ”¾åœ¨å³é¢ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæœ‰åºæˆ–åŸºæœ¬æœ‰åºçš„æ•°æ®ï¼Œæˆ‘ä»¬åœ¨pivotçš„é€‰æ‹©ä¸Šå¯ä»¥ä½¿ç”¨éšæœºã€ä¸‰å€¼æ³•ç­‰æ‰‹æ®µï¼Œä¿è¯æ•°æ®çš„å¹³å‡åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;æ€»çš„è¯´æ¥ï¼Œquick sortçš„é«˜æ•ˆæ€§ï¼Œå–å†³äºpartitionå‡½æ•°çš„å¹³å‡åˆ†é…æ€§èƒ½ä¸Šã€‚&lt;/p&gt;
&lt;h4&gt;ä¸€ä¸ªå®ç°&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;FUNC&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="n"&gt;RandomAccessor&lt;/span&gt; &lt;span class="n"&gt;mypartition&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;RandomAccessor&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;FUNC&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;dis&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;distance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;RandomAccessor&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;dis&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;iter_swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;RandomAccessor&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;RandomAccessor&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tail&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;lt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;gt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;eq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;lt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;gt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;eq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;iter_swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä¸»å‡½æ•°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;srand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

    &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1999&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="n"&gt;mysort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;less&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;99&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9999&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="n"&gt;mysort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
            &lt;span class="p"&gt;[](&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="C++"></category><category term="sort"></category></entry><entry><title>Beauty-of-Programming 2015 Qualification Round Tutorial</title><link href="http://wizmann.tk/beauty-of-programming-2015-qualification-round.html" rel="alternate"></link><updated>2015-04-25T00:54:08+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-04-25:beauty-of-programming-2015-qualification-round.html</id><summary type="html">&lt;h2&gt;A. 2æœˆ29æ—¥ (Feb. 29th)&lt;/h2&gt;
&lt;h3&gt;Description&lt;/h3&gt;
&lt;p&gt;Given a starting date and an ending date. Count how many Feb. 29th are between the given dates.&lt;/p&gt;
&lt;h3&gt;Solution&lt;/h3&gt;
&lt;p&gt;The easiest way, of course, the brute force, which is quite simple with Python using the &lt;code&gt;datetime&lt;/code&gt; lib.&lt;/p&gt;
&lt;p&gt;However, it's not an effective way for the problem.&lt;/p&gt;
&lt;p&gt;Let simplify the problem. "How many Feb. 29th from year A to year B?" Actually, it't not a hard one. But there is a pitfall. Loot at this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;yearA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2001&lt;/span&gt;
&lt;span class="n"&gt;yearB&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2017&lt;/span&gt;

&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yearB&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;yearA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yearB&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;yearA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yearB&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;yearA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Seems OK, but a little bit weird, right? But, opps, it absolutely wrong.&lt;/p&gt;
&lt;p&gt;For example,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mi"&gt;2001&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2002&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2003&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;@2004&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2005&lt;/span&gt;   &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lear_year&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;@2000&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2001&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2002&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2003&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;@2004&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;leap_year&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The right way is using a &lt;code&gt;ceil&lt;/code&gt; way to adjust yearA to the nearest greater leap year.&lt;/p&gt;
&lt;p&gt;And then we deal with other details to make everything right.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cmath&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x &lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;months&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;January&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;February&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;March&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;April&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;May&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;June&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;July&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;August&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;September&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;October&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;November&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="s"&gt;&amp;quot;December&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Date&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;iyy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;imm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;idd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iyy&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imm&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;months&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="nf"&gt;year_diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;aa&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;bb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;aa&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;bb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bb&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;aa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;aa&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;99&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;bb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;aa&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;bb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bb&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;aa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;aa&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;399&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;bb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;aa&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;bb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bb&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;aa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;is_leap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;year_diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;is_leap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;is_leap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dd&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;is_leap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;da&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dd&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;mm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Date&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Case #%d: %lld&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. å›æ–‡å­—ç¬¦åºåˆ—(Palindrome Subsequences)&lt;/h2&gt;
&lt;h3&gt;Description&lt;/h3&gt;
&lt;p&gt;Given a string, try to count how many subsequences there are palindromes.&lt;/p&gt;
&lt;p&gt;For example, for the string "aba", the palindrome subsequences are: "a", "a", "aa", "b", "aba".&lt;/p&gt;
&lt;h3&gt;Solution&lt;/h3&gt;
&lt;p&gt;Let's simplify the problem. (Of course, the simple one always comes the first.)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;How many substring there are palindromes?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This one is a more populare problem which can be solved with an &lt;code&gt;O(n^2)&lt;/code&gt; DP algorithm.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;dp[i][j] = (str[i] == str[j] &amp;amp;&amp;amp; dp[i - 1][j - 1])
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If &lt;code&gt;dp[i][j]&lt;/code&gt; equals to one, it means that the substring &lt;code&gt;str[i:j + 1]&lt;/code&gt; is a palindrome, vice versa.&lt;/p&gt;
&lt;p&gt;For this problem, things are quite similar. If there are some palindrome subsequences at &lt;code&gt;str[i - 1: j]&lt;/code&gt;, and at the same time &lt;code&gt;str[i] == str[j]&lt;/code&gt;, that is, there must be one or more palindrome subsequences at &lt;code&gt;str[i:j + 1]&lt;/code&gt; and these subsequences contain &lt;code&gt;str[i]&lt;/code&gt; and &lt;code&gt;str[j]&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;That is the basic idea of the problem, and the DP formula is like this. You can consider why.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
    &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Be ware, the result need to be module by 100007. As we have minus in the DP formula, don't forget there are possibility that &lt;code&gt;dp[i][j] &amp;lt; 0&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// This is actually the solution for HDU 4632, which is similar to this problem.&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10007&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;do_mod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;do_mod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                    &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;do_mod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                    &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Case %d: %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C.åŸºç«™é€‰å€(Base Station Locationing)&lt;/h2&gt;
&lt;h3&gt;Description&lt;/h3&gt;
&lt;p&gt;Given a N Ã— M grid which contain A user and B communications companies, and &lt;strong&gt;one single&lt;/strong&gt; base station.&lt;/p&gt;
&lt;p&gt;The cost of communication between users and base station is defined as the square of the Euclidean distance.&lt;/p&gt;
&lt;p&gt;The cost for the companies to maintain the base station is defined as the minimal Manhattan distance between the station and all the communications companies.&lt;/p&gt;
&lt;h3&gt;Solution&lt;/h3&gt;
&lt;p&gt;All we have to do is to find the minimal distance with that formula.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/611be1334aab00954c56e31af0bc0cc4" /&gt;&lt;/p&gt;
&lt;p&gt;It's easy to see that we can deal with the x-axis and y-axis separately&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/2bffa65945d689235e602935d782256b" /&gt;.&lt;/p&gt;
&lt;p&gt;We can learn something from the quadratic equation like formula. And of course, we minimum value is near &lt;code&gt;sum(xa[i]) / A&lt;/code&gt;. This is same with the y-axis. As a result, we can check the grid near &lt;code&gt;&amp;lt;sum(xa[i]) / A, sum(ya[i]) / A&amp;gt;&lt;/code&gt;, to see if there is a minimum cost for the communication.&lt;/p&gt;
&lt;p&gt;I don't want to write the code here because it's easy if you know the basis of the algorithm and it's too late now. I'm gonna to have a diet pepsi, and say good night for all you guys.&lt;/p&gt;
&lt;p&gt;Lazy guy, indeed. :)&lt;/p&gt;</summary><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category><category term="Microsoft"></category></entry><entry><title>GCJ Qualification Round 2015 é¢˜è§£</title><link href="http://wizmann.tk/gcj-qualification-round-2015-tutorial.html" rel="alternate"></link><updated>2015-04-12T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-04-12:gcj-qualification-round-2015-tutorial.html</id><summary type="html">&lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;è¿™ç¯‡æ—¥å¿—ç”¨ä¸­æ–‡å†™æ˜¯å› ä¸ºæƒ³çœç‚¹æ—¶é—´æ‰“æ¸¸æˆã€‚ã€‚ã€‚ï¼ˆè¯·é„™è§†æˆ‘å§ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2&gt;A. Standing Ovation&lt;/h2&gt;
&lt;h3&gt;é¢˜æ„&lt;/h3&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéª—æŒå£°çš„æ•…äº‹ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ¼”å‡ºç»“æŸåï¼Œè§‚ä¼—ä»¬è¦ç«™èµ·æ¥é¼“æŒã€‚ä½†æ˜¯æœ‰äº›è§‚ä¼—æ¯”è¾ƒç¾æ¶©ï¼Œåªæœ‰åœ¨kä¸ªäººç«™èµ·æ¥é¼“æŒåæ‰ä¼šæ•…éšœã€‚&lt;/p&gt;
&lt;p&gt;ä½ çš„ç›®æ ‡æ˜¯åœ¨è§‚ä¼—ä¸­å®‰æ’ä¸€äº›å§åº•é¢†æŒï¼Œè®©æ‰€æœ‰è§‚ä¼—éƒ½ç«™èµ·æ¥é¼“æŒã€‚ï¼ˆè‡­ä¸è¦è„¸ï¼‰&lt;/p&gt;
&lt;p&gt;æ±‚æœ€å°‘çš„å§åº•æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;æ•°æ®è§„æ¨¡&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æŠ›å¼€æ•°æ®è§„æ¨¡è°ˆè§£é¢˜ï¼Œéƒ½æ˜¯TMè€æµæ°“ã€‚ â€”â€” Wizmann&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;100ç»„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å°æ•°æ®é›†ï¼Œè§‚ä¼—ç¾æ¶©å€¼çš„èŒƒå›´ï¼š0 â‰¤ Smax â‰¤ 6.&lt;/p&gt;
&lt;p&gt;å¤§æ•°æ®é›†ï¼Œè§‚ä¼—ç¾æ¶©å€¼çš„èŒƒå›´ï¼š0 â‰¤ Smax â‰¤ 1000.&lt;/p&gt;
&lt;h3&gt;è§£é¢˜&lt;/h3&gt;
&lt;p&gt;æœ¬é¢˜æ¯”è¾ƒç®€å•ã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯æš´åŠ›æšä¸¾ï¼Œå› ä¸ºå¤§æ•°æ®é›†ä¸­ï¼Œè§‚ä¼—ç¾æ¶©å€¼æœ€å¤§åªä¸º1000,å³æœ€å¤§å®‰æ’å§åº•æ•°ä¸è¶…è¿‡1000ã€‚(å½“ç„¶ï¼ŒäºŒåˆ†ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡å¯¹äº1000çš„æ•°æ®é›†ï¼ŒçœŸå¿ƒæ²¡å•¥å¿…è¦ã€‚)&lt;/p&gt;
&lt;p&gt;äºŒæ˜¯O(N)çš„ä¸€ä¸ªéå†ï¼Œåœ¨è§‚ä¼—ç¾æ¶©çš„ä¸æƒ³é¼“æŒæ—¶ï¼Œå®‰æ’ç›¸åº”æ•°é‡çš„å§åº•ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜æ¨èæ–¹æ³•ä¸€ã€‚å› ä¸ºä¸ªäººæ„Ÿè§‰ï¼Œåœ¨ç¼–ç¨‹ç«èµ›ä¸­ï¼Œåœ¨æ—¶é™å’Œç©ºé—´å…è®¸çš„æƒ…å†µä¸‹ï¼Œå°½é‡è®©æ–¹æ³•ç®€å•åŒ–ã€‚è¿™æ ·ä¸å®¹æ˜“å‡ºé”™ã€‚ä½†æ˜¯åœ¨è¦ä½“ç°é€¼æ ¼çš„æ—¶å€™ï¼Œå°½é‡â€œä¼˜åŒ–â€ä½ çš„ä»£ç ï¼Œæå‡æ€è€ƒå¤æ‚åº¦æ¥æ¢å–å°½å¯èƒ½å¤šçš„ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aud&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;aud&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aud&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;stand&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aud&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aud&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;stand&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;stand&lt;/span&gt;
            &lt;span class="n"&gt;stand&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;
        &lt;span class="n"&gt;stand&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;

&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Case #&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt;: &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Infinite House of Pancakes&lt;/h2&gt;
&lt;h3&gt;é¢˜æ„&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªå®´ä¼šå…ä¸­ï¼ˆæƒ³åˆ°äº†â€œç±³é˜¿çš„å®´ä¼šå…â€)ï¼Œæœ‰æ— é™çš„å®¢äººï¼Œä½†æ˜¯åªæœ‰æœ‰é™çš„ç…é¥¼ã€‚ä½ çš„ç›®æ ‡æ˜¯è®©æ‰€æœ‰å®¢äººå°½å¯èƒ½å¿«çš„åƒå®Œæ‰€æœ‰çš„ç…é¥¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå®¢äººåœ¨ä¸€ä¸ªå•ä½æ—¶é—´åªèƒ½åƒä¸€å—ç…é¥¼ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªå•ä½æ—¶é—´å†…ï¼Œè°ƒæ•´ä¸€ä¸ªå®¢äººçš„ç…é¥¼ï¼Œå³æŠŠä»–çš„ç…é¥¼ç»™åˆ«äººã€‚&lt;/p&gt;
&lt;p&gt;æ±‚æ‰€æœ‰å®¢äººåƒå®Œæ‰€æœ‰ç…é¥¼çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;'Here comes Mia, daughter of none!'  &lt;br /&gt;
-- &lt;em&gt;The Dark Tower V: Wolves of the Calla&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;æ•°æ®è§„æ¨¡&lt;/h3&gt;
&lt;p&gt;100ç»„æµ‹è¯•æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;Dä¸ºæœ‰ç…é¥¼çš„å®¢äººçš„æ•°ç›®ã€‚Piä¸ºå®¢äººæ‹¥æœ‰ç…é¥¼çš„æœ€å¤§å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å°æ•°æ®ï¼š  &lt;br /&gt;
1 â‰¤ D â‰¤ 6. &lt;br /&gt;
1 â‰¤ Pi â‰¤ 9.&lt;/p&gt;
&lt;p&gt;å¤§æ•°æ®ï¼š  &lt;br /&gt;
1 â‰¤ D â‰¤ 1000. &lt;br /&gt;
1 â‰¤ Pi â‰¤ 1000.&lt;/p&gt;
&lt;h3&gt;è§£é¢˜&lt;/h3&gt;
&lt;p&gt;ä¸€å¼€å§‹æƒ³ç”¨äºŒåˆ†åšã€‚ä½†æ˜¯è¿™é“é¢˜å¹¶ä¸èƒ½æ»¡è¶³äºŒåˆ†çš„æ¡ä»¶ã€‚å› ä¸ºæ— è®ºæ˜¯äºŒåˆ†æ—¶é—´è¿˜æ˜¯äºŒåˆ†æœ€å¤§ç…é¥¼æ•°ï¼Œå®¢äººéƒ½å¯ä»¥åƒå®Œç…é¥¼ï¼Œè¿™æ ·çš„äºŒåˆ†æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¢ä¸ªæ€è·¯ï¼Œåœ¨åƒç…é¥¼å‰ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ‰€æœ‰å®¢äººçš„ç…é¥¼æ•°è¿›è¡Œè°ƒæ•´ã€‚åˆç”±äºå®¢äººçš„æ•°ç›®æ˜¯æ— é™å¤šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è°ƒæ•´å°±æ˜¯&lt;strong&gt;æŠŠç…é¥¼é€ç»™æ²¡æœ‰ç…é¥¼çš„å®¢äºº&lt;/strong&gt;ã€‚è°ƒæ•´çš„ç›®æ ‡æ˜¯&lt;strong&gt;è®©ç…é¥¼æ•°å°½é‡å¹³å‡&lt;/strong&gt;ï¼ˆâ€œå°½é‡â€å’Œâ€œå°½å¯èƒ½â€æ˜¯ä¸åŒçš„ï¼Œâ€œå°½é‡â€çš„èŒƒå›´æ›´å®½èŒƒä¸€äº›ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ï¼Œæˆ‘ä»¬å°è¯•æšä¸¾â€œè°ƒæ•´åçš„æœ€å¤§ç…é¥¼æ•°é‡â€ã€‚é€šè¿‡æšä¸¾è¿™ä¸ªå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°â€œè°ƒæ•´ç…é¥¼æ—¶é—´ + åƒç…é¥¼æ—¶é—´â€ã€‚åˆç”±äºæ•°æ®è§„æ¨¡æ¯”è¾ƒå°ï¼Œæèµ·æ¥ä¸æ˜¯å¾ˆå›°éš¾ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;set&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;233&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;233&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;num&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nl"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;


        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Case #%d: %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Dijkstra&lt;/h2&gt;
&lt;h3&gt;é¢˜æ„&lt;/h3&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªä»£æ•°ç³»ç»Ÿï¼ˆå¯ä»¥è¿™ä¹ˆè¯´å§ï¼‰ï¼ŒåŒ…æ‹¬â€œ1, i, j, kâ€ã€‚&lt;/p&gt;
&lt;p&gt;å·²çŸ¥å®ƒä»¬çš„è¿ç®—è§„å¾‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/ba89abba98064a7e42e52e9e5b2de57f" /&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œæœ‰ä¸€ä¸ªåŒ…å«"i, j, k"çš„è¿ä¹˜å¼ã€‚å®ƒæ˜¯ç”±ä¸€æ®µè¿ä¹˜å¼é‡å¤Xéå¾—å‡ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;é—®ï¼Œèƒ½å¦æŠŠå®ƒè½¬åŒ–ä¸º&lt;code&gt;i * j * k&lt;/code&gt;çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;h3&gt;æ•°æ®è§„æ¨¡&lt;/h3&gt;
&lt;p&gt;æµ‹è¯•ç»„æ•°ï¼š 1 â‰¤ T â‰¤ 100.   &lt;br /&gt;
ç»™å‡ºçš„è¿ä¹˜å¼é•¿åº¦ï¼š 1 â‰¤ L â‰¤ 10000.     &lt;/p&gt;
&lt;p&gt;è¿ä¹˜å¼çš„é‡å¤æ¬¡æ•°ä¸ºXã€‚&lt;/p&gt;
&lt;p&gt;å°æ•°æ®é›†ï¼š  &lt;br /&gt;
1 â‰¤ X â‰¤ 10000.   &lt;br /&gt;
1 â‰¤ L * X â‰¤ 10000.     &lt;/p&gt;
&lt;p&gt;å¤§æ•°æ®é›†ï¼š &lt;br /&gt;
1 â‰¤ X â‰¤ 10^12.  &lt;br /&gt;
1 â‰¤ L * X â‰¤ 10^16.    &lt;/p&gt;
&lt;h3&gt;è§£é¢˜&lt;/h3&gt;
&lt;p&gt;é¢˜ä¸­ç»™å‡ºäº†ä¹˜æ³•çš„è§„å¾‹ã€‚æˆ‘ä»¬ä¸éš¾ä»ä¸­æ¨æµ‹å‡ºé™¤æ³•çš„è§„å¾‹ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬å·²ç»æŠŠè¿ä¹˜å¼è½¬åŒ–ä¸º&lt;code&gt;i * j&lt;/code&gt;çš„å½¢å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠå‰©ä¸‹çš„éƒ¨åˆ†è½¬åŒ–ä¸ºæ•°å­—&lt;code&gt;k&lt;/code&gt;ï¼Œå³å¯æ»¡è¶³é¢˜æ„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å»æ€è€ƒè½¬åŒ–çš„è¿‡ç¨‹ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€†å‘æ€è€ƒï¼Œå»æ€è€ƒè½¬åŒ–åçš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œ&lt;code&gt;i * j * k == -1&lt;/code&gt;ï¼Œå½“æˆ‘ä»¬æŠŠå‰è¾è½¬åŒ–ä¸º&lt;code&gt;i * j&lt;/code&gt;çš„å½¢å¼åï¼Œå¦‚æœåˆ¤æ–­æ•´ä¸ªè¿ä¹˜å¼çš„ç»“æœä¸º&lt;code&gt;-1&lt;/code&gt;ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ–­å®šï¼Œè¯¥è¿ä¹˜å¼å¯ä»¥è½¬åŒ–ä¸º&lt;code&gt;i * j * k&lt;/code&gt;çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;iä¸jçš„è½¬åŒ–æ˜¯ç±»ä¼¼çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼ŒO(N)çš„ç®—æ³•æ˜¯æ— æ³•é€šè¿‡å¤§æ•°æ®é›†çš„ã€‚å› ä¸ºï¼Œè¿ä¹˜å¼æ˜¯å¾ªç¯çš„ï¼Œæ€»é•¿åº¦å¯èƒ½ä¼šéå¸¸é•¿ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»§ç»­ä½¿ç”¨åŒæ ·çš„æ€è·¯ã€‚å¦‚æœæˆ‘ä»¬æœ‰äº†iå’Œjï¼Œå½“æ•´ä½“è¿ä¹˜å¼ä¹‹ç§¯ä¸º&lt;code&gt;-1&lt;/code&gt;æ—¶ï¼Œå³æ–­å®šæ»¡è¶³æ¡ä»¶ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å¿«é€Ÿå¹‚ç®—æ³•ï¼Œç›´æ¥è®¡ç®—å¾ªç¯èŠ‚çš„ä¹˜ç§¯ã€‚å¤æ‚åº¦ä¸º&lt;code&gt;O(L) + O(logX)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºiå’Œjï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è€ƒè™‘ã€‚å¾ªç¯èŠ‚ä¹‹ç§¯åªæœ‰ä»¥ä¸‹å‡ ç§å¯èƒ½ï¼š&lt;code&gt;Â±1, Â±i, Â±j, Â±k&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="the table" src="http://wizmann-pic.qiniudn.com/252e0e81143f2dd5cb6e01e1e69d0709" /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¯¹äº&lt;code&gt;1, i, j, k&lt;/code&gt;ï¼Œä¹˜æ³•éƒ½æ˜¯æœ‰ä¸€ä¸ªå¾ªç¯èŠ‚çš„ã€‚è¿™é‡Œä¸éœ€è¦å®šé‡åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ–­å®šï¼Œå¦‚æœåœ¨ä¸€å®šçš„å¾ªç¯èŠ‚ä¸­ï¼Œä¸èƒ½æŠŠç®—å¼è½¬åŒ–ä¸º&lt;code&gt;i * j&lt;/code&gt;çš„å½¢å¼ï¼Œé‚£ä¹ˆå°±ä¸å¯èƒ½è½¬åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;
&lt;span class="cp"&gt;#define error(x) cerr &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12345&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;ONE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;II&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;JJ&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;KK&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;trans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ONE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;II&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;JJ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;KK&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;II&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ONE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;JJ&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JJ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;KK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ONE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;II&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;JJ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;II&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ONE&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;conv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ONE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;i&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;II&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;j&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;JJ&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;KK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Number&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;sign&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;isign&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ivalue&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;isign&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ivalue&lt;/span&gt;&lt;span class="p"&gt;){}&lt;/span&gt;

    &lt;span class="n"&gt;Number&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;_word&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;get_whole&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Number&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;_word&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;Number&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;ONE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_word&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19LL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;_word&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;Number&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;jj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;kk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_whole&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;II&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;KK&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;jj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;kk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kk&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;jj&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Case #%d: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cas&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kk&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;YES&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;19&lt;/code&gt;æ˜¯ä¸€ä¸ªmagic numberã€‚è¿˜æœ‰ï¼Œå°å¿ƒ&lt;del&gt;Dandelo&lt;/del&gt;æ•°æ®è¶…intã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/625c5bb804b76545978bcb11310099a6" /&gt;&lt;/p&gt;
&lt;h2&gt;D. Ominous Omino&lt;/h2&gt;
&lt;p&gt;å……æ»¡ç„å­¦çš„ä¸€é¢˜ã€‚ç½‘ä¸Šçœ‹åˆ°çš„æœ€ç²¾å½©çš„é¢˜è§£æ˜¯äººå·¥æ¨¡æ‹Ÿå‡ºäº†æ‰€æœ‰å¯èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è§‰å¾—åƒæˆ‘è¿™ç§å†…å­˜å°çš„äººï¼Œä¼°è®¡æ˜¯æƒ³ä¸å‡ºæ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;è²Œä¼¼ä¹Ÿæœ‰äººç”¨æ¨¡æ‹Ÿã€‚ã€‚ã€‚æˆ‘è§‰å¾—ã€‚ã€‚ã€‚å¯èƒ½ä¼šæœ‰æ›´ä¼˜é›…çš„æ–¹æ³•ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜è§£åœ¨&lt;a href="http://www.huangwenchao.com.cn/2015/04/gcj-2015-qual-d.html"&gt;è¿™é‡Œ&lt;/a&gt;ï¼ŒçœŸå¿ƒæ˜¯ç»™è·ªäº†ã€‚&lt;/p&gt;</summary><category term="GCJ"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category><category term="google"></category></entry><entry><title>ZeroMQå¯ç¤ºå½•</title><link href="http://wizmann.tk/inspiration-from-zeromq.html" rel="alternate"></link><updated>2015-04-07T10:01:34+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-04-07:inspiration-from-zeromq.html</id><summary type="html">&lt;h2&gt;Ã˜MQæ˜¯ä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿ&lt;/h2&gt;
&lt;p&gt;ZeroMQæ˜¯ä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿï¼Œä¹Ÿè¢«ç§°ä¸ºâ€œæ¶ˆæ¯ä¸­é—´ä»¶â€ã€‚å®ƒè¢«å¹¿æ³›çš„ç”¨äºç»æµã€æ¸¸æˆã€åµŒå…¥å¼ç­‰é¢†åŸŸã€‚&lt;/p&gt;
&lt;h3&gt;ä»€ä¹ˆæ˜¯æ¶ˆæ¯ç³»ç»Ÿ&lt;/h3&gt;
&lt;p&gt;æ‰“ä¸ªæ¯”æ–¹ï¼Œæ¶ˆæ¯ç³»ç»Ÿå°±åƒæˆ‘ä»¬ä½¿ç”¨çš„IMè½¯ä»¶ä¸€æ ·ã€‚é¦–å…ˆï¼Œä¸€æ–¹å†³å®šå°†æ¶ˆæ¯å‘å¾€ä½•å¤„ï¼ˆä¸€å¯¹ä¸€æˆ–ä¸€å¯¹å¤šï¼‰ã€‚ç„¶åå°†ä¿¡æ¯æ‰“åŒ…ï¼Œç‚¹å‡»å‘é€æŒ‰é’®ã€‚ä¹‹åï¼ŒIMç³»ç»Ÿä¼šå¸®ä½ æ–™ç†å‰©ä½™çš„äº‹åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå®ƒä»¬ä¹Ÿæœ‰å¾ˆå¤§çš„ä¸åŒç‚¹ã€‚IMç³»ç»Ÿå¯¹äºæ¶ˆæ¯ç³»ç»Ÿä¼¼ä¹å¤ªä½æ•ˆäº†ä¸€ç‚¹ã€‚å¦å¤–ï¼Œæ¶ˆæ¯ç³»ç»Ÿæ˜¯æ²¡æœ‰ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰çš„ã€‚åœ¨é”™è¯¯å‘ç”Ÿæ—¶ï¼Œæ¶ˆæ¯çš„å¦ä¸€ç«¯ä¹Ÿä¸ä¼šæœ‰äººæ¥æ™ºèƒ½çš„ä»‹å…¥å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä¸‹å®šä¹‰ã€‚æ¶ˆæ¯ç³»ç»Ÿæ˜¯å…·æœ‰é«˜æ•ˆæ€§å’Œå®¹é”™æ€§çš„æ¶ˆæ¯ä¼ é€’è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h3&gt;ZeroMQçš„èµ·æºå’Œå‘å±•&lt;/h3&gt;
&lt;p&gt;ZeroMQæœ€å…ˆçš„è®¾æƒ³æ˜¯å®ç°ä¸€ä¸ªç‚’é¸¡å¿«çš„ç”¨äºè¯åˆ¸äº¤æ˜“çš„æ¶ˆæ¯ç³»ç»Ÿï¼Œæ‰€ä»¥åœ¨è®¾è®¡åˆæœŸçš„å…³æ³¨ç‚¹å°±æ˜¯åœ¨æè‡´çš„ä¼˜åŒ–ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€å¹´çš„å·¥ä½œé‡ç‚¹ï¼Œåœ¨äºå‘æ˜æ€§èƒ½æµ‹è¯•çš„æ–¹æ³•ï¼Œå’Œè®¾è®¡é«˜æ•ˆæ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åï¼Œå¤§çº¦åœ¨ç¬¬äºŒå¹´ï¼Œå·¥ä½œé‡ç‚¹è½¬ç§»åˆ°å®ç°ä¸€ä¸ªé€šç”¨çš„æ¶ˆæ¯ç³»ç»Ÿï¼Œä»¥åº”ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä½¿å…¶å¯ä»¥åˆ©ç”¨&lt;strong&gt;ä¸åŒçš„ç¼–ç¨‹è¯­è¨€&lt;/strong&gt;ï¼Œä½¿ç”¨&lt;strong&gt;ä¸åŒæ–¹å¼&lt;/strong&gt;ï¼Œæ¥ä¼ é€’&lt;strong&gt;å„ç§æ¨¡å¼&lt;/strong&gt;çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º1ï¼šç‹¬ç«‹åº”ç”¨ vs. ç¨‹åºåº“&lt;/h2&gt;
&lt;p&gt;ZeroMQæ˜¯ä¸€ä¸ªç¨‹åºåº“ï¼Œä¸æ˜¯ä¸€ä¸ªæ¶ˆæ¯æœåŠ¡å™¨ã€‚è¿™æ ·è®¾è®¡çš„ä¸»è¦åŸå› æ˜¯ï¼šæ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸€ä¸ªä¸­é—´æ¶ˆæ¯æœåŠ¡å™¨ï¼ˆBrokerï¼‰ï¼Œæ¯ä¸€æ¡æ¶ˆæ¯éƒ½ä¼šè¢«åœ¨ç½‘ç»œä¸Šä¼ é€’ä¸¤æ¬¡ï¼ˆSender-&amp;gt;Broker-&amp;gt;Receiver)ã€‚è¿™æ ·çš„è®¾è®¡ä¼šå½±å“æ—¶å»¶å’Œååé‡ã€‚æ›´ä¸¥é‡çš„æ˜¯ï¼Œå¦‚æœæ‰€æœ‰æ¶ˆæ¯éƒ½é€šè¿‡ä¸­é—´æœåŠ¡å™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹å°±ä¼šæˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸­é—´æ¶ˆæ¯æœåŠ¡å™¨çš„å¦ä¸€ä¸ªå¼Šç«¯ï¼Œæ˜¯ä¸åˆ©äºå¤§è§„æ¨¡éƒ¨ç½²ã€‚å¯¹äºè¯åˆ¸äº¤æ˜“æ¥è¯´ï¼ˆZeroMQæœ€åˆçš„åº”ç”¨åœºæ™¯ï¼‰ï¼Œè·¨ç»„ç»‡çš„æ¶ˆæ¯ä¼ è¾“æ˜¯ä¸å¯é¿å…çš„ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸­å¤®é›†æƒå¼çš„æ¶ˆæ¯ä¼ è¾“å°±ä¸åœ¨æœ‰æ•ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬ç¼©å°æ¶ˆæ¯ç³»ç»Ÿçš„ç²’åº¦ï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªç¨‹åºåº“ã€‚ä½¿å…¶æ›´è½»é‡ï¼Œæ›´æ˜“äºéƒ¨ç½²ã€‚åŒæ ·ï¼Œæ›´è½»é‡çš„æ¶ˆæ¯ç³»ç»Ÿå¯ä»¥å®ç°æ›´å¤æ‚çš„æ‹“æ‰‘ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šå¯¹äºä¸€ä¸ªæ–°é¡¹ç›®æ¥è¯´ï¼Œå¦‚æœå¯èƒ½ï¼Œå°½é‡æŠŠå®ƒå®ç°ä¸ºä¸€ä¸ªç¨‹åºåº“ã€‚å°†ä¸€ä¸ªæ–°åº“è”ç¼–åˆ°åŸæœ‰ç¨‹åºä¸­ï¼Œåªéœ€è¦å°‘é‡çš„äººåŠ›ï¼Œä¹Ÿæä¾›äº†è¶³å¤Ÿçš„çµæ´»æ€§ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º2ï¼šå…¨å±€çŠ¶æ€&lt;/h2&gt;
&lt;p&gt;å¯¹äºç¨‹åºåº“æ¥è¯´ï¼Œå…¨å±€çŠ¶æ€å¾€å¾€ä¸èƒ½æ­£ç¡®çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºä¸€ä¸ªç¨‹åºåº“å¯èƒ½è¢«ä¸€ä¸ªåº”ç”¨ç¨‹åºåŠ è½½å¤šæ¬¡ï¼Œè¿™å°±ä¸èƒ½ä¿è¯åªæœ‰ç‹¬ä¸€æ— äºŒçš„å…¨å±€çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;ZeroMQçš„è§£å†³æ–¹æ³•æ˜¯ç”±åº“çš„è°ƒç”¨è€…æ˜¾å¼çš„ç»´æŠ¤ä¸€ä¸ªâ€œç¯å¢ƒâ€ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚&lt;code&gt;libA&lt;/code&gt;å’Œ&lt;code&gt;libB&lt;/code&gt;éƒ½æœ‰å…¶ç‹¬æœ‰çš„â€œç¯å¢ƒâ€ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/71080471bf8bbf4d4e186c353d6b512c" /&gt;&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šä¸è¦åœ¨ç¨‹åºåº“ä¸­ä½¿ç”¨å…¨å±€çŠ¶æ€ã€‚å¦‚æœä½ è¿™ä¹ˆåšäº†ï¼Œå½“åº“æ°å¥½éœ€è¦åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­å®ä¾‹åŒ–ä¸¤æ¬¡æ—¶ï¼Œå®ƒå¾ˆå¯èƒ½ä¼šå´©æºƒã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º3ï¼šæ€§èƒ½&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/4ae6721a94012d877709075558562f2b" /&gt;&lt;/p&gt;
&lt;p&gt;ZeroMQåœ¨æœ€åˆè®¾è®¡æ—¶ï¼Œæ€§èƒ½è°ƒä¼˜å°±æ˜¯é¦–è¦çš„ç›®æ ‡ã€‚åšä¸ºä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿï¼Œå…¶æ€§èƒ½æŒ‡æ ‡ä¸»è¦æœ‰ä¸¤ä¸ªï¼šååé‡å’Œå»¶æ—¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆåº¦é‡å®ƒä»¬å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒAå‘Bå‘é€ä¿¡æ¯ã€‚Båœ¨6ç§’å†…æ¥æ”¶åˆ°äº†5æ¡ä¿¡æ¯ï¼Œå› æ­¤ååé‡ä¸º0.83æ¶ˆæ¯/ç§’ï¼Œå¹³å‡æ—¶å»¶ä¸º1.2ç§’ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æ¢ä¸€ç§è®¡é‡æ–¹å¼ï¼ŒAå‘Bå‘é€æ¶ˆæ¯ï¼Œå¯¹äºå•æ¡ä¿¡æ¯æ¥è¯´ï¼Œå…¶å¹³å‡æ—¶å»¶ä¸º3ç§’ã€‚AèŠ±è´¹2ç§’ï¼Œå‘é€äº†æ‰€æœ‰çš„æ¶ˆæ¯ï¼›BèŠ±è´¹äº†4ç§’ï¼Œæ¥æ”¶åˆ°äº†æ‰€æœ‰çš„æ¶ˆæ¯ã€‚æ‰€ä»¥Açš„ååé‡ä¸º2.5æ¶ˆæ¯/ç§’ï¼ŒBçš„ååé‡ä¸º1.25æ¶ˆæ¯/ç§’ã€‚è¿™ä¸ªæ•°æ®ä¸æˆ‘ä»¬ä¸Šé¢å¾—å‡ºçš„æ•°æ®ç›¸å·®ç”šè¿œã€‚&lt;/p&gt;
&lt;p&gt;ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨ä¸åŒçš„è®¡é‡æ ‡å‡†ï¼Œå¯¹äºæˆ‘ä»¬ä¼°è®¡ç³»ç»Ÿçš„æ€§èƒ½ï¼Œä¼šå¸¦æ¥å¾ˆå¤§çš„ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;æ—¶å»¶åªæœ‰åœ¨ä¸¤ä¸ªèŠ‚ç‚¹é€šä¿¡æ—¶ï¼Œæ‰å¯èƒ½å‘ç”Ÿã€‚æ‰€ä»¥ï¼Œå¹¶ä¸èƒ½æœ‰â€œæŸèŠ‚ç‚¹çš„æ—¶å»¶â€è¿™ç§åº¦é‡æ ‡å‡†çš„å‡ºç°ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¤šæ¡æ¶ˆæ¯çš„æ—¶å»¶è¿›è¡Œå¹³å‡ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æœ‰â€œä¸€ä¸ªæ¶ˆæ¯æµçš„å¹³å‡æ—¶å»¶â€ã€‚&lt;/p&gt;
&lt;p&gt;ååé‡ï¼Œä¸æ—¶å»¶ä¸åŒï¼Œåªèƒ½åœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šè¿›è¡Œåº¦é‡ã€‚æ‰€ä»¥ï¼Œå¹¶ä¸èƒ½æœ‰â€œèŠ‚ç‚¹é—´çš„ååé‡â€è¿™ç§åº¦é‡æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šæ·±å…¥äº†è§£ä½ æ‰€è¦è§£å†³çš„é—®é¢˜ã€‚å¦åˆ™ï¼Œä½ ä¼šåœ¨è§£å†³é—®é¢˜æ—¶ä¼šå¼•å…¥ï¼ˆé”™è¯¯çš„ï¼‰å‡å®šå’Œç„å­¦ï¼Œå†™å‡ºæœ‰ç¼ºé™·çš„å¤æ‚ä»£ç ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º4ï¼šå…³é”®è·¯å¾„&lt;/h2&gt;
&lt;p&gt;ä»£ç ä¸­ç»å¸¸è¢«è°ƒç”¨çš„ä»£ç ï¼Œè¢«ç§°ä¸º&lt;strong&gt;å…³é”®è·¯å¾„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºZeroMQæ¥è¯´ï¼Œå»ºç«‹é“¾æ¥ä¸å†…å­˜ç”³è¯·éƒ½ä¸æ˜¯å½±å“æ€§èƒ½çš„æœ€ä¸»è¦å› ç´ ã€‚å› ä¸ºZeroMQä½¿ç”¨é•¿é“¾æ¥è¿›è¡Œé€šä¿¡ï¼Œæ‰€ä»¥å»ºç«‹é“¾æ¥çš„å¼€é”€å‡æ‘Šåˆ°æ¯ä¸€æ¡ä¿¡æ¯å¾®ä¹å…¶å¾®ã€‚åŒæ ·ï¼ŒZeroMQä½¿ç”¨é«˜æ•ˆçš„å†…å­˜ç»´æŠ¤æœºåˆ¶ï¼Œå°½å¯èƒ½å°‘çš„å‘ç³»ç»Ÿç›´æ¥ç”³è¯·å†…å­˜ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šåªåœ¨ç³»ç»Ÿçš„å…³é”®è·¯å¾„ä¸Šåšä¼˜åŒ–ã€‚å¦åˆ™åªæ˜¯æµªè´¹æ—¶é—´ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º5ï¼šå†…å­˜ç”³è¯·&lt;/h2&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªé«˜æ•ˆçš„ç³»ç»Ÿæ¥è¯´ï¼Œé«˜æ•ˆçš„å¤„ç†å†…å­˜çš„æ–¹æ³•å¾€å¾€æ˜¯åœ¨å†…å­˜ç”³è¯·ä¸å†…å­˜æ‹·è´ä¹‹é—´å¯»æ±‚ä¸€ä¸ªå¹³è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå°å‹æ•°æ®æ¥è¯´ï¼Œç›´æ¥æ‹·è´æ•°æ®ï¼Œå³â€œæ·±æ‹·è´â€ï¼Œçš„å¼€é”€æ›´å°ã€‚è€Œå¯¹äºå¤§å‹æ•°æ®æ¥è¯´ï¼Œæ‰€è°“â€œæµ…æ‹·è´â€çš„å¼€é”€æ›´å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/48deb1742653d61ba04f6e9591f71902" /&gt;&lt;/p&gt;
&lt;p&gt;ZeroMQä½¿ç”¨é€æ˜çš„æ–¹å¼æ¥å¤„ç†ä¸¤ç§ä¸åŒçš„åœºæ™¯ã€‚å¹¶ä¸”ï¼Œå¯¹äºè§„æ¨¡è¾ƒå¤§çš„æ•°æ®ï¼Œä½¿ç”¨å¼•ç”¨è®¡æ•°çš„ç­–ç•¥ï¼Œæœ€å¤§é™åº¦çš„å¤ç”¨ä¸èŠ‚çœå†…å­˜ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šå½“æˆ‘ä»¬ä¼˜åŒ–æ€§èƒ½æ—¶ï¼Œä¸è¦å‡å®šåªæœ‰ä¸€ä¸ªå…¨å±€æœ€ä¼˜è§£ã€‚åœ¨ä¸åŒçš„åœºæ™¯ä¸‹ï¼Œæœ€ä¼˜è§£çš„å®šä¹‰å¯èƒ½å¤§ä¸ç›¸åŒã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º6ï¼šæ‰¹å¤„ç†&lt;/h2&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªé«˜æ€§èƒ½æ¶ˆæ¯ç³»ç»Ÿæ¥è¯´ï¼Œç³»ç»Ÿè°ƒç”¨çš„ç»å¯¹æ•°é‡å°±æ˜¯ç³»ç»Ÿçš„ç“¶é¢ˆã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªå¾ˆæ™®éçš„é—®é¢˜ï¼Œæ¶ˆæ¯åœ¨è°ƒç”¨æ ˆä¹‹é—´ä¼ é€’ï¼Œä¼šå¸¦æ¥ä¸å¯å¿½ç•¥çš„æ€§èƒ½æŸå¤±ã€‚æ‰€ä»¥ï¼Œåœ¨æ„å»ºä¸€ä¸ªé«˜æ€§èƒ½ç³»ç»Ÿæ—¶ï¼Œåº”è¯¥å°½é‡é¿å…æ¶ˆæ¯åœ¨æ ˆé—´çš„ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯¹äºå››æ¡æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦éå†æ•´ä¸ªç½‘ç»œæ ˆå››æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/b99f65135b0f0e840131c58d2cc57896" /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™äº›æ¶ˆæ¯æ‰“åŒ…æˆä¸€æ¡æ¶ˆæ¯ã€‚æˆ‘ä»¬åªéœ€è¦éå†ç½‘ç»œæ ˆä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/cd2ea1ae7a71443b3ff85ebbc7cb1c3b" /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„ç­–ç•¥ä¸TCP/IPåè®®ä¸­çš„Nagleç®—æ³•ç±»ä¼¼ã€‚Nagleç®—æ³•æ˜¯ä¸ºäº†å……åˆ†åˆ©ç”¨å¸¦å®½ï¼Œè€ŒZeroMQçš„Batchingç­–ç•¥æ˜¯ä¸ºäº†å‡æ‘Šç½‘ç»œæ ˆçš„æ—¶é—´å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„å®ç°å¦‚ä¸‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“æ¶ˆæ¯çš„é¢‘ç‡æ²¡æœ‰è¶…è¿‡ç½‘ç»œæ ˆçš„å¸¦å®½æ—¶ï¼ŒZeroMQä¼šæŠŠæ‰€æœ‰batchingå…³æ‰ï¼Œä»¥CPUåˆ©ç”¨ç‡æ¥æ¢å–ä½æ—¶å»¶ã€‚&lt;/li&gt;
&lt;li&gt;å½“æ¶ˆæ¯çš„é¢‘ç‡è¶…è¿‡ç½‘çº¿æ ˆçš„å¸¦å®½æ—¶ï¼ŒZeroMQä¼šå¯ç”¨batchingï¼Œä»¥æ—¶å»¶ä¸ºä»£ä»·æ¥ä¼˜åŒ–ååé‡ã€‚&lt;/li&gt;
&lt;li&gt;å½“æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¿‡å¤šæ—¶ï¼ŒZeroMQä¼šé‡‡ç”¨æ›´æ¿€è¿›çš„batchingç­–ç•¥ã€‚å› ä¸ºæ¶ˆæ¯çš„å †ç§¯é€ æˆçš„æ—¶å»¶å¢é•¿å·²ç»ä¸å¯é¿å…ï¼Œç´¢æ€§å°†æ›´å¤šçš„ä¿¡æ¯æ‰“åŒ…ï¼Œè¿™æ ·å¯ä»¥æ›´å¿«çš„æ¸…ç©ºæ¶ˆæ¯çš„ç§¯å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦å¤–ï¼Œbatchingç­–ç•¥åªåº”è¯¥è¢«åº”ç”¨äºé¡¶å±‚ã€‚åœ¨é¡¶å±‚é‡‡ç”¨batchingä¹‹åï¼Œä½å±‚çš„batchingå°±æ²¡æœ‰æ„ä¹‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼š
&lt;em&gt; åœ¨ä¸€ä¸ªå¼‚æ­¥ç³»ç»Ÿä¸­ï¼Œæƒ³è¦è·å¾—æœ€ä½³çš„å“åº”æ—¶é—´ï¼Œåº”è¯¥æŠŠåº•å±‚çš„batchingç­–ç•¥è½¬ç§»åˆ°é¡¶å±‚ã€‚
&lt;/em&gt; batchingåªåº”è¯¥åœ¨æ–°æ•°æ®åˆ°æ¥çš„é€Ÿåº¦è¶…è¿‡ç³»ç»Ÿå¸¦å®½æ—¶æ‰é‡‡ç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º7ï¼šæ•´ä½“æ¶æ„&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/22f7b30fb17c9a128bbb6dd66ad27a13" /&gt;&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·åˆ©ç”¨â€œsocketâ€ä¸ZeroMQè¿›è¡Œäº¤äº’ï¼Œä¸€ä¸ªsocketå¯ä»¥åŒå¤šä¸ªpeerè¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;
&lt;p&gt;socketå­˜åœ¨äºç”¨æˆ·çº¿ç¨‹ä¸­ã€‚è€Œä¸€äº›å·¥ä½œçº¿ç¨‹ä¼šå¤„ç†å¼‚æ­¥çš„äº¤äº’è¿‡ç¨‹ï¼Œå¦‚ï¼šä»ç½‘ç»œè¯»å–æ¶ˆæ¯ï¼Œå°†æ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—ï¼Œæ¥å—æ–°çš„è¿æ¥è¯·æ±‚ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;sessionè´Ÿè´£ä¸ZeroMQä¸­çš„socketè¿›è¡Œäº¤äº’ï¼Œengineè´Ÿè´£ç½‘ç»œäº¤äº’ã€‚sessionåªæœ‰ä¸€ç§ï¼Œè€Œengineæ ¹æ®ä½¿ç”¨çš„åè®®ä¸åŒï¼Œå¯ä»¥æœ‰å¾ˆå¤šç§ã€‚&lt;/p&gt;
&lt;p&gt;sessionä¸socketä¹‹é—´ä½¿ç”¨pipeè¿›è¡Œé€šä¿¡ï¼Œpipeè¢«å®ç°ä¸ºçº¿ç¨‹å®‰å…¨çš„åŒç«¯é˜Ÿåˆ—ï¼Œç”¨æ¥åœ¨çº¿ç¨‹é—´ä¼ é€’ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šå­¦ä¹ äº†æ•´ä½“çš„è®¾è®¡æ€è·¯ï¼ˆç¬‘&lt;/p&gt;
&lt;h2&gt;å¯ç¤º8ï¼šå¹¶å‘æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;é«˜æ•ˆçš„ZeroMQå¿…ç„¶è¦åˆ©ç”¨å¤šæ ¸çš„è®¡ç®—èµ„æºï¼Œè€Œä¼ ç»Ÿçš„å¤šçº¿ç¨‹æ¨¡å‹ä¼šå¼•å…¥é”ã€ä¿¡å·é‡ç­‰çº¿ç¨‹åŒæ­¥æœºåˆ¶ï¼Œä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚è€Œä½¿ç”¨ç‹¬ç«‹çš„çº¿ç¨‹åˆä¼šå¼•å…¥ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;ZeroMQä½¿ç”¨çš„å¹¶å‘æ¨¡å‹æ˜¯Actorï¼Œå…¶ç›®æ ‡æ˜¯å®Œå…¨é¿å…é”çš„ä½¿ç”¨ï¼Œè®©æ‰€æœ‰çš„ç»„ä»¶å…¨é€Ÿè¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ªCPUæ ¸å¿ƒåªæœ‰ä¸€ä¸ªworkerçº¿ç¨‹ï¼Œæ‰€æœ‰å†…éƒ¨å¯¹è±¡éƒ½æ˜¯çº¿ç¨‹ä¸“æœ‰çš„ï¼Œè¿™æ ·å°±å®Œå…¨é¿å…äº†é”çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œè®¸å¤šå¯¹è±¡éƒ½è¦åˆ†äº«æœ‰é™ä¸ªæ•°çš„workerã€‚æ‰€ä»¥ï¼Œç³»ç»Ÿåº”å½“æ˜¯å…¨å¼‚æ­¥çš„ã€‚å› ä¸ºæ¯ä¸€ä¸ªworkerçš„é˜»å¡ï¼Œéƒ½ä¼šé˜»å¡å…¶å®ƒä½¿ç”¨workerçš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šActoræ¨¡å‹æ˜¯æè‡´è§£å†³æ€§èƒ½ä¸æ‰©å±•æ€§é—®é¢˜çš„æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯åœ¨ä½¿ç”¨ZeroMQæˆ–Erlangï¼Œä½ éœ€è¦æ‰‹å†™è®¸å¤šç›¸å…³çš„Test Caseæ¥æµ‹è¯•ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§ã€‚å¦å¤–ï¼Œå¦‚æœä½ æ— æ³•åº”å¯¹æ¨¡å‹ä¸­çš„å¤æ‚æ¨¡å—ï¼ˆå¦‚ZeroMQçš„shutdownï¼‰ï¼Œè¯·ä¸è¦è½»æ˜“å°è¯•ä½¿ç”¨Actoræ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º9ï¼šæ— é”ç®—æ³•&lt;/h2&gt;
&lt;p&gt;æ— é”ç®—æ³•ä½¿ç”¨ç®€å•çš„æ–¹æ³•è¿›è¡Œçº¿ç¨‹é—´çš„é€šä¿¡ï¼Œè€Œä¸ä¾èµ–å†…æ ¸çº§çš„åŒæ­¥åŸè¯­ã€‚æ— é”ç®—æ³•çš„å…³é”®æ˜¯CPUä¸­çš„åŸå­æ“ä½œï¼Œä¾‹å¦‚compare-and-swapï¼ˆCASï¼‰æ“ä½œã€‚ä½†æ˜¯ï¼Œè¦è®°ä½ï¼Œæ— é”æ“ä½œå¹¶ä¸æ˜¯çœŸæ­£çš„â€œæ— é”â€ï¼Œè€Œæ˜¯æŠŠé”æ“ä½œæ”¾åˆ°äº†è¾ƒä¸ºé«˜æ•ˆçš„ç¡¬ä»¶å±‚ã€‚&lt;/p&gt;
&lt;p&gt;ZeroMQä½¿ç”¨ä¸€ä¸ªæ— é”é˜Ÿåˆ—åœ¨ç”¨æˆ·çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚ZeroMQä¸­çš„æ— é”é˜Ÿåˆ—æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ï¼Œæ¯ä¸€ä¸ªé˜Ÿåˆ—ä¸ºâ€œä¸€å†™ä¸€è¯»â€ã€‚å½“æœ‰ä¸€å¯¹å¤šçš„è¯»å†™éœ€æ±‚å­˜åœ¨æ—¶ï¼ŒZeroMQä¼šåˆ›å»ºå¤šæ¡é˜Ÿåˆ—ã€‚è¿™æ ·çš„è®¾è®¡ä½¿å¾—æˆ‘ä»¬ä¸ç”¨å…³å¿ƒå¤šçº¿ç¨‹è¯»å†™å¸¦æ¥çš„åŒæ­¥é—®é¢˜ï¼Œæœ‰åˆ©äºæˆ‘ä»¬å¯¹å…¶æ€§èƒ½çš„ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒï¼Œå³ä½¿æ— é”ç®—æ³•æ¯”ä¼ ç»Ÿçš„é”ç®—æ³•è¦å¿«å¾ˆå¤šï¼Œä½†æ˜¯å…¶ä»£ä»·ä»ç„¶æ˜¯è¿‡é«˜çš„ï¼ˆå°¤å…¶æ˜¯åœ¨CPUæ ¸å¿ƒä¹‹é—´çš„é€šä¿¡ï¼‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»ç„¶ä¾èµ–äºâ€œbatchingâ€ç®—æ³•ï¼Œå°†æ˜‚è´µçš„åŒæ­¥æ“ä½œå‡æ‘Šåˆ°å¤šæ¡æ¶ˆæ¯ä¸Šã€‚åœ¨ä»é˜Ÿåˆ—çœŸæ­£çš„è¯»å†™æ“ä½œä¹‹å‰ï¼ŒåŠ å…¥ä¸€æ¬¡é¢„å¤„ç†ï¼ˆpre-write / pre-readï¼‰ï¼Œå°†æ¶ˆæ¯æ‰“ä¸ªåŒ…ï¼Œå‘ç”³é€šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/9d97e2979db40e413e43cf7d642d1570" /&gt;&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šæ— é”ç®—æ³•æ˜¯éå¸¸ç²¾å·§çš„ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œå°½é‡ä½¿ç”¨æˆç†Ÿçš„è®¾è®¡ã€‚å¦‚æœä½ éœ€è¦æè‡´çš„æ€§èƒ½ï¼Œä¸è¦ä»…ä»…ä¾èµ–äºæ— é”ç®—æ³•ã€‚å°½ç®¡æ— é”ç®—æ³•éå¸¸å¿«ï¼Œä½ ä»ç„¶å¯ä»¥é€šè¿‡batchingç­–ç•¥ä¼˜åŒ–å®ƒã€‚ï¼ˆå¦å¤–ï¼ŒåŠ é’±ä¸Šèˆ¹ä¹Ÿå¯ä»¥ã€‚ï¼‰&lt;/p&gt;
&lt;h2&gt;å¯ç¤º10ï¼šAPIè®¾è®¡&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡APIï¼Œå°±åƒè®¾è®¡ä¸€æ¬¾äº§å“ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·å¯¹äºä¸€ä¸ªç¨‹åºåº“çš„ç¬¬ä¸€æ„Ÿè§‰æ¥è‡ªäºç”¨æˆ·æ¥å£ã€‚ZeroMQç®€åŒ–äº†è‡ªå·±çš„ç”¨æˆ·æ¥å£ï¼Œå°†å…¶ç”±åŸæ¥çš„â€œç‚’é¸¡å¤æ‚ä¸€ä¸å°å¿ƒå‘æ­»ä½ çš„ä¼ä¸šçº§æ¶ˆæ¯æ¡†æ¶â€å˜ä¸ºäº†â€œæƒ³å‘æ¶ˆæ¯è°ƒç”¨ä¸‹å°±OKâ€çš„ææ˜“ä¸Šæ‰‹çš„å…¥é—¨çº§äº§å“ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªé‡è¦çš„æ–¹é¢ï¼ŒZeroMQä½¿ç”¨äº†å¹¿ä¸ºä½¿ç”¨çš„BSD Sockets APIã€‚è¿™æ ·åšçš„ä¼˜ç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿™æ˜¯ä¸€ä¸ªå¤§å®¶éƒ½ç†ŸçŸ¥çš„APIï¼Œå­¦ä¹ æ›²çº¿ç›¸å½“å¹³ç¼“&lt;/li&gt;
&lt;li&gt;ä½¿ZeroMQä¸ç°æœ‰çš„æŠ€æœ¯è¿æ¥èµ·æ¥ï¼Œæœ‰åˆ©äºå¤ç”¨å·²ç”¨çš„æ¡†æ¶ä¸è®¾è®¡&lt;/li&gt;
&lt;li&gt;æœ€é‡è¦çš„æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªæˆç†Ÿä¸ä¹…ç»è€ƒéªŒçš„æ¡†æ¶ï¼Œå¯ä»¥é¿å…è¸©å‰äººè¸©è¿‡çš„å‘ã€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šé™¤äº†ä»£ç å¤ç”¨ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä»¥ä¸€ç§æ›´ä¸€èˆ¬çš„æ–¹æ³•ï¼Œå¤ç”¨æˆç†Ÿçš„æŠ€æœ¯ã€‚å½“ä½ è®¾è®¡ä¸€ä¸ªæ–°äº§å“æ—¶ï¼Œå€Ÿé‰´ä¸€ä¸‹ç±»ä¼¼çš„äº§å“ï¼ˆè…¾è®¯ï¼ï¼‰ã€‚ä¸è¦çŠ¯â€œåœ¨è¿™é‡Œè¿˜æ²¡æœ‰è¢«å‘æ˜â€ï¼ˆNot Invented Hereï¼‰ç»¼åˆç—‡ã€‚å¤ç”¨ä¸€åˆ‡åˆé€‚çš„æƒ³æ³•ã€APIã€æ¡†æ¶æŠ½è±¡ã€‚å…è®¸ç”¨æˆ·ä½¿ç”¨å·²æœ‰çš„çŸ¥è¯†ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è®©æˆ‘ä»¬è§„é¿æœªçŸ¥çš„é£é™©ã€‚&lt;/p&gt;
&lt;h2&gt;å¯ç¤º11ï¼šæ¶ˆæ¯æ¨¡å¼&lt;/h2&gt;
&lt;p&gt;ZeroMQçš„è®¾è®¡æ€è·¯æ˜¯&lt;strong&gt;ä¸“æ³¨äºä¸€ä¸ªé¢†åŸŸï¼ŒæŠŠå®ƒåšåˆ°æœ€å¥½&lt;/strong&gt;ã€‚å› ä¸ºï¼Œå¤§è€Œå…¨çš„äº§å“åªèƒ½ç»™é¢†åŸŸä¸“å®¶æ¥ä½¿ç”¨ï¼Œè€Œå°è€Œç²¾çš„äº§å“çš„å—ä¼—åˆ™æ˜¯ä»»ä½•å—è¿‡è®­ç»ƒçš„ç¨‹åºå‘˜ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;REQ&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;tcp://192.168.0.111:5555&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;reply&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“æˆ‘ä»¬è¦ç»™ç”¨æˆ·æä¾›æ›´ä¸€èˆ¬æ€§çš„è§£å†³æ–¹æ¡ˆæ—¶ï¼Œä¸€ä¸ªæŠ€æœ¯æ ˆï¼Œæ ˆçš„æ¯ä¸€å±‚å¯ä»¥æœ‰ä¸åŒçš„å®ç°ï¼Œä»è€Œé€‚åº”ä¸åŒäººç¾¤çš„éœ€è¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å’ŒInternetæ ˆçš„è®¾è®¡æ€è·¯éå¸¸ç›¸ä¼¼ï¼šTCPå¯ä»¥è§£å†³åŸºäºé“¾æ¥çš„ã€å¯é çš„æ•°æ®æµä¼ è¾“ï¼ŒUDPå¯ä»¥è§£å†³ä¸å¯é çš„æ•°æ®åŒ…ä¼ è¾“ï¼ŒSCTPå¯ä»¥è§£å†³å¤šç”¨æˆ·æ•°æ®æµä¼ è¾“é—®é¢˜ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰çš„è§£å†³æ–¹æ¡ˆéƒ½æ˜¯æ­£äº¤çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä¸­å¥½çš„è®¾è®¡ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰é¢å¤–ä»£ä»·çš„æŠ›å¼ƒä¸å¥½çš„è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;è·å¾—çš„å¯ç¤ºï¼šå½“è§£å†³ä¸€ä¸ªå¤æ‚ä¸”å¤šé¢åŒ–çš„é—®é¢˜æ—¶ï¼Œå•ä¸ªé€šç”¨å‹çš„è§£å†³æ–¹æ¡ˆå¯èƒ½å¹¶ä¸æ˜¯æœ€å¥½çš„æ–¹å¼ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé—®é¢˜çš„é¢†åŸŸæƒ³è±¡æˆä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå¹¶åŸºäºè¿™ä¸ªå±‚æ¬¡æä¾›å¤šä¸ªå®ç°ï¼Œæ¯ç§å®ç°åªè‡´åŠ›äºè§£å†³ä¸€ç§å®šä¹‰è‰¯å¥½çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬è¿™ä¹ˆåšæ—¶ï¼Œç¡®å®šé—®é¢˜çš„ç²’åº¦éå¸¸é‡è¦ã€‚å¦‚æœç²’åº¦è¿‡ç»†ï¼Œè½¯ä»¶çš„ä¸€èˆ¬æ€§å°±ä¼šå—åˆ°é™åˆ¶ã€‚å¦‚æœç²’åº¦è¿‡ç²—ï¼Œé‚£ä¹ˆäº§å“å°±ä¼šå˜å¾—éå¸¸å¤æ‚ï¼Œç»™ç”¨æˆ·å¸¦æ¥æ¨¡ç³Šå’Œæ··ä¹±çš„æ„Ÿè§‰ã€‚&lt;/p&gt;
&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åŸæ–‡é“¾æ¥ï¼šhttp://www.aosabook.org/en/zeromq.html&lt;/li&gt;
&lt;li&gt;ä¸­æ–‡ç¿»è¯‘ï¼šhttp://www.ituring.com.cn/article/4669&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ¬æ–‡ä¸­å€Ÿé‰´äº†ä¸­æ–‡ç¿»è¯‘çš„éƒ¨åˆ†è¯å¥ï¼Œå¯¹æ­¤è¡¨ç¤ºæ„Ÿè°¢ã€‚&lt;/p&gt;</summary><category term="zeromq"></category><category term="distributed system"></category><category term="system-design"></category></entry><entry><title>Codeforces Round #290 (Div. 2) Tutorial</title><link href="http://wizmann.tk/cf-290-div-2.html" rel="alternate"></link><updated>2015-02-18T00:30:24+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-02-18:cf-290-div-2.html</id><summary type="html">&lt;h2&gt;A. Fox And Snake&lt;/h2&gt;
&lt;p&gt;Implementation&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;#&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;#&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Fox And Two Dots&lt;/h2&gt;
&lt;p&gt;DFS&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;AAAA
ABCA
AAAA
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We start at arbitrary point, and traverse the neighbour point with the same color to see if there is a circle.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;do_dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; 
                &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; 
                &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;
                &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dir&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dir&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;do_dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;do_dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Yes&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                        &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Got it&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;No&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="p"&gt;(...)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// pass&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Fox And Names&lt;/h2&gt;
&lt;p&gt;Topsort&lt;/p&gt;
&lt;p&gt;This is a classic interview problem. We can find the relationship between two letters from the given name list.&lt;/p&gt;
&lt;p&gt;But in this instance, there is no possible lexical order because the name list is invalid.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;aaa
aa
a
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So the algorithm can be describe in this way:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;If the name list is invalid, there is no solution.&lt;/li&gt;
&lt;li&gt;Try to find the order of the letters.&lt;/li&gt;
&lt;li&gt;Topsort&lt;/li&gt;
&lt;li&gt;If topsort is success, print out the new lexical order of the name list. If failed, there is no solution.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;makeG&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;substr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;top_sort&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;front&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;next&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;print_res&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;makeG&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;top_sort&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print_res&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Impossible&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Fox And Jumping&lt;/h2&gt;
&lt;p&gt;Extended Euclidean algorithm&lt;/p&gt;
&lt;p&gt;As we might know, for every positive integer &lt;code&gt;x&lt;/code&gt; and &lt;code&gt;y&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ax + by = gcd(x, y)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let's extend this theorem, for an array of positive integer &lt;code&gt;Xs&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;As * Xs = gcd(Xs)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(&lt;code&gt;As&lt;/code&gt; is an array of constants, both positive and negative)&lt;/p&gt;
&lt;p&gt;If &lt;code&gt;gcd(Xs)&lt;/code&gt; equal to one, that is, every two number of the array is co-prime.&lt;/p&gt;
&lt;p&gt;So, we can find a subarray that every two number is co-prime, and have the minimal cost.&lt;/p&gt;
&lt;p&gt;As there are not too many factors in a single number, even the number here is as large as 10^9. The &lt;code&gt;gcd()&lt;/code&gt; of the subarray won't have too many results, and could be stored in a single &lt;code&gt;unordered_map&lt;/code&gt; here.&lt;/p&gt;
&lt;p&gt;And,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;C++ Iterator Invalidation Rules (C++03)&lt;/p&gt;
&lt;p&gt;Associative containers&lt;/p&gt;
&lt;p&gt;[multi]{set,map}: all iterators and references unaffected&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Here is the rule of C++ about the behavoir of the iterators when we try to add something into the map during the iteration. So we can just use one sigle map, and avoid the complexity of moving things between to containers.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;unordered_map&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mh"&gt;0x3f3f3f3f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;gcd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;gcd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Card&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Card&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;unordered_map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;card&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;thres&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;p&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;second&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;thres&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gcd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;-1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;E. Fox And Dinner&lt;/h2&gt;
&lt;p&gt;Max Flow Algorithm&lt;/p&gt;
&lt;p&gt;As we know, every odd number must be connected to two even numbers. And, of course, one even number should be connected to two odd numbers.&lt;/p&gt;
&lt;p&gt;We use the max flow algortihm. Every odd number have a path with 2 unit of flow to the &lt;strong&gt;source&lt;/strong&gt; node, every even number have a path with 2 unit of flow to the &lt;strong&gt;sink&lt;/strong&gt; node. And if the sum of one odd number and an even number is a prime, we connect them with a path with 1 unit of flow.&lt;/p&gt;
&lt;p&gt;As the result, we have a undirected graph that every node have a degree of 2. It's easy to find out that is an &lt;strong&gt;Euler circuit&lt;/strong&gt;. We find the circuit and print it out.&lt;/p&gt;
&lt;p&gt;The problem is not easy as it seems. Harsh one, indeed. I used &lt;strong&gt;Dinic&lt;/strong&gt; algorithm for the max flow. Actually, I don't like my code here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stack&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout&amp;lt;&amp;lt;x&amp;lt;&amp;lt;endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin&amp;gt;&amp;gt;x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;NODE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;EDGE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NODE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mh"&gt;0x3f3f3f3f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;flow&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ist&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;iend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;iflow&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;inext&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ist&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iend&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;flow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iflow&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inext&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;EDGE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ind&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cnc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;addEdge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ind&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ind&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ind&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ind&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;dinic&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;curhead&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;Que&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;estack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;EDGE&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;BFS&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;Que&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;fr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;fr&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;fr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fr&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Que&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fr&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;!=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;Que&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;NODE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;!=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;DFS&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;indptr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                                                   
        &lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;memcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;curhead&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;  
        &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;            
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;                                      
                &lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;estack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                    &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                        &lt;span class="n"&gt;indptr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                                   

                &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;{&lt;/span&gt;               
                    &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;estack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                    &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt;&lt;span class="o"&gt;-=&lt;/span&gt;&lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;minf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;indptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                                    
                &lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;estack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="p"&gt;]].&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;          
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;curhead&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;!=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;  
                &lt;span class="n"&gt;curhead&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;estack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;==-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;                                           
                &lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                                    
                &lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;estack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;estop&lt;/span&gt;&lt;span class="p"&gt;]].&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;               
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;ind&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;u&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;cnc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;show_res&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;EDGE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;flow&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;sink&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;cnc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="n"&gt;cnc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;    for (int i = 1; i &amp;lt;= n; i++) {&lt;/span&gt;
&lt;span class="cm"&gt;        printf(&amp;quot;%d -&amp;gt; &amp;quot;, i);&lt;/span&gt;
&lt;span class="cm"&gt;        for (auto&amp;amp; item: cnc[i]) {&lt;/span&gt;
&lt;span class="cm"&gt;            printf(&amp;quot;%d &amp;quot;, item);&lt;/span&gt;
&lt;span class="cm"&gt;        }&lt;/span&gt;
&lt;span class="cm"&gt;        puts(&amp;quot;&amp;quot;);&lt;/span&gt;
&lt;span class="cm"&gt;    }&lt;/span&gt;
&lt;span class="cm"&gt;    puts(&amp;quot;---&amp;quot;);&lt;/span&gt;
&lt;span class="cm"&gt;    */&lt;/span&gt;
    &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="nl"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot; %d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;isPrime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;E.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sink&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;isPrime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;addEdge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nums&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;addEdge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;addEdge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sink&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dinic&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;BFS&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;dinic&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;DFS&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Impossible&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;show_res&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category></entry><entry><title>Codeforces Round #289 (Div. 2) Tutorial</title><link href="http://wizmann.tk/cf-289-div-2.html" rel="alternate"></link><updated>2015-02-16T21:16:31+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-02-16:cf-289-div-2.html</id><summary type="html">&lt;h2&gt;A. Maximum in Table&lt;/h2&gt;
&lt;p&gt;Simulation. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Painting Pebbles&lt;/h2&gt;
&lt;p&gt;Reading comperhension &amp;amp; Constructive.&lt;/p&gt;
&lt;p&gt;The key point of this problem is &lt;code&gt;abs(b(i, c) - b(j, c)) &amp;lt;= 1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;First of all, it's safe to paint k pebbles of every pile with the same color, when &lt;code&gt;k = min(piles)&lt;/code&gt;. At this moment, every &lt;code&gt;b(i, c) - b(j, c) == 0&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And then, we paint 1 pebbles of every pile with color &lt;code&gt;C[i]&lt;/code&gt; at a time (if possible). That is, for every pile, the number of pebbles with color &lt;code&gt;C[i]&lt;/code&gt; is zero or one.&lt;/p&gt;
&lt;p&gt;If you can't paint all the pebbles with proper color, just print a "NO" here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;mini&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;NO&amp;#39;&lt;/span&gt;
    &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;YES&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Sums of Digits&lt;/h2&gt;
&lt;p&gt;Brute force &amp;amp; Constructive&lt;/p&gt;
&lt;p&gt;After reading this problem, there is one thing that we could NEVER miss is the scope of number n: &lt;code&gt;1 &amp;lt;= n &amp;lt;= 300&lt;/code&gt;, which means that the max number here is no more than 40 digits and we can solve the problem with brute force.&lt;/p&gt;
&lt;p&gt;As we know, the number in the array must be incremental, and every number should be the minimum.&lt;/p&gt;
&lt;p&gt;Assuming we have got an array which is incremental, the last number is K. Such as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;K = d3 ++ d2 ++ d1 ++ d0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Our mission is to find a way to generate the smallest number which follow the rules:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;the number here is greater than the previous one&lt;/li&gt;
&lt;li&gt;the digit sum&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Rule No.1 is not hard as it seems, if we increase any digit of the number K, the new number is of course greater. But how to satisfy the digit sum?&lt;/p&gt;
&lt;p&gt;For example, we got a new number &lt;code&gt;K1&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;K1 = d3 ++ (d2 + 1) ++ d1 ++ d0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here, of course, &lt;code&gt;K1 &amp;gt; K&lt;/code&gt;. But the number &lt;code&gt;K2&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;K2= d3 ++ (d2 + 1) ++ 0 ++ 0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;is smaller then &lt;code&gt;K1&lt;/code&gt;, and also greater than the number &lt;code&gt;K&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And then, we fill the lower digits with number to make the sum of the digits equal to the given one. If failed, keep on trying, such as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;K3 = d3 ++ (d2 + 2) ++ 0 ++ 0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;or&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;K4 = (d3 + 1) ++ 0 ++ 0 ++ 0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;or even&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;K5 = 1 ++ 0 ++ 0 ++ 0 ++ 0
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_fill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
            &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;do_fill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;ns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[::&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Restoring Numbers&lt;/h2&gt;
&lt;p&gt;Math&lt;/p&gt;
&lt;p&gt;Each number of the input matrix is &lt;code&gt;(A[i] + B[i]) % MOD&lt;/code&gt;. And we can get &lt;code&gt;(A[i] - A[j]) % MOD&lt;/code&gt; by subtract the number on the same line.&lt;/p&gt;
&lt;p&gt;Sometimes, the &lt;code&gt;(A[i] - A[j]) % MOD&lt;/code&gt; can be both positive and negetive. And we can get the value of &lt;code&gt;MOD&lt;/code&gt; here.&lt;/p&gt;
&lt;p&gt;As a result, we can get the value of every &lt;code&gt;A[i] - A[0]&lt;/code&gt;. We set A[0] to the number '0', and get the values of array A.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;diffs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;diff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;])&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;diffs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;NO&amp;#39;&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;NO&amp;#39;&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;diffs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;As&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;Bs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;diffs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;

&lt;span class="n"&gt;Bs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Bs&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;Bs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;As&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;Bs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;As&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Bs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;NO&amp;#39;&lt;/span&gt;
            &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;YES&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;As&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Bs&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;E. Pretty Song&lt;/h2&gt;
&lt;p&gt;Math &amp;amp; Thinkin' in reverse&lt;/p&gt;
&lt;p&gt;It's hard to get the answer by brute force because the scope of this problem is too large.&lt;/p&gt;
&lt;p&gt;Try to think in reverse. It's hard to calculate all the value of the substrings, but why don't we find a way to get the value that every vowel contributes to the final result?&lt;/p&gt;
&lt;p&gt;For example, string "AAA". The first "A" will add &lt;code&gt;1 + 1/2 + 1/3&lt;/code&gt; to the final result. And the second "A", &lt;code&gt;1 + 1/2 + 1/2 + 1/3&lt;/code&gt;. And the last "A", &lt;code&gt;1 + 1/2 + 1/3&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We can make a table here for a 4-length string.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="data:image/png;base64,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" /&gt;&lt;/p&gt;
&lt;p&gt;We can easily find the pattern here. (Of course we can prove it.) And the code is right here.&lt;/p&gt;
&lt;p&gt;(But you can always find a &lt;a href="http://codeforces.com/contest/509/submission/9862199"&gt;harder way&lt;/a&gt; to sovle it. LOL. But I have to say that &lt;strong&gt;pypy&lt;/strong&gt; is awesome!)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# pypy: 171ms&lt;/span&gt;
&lt;span class="c"&gt;# python2: 467ms&lt;/span&gt;
&lt;span class="n"&gt;VOWELS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;AEIOUY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500010&lt;/span&gt;

&lt;span class="n"&gt;ds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;

&lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;ds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;ds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;VOWELS&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;pypy is about 3~5 times faster than the original python interpreter, and this is the very useful tool to help us with the algorithm problems.&lt;/p&gt;
&lt;h2&gt;F. Progress Monitoring&lt;/h2&gt;
&lt;p&gt;DP&lt;/p&gt;
&lt;p&gt;This problem is about the pre-order traversal with a tree. There are multiple situations of the output string given in the problem.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;  a    | b c d |         | e f g h i j |
  ^        ^                    ^
father  children   siblings &amp;amp; siblings children
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;or &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;  a    | b c d e f |         | g h i j |
  ^          ^                    ^
father   children    siblings &amp;amp; siblings children
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But be aware, if &lt;code&gt;x &amp;lt; a&lt;/code&gt;, &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;x&lt;/code&gt; can't be siblings. &lt;/p&gt;
&lt;p&gt;&lt;code&gt;dp[i][j]&lt;/code&gt; stands for the number of permutations of the subtree. whose pre-order traversal is right match the &lt;code&gt;s[i...j]&lt;/code&gt;, the substring of the given traversal path.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="c"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="n"&gt;typedef&lt;/span&gt; &lt;span class="nb"&gt;long&lt;/span&gt; &lt;span class="nb"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000000&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;555&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;outvec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;void&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outvec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;outvec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;siblings&lt;/span&gt;
                &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;..&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;
            &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outvec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;outvec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;sibling&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                    &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;sibling&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;outvec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>Codeforces Round #288 (Div. 2)</title><link href="http://wizmann.tk/cf-288-div-2.html" rel="alternate"></link><updated>2015-02-16T21:16:30+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2015-02-16:cf-288-div-2.html</id><summary type="html">&lt;h2&gt;A. Pasha and Pixels&lt;/h2&gt;
&lt;p&gt;Brute force.&lt;/p&gt;
&lt;p&gt;There are multiple ways to form a 2*2 square at one single step.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/6fb53c51539b47559cf0d122a832cf63" /&gt;&lt;/p&gt;
&lt;p&gt;So at every step, we have to check the neighbours of pixel that is colored black.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;123&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;MOVE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;isBlackBlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;MOVE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;
                &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;MOVE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;MOVE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="n"&gt;isBlackBlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Anton and currency you all know&lt;/h2&gt;
&lt;p&gt;At first, you have to understand the questions accurately.&lt;/p&gt;
&lt;p&gt;The exchange rate is &lt;strong&gt;an odd number&lt;/strong&gt;. And your mission is swap one digit with another, to make it the maximum even number.&lt;/p&gt;
&lt;p&gt;Because if the exchange rate is an even number, it will lead to a more sophisticated problem.&lt;/p&gt;
&lt;p&gt;The intuitive thought is that we can swap the hightest even digit with the last digit. However, for this case "92291", you may swap the second digit "2" and the last digit "1". But "91292" is not the largest number, "92192" is.&lt;/p&gt;
&lt;p&gt;So, ther are two scenario. First is the final answer is greater than the ordinary one. Just find out the &lt;strong&gt;first even digit that is less than the last digit&lt;/strong&gt;. Second is the final answer is less than the given one. If we want to make it the largest one, we have to find the &lt;strong&gt;lowest even digit and then swap&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;We can make it by loop twice. But there is a way to find the final answer in one single iteration.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;123456&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;strlen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Anya and Ghosts&lt;/h2&gt;
&lt;p&gt;The background of this problem is quite twisted.&lt;/p&gt;
&lt;p&gt;First of all, we have to find out in which scenario there is no way to defence against the ghost.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/833368d068c6dc956b62d9babf01c3b6" /&gt;&lt;/p&gt;
&lt;p&gt;It's easy to find out in that diagram above that if the duration of the candle is less than the number of candles which is needed.&lt;/p&gt;
&lt;p&gt;So, before the ghost comes, we have to light up the candles. If we want to have K candles in one second, we have to light it up at second (T - 1) (T - 2) ... (T - K).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ghosts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="c"&gt;# impossible&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;candles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ghost&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ghosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;candles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ghost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;candles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ghost&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;delay&lt;/span&gt;
            &lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Tanya and Password&lt;/h2&gt;
&lt;p&gt;Tanya cut the password into three-letter continuous substrings. Our mission is to re-assemble these substrings.&lt;/p&gt;
&lt;p&gt;For example,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Password&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fuckme&lt;/span&gt;
&lt;span class="n"&gt;Substrings&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fuc&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;uck&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ckm&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kme&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It's not hard to find out that the problem is not about the "string" but the "graph". But how to convert the string and substrings into a graph.&lt;/p&gt;
&lt;p&gt;At the every beginning, we regard the substrings as vertexes, every two substrings which could be connected has an edge between them.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/bbc690924ece17dde46fd5d23188bf5d" /&gt;&lt;/p&gt;
&lt;p&gt;In this scenario, all we have to do is find a path that visit all the vertexes. This path is called &lt;strong&gt;Hamilton path&lt;/strong&gt;. The algorithm to find a hamilton path in a graph is quite slow with O(2 ** N) time complexity. We have to find another way.&lt;/p&gt;
&lt;p&gt;Similar to hamilton path, the eular path is a path that visit all the edges of the graph. And this inspires us to make the strings to another graph, and the eular path will be the final answer with the complete password.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="http://wizmann-pic.qiniudn.com/bd69ddd562d6b4b4cde4e3a461a8706e" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;set&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;
&lt;span class="cp"&gt;#define err(x)   cerr &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;BASE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;indeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;outdeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;z&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;Z&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;9&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;52&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;get_value_err:&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_char&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;51&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;52&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;52&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;get_char_err&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ia&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ib&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ia&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;BASE&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ib&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;add_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;outdeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;indeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;is_connected&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;get_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;indeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;outdeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1U&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_start_point&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;is_connected&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outdeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;indeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outdeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;indeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outdeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;indeg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;show_path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;u&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;BASE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_char&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_char&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;BASE&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;add_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_start_point&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;NO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;YES&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;node_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;show_path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;E. Arthur and Brackets&lt;/h2&gt;
&lt;p&gt;DP + Greedy&lt;/p&gt;
&lt;p&gt;For this problem, be ware that the position of the right bracket is not the absolute position but the relative position. And according to the common sense, there will only be complete brackets between one left bracket and one right bracket.&lt;/p&gt;
&lt;p&gt;For example,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;RIGHT: *(* ()(()) *)*
WRONG: *(* ((((() *)*
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So, it's OK to close the bracket if possible. And this is the key to solve to problem.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;brackets&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;tuple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

&lt;span class="n"&gt;INF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mh"&gt;0xcafebabe&lt;/span&gt;
&lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;brackets&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;(&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pre_l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pre_r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pre_l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;pre_r&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;
            &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;IMPOSSIBLE&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>Sequence Median</title><link href="http://wizmann.tk/sequence-median.html" rel="alternate"></link><updated>2014-12-14T16:51:50+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-12-14:sequence-median.html</id><summary type="html">&lt;h2&gt;Description&lt;/h2&gt;
&lt;p&gt;Given a sequence of integer numbers, try to find the median of the sequence.&lt;/p&gt;
&lt;h3&gt;Extending&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Make sure your code can get the right answer in any conditions&lt;/li&gt;
&lt;li&gt;Make sure your code work effectively on some special kinds of sequence. For example, ordered sequence or a nearly ordered one, a sequence with few unique items.&lt;/li&gt;
&lt;li&gt;If the memory is not large enough for all the elements in the sequence, how can we implement this algorithm?&lt;/li&gt;
&lt;li&gt;If it's not a sequence, but a data stream. How can we find the median?&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;Finding the median is quite similar to finding the kth element.&lt;/p&gt;
&lt;p&gt;The basic solution to find the kth element is to sort the sequence first, and then find the kth. It'll get the right answer, of course, but the time complexity is O(n * logn), which is not the optimized one.&lt;/p&gt;
&lt;p&gt;There is a vintage algorithm to get the kth_element.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;partition&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;partition&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pivot_idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="nf"&gt;find_median&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kth_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The time complexity of the algorithm is O(N). It works well in most conditions. But there is a potential error in the code, can you find it?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If &lt;code&gt;a + b&lt;/code&gt; is greater than INT_MAX, it will overflow, and make a mess to your code. The right way isï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is another problem in the code. If the sequence is already ordered, the algorithm will take O(N^2) time, and can't work effectively as what we design. It is because the pivot is the very first element of the sequence (or the sub-sequence), if the sequence is ordered, we will partition the sequence into this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;nil ++ pivot ++ [elements]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The solution is to use the random pivot. And we will modify the code here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;partition&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This code will perform well for the ordered / nearly ordered data. But there is another "however", what if there are few unique elements in the sequence?&lt;/p&gt;
&lt;p&gt;For example, the sequence &lt;code&gt;[1, 1, 1, 1, 1, 1, 1]&lt;/code&gt;. If we deal this sequence by the previous algorithms, it also takes O(N) time, because we can just separate the sequence into this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;[elements] + pivot + nil
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This scenario is similar as the previous one. So we have to come up a new way to cope with it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;partition&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pivot_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pivot_idx&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// &amp;lt;- rewrite zone&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="c1"&gt;// &amp;lt;- end of rewrite zone&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This code could put the same number into left part and right part by half.&lt;/p&gt;
&lt;p&gt;With all these optimization, you can get an &lt;strong&gt;Accepted&lt;/strong&gt; in the problem &lt;a href="http://poj.org/problem?id=2623"&gt;POJ-2623&lt;/a&gt;. But be ware, the function to initizalize of random number, &lt;code&gt;srand(time(NULL))&lt;/code&gt;, is disallowed when using the G++ compiler, please choose C++ instead.&lt;/p&gt;
&lt;p&gt;There's always something next, if we don't have enough memory to storage all the data in the sequence. We will use a heap to find the kth_element, and that will save half of the memory space. But the time complexity is O(n * logn) here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// This is a bad code :)&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;priority_queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%.1f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%.1f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay, there is the last problem: what if the sequence is a stream that you have to find the median whenver a new number comes in? The solution is using two heaps. The max heap storages the numbers which less than the median, and the min heap storages the numbers which greater than the median.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MaxHeap&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;priority_queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;

&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MinHeap&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;priority_queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;greater&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MedianStream&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;do_adjust&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;_size&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;get_median&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_size&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;do_adjust&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
            &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
            &lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;_size&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;MaxHeap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;_max_heap&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;MinHeap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;_min_heap&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="quick sort"></category><category term="median"></category><category term="partition"></category><category term="priority queue"></category></entry><entry><title>ç±»å‹-é•¿åº¦-å€¼ï¼ˆTLVï¼‰åè®®</title><link href="http://wizmann.tk/tlv-protocol.html" rel="alternate"></link><updated>2014-11-17T00:25:42+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-11-17:tlv-protocol.html</id><summary type="html">&lt;p&gt;åœ¨æ•°æ®é€šä¿¡åè®®ä¸­ï¼Œå¯é€‰çš„ä¿¡æ¯æˆ–å­—æ®µé€šå¸¸ä½¿ç”¨type-length-valueï¼ˆa.k.a TLVï¼‰å…ƒç´ æ¥è¿›è¡Œç¼–ç ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Type - ç±»å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”¨æ¥æ ‡ç¤ºå­—æ®µç±»å‹çš„å€¼ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å€¼æˆ–ç®€å•çš„å­—æ¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Length - é•¿åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å­—æ®µé•¿åº¦ï¼Œå•ä½é€šå¸¸ä¸ºByte&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Value - å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸€ä¸ªå˜é•¿çš„æ¯”ç‰¹æ•°ç»„ç”¨æ¥å­˜å‚¨è¿™ä¸ªå­—æ®µçš„å€¼&lt;/p&gt;
&lt;h2&gt;ä¼˜åŠ¿&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TLVåºåˆ—æ–¹ä¾¿éå†æŸ¥æ‰¾&lt;/li&gt;
&lt;li&gt;æ–°çš„å­—æ®µå¯ä»¥æ— ç—›çš„åŠ å…¥ç°æœ‰çš„åè®®ä¸­ã€‚è§£æçš„æ—¶å€™ï¼Œå¯¹äºæœªçŸ¥çš„å­—æ®µï¼Œå¯ä»¥è½»æ¾çš„è·³è¿‡ã€‚è¿™ç‚¹ä¸XMLç±»ä¼¼&lt;/li&gt;
&lt;li&gt;TLVå…ƒç´ çš„é¡ºåºå¯ä»¥æ˜¯éšæ„çš„&lt;/li&gt;
&lt;li&gt;TLVå…ƒç´ é€šå¸¸ä½¿ç”¨äºŒè¿›åˆ¶å­˜å‚¨ï¼Œå¯ä»¥ä½¿è§£æé€Ÿåº¦åŠ å¿«å¹¶ä¸”ä½¿æ•°æ®æ›´å°&lt;/li&gt;
&lt;li&gt;TLVå¯ä»¥ä¸XMLæ•°æ®ç›¸äº’è½¬æ¢ï¼Œæ˜“äºäººç±»é˜…è¯»&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ä¾‹å­&lt;/h2&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»¥protobufçš„å¯é€‰å’Œå˜é•¿å­—æ®µä¸ºä¾‹ã€‚&lt;/p&gt;
&lt;h3&gt;field_number ++ wire_type&lt;/h3&gt;
&lt;p&gt;æ¯ä¸€ä¸ªprotobufçš„å­—æ®µåœ¨ä¼ è¾“æ—¶ï¼Œéƒ½ä¼šåŠ ä¸Š&lt;code&gt;field_number&lt;/code&gt;å’Œ&lt;code&gt;wire_type&lt;/code&gt;è¿™ä¸¤ä¸ªå€¼ï¼Œè¿™ä¸¤ä¸ªå€¼ç»„æˆè¿™ä¸ªå­—æ®µçš„keyã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;key = (field_number &amp;lt;&amp;lt; 3) | wire_type
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;field_number&lt;/code&gt;æ ‡æ˜äº†å­—æ®µçš„ç¼–å·ï¼Œæ–¹ä¾¿åè®®å‘å‰å‘åçš„å…¼å®¹ã€‚è€Œ&lt;code&gt;wire_type&lt;/code&gt;æ ‡æ˜å­—æ®µçš„ç±»å‹ï¼Œæ–¹ä¾¿è§£æç¨‹åºä½¿ç”¨ç›¸åº”çš„æ–¹æ³•æ¥è¿›è¡Œååºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;h3&gt;Varint å˜é•¿æ•´å‹&lt;/h3&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªå˜é•¿æ•´å‹å­—æ®µï¼Œprotobufä¸­ä½¿ç”¨Type(0)æ¥æ ‡ç¤ºï¼Œè€Œé•¿åº¦å¹¶æ²¡æœ‰æ˜¾å¼çš„æ ‡å‡ºã€‚&lt;/p&gt;
&lt;p&gt;Varintçš„å€¼ä½¿ç”¨å¦‚ä¸‹ç¼–ç æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Varintä½¿ç”¨åˆ†æ®µå­˜å‚¨æ–¹æ³•ï¼Œæ¯ä¸ªByteä¸ºä¸€æ®µ&lt;/li&gt;
&lt;li&gt;Varintæ¯æ®µçš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯æ ‡ç¤ºä½ï¼Œå¦‚æœè¿™ä¸€ä½æ˜¯1ï¼Œåˆ™ä¸‹ä¸€ä¸ªByteä¹Ÿæ˜¯è¿™ä¸ªæ•°çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè¿™ä¸€ä½æ˜¯0ï¼Œåˆ™åœ¨è¿™ä¸ªByteæ˜¯è¿™ä¸ªVarintçš„æœ€åä¸€ä¸ªByte&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;String å˜é•¿å­—ç¬¦ä¸²&lt;/h3&gt;
&lt;p&gt;å­—ç¬¦ä¸²è¢«æ ‡ç¤ºä¸ºType(2)ï¼Œé•¿åº¦ä½¿ç”¨Varintç±»å‹æ˜¾å¼æ ‡å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªstringåœ¨protobufä¸­è¢«ç¼–ç ä¸ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;encoded_string = key ++ length ++ string
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å…¶å®ƒæ–¹æ³•&lt;/h2&gt;
&lt;p&gt;TLVåŒæ ·ä¹Ÿå¯ä»¥è¡¨ç¤ºtag-length valueï¼Œä¾‹å¦‚HTTPã€FTPã€POP3ç­‰åè®®éƒ½æ˜¯ä½¿ç”¨è¿™ç§åŸºäºå¯è¯»æ–‡æœ¬çš„"Field: Value"åè®®ã€‚è¿™æ ·è®¾è®¡çš„åŸå› å¤§æ¦‚æ˜¯ç”±äºåœ¨â€œä¸Šå¤æ—¶ä»£â€ï¼Œäº’è”ç½‘é€Ÿåº¦è¿œå°äºCPUå¤„ç†çš„é€Ÿç‡ï¼ˆç°åœ¨æ›´åº”è¯¥æ˜¯&lt;strong&gt;è¿œè¿œå°äº&lt;/strong&gt;ï¼ŒCPUå·²ç»çˆ†äº†IOä¸€æ¡è¡—äº†ï¼‰ï¼Œè®¾è®¡ä¸€äº›æ›´å¯è¯»çš„åè®®å¯¹äººç±»æ¥è¯´ç¡®å®æ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;p&gt;è€ŒTCP/IPæ ¸å¿ƒåè®®éƒ½ä½¿ç”¨çš„å®šé•¿ä¸å¯å˜çš„åè®®ï¼Œè¿™æ ·å¯ä»¥ä½¿ç¼–ç ã€è§£æé€Ÿç‡è¾¾åˆ°æœ€å¿«ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºXMLå’Œjsonè¿™ç§å¥‡è¡Œç§ï¼Œæˆ‘ä»¬å°±ä¸è¯´äº†å§ :)&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé“¾æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://en.wikipedia.org/wiki/Type-length-value"&gt;Type-length-value&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.cnblogs.com/shitouer/archive/2013/04/12/google-protocol-buffers-encoding.html"&gt;Google Protocol Buffers ç¼–ç (Encoding)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://wizmann.tk/moujiecao.html"&gt;ç ´è§£èŠ‚æ“çš„ä¸‹é™&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="TLV"></category><category term="protocol"></category><category term="network"></category><category term="protobuf"></category><category term="flatbuffer"></category></entry><entry><title>Reasons They Recruit</title><link href="http://wizmann.tk/reasons-they-recruit.html" rel="alternate"></link><updated>2014-11-16T01:03:14+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-11-16:reasons-they-recruit.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;From &lt;em&gt;Ace of Programming Interview&lt;/em&gt;, Cpt1 - Hiring Programmers: The Inside Story&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Establish a Rapport&lt;/h2&gt;
&lt;p&gt;For an interviewee, one the the most efficient way to build a rapport is to &lt;strong&gt;try to see things in from the interviewer's perspective&lt;/strong&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;understand the motivation of the interviewer&lt;/li&gt;
&lt;li&gt;establishing a common ground&lt;/li&gt;
&lt;li&gt;adapting your responses appropritely&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Reasons They Recruit&lt;/h2&gt;
&lt;p&gt;If you know what the reason is and understand the motivation for it, then you can optimize your approach accordingly.&lt;/p&gt;
&lt;h3&gt;Planned Expansion&lt;/h3&gt;
&lt;p&gt;This is a common scenario that the company's expansion require them to take on more programmers accordance with the comming business growth. &lt;/p&gt;
&lt;h4&gt;The Interviewer vs. You&lt;/h4&gt;
&lt;p&gt;As the hiring is due to a long plan, so the interviewer is unlikely to feel a great sence of urgency. The interviewer will have a well prepared job description (a.k.a JD), or even a person profile. The interviewer are unlikely to compromise their pre-determined requirements. If you are deviate from their expectation, they will probable be less open to giving you the offer.&lt;/p&gt;
&lt;p&gt;Your approach is to &lt;strong&gt;highlight&lt;/strong&gt; these areas which matches to the job profile. That's the easy part.&lt;/p&gt;
&lt;p&gt;If your skills are not a good fit, you can use these three tricks below to change the situation.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Play it down&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Your first choice is to downplay the perceived gap in skills -- including the option of substituting other experience as being of equivalent value.&lt;/p&gt;
&lt;p&gt;For example,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œItâ€™s been my experience that it never takes long to learn the basics of a new component library, since, as programmers, we face an endless supply of new components and frameworks both open source and from the major vendors.â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;or,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œOne thing I really like about programming is the experience of learning new
technologies and platforms. Itâ€™s part of the ongoing attraction of the job.â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;However, the biggest risk in taking this approach is that you might appear evasive, so be wary of overdoing it.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Take it on the chin&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you decide to take it on the chin, simply agree with the interviewer's observation and at the same time show your enthusiasm for learning something new.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œI donâ€™t have experience of that particular technology but I would really enjoy learning it.â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If the interviewer persists, you might feel it appropriate to ask how other developers in the team might learn new things.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œCould you describe how the developers in your team generally learn new skills?â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Each example the interviewer gives you is an opportunity to show how, as a part of the team, you would &lt;strong&gt;benefit the same approach&lt;/strong&gt; and so acquire the necessary skill.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Understand the requirement&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Your third option is to gently probe the motives underpinning the requirement. The basic idea is that you explore the requirement looking to show that you understand and can meaningfully address the underlying requirement despite lacking a specific skill or experience.&lt;/p&gt;
&lt;p&gt;Whatever approach you take, keep in mind that you should not &lt;strong&gt;dwell on any particular mismatch&lt;/strong&gt;. In particular, keep you comment brief and to the point. The more you talk about it, the more prominence it will have in the interviewer's memory of the interview when they reflect afterward.&lt;/p&gt;
&lt;h3&gt;Specific Projet&lt;/h3&gt;
&lt;p&gt;When a company spots an opportunity in the market, it might scramble to put 
together a development team focused on delivering a solution to capitalize on 
the opportunity. &lt;/p&gt;
&lt;h4&gt;The Interviewer vs. You&lt;/h4&gt;
&lt;p&gt;The interviewer wants to know that you can work under pressure, and that you are someone who finishes what you start. Sometimes that the pressure to hire can relax the strictness with which the interviewer will match your experience against the details of job specification, although of course you can't assume that case.&lt;/p&gt;
&lt;p&gt;Be ware that although you have to demonstrate how your skills and experience are good match for the position, the interviewer also probable has the need of specific project in mind. You enthusiasm and ability to adapt might count for more than usual. Showing an ability of &lt;strong&gt;grasp key aspect of project&lt;/strong&gt; give you an advantage over others.&lt;/p&gt;
&lt;p&gt;If you are not sure of the motivation of hiring, there's absolutely no harm to ask directly:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Could I ask why you are recruiting? Is it for a specific project?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Replacing Someone&lt;/h3&gt;
&lt;p&gt;This is another common reason for hiring simply to replace someone who is leaving or has left the company.&lt;/p&gt;
&lt;h4&gt;The Interviewer vs. You&lt;/h4&gt;
&lt;p&gt;An interesting aspect of this situation is that they will probably have experience of a previous person i  lling this role, for better or for worse, and will therefore have a list of things they want to ensure the next person will and wonâ€™t bring to the role.&lt;/p&gt;
&lt;p&gt;Unless you are very lucky, you can't gather insight into what interviewer like or dislike prior to the interview. What you can do at the interview is ask about &lt;strong&gt;unique challenge for the role&lt;/strong&gt;, things for which you might to need to be on guard, and so on:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œCould you tell me a bit about the challenges of this role that might make it different from the usual programming job?â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you ask right questions, you may get vatal clues about the things you need to highlight with regard to your experience and ability:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œCan I ask whether there have been issues about how the team has been working together that make this ability particularly important?â€&lt;/p&gt;
&lt;/blockquote&gt;</summary><category term="interview"></category><category term="programming interview"></category><category term="è¯»ä¹¦"></category></entry><entry><title>Quora - What are effective ways to assess if someone is good at "getting things done"?</title><link href="http://wizmann.tk/good-at-get-things-done.html" rel="alternate"></link><updated>2014-11-15T16:08:10+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-11-15:good-at-get-things-done.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;Ian McAllister, GM at Amazon. I lead the AmazonSmile program.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;First, letâ€™s break â€œgetting things doneâ€ into two components: â€œexcellent functional skillsâ€ and â€œdriveâ€. Someone with great functional skills but poor drive will not get (enough) things done. Someone with great drive but poor functional skills will not get things done, or theyâ€™ll do the wrong things, or theyâ€™ll do the right things shittily.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Excellent functional skills&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can probe for domain knowledge and functional skills effectively in an interview or on a phone call. You come up with a list of role-specific responsibilities, probe deeply (several levels below the surface) into past examples where theyâ€™ve done similar work, and give them example challenges and see how they perform. You can make allowances for language or tool by letting them pick the language or tool of their choice, but donâ€™t give them a pass on accomplishing the task set forth. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Drive&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Drive is tougher to gauge effectively. Youâ€™ll have to form a picture of drive based on a number of different signals, and use your judgment on how heavily to weight each one.&lt;/p&gt;
&lt;p&gt;Projects theyâ€™ve initiated - Are they spawning new projects, based on their own ideas or prototypes? If so, thatâ€™s evidence theyâ€™re pushing the boundaries of their role in good ways. If they havenâ€™t, then they might make a good soldier, but youâ€™ll know going in that theyâ€™ll always need someone to tell them what to do next.&lt;/p&gt;
&lt;p&gt;Variation in projects or roles - Have they worked on the same types of projects for 5+ years? If so, they might have deep knowledge and be able to get things done in that domain, but it is evidence that they have a comfort zone. They clearly donâ€™t have a drive to leave or expand their comfort zone, and may not be effective if your role places them outside of it. Look for evidence that a candidate has initiated some type of change in the type of work they do.&lt;/p&gt;
&lt;p&gt;Progression in complexity of projects or roles - Someone good at getting things done gets more done over time. Often the results of this are not more projects, but projects of larger scope and complexity. A good rÃ©sumÃ© will show this, but you can also probe for it explicitly.&lt;/p&gt;
&lt;p&gt;Side projects - I have a hard time hiring engineers, web developers, or designers (maker roles) who donâ€™t have a history of side projects. These days, if youâ€™re hiring a young engineer youâ€™re looking for one who has been coding since she was twelve (or younger).&lt;/p&gt;
&lt;p&gt;I intend to add more signals as I think of them, but hopefully these are a start.&lt;/p&gt;</summary><category term="get things done"></category><category term="quora"></category><category term="career"></category></entry><entry><title>The Checklist of Steve Yegge</title><link href="http://wizmann.tk/steve-yegge-interview-checklist.html" rel="alternate"></link><updated>2014-10-26T00:24:44+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-10-26:steve-yegge-interview-checklist.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;Hey man, I don't know that stuff&lt;/p&gt;
&lt;p&gt;Stevey's talking aboooooout&lt;/p&gt;
&lt;p&gt;If my boss thinks it's important&lt;/p&gt;
&lt;p&gt;I'm gonna get fiiiiiiiiiired&lt;/p&gt;
&lt;p&gt;Oooh yeah baaaby baaaay-beeeeee....&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;éæŠ€æœ¯éƒ¨åˆ†&lt;/h2&gt;
&lt;h3&gt;çƒ­èº«&lt;/h3&gt;
&lt;h4&gt;å¥½å¥½è¯»ä¸€æœ¬è®²æ•°æ®ç»“æ„å’Œç®—æ³•çš„ä¹¦&lt;/h4&gt;
&lt;p&gt;ç†Ÿæ‚‰ä¸€äº›â€œæœ¯è¯­â€ï¼Œå¯ä»¥å¼ºåŒ–åˆ†è¾¨é—®é¢˜çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;Yeggeæ¨èäº† Steven S. Skiena çš„&lt;a href="http://book.douban.com/subject/4048566/"&gt;ã€Šç®—æ³•è®¾è®¡æ‰‹å†Œã€‹&lt;/a&gt;ï¼Œè€Œæˆ‘æ¨èçš„æ˜¯
Udi Manber çš„&lt;a href="http://book.douban.com/subject/1436134/"&gt;ã€Šç®—æ³•å¼•è®ºã€‹&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸€æœ¬ä¹¦éƒ½æœ‰å®ƒçš„é•¿å¤„çŸ­å¤„ã€‚æ‰¾ä¸€æœ¬è¯„ä»·ä¸é”™çš„ä¹¦ï¼Œè®¤çœŸè¯»å®Œï¼Œè‚¯å®šä¼šæœ‰æ”¶è·ã€‚&lt;/p&gt;
&lt;h4&gt;æ‰¾ä¸ªæœ‹å‹æ¥é¢è¯•ä½ ï¼Œå°è¯•ç™½æ¿ç¼–ç¨‹&lt;/h4&gt;
&lt;p&gt;åœ¨ç™½çº¸/ç™½æ¿ä¸Šç¼–ç¨‹çš„ä½“éªŒå’Œåœ¨è®¡ç®—æœºä¸Šå¤§æœ‰ä¸åŒã€‚æ²¡æœ‰æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œè¯•è¯•Leetcodeçš„â€œPick oneâ€ï¼Œç„¶ååœ¨ç™½çº¸ä¸Šç»ƒä¹ å§ï¼&lt;/p&gt;
&lt;h4&gt;åœ¨é¢è¯•å‰ä¿æŒè­¦é†’ï¼Œå……åˆ†çƒ­èº«&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;è¯»è¯»ä¹¦è®°&lt;/li&gt;
&lt;li&gt;å–ç‚¹å’–å•¡ï¼Œè¿™å¯ä»¥è®©ä½ çš„æ€è·¯å¿«ä¸€äº›&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å¿ƒç†å‡†å¤‡&lt;/h3&gt;
&lt;h4&gt;ä¿æŒè°¦é€Šã€å¼€æ˜ã€ä¸“æ³¨çš„æ€åº¦&lt;/h4&gt;
&lt;p&gt;ä¸è¦è´¨ç–‘é¢è¯•å®˜çš„æ°´å¹³ï¼Œä½†æ˜¯ä¹Ÿä¸è¦å®³æ€•é—®é—®é¢˜ã€‚é—®ä¸€ä¸ªè ¢é—®é¢˜æ€»æ¯”æ²‰é»˜åƒµæŒåŠå°æ—¶è¦å¥½çš„å¤šã€‚å†µä¸”ï¼Œä¸€ä¸ªå¥½é—®é¢˜ä¹Ÿè®¸è¿˜æ˜¯ä¸€ä¸ªåŠ åˆ†é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”ï¼Œä¸è¦å°è¯•å»è½¬ç§»è¯é¢˜ï¼ŒæŠŠæ³¨æ„åŠ›æ”¾åœ¨é—®é¢˜æœ¬èº«ã€‚&lt;/p&gt;
&lt;h4&gt;äº†è§£é¢è¯•å®˜å¯¹ä»£ç çš„è¦æ±‚&lt;/h4&gt;
&lt;p&gt;æœ‰çš„é¢è¯•å®˜ä¸ä¼šè¦æ±‚ä½ å†™ä»£ç ï¼Œä½†æ˜¯ä»–ä»¬å¸Œæœ›ä½ åœ¨å›ç­”é—®é¢˜æ—¶å†™ä¸€ç‚¹ä»£ç ã€‚å¦‚æœä½ ä¸èƒ½ç¡®å®šï¼Œä¸å¦¨ç›´æ¥é—®ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒçš„é¢è¯•å®˜å¯¹äºé¢è¯•ä»£ç é£æ ¼çš„è¦æ±‚æ˜¯ä¸ä¸€è‡´çš„ï¼Œå¯¹äºè‹›åˆ»çš„é¢è¯•å®˜ï¼Œæœ€å¥½æé«˜å¯¹ä»£ç çš„è¦æ±‚ã€‚å¹¶ä¸”ä»”ç»†æ£€æŸ¥ã€‚&lt;/p&gt;
&lt;h4&gt;é—®é—®é¢˜çš„è‰ºæœ¯&lt;/h4&gt;
&lt;p&gt;åœ¨é¢è¯•ä¸­çš„æœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹æ˜¯å¯ä»¥é—®çš„ï¼ˆå¹¶ä¸”é—®é—®é¢˜æ˜¯è¢«é¼“åŠ±çš„ï¼‰ï¼Œæœ‰æ—¶å€™è¿˜å¯ä»¥å»å’Œé¢è¯•å®˜ç¡®è®¤è‡ªå·±æ˜¯ä¸æ˜¯åœ¨æ­£ç¡®çš„æ–¹å‘ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆéƒ½ä¸é—®ï¼Œç›´æ¥å†²åˆ°ç™½æ¿å‰å¼€å§‹å†™ä»£ç æœ‰å¯èƒ½ä¼šç•™ä¸‹â€œè®¾è®¡æ— ç”¨â€çš„åå°è±¡ã€‚æ‰€ä»¥ï¼Œå³ä½¿ä½ ç¡®å®šè‡ªå·±æ€ä¹ˆåšï¼Œä¹Ÿè¦å…ˆè¯´è¯´è‡ªå·±æ˜¯æ€ä¹ˆæ ·çš„ã€‚ä½†æ˜¯ï¼Œä¹Ÿä¸è¦è¯´çš„å¤ªå¤šã€‚&lt;/p&gt;
&lt;h4&gt;è‡ªå¸¦é«˜çº§è£…å¤‡&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ç»†å¤´å¯æ“¦é©¬å…‹ç¬”&lt;/li&gt;
&lt;li&gt;é“…ç¬”å’Œæ©¡çš®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨é¢è¯•ä¸­è¦ä½¿ç”¨ä¸€åˆ‡å¯ä»¥ä½¿ç”¨çš„èµ„æºï¼Œä¾‹å¦‚ç™½æ¿ä¸Šçš„ç©ºé—´ç®¡ç†ã€‚&lt;/p&gt;
&lt;h2&gt;æŠ€æœ¯éƒ¨åˆ†&lt;/h2&gt;
&lt;h3&gt;ç®—æ³•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¤§O&lt;/li&gt;
&lt;li&gt;æ’åºç®—æ³• â€”â€” å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åº&lt;/li&gt;
&lt;li&gt;å“ˆå¸Œè¡¨&lt;/li&gt;
&lt;li&gt;æ ‘ â€”â€” æ„é€ å’Œéå†&lt;/li&gt;
&lt;li&gt;è‡³å°‘ç†Ÿæ‚‰ä¸€ç§å¹³è¡¡äºŒå‰æ ‘ â€”â€” å¿…é¡»æŒæ¡å®ç°ç»†èŠ‚&lt;/li&gt;
&lt;li&gt;å›¾ â€”â€” å­˜å‚¨ä¸éå†ï¼ŒDijkstraå’ŒA*&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯æ¬¡é‡åˆ°é—®é¢˜ï¼Œé¦–å…ˆåº”å½“è€ƒè™‘çš„å°±æ˜¯å›¾ç®—æ³•ã€‚å®ƒä»¬æ˜¯ä»»ä½•å…³ç³»æœ€åŸºæœ¬ã€æœ€çµæ´»çš„è¡¨ç¤ºæ–¹æ³•ï¼Œä»»ä½•æœ‰ç‚¹æ„æ€çš„è®¾è®¡é—®é¢˜å¯ä»¥è¯´æœ‰ä¸€åŠçš„æœºä¼šæ¶‰åŠå›¾ç®—æ³•ã€‚åªæœ‰åœ¨ä½ ç™¾åˆ†ä¹‹ç™¾ç¡®å®šæ²¡åŠæ³•ç”¨å›¾ç®—æ³•æ¥è§£çš„æ—¶å€™ï¼Œæ‰èƒ½å»è€ƒè™‘å…¶å®ƒæ–¹æ¡ˆã€‚è¿™æ¡å»ºè®®ä¸€å®šè¦ç‰¢è®°åœ¨å¿ƒï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;NPé—®é¢˜ â€”â€” åº”è¯¥çŸ¥é“NPå®Œå…¨é—®é¢˜æ˜¯ä»€ä¹ˆæ„æ€&lt;/li&gt;
&lt;li&gt;å¥½å¥½è¯»æ•°æ®ç»“æ„ä¹¦ï¼Œ&lt;strong&gt;èƒ½è®°å¤šå°‘è®°å¤šå°‘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;ç¦»æ•£æ•°å­¦ â€”â€” è®¡æ•°é—®é¢˜ã€æ¦‚ç‡é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;è®¡ç®—æœºåŸºç¡€çŸ¥è¯†&lt;/h3&gt;
&lt;h4&gt;æ“ä½œç³»ç»Ÿ&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;è¿›ç¨‹ã€çº¿ç¨‹ã€å¹¶å‘&lt;/li&gt;
&lt;li&gt;é”ã€äº’æ–¥é”ã€ä¿¡å·é‡ï¼Œç®¡ç¨‹æœºåˆ¶&lt;/li&gt;
&lt;li&gt;æ­»é”å’Œæ´»é”&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹å’Œçº¿ç¨‹å„éœ€è¦ä»€ä¹ˆèµ„æºã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€è°ƒåº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½œè€…æ¨èäº† Doug Lea çš„&lt;a href="http://book.douban.com/subject/1244021/"&gt;ã€ŠJavaå¹¶å‘ç¼–ç¨‹ã€‹&lt;/a&gt;ï¼Œåšä¸ºä¸€ä¸ªJava haterï¼Œæˆ‘å†³å®šè¿˜æ˜¯å‹‰ä¸ºå…¶éš¾çš„çœ‹ä¸€ä¸‹å§ã€‚:)&lt;/p&gt;
&lt;h4&gt;è¯­è¨€&lt;/h4&gt;
&lt;p&gt;è‡³å°‘è¦ç†Ÿç»ƒæŒæ¡ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œæœ€å¥½æ˜¯C++æˆ–è€…Javaã€‚å¹¶ä¸”&lt;strong&gt;ä¸€å®šè¦å¯¹é‚£é—¨è¯­è¨€çš„ç»†èŠ‚æœ‰ç›¸å½“ç¨‹åº¦çš„äº†è§£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4&gt;å…¶å®ƒçš„åŸºç¡€çŸ¥è¯†&lt;/h4&gt;
&lt;p&gt;åœ¨ä½œè€…çš„æ–‡ç« ä¸­æ²¡æœ‰æåˆ°çš„ï¼Œä½†æ˜¯ä¹Ÿè®¸æ¯”è¾ƒé‡è¦çš„çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CSä¸“ä¸šç¬¬äºŒé‡è¦çš„çŸ¥è¯† â€”â€” ç¼–è¯‘åŸç†&lt;/li&gt;
&lt;li&gt;è®¡ç®—æœºç½‘ç»œ â€”â€” TCP/IPåè®®ä¹Ÿè®¸æ˜¯ä¸ªé‡ç‚¹&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“çš„ä¸€äº›çŸ¥è¯†&lt;/li&gt;
&lt;li&gt;MapReduceï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å…¶å®ƒ&lt;/h2&gt;
&lt;p&gt;å‰©ä¸‹çš„åŸºæœ¬å°±æ˜¯çœ‹è„¸äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="puzzles" src="http://wizmann-pic.qiniudn.com/fa4b0cfd335bae28abf23d34fc6e84ee" /&gt;&lt;/p&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å¥½å¥½çƒ­èº«ã€‚å®é™…å·¥ä½œåªä¼šè®©ä½ ååº”è¿Ÿé’ï¼&lt;/p&gt;
&lt;/blockquote&gt;</summary><category term="interview"></category><category term="Google"></category></entry><entry><title>Snake Problem</title><link href="http://wizmann.tk/snake-problem.html" rel="alternate"></link><updated>2014-10-20T09:11:27+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-10-20:snake-problem.html</id><summary type="html">&lt;h2&gt;é¢˜ç›®&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªå¹³é¢ä¸Šï¼Œæœ‰n+mæ¡è›‡ï¼Œå…¶ä¸­næ¡è›‡æ²¿æ°´å¹³æ–¹å‘ï¼ˆyè½´æ–¹å‘ï¼‰ç§»åŠ¨ï¼Œmæ¡è›‡æ²¿ç«–ç›´æ–¹å‘ï¼ˆxè½´æ–¹å‘ï¼‰ç§»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;ç°ç»™å‡ºè¿™äº›è›‡å¤´å’Œå°¾æ‰€åœ¨çš„åæ ‡ç‚¹ï¼Œæ±‚å‡ºè¿™n+mæ¡è›‡åœ¨æ­¤æ—¶å…±æœ‰å¤šå°‘ä¸ªäº¤ç‚¹ã€‚åœ¨åŒä¸€ä¸ªæ–¹å‘ç§»åŠ¨çš„è›‡ä¸ä¼šæœ‰äº¤ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œn = 5, m = 4ï¼Œè¿™äº›è›‡ä¸€å…±æœ‰5ä¸ªäº¤ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="data:image/png;base64,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" /&gt;&lt;/p&gt;
&lt;h2&gt;åˆ†æ&lt;/h2&gt;
&lt;p&gt;å¯¹äºæ­¤é¢˜ï¼Œæœ€ç®€å•ç›´æ¥çš„æ–¹æ³•å°±æ˜¯æšä¸¾è›‡ä¸¤ä¸¤ä¹‹é—´çš„å…³ç³»ï¼Œè¿™ç§ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘ä»¬ä¸èƒ½æ»¡è¶³äºè¿™ç§æš´åŠ›çš„è§£æ³•ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰æ›´ä¼˜ç¾çš„æ–¹æ³•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt text" src="data:image/png;base64,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" /&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ä¸€æ¡åœ¨yè½´æ–¹å‘ä¸Šçš„ï¼ˆçº¢ï¼‰è›‡æ¥è¯´ï¼Œå®ƒä¸xè½´æ–¹å‘ä¸Šçš„ï¼ˆé»‘ï¼‰è›‡å…±æœ‰ä¸‰ä¸ªäº¤ç‚¹ã€‚é‚£ä¹ˆï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œé—®é¢˜çš„å…³é”®åœ¨äºï¼Œæˆ‘ä»¬å¦‚ä½•å¿«é€Ÿç¡®å®šæŸä¸€æ¡çº¢è›‡ï¼ˆæˆ–é»‘è›‡ï¼‰ä¸å…¶å®ƒè›‡ä¸€å…±æœ‰å¤šå°‘ä¸ªäº¤ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥åšå‡ºå¦‚ä¸‹å‡è®¾ï¼Œæˆ‘ä»¬çŸ¥é“å½“x = kæ—¶ï¼Œæ‰€æœ‰åœ¨å¹³é¢ä¸Šçš„è›‡çš„ä½ç½®ã€‚æ ¹æ®è¿™ä¸ªå‡è®¾ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒºé—´æ±‚å’Œçš„ç®—æ³•æ¥ç¡®å®šç«–ç›´ä½ç½®ä¸Šçš„è›‡ä¼šæœ‰å¤šå°‘ä¸ªç„¦ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬ä»x = 0åˆ°x = MAX_Xæ–¹å‘è¿›è¡Œæ‰«æï¼Œæ¯æ¡è›‡åœ¨æ‰«ææ—¶ï¼Œéƒ½æœ‰ä¸”åªæœ‰ä¸¤ç§çŠ¶æ€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰«æçº¿ç¬¬ä¸€æ¬¡ç»è¿‡è›‡çš„æŸç«¯ç‚¹&lt;/li&gt;
&lt;li&gt;æ‰«æçº¿ç¬¬äºŒæ¬¡ç»è¿‡è›‡çš„å¦ä¸€ä¸ªç«¯ç‚¹ï¼ˆåºŸè¯ï¼ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªçŠ¶æ€åˆ†åˆ«æ„å‘³ç€æŸä¸€æ¡é»‘è›‡åœ¨x = kæ—¶æ˜¯å¦å­˜åœ¨ã€‚æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬uä¸ªå…ƒç´ ä»£è¡¨y = uçš„é»‘è›‡æ˜¯å¦åœ¨x = kæ—¶å­˜åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œå½“æˆ‘ä»¬æŸ¥è¯¢ä¸€æ¡x = [v, w]ä½ç½®çš„çº¢è›‡å…±æœ‰å¤šå°‘ä¸ªäº¤ç‚¹æ—¶ï¼Œåªéœ€è¦è®¡ç®—æ•°ç»„ä¸­[v ... w]å…ƒç´ çš„å’Œã€‚è€Œä½¿ç”¨æ ‘çŠ¶æ•°ç»„(Binary Indexed Tree, BIT)ï¼Œæ¯æ¬¡è¿™æ ·çš„æŸ¥è¯¢åªéœ€è¦O(logN)æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N * logN)ï¼Œæ¯”O(N^2)çš„ç®—æ³•ä¼˜åŒ–äº†å¾ˆå¤šã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;lowbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;BITree&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;lowbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;lowbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Snake&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// manual tested&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;count_intersection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;xsnakes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ysnakes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Mark&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;xsnakes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Mark&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;}));&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Mark&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;}));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ysnakes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Mark&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;}));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ysnakes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ysnakes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Mark&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;friend&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Mark&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Mark&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="n"&gt;BITree&lt;/span&gt; &lt;span class="n"&gt;_tree&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;xsnakes&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ysnakes&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;}),&lt;/span&gt;
        &lt;span class="n"&gt;Snake&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt; &lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="n"&gt;Solution&lt;/span&gt; &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count_intersection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xsnakes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ysnakes&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;é¢˜ç›®æ¥æº&lt;/h2&gt;
&lt;p&gt;ã€Šç®—æ³•å¼•è®ºã€‹&lt;/p&gt;
&lt;h2&gt;æ‰©å±•é¢˜ç›®&lt;/h2&gt;
&lt;p&gt;POJ-2482 &lt;a href="http://poj.org/problem?id=2482"&gt;Stars in Your Window&lt;/a&gt;&lt;/p&gt;</summary><category term="binary indexed tree"></category><category term="algorithm"></category><category term="geometric"></category></entry><entry><title>æ€ç»´è®­ç»ƒ - Thinkin' in induction 2</title><link href="http://wizmann.tk/thinking-in-induction-2.html" rel="alternate"></link><updated>2014-10-01T00:05:29+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-10-01:thinking-in-induction-2.html</id><summary type="html">&lt;h2&gt;æœ€å¤§å¯¼å‡ºå­å›¾ï¼ˆmaximal induced graphï¼‰&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½ ç°åœ¨åœ¨ç»„ç»‡ä¸€ä¸ªå­¦æœ¯ä¼šè®®ã€‚ç°åœ¨ä½ æœ‰ä¸€ä»½äººå‘˜åå•ã€‚å‡å®šåå•ä¸­çš„æ¯ä¸€ä¸ªäººéƒ½åŒæ„åˆ°è¾¾ï¼Œå¹¶ä¸”æœ‰å……è¶³çš„æ—¶é—´äº¤æµæ„è§ã€‚åŒæ—¶ï¼Œæ¯ä¸€ä¸ªç§‘å­¦å®¶éƒ½å†™ä¸‹äº†ä»–æ„¿æ„ä¸å…¶è¿›è¡Œäº¤æµçš„ç§‘å­¦å®¶çš„åå­—ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œé—®é¢˜æ¥äº†ï¼š&lt;del&gt;æŒ–æ˜æœºæŠ€æœ¯å“ªå®¶å¼ºï¼Ÿ&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦ä¿è¯æ¯ä¸€ä½ç§‘å­¦å®¶è‡³å°‘èƒ½ä¸kä½åˆ°åœºçš„ç§‘å­¦å®¶è¿›è¡Œæ·±å…¥çš„äº¤â™‚æµâ™‚ã€‚é‚£ä¹ˆæˆ‘ä»¬æœ€å¤šå¯ä»¥é‚€è¯·å¤šå°‘äººåˆ°ä¼šï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ³¨ï¼šå¦‚æœAæ„¿æ„å’ŒBäº¤æµï¼ŒABä¸€å®šä¼šè¿›è¡Œäº¤æµã€‚åä¹‹äº¦ç„¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æŠŠé—®é¢˜è½¬åŒ–æˆæ•°å­¦è¯­è¨€ï¼šå¯¹äºä¸€ä¸ªæ— å‘å›¾&lt;code&gt;G=(V, E)&lt;/code&gt;ï¼Œè¯•æ±‚å¾—Gçš„æœ€å¤§å¯¼å‡ºå­å›¾Hï¼Œä½¿å¾—Hä¸­æ‰€æœ‰é¡¶ç‚¹çš„åº¦å¤§äºæˆ–ç­‰äºkï¼Œæˆ–è€…è¯æ˜è¿™æ ·çš„å­å›¾æ˜¯ä¸å­˜åœ¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å½’çº³çš„æ€æƒ³æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ˜“å¾—ï¼Œå¯¹äºé¡¶ç‚¹æ•°ä¸ºkçš„å›¾ï¼Œå¦‚æœå­˜åœ¨k-å¯¼å‡ºå­å›¾ï¼Œåˆ™è¯¥å›¾å¿…ä¸ºä¸€ä¸ªå®Œå…¨å›¾ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ï¼Œå¯¹äºä»»æ„é¡¶ç‚¹æ•°å°äºnçš„å›¾ï¼Œæˆ‘ä»¬æ€»å¯ä»¥æ‰¾åˆ°å›¾çš„k-æœ€å¤§å¯¼å‡ºå­å›¾ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæœ‰nä¸ªé¡¶ç‚¹çš„å›¾Gæ¥è¯´ï¼Œå¦‚æœæœ‰ä»»æ„é¡¶ç‚¹çš„åº¦å°äºkï¼Œé‚£ä¹ˆå¯¹äºå›¾Gçš„ä»»æ„å­å›¾ï¼Œæ­¤é¡¶ç‚¹çš„åº¦æ€»å°äºkã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¯¹äºå›¾ä¸­ä»»æ„åº¦å°äºkçš„ç‚¹ï¼Œå¿…ç„¶ä¸å±äºæ‰€æ±‚çš„å­å›¾ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æ¯æ¬¡åˆ é™¤ä¸€ä¸ªä¸å±äºk-å¯¼å‡ºå­å›¾çš„ç‚¹ï¼Œå°±å¯ä»¥æŠŠæœ‰nä¸ªé¡¶ç‚¹çš„å›¾é—®é¢˜åŒ–å½’ä¸ºn-1é¡¶ç‚¹çš„å›¾é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸€å¯¹ä¸€æ˜ å°„&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé›†åˆAå’Œä¸€ä¸ªæ˜ å°„å…³ç³»fã€‚æ±‚Açš„ä¸€ä¸ªå­é›†Sï¼Œä½¿å¾—få¯¹äºSæ˜¯ä¸€ä¸ªä¸€å¯¹ä¸€æ˜ å°„ã€‚å³ï¼šfæŠŠSä¸­çš„ä¸€ä¸ªå…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªå…ƒç´ ï¼›Sä¸­æ²¡æœ‰ä¸¤ä¸ªå…ƒç´ æ˜ å°„åˆ°åŒä¸€ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬ä»ç„¶å¯ä»¥åšå‡è®¾ï¼šå¯¹äºå«æœ‰kä¸ªå…ƒç´ çš„é›†åˆï¼Œæˆ‘ä»¬æœ‰æ–¹æ³•æ‰¾åˆ°æ‰€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;åŸºç¡€æƒ…å†µçš„è¯æ˜éå¸¸ç®€å•ï¼Œå¯¹äºä¸€ä¸ªç‚¹çš„æƒ…å†µï¼Œ&lt;code&gt;f(A) = A&lt;/code&gt;æ»¡è¶³æ¡ä»¶ã€‚å¯¹äºä¸¤ä¸ªç‚¹ï¼Œæ‰¾åˆ°ä¸¤ä¸ªç‚¹&lt;code&gt;(A, B)&lt;/code&gt;ï¼Œåœ¨å›¾ä¸­æœ‰&lt;code&gt;(A -&amp;gt; B)&lt;/code&gt;å’Œ&lt;code&gt;(B -&amp;gt; A)&lt;/code&gt;å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä»»æ„é›†åˆï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šï¼Œå½“æ²¡æœ‰&lt;code&gt;f(x) = i&lt;/code&gt;æ—¶ï¼Œå…ƒç´ iå¿…ç„¶ä¸å±äºè¿™ä¸ªé›†åˆã€‚æ‰€ä»¥ï¼Œæ¯æ¬¡æ“ä½œæˆ‘ä»¬éƒ½åˆ é™¤æ‰å¿…ç„¶ä¸å±äºæ‰€æ±‚å­é›†çš„é‚£ä¸ªç‚¹ï¼ŒæŠŠé—®é¢˜&lt;code&gt;Q(n)&lt;/code&gt;åŒ–å½’ä¸ºå­é—®é¢˜&lt;code&gt;Q(n-1)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2&gt;ç¤¾ä¼šåæµé—®é¢˜&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¤¾ä¼šåæµéƒ½æ˜¯é€¼æ ¼æ¯”è¾ƒé«˜çš„äººï¼Œè¿™ä½“ç°åœ¨æ‰€æœ‰çš„äººéƒ½è®¤è¯†ä»–ï¼Œä½†æ˜¯ä»–ä¸è®¤è¯†ä»»ä½•äººã€‚&lt;/p&gt;
&lt;p&gt;è¯•åœ¨nä¸ªäººçš„èšä¼šä¸­ï¼Œæ‰¾å‡ºå”¯ä¸€çš„åæµã€‚è€Œæ‰¾å‡ºçš„åæµçš„æ–¹æ³•ï¼Œå°±æ˜¯è¯¢é—®ä»»æ„ä¸€ä¸ªäººï¼šDo you know that person? æ¯ä¸€ä¸ªäººéƒ½ä¼šå¦‚å®å›ç­”ã€‚è€Œä½ çš„ç›®æ ‡æ˜¯ä½¿è¯¢é—®æ¬¡æ•°æœ€å°‘ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬ä»ç„¶ä½¿ç”¨å½’çº³çš„æ–¹æ³•ï¼Œå¦‚æœè¿™ä¸ªèšä¼šåªæœ‰ä¸¤ä¸ªäººï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±çŸ¥é“è°&lt;strong&gt;ä¸æ˜¯&lt;/strong&gt;åæµã€‚(Why?)&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸€èˆ¬çš„æƒ…å†µï¼Œå¦‚æœè¯¢é—®Aï¼šDo you know person B?&lt;/p&gt;
&lt;p&gt;å¦‚æœAå›ç­”YESï¼Œé‚£ä¹ˆAå¿…ç„¶ä¸æ˜¯åæµã€‚å¦‚æœAå›ç­”NOï¼Œé‚£ä¹ˆBä¸æ˜¯åæµã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æ˜¯ï¼Œæˆ‘ä»¬åˆå¯ä»¥ä¸€æ­¥ä¸€æ­¥ç¼©å°é¢˜ç›®çš„æ•°æ®èŒƒå›´ã€‚æœ€ååœ¨æ’é™¤äº†æ‰€æœ‰&lt;strong&gt;ä¸æ˜¯&lt;/strong&gt;åæµçš„äººä¹‹åï¼Œå¯¹æœ€åä¸€ä¸ªå€™é€‰äººå†è¿›è¡Œä¸€è½®éªŒè¯ã€‚&lt;/p&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šä¸‰é¢˜éƒ½æ˜¯&lt;strong&gt;Thinkin' in induction&lt;/strong&gt;çš„è‰¯å¥½èŒƒä¾‹ã€‚å¯¹äºæœ‰äº›é¢˜ç›®ï¼Œåšå‡ºå¤§èƒ†çš„å‡è®¾å¹¶ä¸æ˜¯çº¯ç²¹çš„ç¢°è¿æ°”ï¼Œè€Œæ˜¯ä¸€ç§ç§‘å­¦çš„å°è¯•ã€‚åŒæ—¶ï¼Œåœ¨æ€è€ƒæ—¶ï¼Œå¦‚æœä¸èƒ½ç›´è§‚çš„æ‰¾å‡ºâ€œè°æ˜¯å¯¹çš„â€œï¼Œæˆ‘ä»¬ä¸å¦¨åå‘æ€è€ƒä¸€ä¸‹ï¼Œæ‰¾å‡ºâ€œè°æ˜¯ä¸å¯¹çš„â€ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å‚è€ƒUdi Manberçš„ã€ŠIntroduction to algorithms - A creative approachã€‹.&lt;/p&gt;</summary><category term="induction"></category><category term="algorithm"></category></entry><entry><title>æ€ç»´è®­ç»ƒ - Thinkin' in induction</title><link href="http://wizmann.tk/thinking-in-induction.html" rel="alternate"></link><updated>2014-09-26T00:10:45+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-09-26:thinking-in-induction.html</id><summary type="html">&lt;h2&gt;çƒ­èº«é¢˜ - 24Game&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://codeforces.com/contest/469/problem/C"&gt;åŸé¢˜è¯·æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;é¢˜æ„&lt;/h3&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªåŒ…å«æ•´æ•°1...nçš„é›†åˆSã€‚æ¥ä¸‹æ¥è¿›è¡Œn-1æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œä»é›†åˆSä¸­é€‰å–ä¸¤ä¸ªæ•°ï¼Œåœ¨åŠ ã€å‡ã€ä¹˜ä¸‰ç§è¿ç®—ä¸­é€‰å–ä¸€ç§ï¼Œå°†ç»“æœæ”¾å›å†é›†åˆSã€‚åœ¨n-1æ¬¡æ“ä½œå®Œæˆåï¼Œé›†åˆSä¸­åªå‰©ä¸‹ä¸€ä¸ªæ•°ã€‚æ±‚é—®ä¸€ç§å–æ•°å’Œè¿ç®—ç­–ç•¥ï¼Œä½¿æœ€åçš„ç»“æœä¸º24ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;S = [1, 2, 3, 4, 5]&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€‰å–(2, 5)ï¼Œå¹¶è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œè·å¾—ç»“æœ7ã€‚å†å°†7æ”¾å›é›†åˆSä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼ŒS = [1, 3, 4, 7]ã€‚&lt;/p&gt;
&lt;h3&gt;æ•°æ®èŒƒå›´&lt;/h3&gt;
&lt;p&gt;1 &amp;lt;= n &amp;lt;= 100000&lt;/p&gt;
&lt;h3&gt;è§£ç­”&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å»ºè®®ï¼šè¯·æ€è€ƒ10åˆ†é’Ÿåå†æ¥çœ‹ç­”æ¡ˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬æ—¥å¸¸å†™ä»£ç ï¼Œå¾€å¾€æ˜¯ä¸ºäº†å®ç°ä¸€ä¸ªåŠŸèƒ½æˆ–è€…å®ç°ä¸€å¥—é€»è¾‘ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬åšçš„äº‹ä¸€èˆ¬æ˜¯ä»é›¶å¼€å§‹ï¼Œç„¶åé€æ­¥è¿­ä»£ï¼Œæœ€ç»ˆå®ç°ç›®æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æ­£å¸¸çš„ä¸€ç§æ€ç»´æ–¹å¼ï¼Œä¹Ÿæ˜¯ä¸é”™çš„æ€ç»´ã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘ä»¬åšé¢˜æ—¶ï¼ŒæŒ‰éƒ¨å°±ç­çš„æ€è·¯å¾€å¾€ä¼šæŸç¼šæˆ‘ä»¬çš„æƒ³æ³•ã€‚æˆ‘ç»å¸¸è‡ªé»‘è¯´ï¼š&lt;strong&gt;â€œåšä»€ä¹ˆé¢˜éƒ½åƒåšæ¨¡æ‹Ÿé¢˜â€&lt;/strong&gt;ï¼Œå®é™…ä¸Šå°±æ˜¯è¿™æ ·ä¸€ä¸ªé“ç†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ­¤é¢˜ï¼Œå¦‚æœæˆ‘ä»¬ä»é›¶å¼€å§‹æ€è€ƒï¼Œå¿…ç„¶ä¼šé‡åˆ°â€œç¬¬ä¸€æ¬¡é€‰å“ªä¸¤ä¸ªæ•°â€ã€â€œç¬¬äºŒæ¬¡é€‰å“ªä¸¤ä¸ªæ•°â€è¿™æ ·çš„é—®é¢˜ï¼Œè€Œè§£å†³è¿™ç§é—®é¢˜çš„æ–¹å¼å¤§å¤šåªèƒ½æœ‰æš´åŠ›æœç´¢ä¸€ç§æ–¹å¼ã€‚è€Œæ ¹æ®è¿™é¢˜çš„æ•°æ®è§„æ¨¡ï¼Œæš´åŠ›æœç´¢åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æ˜¯ä¸å¯èƒ½çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¹Ÿæœ‰çš„åŒå­¦å–„äºé€†å‘æ€ç»´ï¼Œä½†æ˜¯ï¼ŒåŒæ ·ä¹Ÿä¼šè¿›å…¥æš´åŠ›æœç´¢çš„æ­»è·¯ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè¿™é¢˜å¦‚ä½•æ€è€ƒå‘¢ï¼Ÿ æˆ‘ä»¬ä¸å¦¨è¯•è¯•å½’çº³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾&lt;code&gt;n = k&lt;/code&gt;ï¼Œå¹¶ä¸”æœ‰&lt;code&gt;f(k)&lt;/code&gt;ï¼Œä½¿å¾—&lt;code&gt;f(k)=&amp;gt;24&lt;/code&gt;ã€‚é‚£ä¹ˆï¼Œæ˜“å¾—ï¼Œå¯¹äº&lt;code&gt;f(k + 2)=&amp;gt;f(k) * ((k + 2) - (k + 1))=&amp;gt;24&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°&lt;code&gt;f(k)=&amp;gt;24&lt;/code&gt;ï¼Œå°±å¯ä»¥è¯æ˜æ‰€æœ‰&lt;code&gt;f(k + 2x) =&amp;gt; 24&lt;/code&gt;ã€‚èªæ˜çš„åŒå­¦ä»¬å¿…ç„¶å¯ä»¥æ‰‹åŠ¨ç®—å‡º&lt;code&gt;f(4) = 24&lt;/code&gt;çš„è¿‡ç¨‹ï¼Œè¿™å¯ä»¥è¯æ˜å¯¹äºæ‰€æœ‰&lt;code&gt;k &amp;gt;= 4&lt;/code&gt;çš„å¶æ•°ï¼Œæ€»æœ‰&lt;code&gt;f(k) =&amp;gt; 24&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;f(5) =&amp;gt; 24&lt;/code&gt;ç•¥å¾®å¤æ‚ä¸€ç‚¹ï¼Œä½†æ˜¯ä¹Ÿä¸åœ¨è¯ä¸‹ã€‚è¿™æ ·æˆ‘ä»¬çš„ç»“è®ºå·²ç»æ‰©å±•åˆ°äº†&lt;code&gt;k &amp;gt;= 4&lt;/code&gt;çš„æ‰€æœ‰æ•´æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åˆç”±äºåœ¨&lt;code&gt;k = [1, 2, 3]&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;f(k)&lt;/code&gt;å¿…é¡»ä¸èƒ½æ¨å‡º24ã€‚æˆ‘ä»¬çš„ç»“è®ºå·²ç»æ¨å¹¿åˆ°äº†æ‰€æœ‰æ­£æ•´æ•°ã€‚æ­¤é¢˜å¾—è¯ã€‚&lt;/p&gt;
&lt;h2&gt;å½’çº³æ³•&lt;/h2&gt;
&lt;p&gt;åœ¨Udi Manberçš„_Introdcution to Algorithms - A creative approach_ä¸€ä¹¦ä¸­ï¼Œåœ¨ç¬¬äºŒç« å°±å¯¹æ•°å­¦å½’çº³æ³•è¿›è¡Œäº†å¤§ç¯‡å¹…çš„çš„è®²è§£ã€‚è€Œåœ¨ä¸€èˆ¬çš„ç®—æ³•ä¹¦ä¸­ï¼Œè¿™ä¸ªä½ç½®å¾€å¾€æ˜¯ç»™äº†ç®—æ³•åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;å½’çº³æ³•æ˜¯ä¸€ç§â€œéå¸¸æœ‰åŠ›çš„è¯æ˜æ–¹æ³•â€ï¼Œå¯ä»¥æä¾›ä¸€ç§æƒ³é—®é¢˜çš„æ–¹æ³•ï¼ŒåŒæ—¶å¯ä»¥è¯æ˜ç®—æ³•çš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å½’çº³æ³•çš„åŸºæœ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Let T be a theorem we want to prove.&lt;/p&gt;
&lt;p&gt;Suppose that T includes a parameter n whose value can be any natural number. &lt;/p&gt;
&lt;p&gt;Instead of proving directly that T holds for all values of n, we prove the following two conditions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;T holds for n = 1&lt;/li&gt;
&lt;li&gt;For every n &amp;gt; 1, if T holds for n - 1, then T holds for n&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2&gt;å½’çº³æ³•åº”ç”¨ â€”â€” ç¬›å¡å°”æ ‘&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å·²çŸ¥ä¸€ä¸ªæœ€å¤§å †çš„ä¸­åºéå†åºé‡Œï¼Œè¦æ±‚æ¢å¤è¯¥æœ€å¤§å †ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ–è€…ç”¨å¦å¤–ä¸€ç§æ–¹æ³•æ¥è¡¨ç¤ºï¼Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ±‚ä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿™ä¸ªäºŒå‰æ ‘çš„çˆ¶èŠ‚ç‚¹æ€»æ¯”å­èŠ‚ç‚¹è¦å¤§ï¼Œå¹¶ä¸”è¿™æ£µæ ‘çš„ä¸­åºéå†ä¸åŸæ•°ç»„ç›¸åŒ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬ä»build from scratchçš„è§’åº¦æ¥æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆå¾—å‡ºæ¥çš„ç»“è®ºä¸€å®šæ˜¯O(n^2)çš„ â€”â€” æ¯æ¬¡æ‰¾åˆ°ï¼ˆå­ï¼‰æ•°ç»„çš„æœ€å¤§å€¼ï¼Œç„¶åpartitionè¿™ä¸ªæ•°ç»„ï¼Œç›´åˆ°æ„é€ å‡ºæ•´æ£µæ ‘ã€‚&lt;/p&gt;
&lt;h3&gt;æ¢ä¸€ç§æ€è€ƒæ–¹å¼&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å°è¯•ç”¨å½’çº³æ³•çš„æ€ç»´å»è€ƒè™‘è¿™é“é¢˜ã€‚å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€æ£µæ ‘ï¼Œè¿™æ£µæ ‘æ»¡è¶³ä¸Šé¢æ‰€è¯´çš„æ¡ä»¶ï¼Œä¸”è¿™æ£µæ ‘å±•å¼€åä¸ºæ•°ç»„çš„å‰ké¡¹ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦æ’å…¥ç¬¬k+1é¡¹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;A[k+1] &amp;lt;= A[k]&lt;/code&gt;ï¼Œæ­¤æ—¶ç¬¬k+1é¡¹ä¼šæˆä¸ºåˆ°ç¬¬ké¡¹çš„å³å„¿å­ï¼Œè¿™æ ·æ ‘å±•å¼€æ—¶ï¼Œç¬¬ké¡¹å’Œç¬¬k+1é¡¹å¿…ç„¶ç›¸è”ï¼Œå¹¶ä¸”ä¹Ÿæ»¡è¶³çˆ¶èŠ‚ç‚¹å¿…é¡»æ¯”å­èŠ‚ç‚¹å¤§çš„æ¡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;A[k+1] &amp;gt; A[k]&lt;/code&gt;ï¼Œç¬¬k+1é¡¹å¿…ç„¶ä¼šæˆä¸ºç¬¬ké¡¹çš„å·¦å„¿å­ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘ï¼Œç¬¬ké¡¹çš„çˆ¶èŠ‚ç‚¹æ¯”ç¬¬k+1é¡¹å°çš„æƒ…å†µã€‚ç»è¿‡æ€è€ƒï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œç¬¬k+1é¡¹çš„å·¦å„¿å­tï¼Œä¸€å®šæ˜¯ç¬¬ké¡¹ç¥–å…ˆèŠ‚ç‚¹ä¸­å°äºç¬¬k+1é¡¹çš„æœ€å¤§å€¼ã€‚è€Œç¬¬k+1é¡¹åˆ™æ›¿æ¢æ‰èŠ‚ç‚¹tçš„ä½ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æƒ…å†µä¸€ç¤ºæ„å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="cond1" src="data:image/png;base64,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" /&gt;&lt;/p&gt;
&lt;p&gt;æƒ…å†µäºŒç¤ºæ„å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="cond2" src="data:image/png;base64,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" /&gt;&lt;/p&gt;
&lt;p&gt;ç”±æ­¤ä¸€æ¥ï¼ŒåŸæœ¬çœ‹èµ·æ¥å¤æ‚çš„æ€è·¯ä¸€ä¸‹å­å˜çš„ç®€å•ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå¤æ‚çš„é—®é¢˜åŒ–å½’åˆ°é‡å¤çš„å­é—®é¢˜ä¸Šæ¥ã€‚è¿™æ ·æˆ‘ä»¬åªéœ€è¦æ¯æ¬¡è§£å†³ä¸€ä¸ªé—®é¢˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;å…³é”®ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
    &lt;span class="n"&gt;TreeNode&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;do_insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// one node at a time&lt;/span&gt;
        &lt;span class="n"&gt;TreeNode&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;TreeNode&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;TreeNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;root&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è¯¾åä¹ é¢˜ - æœ€å¤§å­æ®µä¹˜ç§¯&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯Leetcodeæ–°åŠ çš„ä¸€é¢˜ï¼Œåœ¨æ˜¨å¤©åƒæ’‘äº†å–é†‰äº†çš„æƒ…å†µä¸‹ï¼Œå‹‰å¼ºACï¼Œä»Šå¤©çœ‹æ¥ï¼Œè‡ªå·±è¿˜æ˜¯too young too simpleå•Šã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªintæ•°ç»„ï¼Œæ±‚è¿™ä¸ªintæ•°ç»„çš„æœ€å¤§å­æ®µä¹˜ç§¯ã€‚ï¼ˆä¸éœ€è¦è€ƒè™‘æº¢å‡ºï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;ä»é›¶å¼€å§‹çš„æƒ³æ³•&lt;/h3&gt;
&lt;p&gt;æœ€å¤§å­æ®µä¹˜ç§¯å¿…ç„¶æ˜¯ä¸€æ®µä¸å«æœ‰0çš„å­æ®µã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå­æ®µåˆ†å‰²ä¸ºkæ®µï¼Œæ¯ä¸€æ®µéƒ½ä¸åŒ…å«0ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸€ä¸ªå­æ®µï¼Œè¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯å°½é‡ä¸ºæ­£ï¼ŒäºŒæ˜¯å°½é‡åŒ…å«æ›´å¤šçš„æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¯¹äºå­æ®µA[l...r]ï¼Œæœ€å¤§ä¹˜ç§¯åªèƒ½ä¸ºA[m...r]æˆ–A[l...m]ä¸¤ç§æƒ…å†µã€‚æ‰€ä»¥æˆ‘ä»¬ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆï¼Œå°±å¯ä»¥æ±‚å¾—æœ€åçš„ç»“æœäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ã€‚ã€‚ã€‚ç­‰ä¸‹ã€‚ã€‚ã€‚è¿™çœŸç‰¹ä¹ˆtwistedå•Šã€‚ã€‚ã€‚_(:Ğ·ã€âˆ )_&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// a drunk moron who wrote this&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;maxProduct&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pro&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;pro&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pro&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;pro&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="p"&gt;}&lt;/span&gt;
                    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pro&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mh"&gt;0x3f3f3f3f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ç”¨å½’çº³æ³•è§£å†³è¿™ä¸ªé—®é¢˜&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬åšä¸€ä¸ªå‡è®¾ï¼Œå¯¹äºA[k]æ¥è¯´ï¼Œæˆ‘ä»¬å·²çŸ¥&lt;code&gt;mini = min(A[i...k])&lt;/code&gt;å’Œ&lt;code&gt;maxi = max(A[i...k])&lt;/code&gt;ã€‚miniå’Œmaxiæ˜¯ä»¥kç»“å°¾çš„å­æ®µä¸­ï¼Œä¹˜ç§¯ç»å¯¹å€¼æœ€å¤§çš„è´Ÿæ•°/æ­£æ•°ã€‚æ‰€ä»¥æ— è®ºä¹˜ä¸€ä¸ªè´Ÿæ•°è¿˜æ˜¯ä¸€ä¸ªæ­£æ•°ï¼Œmaxiå’Œminiçš„å€¼åªä¼šæ˜¯&lt;code&gt;maxi * a&lt;/code&gt;å’Œ&lt;code&gt;mini * a&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œå¯¹äºç¬¬k+1é¡¹æ¥è¯´ï¼Œä»¥ç¬¬k+1é¡¹ç»“å°¾çš„æœ€å¤§å­åºåˆ—å¿…ä¸º&lt;code&gt;max(mini * A[k+1], maxi * A[k+1], A[k+1])&lt;/code&gt;(miniå’Œmaxiå¯èƒ½ä¸º0)ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œæˆ‘ä»¬ç»§ç»­ç»´æŠ¤miniå’Œmaxiä¸¤ä¸ªå€¼ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå¾ªç¯çš„å­é—®é¢˜ã€‚ä»£ç ä¹Ÿå°±åœ¨æˆ‘ä»¬çš„ç¬”ä¸‹äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;maxProduct&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;0xdeadbeef&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;mini&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;
            &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mini&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="induction"></category><category term="binary tree"></category><category term="codeforces"></category></entry><entry><title>FlatBufferä»£ç é˜…è¯» - 1</title><link href="http://wizmann.tk/read-flatbuffer-1.html" rel="alternate"></link><updated>2014-09-21T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-09-21:read-flatbuffer-1.html</id><summary type="html">&lt;h2&gt;FlatBufferç™½çš®ä¹¦&lt;/h2&gt;
&lt;p&gt;Flatbufferæ˜¯ä¸€ä¸ªå…¨æ–°çš„åºåˆ—åŒ–åº“ã€‚&lt;/p&gt;
&lt;h3&gt;åŠ¨æœº&lt;/h3&gt;
&lt;p&gt;åœ¨è¿œå¤æ—¶ä»£ï¼Œç¨‹åºæ€§èƒ½åŸºæœ¬å–å†³äºä½ çš„æŒ‡ä»¤å’Œå¾ªç¯è¿è¡Œçš„æœ‰å¤šå¿«ã€‚ä½†æ˜¯ï¼Œåœ¨å¦‚ä»Šçš„è®¡ç®—æœºä¸Šï¼Œè®¡ç®—ç»„ä»¶çš„é€Ÿåº¦å·²ç»è¿œè¿œè¶…è¿‡å­˜å‚¨ç»„ä»¶çš„é€Ÿåº¦ã€‚å¦‚æœä½ æƒ³è®©ä½ çš„ç¨‹åºé£èµ·æ¥ï¼Œæœ€é‡è¦çš„å°±æ˜¯ä¼˜åŒ–ä½ çš„å†…å­˜ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œç”¨å¤šå°‘å†…å­˜ï¼Œæ€æ ·å¸ƒå±€å†…å­˜ï¼Œå¦‚ä½•åˆ†é…å†…å­˜ï¼Œä½•æ—¶æ‹·è´å†…å­˜ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;åºåˆ—åŒ–æ˜¯åœ¨ç¨‹åºä¸­éå¸¸å¸¸è§çš„ä¸€ç§æ“ä½œï¼Œå¹¶ä¸”é€šå¸¸æ˜¯ç¨‹åºæ€§èƒ½ä½ä¸‹çš„ä¸»è¦åŸå› ã€‚ä¸€æ˜¯ç”±äºåºåˆ—åŒ–éœ€è¦é¢å¤–çš„ä¸´æ—¶ç©ºé—´å»è§£æå’Œè¡¨ç¤ºæ•°æ®ï¼ŒäºŒæ˜¯ç”±äºä¸ä¼˜é›…çš„å†…å­˜åˆ†é…æ¨¡å¼å’Œå±€éƒ¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªåºåˆ—åŒ–æ¡†æ¶å¯ä»¥ä¸ä½¿ç”¨é¢å¤–çš„å¯¹è±¡ï¼Œæ²¡æœ‰é¢å¤–çš„å†…å­˜åˆ†é…ï¼Œæ²¡æœ‰å†…å­˜æ‹·è´ï¼Œè‰¯å¥½çš„æ•°æ®å±€éƒ¨æ€§ï¼Œè¿™æ­£æ˜¯å¤ªå¥½ä¸è¿‡ã€‚ä¸è¿‡å½“ä¸‹çš„å¾ˆå¤šæ¡†æ¶é€šå¸¸ä¸èƒ½æ»¡è¶³ä»¥ä¸Šçš„æ¡ä»¶ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦å‘å‰/å‘åå…¼å®¹ï¼Œéœ€è¦å…¼å®¹ä¸åŒçš„å¹³å°ï¼Œä¾‹å¦‚å¤§ç«¯/å°ç«¯å’Œå†…å­˜å¯¹é½éƒ½æ˜¯éœ€è¦è¿›è¡Œå…¼å®¹æ€§å¤„ç†çš„ã€‚&lt;/p&gt;
&lt;p&gt;FlatBufferå¯ä»¥åšåˆ°ä»¥ä¸Šçš„ä¸€åˆ‡ã€‚&lt;/p&gt;
&lt;p&gt;Flatbufferå°¤å…¶é€‚åˆç§»åŠ¨è®¾å¤‡ï¼ˆå†…å­˜å®¹é‡å’Œå¸¦å®½æ¯”æ¡Œé¢è®¾å¤‡çš„è¦ä½ä¸å°‘ï¼‰ï¼Œä»¥åŠéœ€è¦é«˜æ€§èƒ½çš„åº”ç”¨ï¼šæ¸¸æˆã€‚&lt;/p&gt;
&lt;h3&gt;FlatBuffers&lt;/h3&gt;
&lt;h4&gt;æ€»è¿°&lt;/h4&gt;
&lt;p&gt;Flatbufferæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶çš„bufferã€‚Flatbufferå¯ä»¥åŒ…å«åµŒå¥—å¯¹è±¡å¦‚structã€tableã€vectorç­‰å¹¶ä½¿ç”¨åç§»é‡æ¥è¿›è¡Œå¯»å€ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒéå†åŸºäºæŒ‡é’ˆçš„ç»“æ„ä¸€æ ·ï¼Œå¯¹flatbufferå…ƒç´ è¿›è¡Œin-placeçš„éå†ã€‚
Flatbufferä½¿ç”¨ä¸¥æ ¼çš„å­—èŠ‚å¯¹é½å’Œå­—èŠ‚é¡ºåºï¼ˆé€šå¸¸æ˜¯å°ç«¯ï¼‰ä»¥ä¿è¯å¯ä»¥è·¨å¹³å°ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œåƒtableè¿™æ ·çš„å¯¹è±¡ï¼ŒFlatbufferæä¾›äº†å‘å‰/å‘åçš„å…¼å®¹æ€§ï¼Œå’Œé€šç”¨çš„å¯é€‰å±æ€§ï¼Œä»¥æ”¯æŒå¤šå˜çš„æ•°æ®æ ¼å¼ã€‚&lt;/p&gt;
&lt;h4&gt;Tables&lt;/h4&gt;
&lt;p&gt;Tablesæ˜¯FlatBufferçš„åŸºçŸ³ï¼Œå› ä¸ºæ•°æ®æ ¼å¼çš„å˜åŒ–å¯¹äºå¾ˆå¤šåº”ç”¨æ¥è¯´ï¼Œæ˜¯éå¸¸æ­£å¸¸çš„äº‹ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€èˆ¬çš„åºåˆ—åŒ–æ¡†æ¶éƒ½æ˜¯åœ¨parsingçš„è¿‡ç¨‹ä¸­ï¼Œé€æ˜çš„å¤„ç†æ•°æ®æ ¼å¼çš„å˜åŒ–çš„ã€‚ä½†æ˜¯FlatBufferæ²¡æœ‰parsingçš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;Tablesä½¿ç”¨vtableæ¥å¯¹æ•°æ®è¿›è¡Œéç›´æ¥çš„è¯»å–ã€‚æ¯ä¸€ä¸ªtableéƒ½æœ‰ä¸€ä¸ªvtableï¼ˆå¯ä»¥åœ¨åŒç±»å‹çš„tablesä¸­è¿›è¡Œå…±äº«ï¼Œç±»ä¼¼C++ç±»çš„è™šè¡¨ï¼‰ï¼Œvtableä¸­åŒ…å«å­—æ®µçš„ä¿¡æ¯ã€‚åŒæ—¶ï¼Œvtableä¹Ÿè®¸ä¹ŸæŒ‡æ˜å“ªä¸€äº›å­—æ®µåœ¨å½“å‰çš„æ•°æ®ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œè¿™äº›å­—æ®µä¼šè¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;p&gt;Tablesåªéœ€è¦å¾ˆå°‘çš„ç©ºé—´ï¼ˆå› ä¸ºvtableså ç”¨ç©ºé—´å¾ˆå°‘ï¼Œå¹¶ä¸”æ˜¯å…±äº«çš„ï¼‰ï¼Œå°½ç®¡åœ¨è®¿é—®æ•°æ®æ—¶æœ‰ä¸€äº›å¼€é”€ï¼Œä½†æ˜¯æä¾›äº†æå¤§çš„å¯ä¼¸ç¼©æ€§ï¼ŒTablesç”šè‡³æ¯”ç­‰ä»·çš„ç»“æ„å ç”¨å†…å­˜æ›´å°ï¼Œå› ä¸ºå½“å­—æ®µç­‰äºé»˜è®¤å€¼æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦ä¸ºå…¶åˆ†é…ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;FlatBuffersé¢å¤–æä¾›äº†â€œè£¸â€ç»“æ„ï¼Œè¿™äº›å­—æ®µä¸èƒ½å‘å‰/å‘åå…¼å®¹ï¼Œä½†æ˜¯è¿™æ ·å¯ä»¥å‡å°‘å®ƒä»¬çš„å†…å­˜å ç”¨ã€‚è¿™ç§å­—æ®µå¯¹äºä¸ç»å¸¸å˜åŒ–çš„å…ƒç´ éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åæ ‡å¯¹å’ŒRGBAé¢œè‰²ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h4&gt;Schema&lt;/h4&gt;
&lt;p&gt;Schemaå‡å°‘äº†ä¸€äº›é€šç”¨æ€§ï¼ˆåœ¨æ²¡æœ‰schemaçš„æƒ…å†µä¸‹ï¼Œä½ ä¸èƒ½è¯»å–å…¶ä¸­çš„æ•°æ®ï¼‰ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰å¾ˆå¤šä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤§éƒ¨åˆ†æ•°æ®æ ¼å¼ä¿¡æ¯å¯ä»¥è¢«ç”Ÿæˆä¸ºä»£ç ï¼Œå‡å°‘åœ¨bufferä¸­å­˜å‚¨æ•°æ®æ ¼å¼çš„æ—¶é—´/ç©ºé—´å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;å¼ºç±»å‹çš„æ•°æ®å®šä¹‰æ„å‘³ç€æ›´å°‘çš„è¿è¡Œæ—¶é”™è¯¯æ£€æŸ¥å’Œå¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;Schemaä½¿å¾—åœ¨è¯»å–bufferå‰ä¸è¿›è¡Œè§£æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;FlatBufferçš„schemaæ ¼å¼å’Œä»–å¤§å“¥ProtoBufç±»ä¼¼ï¼Œå¹¶ä¸”é€šå¸¸æƒ…å†µä¸‹å¯ä»¥è¢«Cé£æ ¼çš„ç¼–ç¨‹è¯­è¨€æ‰€è¯»å–ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯¹å…¶protoæ ¼å¼è¿›è¡Œäº†ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼ƒç”¨æ‰‹åŠ¨ä¸ºå­—æ®µæ·»åŠ IDã€‚è¿™æ ·ä¸€æ¥ï¼Œå¯¹äºæ•°æ®æ ¼å¼çš„å˜åŠ¨ï¼Œä¸€æ¥ä¼šå‡ºç°æ‰‹åŠ¨æ‰¾å¯»ä¸€ä¸ªç©ºä½(slot)çš„æƒ…å†µï¼›äºŒæ˜¯ä¼šå‡ºç°å¯¹äºå¼ƒç”¨å­—æ®µï¼Œç”±äºå‘å‰/å‘åå…¼å®¹çš„åŸå› ä¸æ•¢çœŸæ­£çš„åˆ é™¤ï¼Œå¦‚æœä½ å¹»æƒ³å¯ä»¥å¤ç”¨å­—æ®µï¼Œä½ å°±ç»™è‡ªå·±æŒ–äº†ä¸€ä¸ªæ›´å¤§çš„å‘ã€‚&lt;/li&gt;
&lt;li&gt;tableså’Œstructsæ˜¯ä¸åŒçš„ã€‚tablesçš„å­—æ®µæ˜¯å¯é€‰çš„ï¼Œè€Œstructsçš„å­—æ®µæ˜¯å¿…é¡»çš„ã€‚&lt;/li&gt;
&lt;li&gt;åŸç”Ÿçš„vectoræ”¯æŒï¼Œå–ä»£&lt;code&gt;repeated&lt;/code&gt;å…³é”®å­—ã€‚è¿™æ ·æ— éœ€éå†å°±å¯ä»¥çŸ¥é“vectorçš„é•¿åº¦ã€‚è¿™æ ·å¯ä»¥è®©æ•°æ®çš„è¡¨ç¤ºæ›´åŠ ç´§å‡‘ã€‚&lt;/li&gt;
&lt;li&gt;åŸç”Ÿçš„unionç±»å‹æ”¯æŒã€‚é¿å…ä½¿ç”¨ä¸€ç³»åˆ—çš„optionalå­—æ®µè€Œé€ æˆçš„å†—é•¿çš„æ‰‹åŠ¨æ£€æŸ¥ã€‚&lt;/li&gt;
&lt;li&gt;å…è®¸ä¸ºæ ‡é‡è®¾åˆå€¼ï¼Œæ— éœ€å¤„ç†å¯é€‰å­—æ®µã€‚&lt;/li&gt;
&lt;li&gt;Parserå¯ä»¥ç»Ÿä¸€çš„å¤„ç†schemaå’ŒJSONè¡¨ç¤ºçš„æ•°æ®å®šä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Benchmark&lt;/h2&gt;
&lt;table class="table-bordered table-hover"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;&lt;th&gt;FlatBuffers (binary) &lt;/th&gt;&lt;th&gt;Protocol Buffers LITE &lt;/th&gt;&lt;th&gt;Rapid JSON &lt;/th&gt;&lt;th&gt;FlatBuffers (JSON) &lt;/th&gt;&lt;th&gt;pugixml  &lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Decode + Traverse + Dealloc (1 million times, seconds) &lt;/td&gt;&lt;td&gt;0.08 &lt;/td&gt;&lt;td&gt;302 &lt;/td&gt;&lt;td&gt;583 &lt;/td&gt;&lt;td&gt;105 &lt;/td&gt;&lt;td&gt;196 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Decode / Traverse / Dealloc (breakdown) &lt;/td&gt;&lt;td&gt;0 / 0.08 / 0 &lt;/td&gt;&lt;td&gt;220 / 0.15 / 81 &lt;/td&gt;&lt;td&gt;294 / 0.9 / 287 &lt;/td&gt;&lt;td&gt;70 / 0.08 / 35 &lt;/td&gt;&lt;td&gt;41 / 3.9 / 150 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Encode (1 million times, seconds) &lt;/td&gt;&lt;td&gt;3.2 &lt;/td&gt;&lt;td&gt;185 &lt;/td&gt;&lt;td&gt;650 &lt;/td&gt;&lt;td&gt;169 &lt;/td&gt;&lt;td&gt;273 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Wire format size (normal / zlib, bytes) &lt;/td&gt;&lt;td&gt;344 / 220 &lt;/td&gt;&lt;td&gt;228 / 174 &lt;/td&gt;&lt;td&gt;1475 / 322 &lt;/td&gt;&lt;td&gt;1029 / 298 &lt;/td&gt;&lt;td&gt;1137 / 341 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Memory needed to store decoded wire (bytes / blocks) &lt;/td&gt;&lt;td&gt;0 / 0 &lt;/td&gt;&lt;td&gt;760 / 20 &lt;/td&gt;&lt;td&gt;65689 / 4 &lt;/td&gt;&lt;td&gt;328 / 1 &lt;/td&gt;&lt;td&gt;34194 / 3 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Transient memory allocated during decode (KB) &lt;/td&gt;&lt;td&gt;0 &lt;/td&gt;&lt;td&gt;1 &lt;/td&gt;&lt;td&gt;131 &lt;/td&gt;&lt;td&gt;4 &lt;/td&gt;&lt;td&gt;34 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Generated source code size (KB) &lt;/td&gt;&lt;td&gt;4 &lt;/td&gt;&lt;td&gt;61 &lt;/td&gt;&lt;td&gt;0 &lt;/td&gt;&lt;td&gt;4 &lt;/td&gt;&lt;td&gt;0 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Field access in handwritten traversal code &lt;/td&gt;&lt;td&gt;typed accessors &lt;/td&gt;&lt;td&gt;typed accessors &lt;/td&gt;&lt;td&gt;manual error checking &lt;/td&gt;&lt;td&gt;typed accessors &lt;/td&gt;&lt;td&gt;manual error checking &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Library source code (KB) &lt;/td&gt;&lt;td&gt;15 &lt;/td&gt;&lt;td&gt;some subset of 3800 &lt;/td&gt;&lt;td&gt;87 &lt;/td&gt;&lt;td&gt;43 &lt;/td&gt;&lt;td&gt;327 &lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</summary><category term="flatbuffer"></category></entry><entry><title>æœ€å°è¡¨ç¤ºæ³•åŠå…¶è¯æ˜</title><link href="http://wizmann.tk/minimal-round-string.html" rel="alternate"></link><updated>2014-09-17T00:46:16+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-09-17:minimal-round-string.html</id><summary type="html">&lt;h2&gt;é—®é¢˜&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªå­—ç¬¦ä¸²Sï¼Œæ±‚Sçš„å¾ªç¯çš„åŒæ„å­—ç¬¦ä¸²Sâ€™ä¸­å­—å…¸åºæœ€å°çš„ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬ä¸¾ä¾‹è¯´æ˜ï¼Œå­—ç¬¦ä¸²"abcd"çš„å¾ªç¯åŒæ„å­—ç¬¦ä¸²æœ‰ï¼š&lt;code&gt;["abcd", "bcda", "cdab", "dabc"]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®çš„ç›®æ ‡æ˜¯æ±‚è¿™äº›å­—ç¬¦ä¸²ä¸­å­—å…¸åºæœ€å°çš„é‚£ä¸ªã€‚&lt;/p&gt;
&lt;h2&gt;æš´åŠ›è§£æ³•&lt;/h2&gt;
&lt;p&gt;æš´åŠ›è§£æ³•éå¸¸ç›´è§‚ï¼Œç›´æ¥æšä¸¾å­—ç¬¦ä¸²çš„èµ·ç‚¹ï¼Œç„¶åæ‰¾åˆ°æ„æˆæœ€å°å­—ç¬¦ä¸²çš„é‚£ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å°±ä¸åœ¨è¿™é‡Œå†™äº†ã€‚&lt;/p&gt;
&lt;h2&gt;æœ€å°è¡¨ç¤ºæ³•&lt;/h2&gt;
&lt;p&gt;æœ€å°è¡¨ç¤ºæ³•æ˜¯è§£å†³åŒæ„å­—ç¬¦ä¸²æœ€å°è¡¨ç¤ºçš„å·§å¦™ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ç®—æ³•æè¿°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ä»¤i=0,j=1
å¦‚æœS[i] &amp;gt; S[j] i=j, j=i+1
å¦‚æœS[i] &amp;lt; S[j] j++
å¦‚æœS[i] == S[j] è®¾æŒ‡é’ˆkï¼Œåˆ†åˆ«ä»iå’Œjä½ç½®å‘ä¸‹æ¯”è¾ƒï¼Œç›´åˆ°S[i] != S[j]
         å¦‚æœS[i+k] &amp;gt; S[j+k] i=j,j=i+1
         å¦åˆ™j++
è¿”å›i
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆçœ‹è¿™ä¸ªç®—æ³•ï¼Œä¸€èˆ¬éƒ½ä¼šä¸€å¤´é›¾æ°´ï¼šè¿™TMDæ˜¯å˜›ç©æ„å„¿ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»è¿‡è¯æ˜ï¼Œæ¥è¯å®å®ƒçš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;h3&gt;æœ€å°è¡¨ç¤ºæ³•çš„æ­£ç¡®æ€§è¯æ˜&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œ&lt;code&gt;S = S ++ S&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è®¾&lt;code&gt;i &amp;lt; j&lt;/code&gt;ï¼Œä¸”&lt;code&gt;S[i] &amp;lt; S[i + 1 ... j - 1]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”ä»¥iä¸ºèµ·ç‚¹çš„å­—ç¬¦ä¸²ä¸º&lt;code&gt;RS[i]&lt;/code&gt;ï¼Œä»¥jä¸ºèµ·ç‚¹çš„å­—ç¬¦ä¸²ä¸º&lt;code&gt;RS[j]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸”&lt;code&gt;RS[i]&lt;/code&gt;ä¸º&lt;code&gt;RS[0...i-1]&lt;/code&gt;å­—å…¸åºæœ€å°çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;RS[i] = S[i...i+k] ++ S[i+k+1 ... i+n-1]
RS[j] = S[j...j+k] ++ S[j+k+1 ... j+n-1]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»¥ä¸Šä¸ºæˆ‘ä»¬çš„å­é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;i = 0, j = 1&lt;/code&gt;æ—¶ï¼Œå­é—®é¢˜å³æˆç«‹ã€‚&lt;/p&gt;
&lt;h4&gt;æƒ…å†µ0&lt;/h4&gt;
&lt;p&gt;æ˜“å¾—ã€‚&lt;/p&gt;
&lt;p&gt;å½“&lt;code&gt;S[i] &amp;lt; S[j]&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;j++&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“&lt;code&gt;S[i] &amp;gt; S[j]&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;i = j; j++&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h4&gt;æƒ…å†µ1&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;S[i+k+1 ... i+n-1] == S[j+k+1 ... j+n-1]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æ˜“å¾—ï¼Œå­—ç¬¦ä¸²Sæ˜¯ç”±ä¸€ä¸ªé•¿åº¦ä¸ºkçš„å­ä¸²å¾ªç¯å¤åˆ¶ç”Ÿæˆã€‚æ‰€æœ‰çš„åŒæ„å­ä¸²åªæœ‰&lt;code&gt;RS[i ... j-1]&lt;/code&gt;è¿™kä¸ªï¼Œåˆç”±äº&lt;code&gt;RS[i + 1 ... j - 1]&lt;/code&gt;çš„æ‰€æœ‰å­—ç¬¦ä¸²éƒ½å­—å…¸åºå¤§äº&lt;code&gt;RS[i]&lt;/code&gt;ã€‚æ‰€ä»¥iå³ä¸ºæœ€åçš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;h4&gt;æƒ…å†µ2&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;S[i+k+1 ... i+n-1] &amp;gt; S[j+k+1 ... j+n-1]&lt;/code&gt;ï¼Œé‚£ä¹ˆæ­¤æ—¶&lt;code&gt;RS[i] &amp;gt; RS[j]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº&lt;code&gt;S[i...i+k] == S[j...j+k]&lt;/code&gt;ï¼Œä¸”è¿™ä¸¤ä¸ªå‰è¾ä¸­ï¼Œåªæœ‰&lt;code&gt;S[i] == S[j]&lt;/code&gt;å­—å…¸åºæœ€å°ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥iæŒ‡å‘jç‚¹ï¼Œä¿æŒæœ€å°æ€§è´¨ã€‚è€Œjåˆ™æŒ‡å‘&lt;code&gt;j + k + 1&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¿æŒi &amp;lt; jï¼Œä¸”S[i] &amp;lt;= S[j]çš„æ€§è´¨ã€‚ä½¿é—®é¢˜å›åˆ°æˆ‘ä»¬å½’çº³çš„å­é—®é¢˜ä¸Šæ¥ã€‚&lt;/p&gt;
&lt;h4&gt;æƒ…å†µ3&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;S[i+k+1 ... i+n-1] &amp;lt; S[j+k+1 ... j+n-1]&lt;/code&gt;ï¼Œé‚£ä¹ˆæ­¤æ—¶&lt;code&gt;RS[i] &amp;lt; RS[j]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº&lt;code&gt;S[i...i+k] == S[j...j+k]&lt;/code&gt;ï¼Œä¸”è¿™ä¸¤ä¸ªå‰è¾ä¸­ï¼Œåªæœ‰&lt;code&gt;S[i] == S[j]&lt;/code&gt;å­—å…¸åºæœ€å°ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥iä¸å˜ï¼Œä¿æŒæœ€å°æ€§è´¨ã€‚è€ŒjæŒ‡å‘&lt;code&gt;j + k + 1&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¿æŒi &amp;lt; jï¼Œä¸”S[i] &amp;lt;= S[j]çš„æ€§è´¨ã€‚ä½¿é—®é¢˜å›åˆ°æˆ‘ä»¬å½’çº³çš„å­é—®é¢˜ä¸Šæ¥ã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// Result: wizmann  1509    Accepted    272K    16MS    C++ 1247B   2014-09-17 00:44:22&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12345&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ll&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strlen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è¯æ˜çš„é€»è¾‘æ€§ä¸å¥½ï¼Œä½†æ˜¯åº”è¯¥æ˜¯å¯¹çš„ã€‚åªæ˜¯è¯­è¨€è¡¨è¾¾ä¸Šé—®é¢˜å¾ˆå¤§ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªå¥½çš„å­é—®é¢˜å‡è®¾ä¼šå¤§å¤§æå‡åšé¢˜æ•ˆç‡å•Šï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å‚è€ƒé“¾æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://blog.csdn.net/cclsoft/article/details/5467743"&gt;ç†è§£å­—ç¬¦ä¸²å¾ªç¯åŒæ„çš„æœ€å°è¡¨ç¤ºæ³•&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="string"></category><category term="å­—ç¬¦ä¸²"></category><category term="æœ€å°è¡¨ç¤ºæ³•"></category><category term="algorithm"></category></entry><entry><title>System Design - æœ€çƒ­é—¨çš„IPåœ°å€</title><link href="http://wizmann.tk/hottest-ip-address.html" rel="alternate"></link><updated>2014-08-08T01:25:54+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-08-08:hottest-ip-address.html</id><summary type="html">&lt;h2&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;é—®é¢˜æ˜¯éå¸¸æµè¡Œçš„ï¼Œä¹Ÿç¡®å®æµè¡Œäº†ä¸€é˜µçš„system-designé—®é¢˜ã€‚åœ¨&lt;a href="http://www.zhihu.com/question/19805967"&gt;çŸ¥ä¹&lt;/a&gt;ä¸Šå†æ¬¡è¢«äººæèµ·ã€‚ç„¶åæˆ‘éå¸¸æ¬£èµ&lt;a href="http://zhi.hu/3gJb"&gt;é™ˆç¡•çš„å›ç­”&lt;/a&gt;ã€‚æ‰€ä»¥è¦å†™ä¸€ç¯‡æ–‡ç« ï¼Œè®°ä¸‹è‡ªå·±çš„æ„Ÿæƒ³ã€‚&lt;/p&gt;
&lt;h2&gt;é—®é¢˜&lt;/h2&gt;
&lt;p&gt;æµ·é‡æ•°æ®ç®—æ³•:å¦‚ä½•ä»è¶…è¿‡10Gçš„è®°å½•IPåœ°å€çš„æ—¥å¿—ä¸­ï¼Œè¾ƒå¿«çš„æ‰¾å‡ºç™»å½•æ¬¡æ•°æœ€å¤šçš„ä¸€ä¸ªIPï¼Ÿ&lt;/p&gt;
&lt;h2&gt;é“¶å¼¹ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;é¢å¯¹è¿™ç§system-designé—®é¢˜ï¼Œå°¤å…¶æ˜¯è¿™ç§ï¼Œ&lt;strong&gt;éé«˜å¹¶å‘ã€éå®æ—¶&lt;/strong&gt;çš„é—®é¢˜ï¼Œå¾ˆå¤šäººä¼šé‡‡ç”¨_map-reduce_ â€”â€” è§£å†³system-designé—®é¢˜çš„é“¶å¼¹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¯¹map-reduceçš„ç†è§£éå¸¸è‚¤æµ…ï¼Œä½†æ˜¯å¯ä»¥è§£é‡Šä¸€ä¸‹å¤§æ¦‚çš„æµç¨‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°†æ—¥å¿—è¿›è¡Œåˆ†ç‰‡ã€‚æŠŠhash(ip)ç›¸åŒçš„ipåœ°å€åˆ†åˆ°åŒä¸€ä¸ªç‰‡ä¸­ã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œçš„hashå¹¶ä¸æ˜¯ç­¾åå‡½æ•°ï¼Œåªæ˜¯ä¸€ä¸ªåˆ†ç‰‡æ ‡ç¤ºï¼‰&lt;/li&gt;
&lt;li&gt;åˆ†ç‰‡åçš„æ—¥å¿—çš„å¤§å°ä¼šå°å¾ˆå¤šï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œæ’åºï¼Œè®°æ•°ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åå†ä»å„ä¸ªç‰‡ä¸­ï¼Œç»Ÿè®¡å‡ºæœ€çƒ­é—¨çš„IPåœ°å€ã€‚ï¼ˆæˆ–TopKçš„IPåœ°å€ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä¸æ»¡æ„æˆ‘çš„ç­”æ¡ˆçš„è¯ï¼Œæ¨è&lt;a href="http://book.douban.com/subject/19934150/"&gt;Mining of Massive Datasets&lt;/a&gt;ä¸€ä¹¦ï¼Œå…¶ä¸­å¯¹map-reduceç®—æ³•åšä¸€ç•ªä¸é”™çš„ä»‹ç»ã€‚&lt;/p&gt;
&lt;h2&gt;æ­£ç¡®çš„åˆ†æå§¿åŠ¿&lt;/h2&gt;
&lt;h3&gt;ä¸šåŠ¡å®ä½“&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸šåŠ¡å®ä½“æ‹¥æœ‰å››ç§ä¸»è¦çš„ç»„ä»¶ï¼š ä¿¡æ¯æ¨¡å‹ã€ç”Ÿå‘½å‘¨æœŸæ¨¡å‹ã€è®¿é—®ç­–ç•¥ä»¥åŠé€šçŸ¥ã€‚ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼Œä¸šåŠ¡å®ä½“å°±æ˜¯é¢˜ç›®ä¸­æåˆ°çš„â€œåè¯â€ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬é¢˜ä¸­ï¼Œä¸šåŠ¡å®ä½“æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IPåœ°å€ï¼ˆé»˜è®¤ä¸ºipv4ï¼‰&lt;/li&gt;
&lt;li&gt;æœ€çƒ­é—¨IPåœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ä¸šåŠ¡åº”ç”¨&lt;/h3&gt;
&lt;p&gt;ä¸šåŠ¡åº”ç”¨æŒ‡çš„æ˜¯å½“å‰åœºæ™¯çš„&lt;strong&gt;ç‰¹æ®Š&lt;/strong&gt;åº”ç”¨ï¼Œä»¥åŠä¸šåŠ¡å®ä½“çš„å…³è”å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬é—®é¢˜ä¸­ï¼Œä¸šåŠ¡åº”ç”¨æŒ‡çš„æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰¾åˆ°&lt;strong&gt;æœ€çƒ­é—¨&lt;/strong&gt;çš„IPåœ°å€&lt;/li&gt;
&lt;li&gt;å¤§æ•°æ®é‡ï¼Œ10Gçš„æ—¥å¿—æ–‡ä»¶ â€”â€” ä¸æ–¹ä¾¿åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œ
ï¼ˆåœ¨åŠ¨è¾™ä¸Šç™¾Gçš„æœåŠ¡å™¨é¢å‰ï¼Œ10Gçš„æ•°æ®é‡çœŸæ˜¯å¼±çˆ†äº†^_^)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ç‰©ç†&lt;/h3&gt;
&lt;p&gt;ç‰©ç†æŒ‡çš„æ˜¯æ•°æ®çš„ç‰©ç†æ¨¡å‹ï¼ŒåŒ…æ‹¬æ•°æ®ç»“æ„ã€æ•°æ®åº“è¡¨ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬é¢˜ä¸­ï¼ŒæŒ‡çš„æ˜¯å¯¹IPåœ°å€å­˜å‚¨å’Œè®°æ•°çš„æ•°æ®ç»“æ„ã€‚&lt;/p&gt;
&lt;h3&gt;è®©æˆ‘ä»¬åšä¸€ä¸‹åˆ†æ&lt;/h3&gt;
&lt;p&gt;æœ¬é¢˜ä¸­ï¼Œä¸šåŠ¡å®ä½“çš„ç‰¹ç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IPv4å¯ä»¥ç”±ä¸€ä¸ªuint32_tæ¥è¡¨ç¤º&lt;/li&gt;
&lt;li&gt;ipåœ°å€æ˜¯ç¨€ç–çš„&lt;ul&gt;
&lt;li&gt;å¤§éƒ¨åˆ†ipåœ°å€çš„è®¿é—®æ¬¡æ•°éå¸¸å°‘ï¼ˆé•¿å°¾ï¼‰&lt;/li&gt;
&lt;li&gt;å¾ˆå¤šipåœ°å€æ˜¯ä¿ç•™åœ°å€ï¼Œæ‰€ä»¥ä¸å¯èƒ½å‡ºç°åœ¨æ—¥å¿—ä¸­&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸šåŠ¡åº”ç”¨çš„ç‰¹ç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;â€œæœ€çƒ­é—¨â€è¡¨ç¤ºè¦æ±‚å¾—ç²¾ç¡®è§£ï¼Œè€Œä¸æ˜¯æ»¡æ„è§£&lt;/li&gt;
&lt;li&gt;å†…å­˜é™åˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åº”ç”¨çš„ç‰©ç†ç»“æ„çš„ç‰¹ç‚¹æ˜¯ï¼š æ”¯æŒå­˜å‚¨ä¸è®°æ•°&lt;/p&gt;
&lt;h2&gt;æ— ä»£ç æ— çœŸç›¸&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;assert.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdint.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;static_assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;64-bit only.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;uint8_t&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;IPcount&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kt"&gt;uint32_t&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kt"&gt;uint32_t&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IPcount&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;IPcount&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;overflows_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;IPcount&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;addOverflow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;IPcount&lt;/span&gt; &lt;span class="n"&gt;newItem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt; &lt;span class="p"&gt;};&lt;/span&gt;
  &lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;lower_bound&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;overflows_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;overflows_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;newItem&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;overflows_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;you need larger count variable&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;newItem&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="k"&gt;else&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;overflows_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;newItem&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;newItem&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;newItem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;addOverflow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="k"&gt;else&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;uint32_t&lt;/span&gt; &lt;span class="nf"&gt;getMostFrequenntIP&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max_size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mh"&gt;0xFFFFFFFFUL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1L&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%zd&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;counts_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

  &lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1L&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x3&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%08x %u&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä»ä»£ç è¯´å¼€æ¥&lt;/h3&gt;
&lt;p&gt;è¿™æ®µä»£ç ä¸ç®—æœ€æ¼‚äº®ï¼Œæœ‰å‡ ä¸ªå°æ§½ç‚¹ï¼Œä½†ä¹Ÿç®—æ˜¯éå¸¸ä¼˜é›…çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»æ€è·¯ä¸Šè¯´ï¼Œè¿™æ®µä»£ç æ³¨æ„åˆ°äº†æˆ‘ä»¬åˆšæ‰åˆ†æåˆ°çš„ï¼Œè¿™ä¸ªé—®é¢˜çš„ä¸šåŠ¡ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ipv4åœ°å€å¯ä»¥å­˜åœ¨uint32_tä¸­ï¼Œæ— éœ€å­˜å‚¨å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;ipåœ°å€æ˜¯ç¨€ç–çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸€å±‚uint_8è¿›è¡Œå“ˆå¸Œè®°æ•°ï¼Œå¯¹äºå°‘æ•°çš„çƒ­é—¨ipå†è¿›è¡Œuint32_tè®¡æ•°
ï¼ˆåŒæ—¶è€ƒè™‘äº†ipåœ°å€çš„ç¨€ç–æ€§ä»¥åŠå†…å­˜çš„é™åˆ¶ï¼Œå¹¶ä¸”å¯¹å†…å­˜çš„ä¼˜é›…ä½¿ç”¨ï¼Œå¯ä»¥æé«˜ç¼“å­˜çš„å‘½ä¸­ç‡ï¼Œæé«˜æ•ˆç‡ï¼‰&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç²¾ç¡®è®¡æ•°ï¼Œè·å¾—æ­£ç¡®è§£&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;ä»£ç ç•™ç»™æˆ‘ä»¬çš„æ€è€ƒé¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»ƒä¹ ï¼šæ‰¾å‡º worse caseï¼Œè®©è¿è¡Œæ—¶é—´é•¿è¾¾å‡ åˆ†é’Ÿç”šè‡³åå‡ åˆ†é’Ÿï¼Œç„¶åæå‡ºå¹¶å®æ–½æ”¹è¿›æªæ–½&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬æ‹¿ä¸å‡ºreal worldä¸­çš„dataï¼Œæ‰€ä»¥å¾ˆå¤šåˆ†æéƒ½æ˜¯çº¸ä¸Šè°ˆå…µï¼Œä¸è¿‡ä¸€åˆ‡çš„å®è·µä¹Ÿéƒ½æ˜¯ä»çº¸ä¸Šè°ˆå…µå¼€å§‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¢˜ç›®ä¸­çš„&lt;code&gt;std::vector&amp;lt;IPcount&amp;gt; overflows_;&lt;/code&gt;ä½¿ç”¨&lt;code&gt;unordered_map&lt;/code&gt;æ›´å¥½ï¼Œå‡å°‘æŸ¥æ‰¾çš„æ—¶é—´ï¼ˆO(logN) =&amp;gt; O(1)ï¼‰ï¼Œå¹¶ä¸”å‡å°‘æ’å…¥çš„æ—¶é—´ï¼ˆO(N) =&amp;gt; O(1)ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;std::vector&amp;lt;uint8_t&amp;gt; counts_;&lt;/code&gt;å¯ä»¥åœ¨é€‚å½“çš„æƒ…å†µè°ƒæ•´ä¸º&lt;code&gt;uint16_t&lt;/code&gt;ï¼Œå¯ä»¥å‡å°‘å“ˆå¸ŒèŠ‚ç‚¹ç”Ÿæˆå¯¹äºå†…å­˜çš„é¢‘ç¹ç”³è¯·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;p&gt;é¢˜ç›®ä¸­çš„åˆ†ææœ‰å¾ˆå¤šæ˜¯â€œæ‰§æœç´¢å› â€çš„æˆæœï¼Œæ¯•ç«Ÿåæ¨æ¯”æ­£æ¨è¦æ›´å®¹æ˜“ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³è¦ä»åæ¨æå‡ä¸ºæ­£æ¨ï¼ŒçœŸçš„éœ€è¦è‰¯å¥½çš„å‘æ•£æ€ç»´ä»¥åŠæ•é”çš„æ´å¯ŸåŠ›ã€‚å› ä¸ºé¢è¯•æ—¶ï¼Œæ²¡äººä¼šæŠŠé¢˜ç›®å¸®ä½ å†™åœ¨çº¸ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;è¯è¯´ï¼Œæˆ‘æ‰çŸ¥é“ipv6æ˜¯128ä½çš„ã€‚é‚£ä¹ˆå½“é¢˜ç›®ä¸­çš„ipåœ°å€ä¸ºipv6æ—¶ï¼Œåˆä¼šæœ‰ä»€ä¹ˆå¥½æ–¹æ³•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé“¾æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.infoq.com/cn/news/2010/05/BEDL"&gt;ä»‹ç»ï¼šä¸šåŠ¡å®ä½“å’Œä¸šåŠ¡å®ä½“å®šä¹‰è¯­è¨€&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="interview"></category><category term="system-design"></category></entry><entry><title>Single Number Problem</title><link href="http://wizmann.tk/single-number-in-the-array.html" rel="alternate"></link><updated>2014-08-05T23:07:02+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-08-05:single-number-in-the-array.html</id><summary type="html">&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;There are a lot of interview problem based on the 1D-array, which is the one of the easiest "data structure".&lt;/p&gt;
&lt;p&gt;But the problem about that simple data structure might not be that simple. Here is the summary of the problem about 1D-array.&lt;/p&gt;
&lt;p&gt;Of course, most of them come from Leetcode.&lt;/p&gt;
&lt;h2&gt;All Twice Excpet One&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Given an array of integers, every element appears twice except for one. Find that single one.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This &lt;a href="https://oj.leetcode.com/problems/single-number/"&gt;problem&lt;/a&gt; is the very basic one. So I just paste my code here. If you are confused with the &lt;code&gt;xor&lt;/code&gt; operatorï¼Œ you might have to review the knowledge of &lt;strong&gt;bit manipulation&lt;/strong&gt; carefully.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c"&gt;# @param A, a list of integer&lt;/span&gt;
    &lt;span class="c"&gt;# @return an integer&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;singleNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Time complexity: O(n)&lt;/p&gt;
&lt;h2&gt;All Once Except One&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Given an array of N integers, which are in the scope of [1...N - 1]. Every element in the array appears once except one. Find that number.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This one is simple enough. But it looks a "hard" problem because we can solve this by using the previously "xor".&lt;/p&gt;
&lt;p&gt;It's easy for us to calcuate the summary of the array [1...N - 1], and easy enough to calculate the summay of the given array as well. And the answer is the diffrence of the two summary.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c"&gt;# @param A, a list of integer&lt;/span&gt;
    &lt;span class="c"&gt;# @return an integer&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;singleInteger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Time complexity: O(n)&lt;/p&gt;
&lt;p&gt;p.s. &lt;code&gt;xor(A) ^ xor(range(n))&lt;/code&gt; is better if we have a large N that might overflow when we add all the elements.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Given an array of integers, every element appears once except for one which appears twice. Find that special number.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This problem is harder because all numbers in the array is arbitrary. And it seems hard to find any rules and patterns in the array.&lt;/p&gt;
&lt;p&gt;I don't know there is an algorithm which is O(1) space and O(n) time complexity. Tackle it with a hash set may be the best solution, which takes O(n) space and O(n) time complexity.&lt;/p&gt;
&lt;h2&gt;All three times except one&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Given an array of integers, every element appears three times except for one. Find that single one.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;To slove &lt;a href="https://oj.leetcode.com/problems/single-number-ii/"&gt;this problem&lt;/a&gt;, just using an array of size 32 to keep track on the total count of the ith bit.&lt;/p&gt;
&lt;p&gt;And a tricky solution to reduce the memory usage is use three integers to indicate the remainder of 3 of the total count of the bits.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;singleNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;twos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;threes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;twos&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;threes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;twos&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;threes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;twos&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;threes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;All twice except two&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Given an array of integers, every element appears twice except for two. Find that two numbers.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;xor(array) = 0 ^ a ^ b
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;a href="http://www.v2ex.com/t/94742"&gt;This problem&lt;/a&gt; is an update of "All twice except one". It's easy to prove that if there is an "1" in the bits of xor(array), it indicates that a and b are diffrent on that bit. We can separate the whole array by that bit, and then we can get two arrays which each contains a single "single number".&lt;/p&gt;
&lt;h3&gt;Once, twice, three times a lady&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Given an array of integers, some of the numbers appear once, and some appear twice, and the others appear three times. Please find the number which appear three times.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Of course, hash map is a panacea, with O(n) space and O(n) time.&lt;/p&gt;
&lt;p&gt;And there is another way to solve &lt;a href="http://www.ituring.com.cn/article/56179"&gt;this problem&lt;/a&gt; with O(1) space and O(n) time. But it has its limitation -- integer overflow. If the max number of this array is too large, it can't be done.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;randint&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Counter&lt;/span&gt;

&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;

&lt;span class="n"&gt;ns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;counter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Counter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;
    &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;

&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;counter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Considering the number &lt;code&gt;ns[i]&lt;/code&gt; with the index &lt;code&gt;i&lt;/code&gt; and with the value &lt;code&gt;val&lt;/code&gt;. We make &lt;code&gt;ns[i] = count(i) * MAX + val&lt;/code&gt;. By that, we can get the count of number &lt;code&gt;i&lt;/code&gt; by &lt;code&gt;ns[i] / MAX&lt;/code&gt;, and get the value of &lt;code&gt;ns[i]&lt;/code&gt; by &lt;code&gt;ns[i] % MAX&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And it's the same to find the "missing number of an array of [1 ... n]`` or something like that.&lt;/p&gt;
&lt;h2&gt;Summarize&lt;/h2&gt;
&lt;h3&gt;Hash Map is PANACEA&lt;/h3&gt;
&lt;p&gt;Almost every problem on the array which want you to detect a single / two / or more "special" number can be tackled by the Hash Map. Easy and fast.&lt;/p&gt;
&lt;p&gt;But for almost every problem, a hash map may no the very &lt;strong&gt;BEST&lt;/strong&gt; solution.&lt;/p&gt;
&lt;h3&gt;Bit Map takes less memory&lt;/h3&gt;
&lt;p&gt;An update for the hash map is the bit map. It takes less memory, but can storage less infomation, 0 or 1. Further, you can treat several bits as one to put more information in it.&lt;/p&gt;
&lt;p&gt;By its very nature, bit map is the same with hash map.&lt;/p&gt;
&lt;h3&gt;More powerful tool: Bloomfilter&lt;/h3&gt;
&lt;p&gt;Bloomfilter is a powerful algorithm / data structure which is used to slove the "in / not in" problem, and takes less memory than hash map, and can do better than bit map if the data is sparse and random.&lt;/p&gt;
&lt;p&gt;But it can't keep way the &lt;strong&gt;randomizing error&lt;/strong&gt; called &lt;strong&gt;false positive&lt;/strong&gt;, and if you can put up with that error and want to reduce your memory usage, try that.&lt;/p&gt;
&lt;p&gt;I didn't mention this in my passage, but you can find some information on this &lt;a href="http://en.wikipedia.org/wiki/Bloom_filter"&gt;wikipedia page&lt;/a&gt;. It's easy.&lt;/p&gt;
&lt;h3&gt;xor and bits manipulation&lt;/h3&gt;
&lt;p&gt;xor is a good way to solve the "only one appear once" problem. And xor manipulate will never cause overflow which will ruin your whole program.&lt;/p&gt;
&lt;h3&gt;just calculate the sum of the array&lt;/h3&gt;
&lt;p&gt;Somethimes we just forget the simplest way to deal with a "hard problem".&lt;/p&gt;
&lt;p&gt;For example, once I was asked "give you three integers (a, b, c), and calculate how many (x, y, z) is possible to make ax + by + cz == R".&lt;/p&gt;
&lt;p&gt;I'm glad because it is so much like a "3-Sum" problem, and I solve it fast. But the interver told me it's not the best solution. (You know how to deal with 3-sum, right?)&lt;/p&gt;
&lt;p&gt;I thought for a while, and give up at last. And the interver told me that the solution is to enumerate (x, y) and get z by this formula.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;z = (R - ax - by) / c
p.s. must be exact division
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It's a better and much easier solution, right? It was a shame for me not came up with that idea.&lt;/p&gt;
&lt;p&gt;So, don't forget the simple way, it may be the very best solution.&lt;/p&gt;
&lt;h3&gt;attach some information to some numbers&lt;/h3&gt;
&lt;p&gt;It useful if the length of the array (L) and the max value of the array (M). If M * L &amp;lt;= MAX_INT, you can storge the counter of number i in the array[i] by &lt;code&gt;array[i] = array[i] + counter * M&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It's a useful way to implement a counter in the array. And it will be a big plus for you in the interview.&lt;/p&gt;</summary><category term="ç®—æ³•"></category><category term="leetcode"></category><category term="algorithm"></category></entry><entry><title>ç®€æ˜Pythoné­”æ³• - 2</title><link href="http://wizmann.tk/python-magic-2.html" rel="alternate"></link><updated>2014-07-27T14:23:10+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-07-27:python-magic-2.html</id><summary type="html">&lt;h2&gt;å†è¯´æè¿°ç¬¦ - Descriptor&lt;/h2&gt;
&lt;h3&gt;æœ€ç®€å•çš„æè¿°ç¬¦&lt;/h3&gt;
&lt;p&gt;è¦†å†™ç±»çš„&lt;code&gt;__get__&lt;/code&gt;å’Œ&lt;code&gt;__setter__&lt;/code&gt;å‡½æ•°å°±å¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„æè¿°ç¬¦ã€‚å¯¹æŸä¸ªç±»å‹å®ä¾‹çš„è¯»å†™è¿›è¡Œé¢å¤–çš„æ§åˆ¶ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CurrentDate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__get__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;owner&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__set__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;NotImplementedError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Can&amp;#39;t change the current date.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Example&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CurrentDate&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Example&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;
&lt;span class="go"&gt;datetime.date(2008, 11, 24)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
  &lt;span class="c"&gt;...&lt;/span&gt;
&lt;span class="gr"&gt;NotImplementedError&lt;/span&gt;: &lt;span class="n"&gt;Can&amp;#39;t change the current date.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ç±»å±æ€§æè¿°ç¬¦&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyClass&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;__var&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_set_var&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__var&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_get_var&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__var&lt;/span&gt;

    &lt;span class="n"&gt;var&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;property&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_get_var&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_set_var&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyClass&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyClass&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼ŒåŒ…è£…ä¸€ä¸ªç±»å±æ€§æè¿°ç¬¦ã€‚å¯¹ç±»å±æ€§è¿›è¡Œæ“ä½œã€‚&lt;/p&gt;
&lt;h3&gt;å¯¹èµ„æºè¿›è¡Œå°è£…&lt;/h3&gt;
&lt;p&gt;åœ¨Djangoä¸­ï¼Œå¯ä»¥ä½¿ç”¨pickleåœ¨æ•°æ®åº“ä¸­å­˜å‚¨ä¸€äº›åºåˆ—åŒ–ä¿¡æ¯ï¼Œå¦‚åˆ—è¡¨ã€å­—å…¸ç­‰ï¼ˆè¿™äº›å­—æ®µéƒ½ä¸æ˜¯åŸå­çš„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç»§æ‰¿&lt;code&gt;models.TextField&lt;/code&gt;æ¥å®ç°æˆ‘ä»¬çš„&lt;code&gt;PickleField&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PickleField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TextField&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pickle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dumps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;unpickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pickle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_attname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;_pickled&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_db_prep_lookup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lookup_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;        ç¦æ­¢ä½¿ç”¨pickledå­—æ®µè¿›è¡ŒæŸ¥è¯¢&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Con&amp;#39;t make comparisons against pickled data.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»¥ä¸Šå®ç°çš„æ˜¯æœ€ç®€å•çš„PickleFieldï¼Œç”¨æˆ·åœ¨ä½¿ç”¨è¿™ä¸ªç±»å‹çš„å­—æ®µæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨å¯¹æ•°æ®è¿›è¡Œpickle/unpickleã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨propertyï¼Œå®ç°ä¸€ä¸ªPickleDescriptoræè¿°ç¬¦ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PickleDescriptor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;property&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;
&lt;span class="err"&gt;â€‰&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__get__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;owner&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;
&lt;span class="err"&gt;â€‰&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="c"&gt;# The object hasn&amp;#39;t been created yet, so unpickle the data&lt;/span&gt;
           &lt;span class="n"&gt;raw_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attname&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
           &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unpickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;raw_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="err"&gt;â€‰&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;â€‰&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__set__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
        &lt;span class="nb"&gt;setattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pickle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªæè¿°ç¬¦çš„ä½œç”¨æ˜¯å°è£…PickleFieldçš„get/setæ“ä½œã€‚å¯¹äºgetï¼Œå½“å­—æ®µæœªè¢«ååºåˆ—åŒ–æ—¶ï¼Œè°ƒç”¨unpickledï¼Œå…¶å®ƒæ—¶å€™ç›´æ¥è¯»å–å­—æ®µã€‚å¯¹äºsetï¼Œåˆ™æ˜¯åŒæ—¶æ›´æ–°å­—æ®µä»¥åŠpickledå­—æ®µã€‚å®ç°äº†ä¸€ä¸ªç±»ä¼¼cacheçš„æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å†ä¸º&lt;code&gt;PickleField&lt;/code&gt;åŠ ä¸Šä¸€ä¸ª&lt;code&gt;contribute_to_class&lt;/code&gt;å›è°ƒã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;contribute_to_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PickleField&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contribute_to_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;setattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PickleDescriptor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“è¿™ä¸ªå­—æ®µè¢«åŠ å…¥æ•°æ®æ¨¡å‹çš„æ—¶å€™ï¼Œè‡ªåŠ¨æŠŠå¯¹å­—æ®µçš„å­—ä¹‰æ›¿æ¢ä¸ºè¯¥æè¿°ç¬¦ã€‚ï¼ˆå¤ªæ¼‚äº®ï¼ï¼‰&lt;/p&gt;
&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;p&gt;åœ¨åšæ¯•è®¾çš„æ—¶å€™ï¼Œæå‰è¯»äº†_Pro Django_ä¸€ä¹¦ï¼ŒçœŸå¿ƒè®©æˆ‘å°‘èµ°äº†ä¸å°‘å¼¯è·¯ã€‚åœ¨å¯¼å¸ˆæœ€åä¸€å¤©æ”¹éœ€æ±‚çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥ä»å®¹ä¸è¿«çš„è§æ‹›æ‹†æ‹›ã€‚è¿™çœŸçš„å¾—æ„Ÿè°¢Pythonè¶…å¼ºçš„å¼¹æ€§ï¼Œä»¥åŠDjangoå®Œç¾çš„è®¾è®¡å“²å­¦ã€‚&lt;/p&gt;
&lt;p&gt;_Pro Django_çš„éƒ¨åˆ†åˆ°è¿™é‡ŒåŸºæœ¬å°±ç»“æŸäº†ï¼Œæ­¤ä¹¦åé¢çš„ç« èŠ‚å¤§éƒ½æ˜¯Djangoç›¸å…³çš„ï¼Œå¯¹äºPythonçš„è®²è§£è¢«æ·¡åŒ–äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ç³»åˆ—åé¢çš„æ–‡ç« è¿˜æ˜¯ä¼šä»å£°æ˜å¼ç¼–ç¨‹ä»¥åŠç±»DSLç¼–ç¨‹çš„è§’åº¦å‡ºå‘ï¼Œå¯¹äºPythonçš„é­”æ³•è¿›è¡Œå­¦ä¹ ã€‚&lt;/p&gt;
&lt;h2&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://book.douban.com/subject/3086812/"&gt;Pro Django&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="python"></category></entry><entry><title>ç®€æ˜Pythoné­”æ³• - 1</title><link href="http://wizmann.tk/python-magic-1.html" rel="alternate"></link><updated>2014-07-26T22:23:34+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-07-26:python-magic-1.html</id><summary type="html">&lt;h2&gt;Pythonä¸­ç±»çš„å®ç°&lt;/h2&gt;
&lt;p&gt;åœ¨Pythonçš„Webæ¡†æ¶Djangoä¸­ï¼ŒPythonç±»çš„æ„é€ ç‰¹æ€§å®ç°äº†å®ƒå¤§éƒ¨åˆ†çš„æ ¸å¿ƒåŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å½“Pythonè§£é‡Šå™¨é‡åˆ°ç±»å£°æ˜æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„namespace ï¼Œå¹¶æ‰§è¡Œå…¶å†…çš„æ‰€æœ‰ä»£ç ï¼Œå¹¶å°†å˜é‡æ³¨å†Œåˆ°è¿™ä¸ªnamespaceä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Loading...&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="n"&gt;spam&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;eggs&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Done!&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;
&lt;span class="go"&gt;Loading...&lt;/span&gt;
&lt;span class="go"&gt;Done!&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spam&lt;/span&gt;
&lt;span class="go"&gt;&amp;#39;eggs&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;åŠ¨æ€çš„å®ç°ä¸€ä¸ªç±»&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨typeæ–¹æ³•å¯ä»¥åŠ¨æ€çš„ä»£ç ä¸­å®ç°ä¸€ä¸ªç±»ï¼Œæ¥å—ä¸‰ä¸ªå‚æ•°â€œç±»åâ€ã€â€œåŸºç±»â€ã€â€œå±æ€§â€ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;Bar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Bar&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,),&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;spam&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;eggs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;Bar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spam&lt;/span&gt;
&lt;span class="go"&gt;&amp;#39;eggs&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;è¶…ç±»æ”¹å˜ä¸€åˆ‡&lt;/h3&gt;
&lt;p&gt;â€œmetaprogrammingâ€æ˜¯æŒ‡ä¸€ç§åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ›å»ºæˆ–æ”¹å˜ä»£ç çš„ç¼–ç¨‹æ‰‹æ®µã€‚&lt;code&gt;type&lt;/code&gt;æ˜¯ä¸€ä¸ªmetaclassï¼Œä¸€ä¸ªåˆ›å»ºå…¶å®ƒç±»çš„metaclassã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æ›¿æ¢æ‰åŸç”Ÿçš„&lt;code&gt;type&lt;/code&gt;ï¼Œä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„ç‰ˆæœ¬ï¼Œä»è€Œæ§åˆ¶åˆ›å»ºç±»çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MetaClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bases&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Defining &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Name: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Bases: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bases&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Attributes:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;    &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RealClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metaclass&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;MetaClass&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="n"&gt;spam&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;eggs&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="go"&gt;Defining &amp;lt;class &amp;#39;__main__.RealClass&amp;#39;&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;Name: RealClass&lt;/span&gt;
&lt;span class="go"&gt;Bases: (&amp;lt;class &amp;#39;object&amp;#39;&amp;gt;,)&lt;/span&gt;
&lt;span class="go"&gt;Attributes:&lt;/span&gt;
&lt;span class="go"&gt;    spam: &amp;#39;eggs&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;    __module__: &amp;#39;__main__&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;    __qualname__: &amp;#39;RealClass&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;RealClass&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;class &amp;#39;__main__.RealClass&amp;#39;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯å½“ä¸€ä¸ªæ–°çš„ç±»è¢«åˆ›å»ºæ—¶ï¼Œéƒ½ä¼šè§¦å‘metaclassçš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;h3&gt;åŸºç±»ä¸è¶…ç±»&lt;/h3&gt;
&lt;p&gt;åŸºç±»ä¸è¶…ç±»ä¸€èµ·ä½¿ç”¨å¯ä»¥å®ç°ç±»æ–¹æ³•çš„å¤ç”¨ï¼Œä»¥åŠå¯¹äºç±»åˆ›å»ºçš„è·Ÿè¸ªã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="go"&gt; &amp;gt;&amp;gt;&amp;gt; class SubClass(RealClass):  # Notice there&amp;#39;s no metaclass here.&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="go"&gt;Defining &amp;lt;class &amp;#39;__main__.SubClass&amp;#39;&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;Name: SubClass&lt;/span&gt;
&lt;span class="go"&gt;Bases: (&amp;lt;class &amp;#39;__main__.RealClass&amp;#39;&amp;gt;,)&lt;/span&gt;
&lt;span class="go"&gt;Attributes:&lt;/span&gt;
&lt;span class="go"&gt;    __module__: &amp;#39;__main__&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨è¿™é‡Œï¼Œè¶…ç±»å¯¹äº&lt;code&gt;SubClass&lt;/code&gt;æ˜¯å®Œå…¨é€æ˜çš„ï¼Œ&lt;code&gt;SubClass&lt;/code&gt;åªéœ€è¦å®Œæˆè‡ªå·±çš„å·¥ä½œï¼ŒPythonä¼šåœ¨åå°æ–™ç†å¥½ä¸€åˆ‡ã€‚&lt;/p&gt;
&lt;h3&gt;å£°æ˜å¼è¯­æ³•&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;This syntax (Declarative Syntax) is designed to make minimize "boilerplate" repetitive syntax and provide elegant, readable code.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å£°æ˜å¼è¯­æ³•æ˜¯ä¸€ç§æŠŠæ•°æ®å’Œé€»è¾‘åˆ†ç¦»çš„ç¼–ç¨‹æ–¹å¼ï¼Œé¢å¯¹ç»å¸¸å˜åŠ¨çš„ä½†æ˜¯è§„å¾‹æ˜æ˜¾çš„éœ€æ±‚ï¼Œå£°æ˜å¼ç¼–ç¨‹å¯ä»¥è§£æ•‘ä½ äºæ°´ç«ä¹‹ä¸­ã€‚:-P&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Contact&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Contact information provided when sending messages to the owner of the site.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EmailField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šé¢æ˜¯Djangoçš„æ¨¡å‹å£°æ˜è¯­æ³•ï¼Œç®€æ´ã€æ˜äº†ã€å¤§æ°”ï¼&lt;/p&gt;
&lt;h2&gt;è®©æˆ‘ä»¬ä¸€èµ·åšé¸­&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Shakespeare: "If it walks like a duck and talks like a duck, it's a Duck." &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Callables&lt;/h3&gt;
&lt;h4&gt;__call__&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Multiplier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;factor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;factor&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;factor&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;times2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Multiplier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;times2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;10&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;times2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;20&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;times3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Multiplier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;times3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;30&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨callableå‡½æ•°æ¥æ„é€ â€æœ‰çŠ¶æ€çš„å‡½æ•°â€œï¼Œä»¥åŠå…¶å®ƒå¯ä»¥æƒ³çš„åˆ°çš„ä¸€äº›é»‘é­”æ³•ã€‚&lt;/p&gt;
&lt;h3&gt;Dictionaries&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;__contains&lt;/code&gt;ã€&lt;code&gt;__getitem__&lt;/code&gt;å’Œ&lt;code&gt;__setitem__&lt;/code&gt;å†…å»ºå‡½æ•°ï¼Œå¯ä»¥è®©ä¸€ä¸ªç±»å®ä¾‹æ¨¡æ‹Ÿå­—å…¸çš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;h3&gt;File&lt;/h3&gt;
&lt;p&gt;å®ç°&lt;code&gt;read&lt;/code&gt;ã€&lt;code&gt;write&lt;/code&gt;å’Œ&lt;code&gt;close&lt;/code&gt;ï¼Œä½ ä»¬å°±å¯ä»¥æŠŠæˆ‘å½“æ–‡ä»¶æ¥ç”¨å•¦ã€‚&lt;/p&gt;
&lt;h3&gt;Iterable&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Fibonacci&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;count&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__iter__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;                &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;                &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;                &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;                &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;Fibonacci&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="go"&gt;0&lt;/span&gt;
&lt;span class="go"&gt;1&lt;/span&gt;
&lt;span class="go"&gt;1&lt;/span&gt;
&lt;span class="go"&gt;2&lt;/span&gt;
&lt;span class="go"&gt;3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åå‡½æ•°&lt;/h2&gt;
&lt;p&gt;åå‡½æ•°å’Œå‡½æ•°å¼ç¼–ç¨‹ä¸­çš„â€æŸ¯é‡ŒåŒ–â€œä¸€æ ·ï¼Œéƒ½æ˜¯é€šè¿‡å¡«å……å‡½æ•°ä¸­çš„ä¸€éƒ¨åˆ†å‚æ•°ï¼Œä»è€Œå®ç°ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;functools&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;6&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;plus3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;functools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;plus5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;functools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;plus3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;7&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;plus3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;10&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;plus5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;15&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æè¿°ç¬¦&lt;/h2&gt;
&lt;p&gt;æè¿°ç¬¦ç”¨æ¥å­˜å–ç±»å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥æä¾›å¦‚ä¸‹çš„ä¾¿åˆ©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»å¤æ‚çš„å¯¹è±¡ä¸­å–å‡ºæ•°æ®ï¼Œä¾‹å¦‚æ•°æ®åº“æˆ–æ˜¯é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;æŠŠä¸€ä¸ªç®€å•çš„å€¼ä¼ å…¥ä¸€ä¸ªå¤æ‚å¯¹è±¡ä¸­&lt;/li&gt;
&lt;li&gt;å¯¹å­˜å–çš„å€¼è¿›è¡Œè‡ªå®šä¹‰æ“ä½œ&lt;/li&gt;
&lt;li&gt;æŠŠå€¼è½¬åŒ–ä¸ºæ˜“äºå†™å…¥æ•°æ®åº“ä¸­çš„ç±»å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CurrentDate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__get__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;owner&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__set__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;NotImplementedError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Can&amp;#39;t change the current date.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Example&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CurrentDate&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Example&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;
&lt;span class="go"&gt;datetime.date(2008, 11, 24)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
  &lt;span class="c"&gt;...&lt;/span&gt;
&lt;span class="gr"&gt;NotImplementedError&lt;/span&gt;: &lt;span class="n"&gt;Can&amp;#39;t change the current date.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;å®ç°&lt;/h3&gt;
&lt;p&gt;è¦†å†™ç±»çš„&lt;code&gt;__get__&lt;/code&gt;å’Œ&lt;code&gt;__set__&lt;/code&gt;å‡½æ•°å°±å¯ä»¥å®ç°ç±»çš„æè¿°ç¬¦ã€‚&lt;/p&gt;
&lt;h2&gt;å®è·µï¼šä¸€ä¸ªç®€å•çš„UnitTestæ¡†æ¶&lt;/h2&gt;
&lt;h3&gt;è®¾è®¡æ€è·¯&lt;/h3&gt;
&lt;p&gt;å¯¹äºæ¯ä¸€ä¸ªCaseï¼Œåªéœ€è¦å£°æ˜ä¸€ä¸ªç±»ã€‚åœ¨ç±»ä¸­å£°æ˜è¦æµ‹è¯•çš„å‡½æ•°ä»¥åŠæµ‹è¯•çš„Inputå’Œé¢„æœŸOutputã€‚ä¹‹åæ¡†æ¶å¯ä»¥è¿è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶è¾“å‡ºç»“æœã€‚&lt;/p&gt;
&lt;h3&gt;æ¥å£è®¾è®¡&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;PyUnitTest&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyUnitTest&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BaseCase&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;func1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;func2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TestFunc1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BaseCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;FUNC&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func1&lt;/span&gt;
    &lt;span class="n"&gt;INPUT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
             &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
             &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;}]&lt;/span&gt;
    &lt;span class="n"&gt;OUTPUT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TestFunc2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BaseCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;FUNC&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func2&lt;/span&gt;
    &lt;span class="n"&gt;INPUT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
             &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
             &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;}]&lt;/span&gt;
    &lt;span class="n"&gt;OUTPUT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;PyUnitTest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_all_test&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨Caseä¸­ï¼Œä½¿ç”¨&lt;code&gt;FUNC&lt;/code&gt;æ ‡æ˜å‡½æ•°ï¼Œä½¿ç”¨&lt;code&gt;INPUT&lt;/code&gt;å’Œ&lt;code&gt;OUTPUT&lt;/code&gt;æ ‡æ˜é¢„æœŸè¾“å…¥è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;PyUnitTest.run_all_test()&lt;/code&gt;è‡ªåŠ¨è¿è¡Œæ‰€æœ‰ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;h3&gt;CaseContainer&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Case&lt;/code&gt;ç±»è·å¾—&lt;code&gt;Case&lt;/code&gt;åï¼Œå¾…æµ‹è¯•å‡½æ•°åï¼Œè¾“å…¥å’Œè¾“å‡ºæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”å®ç°&lt;code&gt;run()&lt;/code&gt;æ–¹æ³•ï¼Œè¿è¡Œæµ‹è¯•ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;assert&lt;/code&gt;æ–¹æ³•ä¿è¯ç”¨ä¾‹çš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;in_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;INPUT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;OUTPUT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;FUNC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;in_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;in_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out_data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;running case: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt; ...&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
        &lt;span class="n"&gt;data_pair&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;in_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;ok&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;data_in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_out&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;data_pair&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;data_in&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;data_out&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;ok&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;[PASS &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt;]...&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;[FAILED &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt;]...&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;INPUT:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;repr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_in&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;OUTPUT:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;repr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;EXPECT:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;repr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;finish case: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt; (&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt; / &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt;) ...&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;CaseContainerç±»å®ç°äº†Caseçš„æ”¶é›†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CaseContainer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;cases&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;case&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cases&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;case&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;è¶…ç±»ä¸åŸºç±»&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;CaseContainer&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Case&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CaseContainer&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MetaCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bases&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;BaseCase&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;

        &lt;span class="n"&gt;case&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;CaseContainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;case&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BaseCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;__metaclass__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MetaCase&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_all_test&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;case&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;CaseContainer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cases&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;case&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¶…ç±»ä¸­ï¼Œå£°æ˜Caseçš„æ”¶é›†é€»è¾‘ã€‚è€ŒåŸºç±»ä¸­çš„&lt;code&gt;__metaclass__&lt;/code&gt;ä½¿æ‰€æœ‰Caseå­ç±»çš„è¶…ç±»çš†ä¸º&lt;code&gt;MetaCase&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åçš„&lt;code&gt;run_all_test&lt;/code&gt;å¯ä»¥æ‰¹å¤„ç†æ‰€æœ‰çš„test caseã€‚&lt;/p&gt;
&lt;h3&gt;åç»­&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªå°çš„å•å…ƒæµ‹è¯•æ¡†æ¶å¹¶ä¸å®Œå–„ï¼Œåªæ˜¯å®ç°äº†æœ€åŸºæœ¬çš„æµ‹è¯•åŠŸèƒ½ã€‚å¹¶ä¸”ä¹Ÿæ²¡æœ‰å®Œå…¨åº”ç”¨ä¸Šé¢æ‰€æåˆ°çš„æ‰€æœ‰Pythonçš„é­”æ³•ç‰¹æ€§ã€‚æ‰€ä»¥åç»­å¦‚æœæœ‰æ—¶é—´å’Œç²¾åŠ›ï¼Œåº”è¯¥ç»§ç»­å®Œå–„å§ã€‚&lt;/p&gt;
&lt;h2&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://book.douban.com/subject/24806569/"&gt;Pro Django&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="python"></category></entry><entry><title>Codeforces 447D DZY Loves Modification</title><link href="http://wizmann.tk/cf-447d.html" rel="alternate"></link><updated>2014-07-24T23:44:44+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-07-24:cf-447d.html</id><summary type="html">&lt;h2&gt;é¢˜æ„&lt;/h2&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªn * mçš„çŸ©é˜µï¼Œè®©ä½ åšKæ¬¡æ“ä½œï¼Œä½¿å¾—æœ€åå¾—åˆ°çš„å€¼æœ€å¤§ã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œæœ‰ä¸¤ç§ï¼š&lt;/p&gt;
&lt;p&gt;ä¸€æ˜¯&lt;strong&gt;åœ¨ä»»æ„ä¸€è¡Œä¸Š&lt;/strong&gt;æ“ä½œï¼Œæœ€ç»ˆçš„ç»“æœå€¼åŠ ä¸Šè¿™ä¸€è¡Œæ•°çš„å’Œï¼Œç„¶åè¿™ä¸€è¡Œæ¯ä¸€ä¸ªæ•°éƒ½è¦å‡å»pã€‚&lt;/p&gt;
&lt;p&gt;äºŒæ˜¯&lt;strong&gt;åœ¨ä»»æ„ä¸€åˆ—ä¸Š&lt;/strong&gt;æ“ä½œï¼Œæœ€ç»ˆçš„ç»“æœå€¼åŠ ä¸Šè¿™ä¸€åˆ—æ•°çš„å’Œï¼Œç„¶åè¿™ä¸€åˆ—æ¯ä¸€ä¸ªæ•°éƒ½è¦å‡å»pã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ®èŒƒå›´ï¼š1â€‰â‰¤â€‰n,â€‰mâ€‰â‰¤â€‰10^3; 1â€‰â‰¤â€‰kâ€‰â‰¤â€‰10^6; 1â€‰â‰¤â€‰pâ€‰â‰¤â€‰100&lt;/p&gt;
&lt;h2&gt;é€€åŒ–ç‰ˆçš„é¢˜ç›®æ€è·¯&lt;/h2&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬åªé™å®šä¸€ç§æ“ä½œï¼Œæ­¤é¢˜å°±æ˜¯ç®€å•é¢˜äº†ã€‚æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå¤§æ ¹å †ï¼Œå †ä¸­ä¿å­˜æ¯ä¸€è¡Œï¼ˆæˆ–åˆ—ï¼‰ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æ“ä½œåªéœ€è¦å–å‡ºæœ€å¤§å€¼ï¼ŒåŠ åˆ°æœ€ç»ˆç»“æœä¸Šã€‚ä¹‹åå°†è¿™ä¸ªå€¼å‡å»å¯¹åº”çš„p * nï¼ˆæˆ–p * mï¼‰ï¼Œå†åŠ å…¥å †ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç»è¿‡Kæ¬¡å¾ªç¯ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€åçš„ç­”æ¡ˆäº†ã€‚&lt;/p&gt;
&lt;h2&gt;çœŸæ­£çš„é¢˜ç›®æ€è·¯&lt;/h2&gt;
&lt;p&gt;å¯¹äºè¡Œå’Œåˆ—åŒæ—¶æ“ä½œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¥—ç”¨è¿™ç§æ–¹æ³•ã€‚ä½†æ˜¯è¦è§£å†³å¯¹è¡Œæ“ä½œåï¼Œå¯¹åˆ—ä¸Šæ•°å­—çš„å€¼çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;æ˜“å¾—ï¼Œå¦‚æœè¡Œåˆ—æ··åˆæ“ä½œï¼Œä¸”åªä½¿ç”¨ä¸Šè¿°æ–¹æ³•çš„è¯ã€‚æ¯æ¬¡è¡Œæ“ä½œæ‰€å¾—åˆ°çš„å€¼ï¼Œå®é™…ä¸Šä¸º&lt;code&gt;ç®€å•è¡Œæ“ä½œå¾—åˆ°çš„å€¼ - æ­¤æ¬¡è¡Œæ“ä½œä¹‹å‰çš„æ‰€æœ‰åˆ—æ“ä½œæ¬¡æ•° * p&lt;/code&gt;(ä¸ºä»€ä¹ˆï¼Ÿ)ã€‚å¯¹äºåˆ—æ“ä½œäº¦ç„¶ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ“ä½œåºåˆ—ï¼Œ&lt;code&gt;&amp;lt;a0, b0&amp;gt;&lt;/code&gt;ä»£è¡¨åºåˆ—çš„ä¸€æ®µæ‰§è¡Œäº†a0ä¸ªè¡Œæ“ä½œå’Œb0ä¸ªåˆ—æ“ä½œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;lt;a0, b0&amp;gt;  | &amp;lt;1, 0&amp;gt;  | &amp;lt;0, 1&amp;gt;  | &amp;lt;a1, b1&amp;gt;|
|&amp;lt;---A---&amp;gt;|&amp;lt;---B---&amp;gt;|&amp;lt;---C---&amp;gt;|&amp;lt;---D---&amp;gt;|
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ“ä½œè¢«åˆ†ä¸ºäº†å››ä¸ªé˜¶æ®µã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºBé˜¶æ®µæ¥è¯´ï¼Œå…¶ç»“æœä¸º&lt;code&gt;1æ¬¡ç®€å•è¡Œæ“ä½œçš„å€¼ - b0 * p&lt;/code&gt;(ä¸ºä»€ä¹ˆï¼Ÿ)ï¼Œå¯¹äºCé˜¶æ®µæ¥è¯´ï¼Œå…¶ç»“æœä¸º&lt;code&gt;1æ¬¡ç®€å•åˆ—æ“ä½œçš„å€¼ - (a0 + 1) * p&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œå¦‚æœå½“æˆ‘ä»¬æŠŠBé˜¶æ®µå’ŒCé˜¶æ®µäº’æ¢çš„è¯ï¼Œ ç»“æœæ˜¯ä¸å˜çš„ã€‚(ä¸ºä»€ä¹ˆï¼Ÿæˆ‘çœŸTMDæ˜¯åä¸‡ä¸ªä¸ºä»€ä¹ˆã€‚ã€‚ã€‚)&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œåœ¨ä»»ä¸€ä¸ªæ“ä½œåºåˆ—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº¤æ¢ä»»æ„ä¸€ä¸ªçš„è¡Œæ“ä½œå’Œåˆ—æ“ä½œï¼Œè€Œæ€»ç»“æœä¸å˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼Œæˆ‘ä»¬å¯ä»¥å°†æ“ä½œåºåˆ—ç­‰ä»·å˜åŒ–æˆä¸‹é¢çš„åºåˆ—ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;lt;a, 0&amp;gt; | &amp;lt;0, b&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ­¤æ—¶ï¼Œæœ€ç»ˆçš„ç»“æœä¸º&lt;code&gt;aæ¬¡ç®€å•è¡Œæ“ä½œçš„å€¼ + bæ¬¡ç®€å•åˆ—æ“ä½œçš„å€¼ - a * b * p&lt;/code&gt;ã€‚(ä¸ºä»€ä¹ˆï¼Ÿ)&lt;/p&gt;
&lt;p&gt;è€Œaä¸bçš„å€¼å¯ä»¥ç®€å•çš„é€šè¿‡æšä¸¾å¾—åˆ°ã€‚æ€è·¯æœ‰äº†ï¼Œä»£ç å¦‚æœä¸å‡ºå¤§é—®é¢˜ï¼Œè¿™é¢˜å°±å¯ä»¥ACäº†ã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1024000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;sumX&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sumY&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;do_calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;vs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;priority_queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="nl"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;vs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;calcX&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;do_calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sumX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;calcY&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;do_calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sumY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;xs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;calcX&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;calcY&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;numeric_limits&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;::&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;sumX&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;sumY&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;p&gt;æŸå‚çš„g++ç‰ˆæœ¬æ˜¯3.4.xï¼Œæ²¡æœ‰C++11ï¼Œ&lt;strong&gt;æ ¹æœ¬ç§€ä¸èµ·æ¥å•Š&lt;/strong&gt;ï¼&lt;/p&gt;
&lt;p&gt;è¯´çš„å°±å’Œä½ ä¼šå†™C++11ä¸€æ ·_(:Ğ·ã€âˆ )_&lt;/p&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>CPU cacheå¼•å‘çš„æ€§èƒ½è¡€æ¡ˆ</title><link href="http://wizmann.tk/cpu-cache-miss.html" rel="alternate"></link><updated>2014-07-20T00:18:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-07-20:cpu-cache-miss.html</id><summary type="html">&lt;p&gt;åœ¨__&lt;a href="http://evol128.is-programmer.com/posts/35453.html"&gt;ä¸ºä»€ä¹ˆè½¬ç½®ä¸€ä¸ª512x512çš„çŸ©é˜µï¼Œä¼šæ¯”513x513çš„çŸ©é˜µæ…¢å¾ˆå¤šï¼Ÿ&lt;/a&gt;__ä¸€æ–‡ä¸­ï¼Œä½œè€…å¼•ç”¨äº†ä¸€ä¸ªçŸ©é˜µè½¬ç½®çš„ä¾‹å­ï¼Œæ¥è®²è§£ç”±äºCPU cacheçš„å¤±æ•ˆè€Œå¸¦æ¥çš„æ€§èƒ½æŸå¤±ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„æ–‡ç« å¯¹é—®é¢˜çš„è§£é‡Šä¸è®¨è®ºéƒ½éå¸¸çš„é€å½»ã€‚æˆ‘çš„è¿™ç¯‡æ–‡ç« åªæ˜¯å¯¹ä¸Šé¢æ–‡ç« çš„ä¸€ç¯‡è¯»åæ„Ÿå’Œå®éªŒæŠ¥å‘Šã€‚å°±é…±ã€‚&lt;/p&gt;
&lt;h2&gt;CPU cache ä¹‹ ç»„ç›¸è”&lt;/h2&gt;
&lt;p&gt;&lt;img alt="ç»„ç›¸è”" src="http://wizmann-tk-pic.u.qiniudn.com/blog-cpu-cache-2-way-set-assosiate.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ç»„ç›¸è”çš„å®ç°å’ŒåŸç†ä¸å¿…å†èµ˜è¿°äº†ã€‚æˆ‘æƒ³è®¨è®ºçš„æ˜¯ï¼Œå¦‚ä½•åœ¨ç¼–ç¨‹ä¸­ä¼˜åŒ–CPUçš„cacheæ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2&gt;æŸ¥çœ‹CPUä¿¡æ¯&lt;/h2&gt;
&lt;p&gt;æˆ‘çš„ç³»ç»Ÿæ˜¯Ubuntu 12.04ï¼ŒCPUæ˜¯i5-3230Mã€‚ï¼ˆå±Œä¸æœº :D)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;wizmann@Wichmann:~$ ls /sys/devices/system/cpu/cpu0/cache/index0/
coherency_line_size  physical_line_partition  size
level                shared_cpu_list          type
number_of_sets       shared_cpu_map           ways_of_associativity
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨catå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥è·å¾—CPU L1 cacheçš„ä¸€äº›ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;table class="table table-striped-white table-bordered"&gt;
&lt;thead&gt;
&lt;tr&gt;
 &lt;th&gt;Key&lt;/th&gt;
 &lt;th&gt;Value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
 &lt;td&gt;level&lt;/td&gt;
 &lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
 &lt;td&gt;size&lt;/td&gt;
 &lt;td&gt;32K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
 &lt;td&gt;ways_of_associativity&lt;/td&gt;
 &lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
 &lt;td&gt;type&lt;/td&gt;
 &lt;td&gt;Data&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
 &lt;td&gt;number_of_sets&lt;/td&gt;
 &lt;td&gt;64&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;ä»¥ä¸Šå¯çŸ¥ï¼ŒCPU L1 cacheæœ‰64ç»„ï¼Œæ¯ç»„æœ‰8ä¸ªcache lineã€‚æ˜¯&lt;strong&gt;8ä½ç»„ç›¸è”&lt;/strong&gt;çš„Cacheç±»å‹ã€‚&lt;/p&gt;
&lt;h2&gt;åˆ†æç¼“å­˜å¤±æ•ˆç‡&lt;/h2&gt;
&lt;p&gt;å¯¹äºä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹å·¥è®¡ç®—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¨‹åºæ¨¡æ‹ŸCacheçš„å¤±æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼ŒValgrindä¸ºæˆ‘ä»¬æä¾›äº†cachegrindå·¥å…·æ¥åˆ†æcacheçš„å¤±æ•ˆã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;wizmann@Wichmann:/tmp$ valgrind --tool=cachegrind --D1=32768,2,16 ./test
==14282== Cachegrind, a cache and branch-prediction profiler
==14282== Copyright (C) 2002-2011, and GNU GPL&amp;#39;d, by Nicholas Nethercote et al.
==14282== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==14282== Command: ./test
==14282== 
--14282-- warning: L3 cache found, using its data for the LL simulation.
Average for a matrix of 257: 1875==14282== 
==14282== I   refs:      18,708,198
==14282== I1  misses:         1,404
==14282== LLi misses:         1,355
==14282== I1  miss rate:       0.00%
==14282== LLi miss rate:       0.00%
==14282== 
==14282== D   refs:       8,936,548  (4,543,346 rd   + 4,393,202 wr)
==14282== D1  misses:     1,107,687  (1,086,263 rd   +    21,424 wr)
==14282== LLd misses:        10,502  (    5,179 rd   +     5,323 wr)
==14282== D1  miss rate:       12.3% (     23.9%     +       0.4%  )
==14282== LLd miss rate:        0.1% (      0.1%     +       0.1%  )
==14282== 
==14282== LL refs:        1,109,091  (1,087,667 rd   +    21,424 wr)
==14282== LL misses:         11,857  (    6,534 rd   +     5,323 wr)
==14282== LL miss rate:         0.0% (      0.0%     +       0.1%  )
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­I1ä»£è¡¨æŒ‡ä»¤1çº§ç¼“å­˜ï¼ŒD1ä»£è¡¨æ•°æ®1çº§ç¼“å­˜ï¼Œè€ŒLLä»£è¡¨äºŒçº§æˆ–ä¸‰çº§ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„è¾“å‡ºä¹Ÿè®¸è¿‡äºå¤æ‚ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢åˆ—è¡¨åˆ†æã€‚&lt;/p&gt;
&lt;h3&gt;æµ‹è¯•ç¯å¢ƒ&lt;/h3&gt;
&lt;p&gt;åªè®¨è®ºL1çš„æƒ…å†µï¼ŒL1å¤§å°32768 Bytesï¼Œ2è·¯ç»„ç›¸è”ï¼Œæ¯ä¸ªcache lineæœ‰16 Bytesã€‚&lt;/p&gt;
&lt;p&gt;valgrindæµ‹è¯•å‘½ä»¤ä¸ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;wizmann@Wichmann:/tmp$ valgrind --tool=cachegrind --D1=32768,2,16 ./test
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æµ‹è¯•ç¨‹åº&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#define SAMPLES 64&lt;/span&gt;
&lt;span class="cp"&gt;#define MATSIZE 256&lt;/span&gt;

&lt;span class="cp"&gt;#include &amp;lt;time.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;MATSIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;MATSIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;transpose&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;MATSIZE&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="p"&gt;{&lt;/span&gt;
       &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
       &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
       &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aux&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="c1"&gt;//initialize matrix&lt;/span&gt;
   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;MATSIZE&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;MATSIZE&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
       &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

   &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SAMPLES&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
       &lt;span class="n"&gt;transpose&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
   &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;elapsed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

   &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Average for a matrix of &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;MATSIZE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;elapsed&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;SAMPLES&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æµ‹è¯•ç»“æœ&lt;/h3&gt;
&lt;table class="table table-striped-white table-bordered"&gt;
&lt;thead&gt;
&lt;tr&gt;
 &lt;th&gt;-&lt;/th&gt;
 &lt;th&gt;MATSIZE = 256&lt;/th&gt;
 &lt;th&gt;MATSIZE = 256 + 1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
 &lt;td&gt;è¿è¡Œæ—¶é—´ (g++ O2) 1024æ¬¡&lt;/td&gt;
 &lt;td&gt;78ms&lt;/td&gt;
 &lt;td&gt;39ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
 &lt;td&gt;D1 Miss&lt;/td&gt;
 &lt;td&gt;2,621,967&lt;/td&gt;
 &lt;td&gt;1,107,687&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
 &lt;td&gt;D1 Miss Rate&lt;/td&gt;
 &lt;td&gt;29.5%&lt;/td&gt;
 &lt;td&gt;12.3%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;ç”±æ­¤å¯è§ï¼ŒCacheçš„Miss RateåŸºæœ¬å†³å®šäº†ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ï¼Œè¿è¡Œæ—¶é—´æ¯”ä¾‹å’ŒD1 MISS RATEçš„æ¯”ä¾‹åŸºæœ¬ä¸€è‡´ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨ï¼šæœ¬æœºç¯å¢ƒä¸cachegrindå‚æ•°æ˜¯ä¸ä¸€è‡´çš„ï¼Œåœ¨æœ¬æœºä¸Šç”±äºcacheè¾ƒå¤§ï¼Œä¸”é‡‡ç”¨8ä½ç»„ç›¸è”ï¼Œæ‰€ä»¥D1 cache missè¾ƒå°‘ï¼Œå·®å¼‚ä¸»è¦ä½“ç°åœ¨LLd Miss Rateä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å®é™…æ„ä¹‰&lt;/h2&gt;
&lt;p&gt;å¦‚æœç¨‹åºå¯¹ä¸€æ®µå†…å­˜è¿›è¡Œé¡ºåºè¯»å–çš„æ—¶å€™ï¼Œä»¥ä¸Šçš„ç¼“å­˜å¤±æ•ˆé—®é¢˜æœ‰å¯èƒ½ä¼šæ˜¾ç°å‡ºæ¥ã€‚ä½†æ˜¯ç¼“å­˜å¤±æ•ˆåªæ˜¯ç¨‹åºæ€§èƒ½é—®é¢˜çš„ä¸€ä¸ªå¯èƒ½çš„åŸå› ï¼Œåº”è¯¥åœ¨å¯¹ç¨‹åºè¿›è¡Œprofileä¹‹åå†åšç»“è®ºã€‚&lt;/p&gt;
&lt;h2&gt;å…¶å®ƒprofileå·¥å…·&lt;/h2&gt;
&lt;p&gt;æˆ‘çš„æé—®ï¼š__&lt;a href="http://www.zhihu.com/question/24540567/noti-answers?group_id=564624072"&gt;æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥å¯¹CPU cacheå¤±æ•ˆè¿›è¡Œè®¡æ•°ï¼Ÿ&lt;/a&gt;__ä¸­ï¼Œå„ä½ç­”ä¸»è¿˜æä¾›äº†ä»¥ä¸‹å‡ ç§å·¥å…·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;perf (linux)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://tiptop.gforge.inria.fr/"&gt;Tiptop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;qemu&lt;/li&gt;
&lt;li&gt;visual studioçš„cpu counter&lt;/li&gt;
&lt;li&gt;intel performance counter monitor&lt;/li&gt;
&lt;li&gt;vtunes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;profileçš„æ–¹æ³•å¾ˆå¤šï¼Œé€‰ä¸€ä¸ªæ˜“ç”¨æ€§ä¸æ­£ç¡®æ€§è¾¾åˆ°å¹³è¡¡å°±å¯ä»¥ã€‚åæ­£æˆ‘æ˜¯å“ªä¸ªä¹Ÿä¸ä¼š_(:Ğ·ã€âˆ )_&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé“¾æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://yoursunny.com/study/EI209/?topic=cache"&gt;cacheæ˜ å°„åŠŸèƒ½ã€å‘½ä¸­ç‡è®¡ç®—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.focus-linux.net/?p=391"&gt;ä½¿ç”¨valgrindæ£€æŸ¥cacheå‘½ä¸­ç‡ï¼Œæé«˜ç¨‹åºæ€§èƒ½&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://valgrind.org/docs/manual/cg-manual.html"&gt;Cachegrind: a cache and branch-prediction profiler&lt;/a&gt; ï¼ˆå®˜æ–¹æ–‡æ¡£ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href="https://access.redhat.com/documentation/zh-CN/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/ch05s03s02.html"&gt;ä½¿ç”¨ Cachegrind ç®€è¦æ¦‚è¿°ç¼“å­˜ä½¿ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://wwwcdf.pd.infn.it/valgrind/cg_main.html"&gt;Cachegrind: a cache-miss profiler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.ibm.com/developerworks/cn/linux/l-cn-perf"&gt;Perf -- Linuxä¸‹çš„ç³»ç»Ÿæ€§èƒ½è°ƒä¼˜å·¥å…·ï¼Œç¬¬ 1 éƒ¨åˆ†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://coolshell.cn/articles/10249.html"&gt;7ä¸ªç¤ºä¾‹ç§‘æ™®CPU Cacheï¼ˆæ‰©å±•é˜…è¯»ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="cpu"></category><category term="cache"></category><category term="profile"></category><category term="valgrind"></category><category term="cachegrind"></category></entry><entry><title>ç©ç©ç®—æ³•é¢˜1ï¼šSherlock and Queries</title><link href="http://wizmann.tk/interview-problem-1-sherlock-and-queries.html" rel="alternate"></link><updated>2014-07-19T11:00:38+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-07-19:interview-problem-1-sherlock-and-queries.html</id><summary type="html">&lt;h2&gt;é¢˜ç›®å¤§æ„&lt;/h2&gt;
&lt;p&gt;ç»™ä½ ä¸‰ä¸ªæ•°ç»„:A[N], B[M], C[M]ã€‚è®©ä½ æŒ‰å¦‚ä¸‹pseudo-codeç»™å‡ºçš„è§„åˆ™è®¡ç®—ï¼Œæ±‚å‡ºæœ€ç»ˆA[N]æ¯ä¸€é¡¹çš„å€¼ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;for i = 1 to M do
    for j = 1 to N do
        if j % B[i] == 0 then
            A[j] = A[j] * C[i]
        endif
    end do
end do
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ•°æ®èŒƒå›´&lt;/h2&gt;
&lt;p&gt;1â‰¤ N,M â‰¤ 10^5 &lt;/p&gt;
&lt;p&gt;1 â‰¤ B[i] â‰¤ N &lt;/p&gt;
&lt;p&gt;1 â‰¤ A[i],C[i] â‰¤10^5&lt;/p&gt;
&lt;h2&gt;Brute-Forceè§£æ³•&lt;/h2&gt;
&lt;p&gt;æš´åŠ›è§£æ³•å°±æ˜¯é¢˜ç›®ä¸­ç»™å‡ºçš„èŒƒä¾‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(M * N)ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰æ›´ä¼˜åŒ–çš„è§£æ³•ã€‚&lt;/p&gt;
&lt;h2&gt;ç­›æ³•&lt;/h2&gt;
&lt;p&gt;ä»&lt;code&gt;j % B[i] == 0&lt;/code&gt;è¿™ä¸ªå…³ç³»æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„è”æƒ³åˆ°&lt;a href="https://zh.wikipedia.org/zh-cn/%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95"&gt;ç­›æ³•&lt;/a&gt;ï¼Œæˆ‘ä»¬ä¸å¿…è¦ä»1åˆ°Næ¯æ¬¡å»å°è¯•æ˜¯å¦å¯ä»¥è¢«B[i]æ•´é™¤ï¼Œè€Œæ˜¯ç›´æ¥åœ¨æ•°ç»„Açš„ç¬¬&lt;code&gt;B[i], B[i] * 2 ... B[i] * k&lt;/code&gt;é¡¹ä¸Šç›´æ¥ä¹˜ä¸ŠC[i]ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(k)ï¼Œk = sum(N / B[i])&lt;/p&gt;
&lt;p&gt;å¦‚æœæ•°ç»„Bä¸­çš„å€¼ä¸¤ä¸¤ä¸ç­‰ã€‚é‚£ä¹ˆkçš„æœ€å¤§å€¼å°±æ˜¯è°ƒå’Œçº§æ•°&lt;code&gt;N + N / 2 + N / 3 + ... + N / N&lt;/code&gt;ï¼Œå…¶å€¼çº¦ä¸º&lt;code&gt;N * lnN&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœæ•°ç»„Bä¸­çš„å€¼æœ‰å¤§é‡ç›¸ç­‰ï¼Œå¹¶ä¸”å€¼éå¸¸å°ï¼ˆå¦‚1æˆ–2ç­‰ï¼‰ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„æ—¶é—´å¤æ‚åº¦ä»ç„¶ä¼šé€€åŒ–åˆ°O(N * M)ã€‚&lt;/p&gt;
&lt;h2&gt;è®©æˆ‘ä»¬å†ä¼˜åŒ–ä¸€å°ä¸‹&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸Šæ–‡æˆ‘ä»¬åˆ†æåˆ°ï¼Œå¦‚æœæ•°ç»„Bä¸­çš„å€¼æœ‰å¤§é‡ç›¸ç­‰æ—¶ï¼Œç¨‹åºçš„æ—¶é—´å¤æ‚åº¦ä¼šä¸¥é‡é€€åŒ–ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ä¼˜åŒ–æ–¹æ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»ä¸Šé¢çš„pseudo-codeæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœB[i] == B[i']ï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šå¯¹Açš„åŒä¸€é¡¹è¿›è¡Œæ“ä½œï¼Œäºæ˜¯æˆ‘ä»¬å°±æŠŠæœ‰ç€ç›¸åŒå€¼çš„B[i]åˆå¹¶åœ¨ä¸€èµ·ï¼Œè€Œæ“ä½œæ•°C[i]ç´¯ä¹˜ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ—¶é—´å¤æ‚åº¦å°±ä¼šæ¥è¿‘äºæœ€ä¼˜å€¼O(N * lnN)ã€‚&lt;/p&gt;
&lt;h2&gt;Show me the code&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100010&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000007&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;vb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;friend&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vb&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;


&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vb&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vb&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pa&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pa&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pa&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;pre&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vb&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;vc&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å…³é”®ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯å¦äº†è§£ç­›æ³•ï¼Œå¹¶ä¸”å¯ä»¥ä»é¢˜ç›®çš„æç¤ºä¸­è”æƒ³åˆ°ç­›æ³•&lt;/li&gt;
&lt;li&gt;æ˜¯å¦äº†è§£è°ƒå’Œçº§æ•°ä¼°è®¡æ—¶é—´å¤æ‚åº¦çš„æ–¹æ³•&lt;/li&gt;
&lt;li&gt;æ˜¯å¦äº†è§£ç®—æ³•çš„best-caseå’Œworst-case&lt;/li&gt;
&lt;li&gt;æ˜¯å¦å¯ä»¥äº†è§£ç®—æ³•çš„ç“¶é¢ˆï¼Œå¹¶ä¼˜åŒ–è‡ªå·±çš„ç®—æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ç®—æ³•åˆ†æç”¨åˆ°çš„ä¸€äº›è¿‘ä¼¼å…¬å¼&lt;/h2&gt;
&lt;p&gt;&lt;img alt="cheetsheet" src="http://wizmann-tk-pic.u.qiniudn.com/book-algorithm-approximate-functions.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬å›¾æ¥è‡ªã€Šç®—æ³• ç¬¬å››ç‰ˆã€‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;åŸé¢˜é“¾æ¥&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://www.hackerrank.com/challenges/sherlock-and-queries"&gt;æˆ³æˆ‘ä¹ˆä¹ˆå“’&lt;/a&gt;&lt;/p&gt;</summary><category term="algorithm"></category><category term="interview"></category></entry><entry><title>Codeforces Round #253 Tutorial</title><link href="http://wizmann.tk/cf-253.html" rel="alternate"></link><updated>2014-06-21T19:24:37+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-06-21:cf-253.html</id><summary type="html">&lt;hr /&gt;
&lt;h2&gt;443A - Anton and Letters&lt;/h2&gt;
&lt;p&gt;Simple and easy, solved by two lines of python code.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;443B - Kolya and Tandem Repeat&lt;/h2&gt;
&lt;p&gt;Brute force. Just enumerate the beginning and the end of the substring, and check if that substring is &lt;strong&gt;tandem repeat&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;str&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;slip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;slip&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;slip&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;slip&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="cm"&gt;/* pass */&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="k"&gt;goto&lt;/span&gt; &lt;span class="n"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nl"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;       &lt;span class="cm"&gt;/*pass*/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;442A - Borya and Hanabig&lt;/h2&gt;
&lt;p&gt;Because Borya knows about the color and value of all his cards, he just need to distinguish each card from the others. &lt;/p&gt;
&lt;p&gt;Distinguish one card from all others seems difficult, but distinguish one card from &lt;em&gt;ONE&lt;/em&gt; other card is simple enough. So if we can tell the difference between one card and any other, it can be determined from all pairs which contain this card. At last, if all pairs of cards can be distinguished, we can claim that we can distinguish all cards.&lt;/p&gt;
&lt;p&gt;It's easy to find out that we have 10 different kind of hints in total(5 colors and 5 values) and 1024 different combination of all that hints(1 &amp;lt;&amp;lt; 10). As a result, we can enumerate all combinations, and try to indicate whether this batch of hints can distinguish all these cards.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cassert&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;map&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;set&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;_str&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;12345RGBYW&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;   

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;conv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)];&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="c1"&gt;// print(a &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; b &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; v);&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="k"&gt;goto&lt;/span&gt; &lt;span class="n"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;__builtin_popcount&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="nl"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;       &lt;span class="cm"&gt;/*pass*/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;442B - Andrey and Problem&lt;/h2&gt;
&lt;p&gt;Assuming that the possibility of getting exactly one problem from some of Andrey's friends is &lt;code&gt;p1&lt;/code&gt; and get no problem is &lt;code&gt;p0&lt;/code&gt;. So, if we want to add one friend whose possibility of comming up a problem is &lt;code&gt;pa&lt;/code&gt; to this very friend set, we can get &lt;code&gt;next_p1 = p1 * (1 - pa) + p0 * pa&lt;/code&gt; and &lt;code&gt;next_p0 = p0 * (1 - pa)&lt;/code&gt;. And it easy to indicate that a greater &lt;code&gt;pa&lt;/code&gt; will lead to a greater &lt;code&gt;next_p1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The initial value is that &lt;code&gt;p0 == 1; p1 == 0&lt;/code&gt;. And we add the friends one by one ordered by the possibilites reversely. At last, the max &lt;code&gt;p1&lt;/code&gt; is the final result.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;good&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;bad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;good&lt;/span&gt;

&lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;good&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]:&lt;/span&gt;
    &lt;span class="n"&gt;good&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;good&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;bad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bad&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;good&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category></entry><entry><title>A simple problem - World at War</title><link href="http://wizmann.tk/world-at-war.html" rel="alternate"></link><updated>2014-06-12T17:42:51+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-06-12:world-at-war.html</id><summary type="html">&lt;h2&gt;Background&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;This problem is from the book "&lt;a href="http://book.douban.com/subject/19952400/"&gt;Algorithm 4th edition&lt;/a&gt;" (Exersise 4.1.10)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There are N cities and M undirected roads between those cities. People can travel to any city along the roads.&lt;/p&gt;
&lt;p&gt;One day, a war breaks out. Our cities are under attack! As we can't defend all these N cities, the commander wants you to find the least important city, which means that if this city fell to the enemy, the traffic among other cities would not be affected.&lt;/p&gt;
&lt;p&gt;If there are multiple answers, print any one of them. If there's no that kind of city, print -1.&lt;/p&gt;
&lt;p&gt;&lt;img alt="world-at-war" src="http://wizmann-tk-pic.u.qiniudn.com/blog-world-at-war.png" /&gt;&lt;/p&gt;
&lt;h2&gt;The spanning tree of a graph&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;It is a spanning tree of a graph G if it spans G (that is, it includes every vertex of G) and is a subgraph of G (every edge in the tree belongs to G). 
-- wikipedia&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="spanning-tree" src="http://wizmann-tk-pic.u.qiniudn.com/blog-spanning-tree.png" /&gt;&lt;/p&gt;
&lt;p&gt;For example, there is a spanning tree of a graph. These nodes in green is leaf node. So it is easy to know that if we remove a leaf node, the graph won't be affect. The rest of the graph (and the spanning tree) are still connected.&lt;/p&gt;
&lt;p&gt;So the answer is here.&lt;/p&gt;
&lt;h2&gt;How to generate a spanning tree&lt;/h2&gt;
&lt;p&gt;There are multiple ways to generate a spanning three of a undirected graph. The most famous algorithm is &lt;strong&gt;prim&lt;/strong&gt;, which will generate a MST(minimum spanning tree) with O(n**2) time complexity.&lt;/p&gt;
&lt;p&gt;However, MST is not needed in this scenario, because an arbitrary spanning tree is enough to find one of the leaf nodes.&lt;/p&gt;
&lt;p&gt;Depth first search (a.k.a DFS) is one of the simplest way to generate the spanning tree. We just start from arbitrary node of the graph, and search through the graph until it comes to a dead-end -- the leaf node. Then print the answer.&lt;/p&gt;
&lt;p&gt;Problem solved.&lt;/p&gt;
&lt;h2&gt;Show me the code&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Solution&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;least_important_city&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;bool&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;fill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;iter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; 
                    &lt;span class="n"&gt;iter&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; 
                    &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="algorithm"></category><category term="interview"></category><category term="graph"></category></entry><entry><title>How to implement a queue with stack(s)?</title><link href="http://wizmann.tk/implement-queue-with-stacks.html" rel="alternate"></link><updated>2014-05-20T13:23:03+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-05-20:implement-queue-with-stacks.html</id><summary type="html">&lt;p&gt;This problem is from the book &lt;a href="http://book.douban.com/subject/19952400/"&gt;&lt;em&gt;Algorithms, 4th Edition&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Queue with three stacks. Implement a queue with three stacks so that each queue operation takes a constant (worst-case) number of stack operations. &lt;/p&gt;
&lt;p&gt;Warning : high degree of difficulty.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;When I search the Internet to find a solution, I find varieties of this problem, such as "implement a queue with ONE stack", "implement a queue with TWO stack", etc.&lt;/p&gt;
&lt;p&gt;It is fun, indeed. I spent the whole morning to finding the solution of these problems. So, let's rock.&lt;/p&gt;
&lt;h2&gt;Build a test environment&lt;/h2&gt;
&lt;p&gt;I choose python as a programming language. &lt;/p&gt;
&lt;p&gt;So firstly, I implement an &lt;strong&gt;ABstract Class&lt;/strong&gt;(ABC) of a queue as the template of all classes of queue, called &lt;code&gt;QueueTpl&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;abc&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;QueueTpl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;__metaclass__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;abc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ABCMeta&lt;/span&gt;

    &lt;span class="nd"&gt;@abc.abstractmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="nd"&gt;@abc.abstractmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="nd"&gt;@abc.abstractmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="nd"&gt;@abc.abstractmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Secondly, I write an &lt;strong&gt;Adapter&lt;/strong&gt; for &lt;code&gt;Queue.Queue()&lt;/code&gt; class of python, called &lt;code&gt;QueueAdapter&lt;/code&gt;, to make it returns &lt;code&gt;None&lt;/code&gt; when we get items from an empty instance.
And we use &lt;code&gt;put_nowait&lt;/code&gt; and &lt;code&gt;get_nowait&lt;/code&gt; to speed up because there's no need to get the guarantee of &lt;strong&gt;thread safe&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Queue&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;QueueAdapter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QueueTpl&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;put_nowait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_nowait&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;At last, use &lt;code&gt;python unittest&lt;/code&gt; to verify my solution.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TestStQueue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_push_and_pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;sq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QueueAdapter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;sq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertFalse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;sq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertFalse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_rand_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;cmd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;push&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;pop&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_brute_force&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;QueueAdapter&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;StQueue3&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;StQueue2&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;StQueue1&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_rand_command&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;push&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;rs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertTrue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Implement a queue with ONE stack&lt;/h2&gt;
&lt;p&gt;It's said that it's an interview problem of Microsoft.(gossip, perhaps)&lt;/p&gt;
&lt;p&gt;The problem asks us to implement a queue with ONLY ONE stack. It seems hard, but it is actually an easy problem.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;push&lt;/code&gt; function is easy, just push the value into the stack. And the &lt;code&gt;pop&lt;/code&gt; function is a little bit hard, but we can do it with recursion to get the first element of the "queue", and put every items else in their origin order in the stack.&lt;/p&gt;
&lt;p&gt;The code is short, too.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StQueue1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QueueTpl&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="err"&gt;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The time complexity of a &lt;code&gt;push&lt;/code&gt; is O(1) with no extra memory space; a &lt;code&gt;pop&lt;/code&gt; is takes O(n) of time, and O(n) extra memory space in the &lt;strong&gt;stack area&lt;/strong&gt;(not the stack).&lt;/p&gt;
&lt;h2&gt;Implement a queue with TWO stacks&lt;/h2&gt;
&lt;p&gt;This problem is so classic and so popular, so I just paste my solution here as everyone knows the answer.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StQueue2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QueueTpl&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Implement a queue with THREE stacks&lt;/h2&gt;
&lt;p&gt;As it is said in the book, it's a hard problem. And here is a &lt;a href="http://stackoverflow.com/questions/5538192/how-to-implement-a-queue-with-three-stacks"&gt;discuss&lt;/a&gt; in the Stackoverflow where I find this &lt;a href="http://stackoverflow.com/a/5568094/2927439"&gt;solution&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;| | | |3| | | |
| | | |_| | | |
| | |_____| | |
| |         | |
| |   |2|   | |
| |   |_|   | |
| |_________| |
|             |
|     |1|     |
|     |_|     |
|_____________|
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This solution uses nested stacks to perform as a &lt;strong&gt;linked-list&lt;/strong&gt;, and use the &lt;strong&gt;linked-list&lt;/strong&gt; to perform as a queue.&lt;/p&gt;
&lt;p&gt;A queue of "1, 2, 3" looks like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;],&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We use three stack pointers &lt;code&gt;stack_a&lt;/code&gt; &lt;code&gt;stack_b&lt;/code&gt; and &lt;code&gt;stack_c&lt;/code&gt;, &lt;code&gt;stack_a&lt;/code&gt; points to the stack which stores the nested stacks, and &lt;code&gt;stack_b&lt;/code&gt; is a pointer to the last stack the nested stack, &lt;code&gt;stack_c&lt;/code&gt; as a temporary stack pointer.&lt;/p&gt;
&lt;p&gt;So, &lt;code&gt;push&lt;/code&gt; function is just push the new value in the last stack in the stack which is pointed by pointer &lt;code&gt;stack_b&lt;/code&gt;, and then push a new stack in &lt;code&gt;stack_b&lt;/code&gt; and make &lt;code&gt;stack_b&lt;/code&gt; to point to the new stack. (complicated, \&amp;lt;(=&lt;em&gt;/Ï‰ï¼¼&lt;/em&gt;=)&amp;gt;)&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;pop&lt;/code&gt; function is to get the first element of the nested stack, just get the first element, and make &lt;code&gt;stack_a&lt;/code&gt; point to the rest of the data.&lt;/p&gt;
&lt;p&gt;This code is easy but may hard to understand.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;StQueue3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QueueTpl&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;The main function&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;To sum up&lt;/h2&gt;
&lt;p&gt;&lt;img alt="summarize" src="http://wizmann-tk-pic.u.qiniudn.com/blog-queue-with-stack-summary.jpg" /&gt;&lt;/p&gt;</summary><category term="algorithm"></category><category term="stack"></category><category term="queue"></category></entry><entry><title>é€—æ¯”å¸¦ä½ è¯»è®ºæ–‡ä¹‹Barrier</title><link href="http://wizmann.tk/read-paper-barrier.html" rel="alternate"></link><updated>2014-05-08T19:05:26+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-05-08:read-paper-barrier.html</id><summary type="html">&lt;p&gt;&lt;img alt="çŸ¥è¯†å…±äº«è®¸å¯åè®®" src="http://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;é€—æ¯”å¸¦ä½ è¯»è®ºæ–‡ä¹‹Barrier&lt;/em&gt; ç”± &lt;a href="http://wizmann.tk"&gt;Wizmann&lt;/a&gt; åˆ›ä½œ&lt;/p&gt;
&lt;p&gt;é‡‡ç”¨ &lt;a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… è®¸å¯åè®®&lt;/a&gt;è¿›è¡Œè®¸å¯ã€‚&lt;/p&gt;
&lt;h2&gt;åŸæ–‡åœ°å€&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://ridiculousfish.com/blog/posts/barrier.html"&gt;Barrier February 17th, 2007&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;å‰è¨€ï¼šæˆ‘è‰¹ï¼å¥½å¤šæ ¸ï¼&lt;/h2&gt;
&lt;p&gt;è™½ç„¶80æ ¸å¿ƒçš„æµ®ç‚¹æ•°è¿ç®—å·¨å…½ç¦»æˆ‘ä»¬è¿˜æœ‰äº›é¥è¿œï¼Œä½†æ˜¯å¤šæ ¸å¤„ç†å™¨å·²ç»èµ°è¿›äº†æˆ‘ä»¬çš„ç”Ÿæ´»ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®å¤šæ ¸å¤„ç†å™¨å·²ç»ä¸æ˜¯æ–°é²œåè¯äº†ï¼Œåœ¨Power Macintosh 9500ä¸­ï¼Œå°±ä½¿ç”¨äº†å¤šæ ¸å¤„ç†å™¨ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥äº†ç†è§£ä¸€ä¸‹å¤šæ ¸å¿ƒå¤„ç†å™¨å§ã€‚&lt;/p&gt;
&lt;h2&gt;çº¿ç¨‹æŠ€æœ¯&lt;/h2&gt;
&lt;h3&gt;ä¸€äº›åè¯å®šä¹‰&lt;/h3&gt;
&lt;h4&gt;çº¿ç¨‹&lt;/h4&gt;
&lt;p&gt;çº¿ç¨‹åªæ˜¯ &lt;strong&gt;æŠ¢å è°ƒåº¦çš„&lt;/strong&gt;ï¼ˆpre-emptively scheduledï¼‰ &lt;strong&gt;å…±äº«åœ°å€ç©ºé—´çš„&lt;/strong&gt; æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚&lt;/p&gt;
&lt;h4&gt;å¤šçº¿ç¨‹&lt;/h4&gt;
&lt;p&gt;ç”¨æ¥ç®€åŒ–æ§åˆ¶æµå’Œç»•å¼€é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•ï¼Œå¹¶éç”¨æ¥å®ç°ç¨‹åºçš„å¹¶è¡ŒåŒ–&lt;/p&gt;
&lt;h4&gt;å¹¶å‘å¤šçº¿ç¨‹&lt;/h4&gt;
&lt;p&gt;åœ¨ç‰©ç†ä¸Šå¹¶å‘çš„çº¿ç¨‹ï¼Œç”¨æ¥åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨æ¥ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½&lt;/p&gt;
&lt;h3&gt;ä¸ºä»€ä¹ˆâ€œå¹¶å‘å¤šçº¿ç¨‹â€æ˜¯ä¸ªç¥å‘&lt;/h3&gt;
&lt;p&gt;äººäººéƒ½åœ¨è¯´â€å¹¶å‘å¤šçº¿ç¨‹â€œæ˜¯ä¸ªç¥å‘ï¼Œä½†è¿™ç§è€ç”Ÿå¸¸è°ˆå¹¶ä¸æ˜¯å› ä¸ºè‡ªç„¶åŸå› ï¼Œè€Œæ˜¯å› ä¸ºæˆ‘ä»¬äº²æ‰‹ä½œä¸‹çš„æ­»ã€‚å…¶æ ¹æœ¬åŸå› åœ¨äºæˆ‘ä»¬å¯¹äºå•çº¿ç¨‹ä¸‹çš„ç¨‹åºçš„è¿‡åˆ†ä¼˜åŒ–åœ¨å¤šçº¿ç¨‹ä¸‹å¹¶ä¸é€‚ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ç¥é©¬æ„æ€å‘¢ï¼Ÿç”±äºCPUè·‘çš„å¤ªå¿«ä»¥è‡³äºå†…å­˜å®Œå…¨è·Ÿä¸ä¸Šå®ƒçš„é€Ÿåº¦ï¼Œäºæ˜¯æˆ‘ä»¬å¼€å§‹çŒœæµ‹å†…å­˜ä¸­çš„å†…å®¹ï¼Œä½¿å¾—CPUä¸å¿…èŠ±æ—¶é—´å†æ£€æŸ¥å†…å­˜ã€‚â€çŒœæµ‹â€œæ˜¯é€šä¿—çš„è¯´æ³•ï¼Œç”¨ä¸“ä¸šåè¯è®²ï¼Œå°±æ˜¯&lt;strong&gt;CPU&lt;/strong&gt;å’Œ&lt;strong&gt;ç¼–è¯‘å™¨&lt;/strong&gt;å¯¹å†…å­˜çŠ¶æ€â€åšå‡ºè¶Šæ¥è¶Šæœ‰ä¾µç•¥æ€§çš„å‡è®¾â€œã€‚&lt;/p&gt;
&lt;h2&gt;ä¸¾ä¸ªæ —å­&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯å†™çº¿ç¨‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// variable1 = variable2 = 0;&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;variable1&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;variable2&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªæ˜¯è¯»çº¿ç¨‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;local2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;local1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;local2&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;local1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Error!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ ¹æ®æ­£å¸¸äººçš„æ€ç»ªï¼Œlocal2ä¸€å®šä¼šå°äºlocal1ï¼Œå› ä¸ºvariable1ä¸€ç›´æ¯”variable2è¦å¤§ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯äº‹å®æ˜¯ä¸æ˜¯è¿™æ ·çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;ctime&amp;gt;&lt;/span&gt;

&lt;span class="cp"&gt;#include &amp;lt;pthread.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;sys/time.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;unistd.h&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;variable2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="cp"&gt;#define ITERATIONS 200000000&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;unused&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(;;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;variable1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;variable2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;unused&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;timeval&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;gettimeofday&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;failureCount&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ITERATIONS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;v2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;v1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v2&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;failureCount&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;gettimeofday&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;seconds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_sec&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_usec&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;1000000.&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_sec&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tv_usec&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;1000000.&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%u failure%s (%2.1f percent of the time) in %2.1f seconds&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
           &lt;span class="n"&gt;failureCount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;failureCount&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
           &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;100.&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;failureCount&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;ITERATIONS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;seconds&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;pthread_t&lt;/span&gt; &lt;span class="n"&gt;thread1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;thread2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;pthread_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;thread1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;pthread_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;thread2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(;;)&lt;/span&gt; &lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¨‹åºçš„è¾“å‡ºä¸ºï¼š&lt;code&gt;0 failures (0.0 percent of the time) in 1.2 seconds&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;è²Œä¼¼æ˜¯æ­£ç¡®çš„ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ç¨‹åºè¿è¡Œçš„æ­£å¦‚æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¡®ä¿¡ç¨‹åºæ˜¯ä¸€å®šæ­£ç¡®çš„å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºç¨‹åºä¸­çš„ä¸¤ä¸ªçº¿ç¨‹å¦‚æœåœ¨åŒä¸€ä¸ªCPUä¸Šè¢«è°ƒåº¦ï¼Œæˆ‘ä»¬æ°¸è¿œéƒ½ä¼šå¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚&lt;/p&gt;
&lt;h3&gt;çº¿ç¨‹ä¸ä¸åŒçš„CPUè¿›è¡Œç»‘å®š&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;unused&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;cpu_set_t&lt;/span&gt; &lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;CPU_ZERO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;CPU_SET&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sched_setaffinity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;unused&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;cpu_set_t&lt;/span&gt; &lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;CPU_ZERO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;CPU_SET&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sched_setaffinity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;cpuset&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// p.s. æˆ‘æœºå™¨æ˜¯i5åŒæ ¸å››çº¿ç¨‹ï¼Œæ‰€ä»¥ç»‘åœ¨äº†CPU0å’ŒCPU2ä¸Š&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç»“æœï¼š&lt;code&gt;0 failures (0.0 percent of the time) in 1.4 seconds&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;è²Œä¼¼è¿˜æ˜¯æ­£ç¡®çš„ï¼Ÿï¼&lt;/h3&gt;
&lt;p&gt;è¿˜æ²¡é”™ã€‚ã€‚ã€‚ä¸è¿‡CPUæ˜¯åœ¨å¯„å­˜å™¨ä¸Šä¹±æçš„ï¼Œè€Œvariable1å’Œvariable2æ˜¯æŒ¨åœ¨ä¸€èµ·çš„ï¼Œè¿™å°±å¯¼è‡´äº†å®ƒä»¬ä¸¤ä¸ªå¯èƒ½åœ¨ç¼“å­˜çš„åŒä¸€è¡Œä¸Šï¼Œè¿™ä½¿å®ƒä»¬åŒæ—¶å†™å…¥ç¼“å­˜åŒæ—¶å†™å›å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªå˜é‡ä¸€ä¸ªæ”¾åœ¨å †ä¸Šï¼Œä¸€ä¸ªæ”¾åœ¨æ ˆä¸Šï¼Œçœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;0 failures (0.0 percent of the time) in 1.2 seconds
0 failures (0.0 percent of the time) in 1.2 seconds
2000000000 failures (100.0 percent of the time) in 1.2 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;å¤ªæ„Ÿäººäº†ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;æˆ‘ä»¬çš„æ•Œäºº â€”â€” ç¼–è¯‘å™¨&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Multithreading bugs are very delicate.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¹¶è¡Œå¤šçº¿ç¨‹çš„é”™è¯¯æ€»æ˜¯é‚£ä¹ˆçš„å¥‡å¦™ï¼Œä¹Ÿè®¸ä½ çš„ç¨‹åºè¿è¡Œäº†å‡ å¤©å®‰ç„¶æ— æ™ï¼Œä½†æ˜¯ä¸çŸ¥é“åœ¨æŸä¸€å¤©æŸä¸€æ—¶ï¼Œå°±æŒ‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå¤šä¸ªçº¿ç¨‹è°ƒåº¦åœ¨åŒä¸€ä¸ªCPUæ ¸å¿ƒä¸Šï¼ŒBugä¼šè¢«æ©ç›–ã€‚  &lt;br /&gt;
å¦‚æœå¤šä¸ªå˜é‡åœ¨CPUåŒä¸€è¡ŒCacheä¸Šï¼ŒBugä¼šè¢«æ©ç›–ã€‚  &lt;br /&gt;
å¦‚æœä½ äººå“è¶³å¤Ÿå¥½çš„è¯ï¼ŒBugåŒæ ·ä¼šè¢«æ©ç›–ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ’é™¤äº†ä»¥ä¸Šçš„æƒ…å†µåï¼Œé—®é¢˜å°±æµ®ç°å‡ºæ¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹readerçš„åæ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;disas&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;
&lt;span class="n"&gt;Dump&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;assembler&lt;/span&gt; &lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;function&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400950&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt; &lt;span class="n"&gt;push&lt;/span&gt;   &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rbx&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400951&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt; &lt;span class="n"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400953&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt; &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400958&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt; &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x80&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;esi&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040095d&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040095f&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;sub&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0xa0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400966&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rdi&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400969&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rdx&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040096c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;rep&lt;/span&gt; &lt;span class="n"&gt;stos&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nl"&gt;es&lt;/span&gt;&lt;span class="p"&gt;:(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rdi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040096f&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edi&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400971&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;movq&lt;/span&gt;   &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x4&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400979&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;callq&lt;/span&gt;  &lt;span class="mh"&gt;0x400790&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;sched_setaffinity&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040097e&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;lea&lt;/span&gt;    &lt;span class="mh"&gt;0x80&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rdi&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400986&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;esi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;esi&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400988&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;callq&lt;/span&gt;  &lt;span class="mh"&gt;0x400710&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;gettimeofday&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040098d&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="mh"&gt;0x2006e4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x601078&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;variable2_p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400994&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;68&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="mh"&gt;0x2006e6&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x601080&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;variable1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040099a&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;74&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;
   &lt;span class="mh"&gt;0x000000000040099c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;76&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x77359400&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009a1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;81&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;nopl&lt;/span&gt;   &lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009a8&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;88&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;cmp&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009aa&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;adc&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009ad&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;93&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;sub&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009b0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;96&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;jne&lt;/span&gt;    &lt;span class="mh"&gt;0x4009a8&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;88&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009b2&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;98&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;lea&lt;/span&gt;    &lt;span class="mh"&gt;0x90&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rdi&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009ba&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;106&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;esi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;esi&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009bc&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;108&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;callq&lt;/span&gt;  &lt;span class="mh"&gt;0x400710&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;gettimeofday&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009c1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;113&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cvtsi2sdq&lt;/span&gt; &lt;span class="mh"&gt;0x98&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009cb&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;123&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cvtsi2sdq&lt;/span&gt; &lt;span class="mh"&gt;0x90&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm1&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009d5&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;133&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;movsd&lt;/span&gt;  &lt;span class="mh"&gt;0x1a3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm3&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x400b80&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009dd&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;141&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;143&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cvtsi2sdq&lt;/span&gt; &lt;span class="mh"&gt;0x88&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm2&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009e9&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;153&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cmp&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009ec&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;156&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x400b3d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009f1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;161&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edi&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009f6&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;166&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;divsd&lt;/span&gt;  &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009fa&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;170&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;
   &lt;span class="mh"&gt;0x00000000004009fc&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;172&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x400b40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;esi&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a01&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;177&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;divsd&lt;/span&gt;  &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm2&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a05&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;181&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;addsd&lt;/span&gt;  &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm1&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a09&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;185&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cvtsi2sdq&lt;/span&gt; &lt;span class="mh"&gt;0x80&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rsp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a13&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;195&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;subsd&lt;/span&gt;  &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm1&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a17&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;199&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cvtsi2sd&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a1c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;204&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x400b3c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a21&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;209&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;cmovne&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rcx&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a25&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;213&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a2a&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;218&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;mulsd&lt;/span&gt;  &lt;span class="mh"&gt;0x156&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x400b88&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a32&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;226&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;subsd&lt;/span&gt;  &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm1&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a36&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;230&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;divsd&lt;/span&gt;  &lt;span class="mh"&gt;0x152&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;xmm0&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x400b90&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a3e&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;238&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;callq&lt;/span&gt;  &lt;span class="mh"&gt;0x400700&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;__printf_chk&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a43&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;243&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edi&lt;/span&gt;
   &lt;span class="mh"&gt;0x0000000000400a45&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;245&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;   &lt;span class="n"&gt;callq&lt;/span&gt;  &lt;span class="mh"&gt;0x4006f0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œå…³é”®åœ¨ä»¥ä¸‹å‡ å¥ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mh"&gt;0x000000000040098d&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="mh"&gt;0x2006e4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x601078&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;variable2_p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="mh"&gt;0x0000000000400994&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;68&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="mh"&gt;0x2006e6&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;0x601080&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;variable1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="mh"&gt;0x000000000040099a&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;74&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;
&lt;span class="mh"&gt;0x000000000040099c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;76&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;mov&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x77359400&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
&lt;span class="mh"&gt;0x00000000004009a1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;81&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;nopl&lt;/span&gt;   &lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;rax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mh"&gt;0x00000000004009a8&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;88&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;cmp&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ecx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;edx&lt;/span&gt;
&lt;span class="mh"&gt;0x00000000004009aa&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;adc&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;ebx&lt;/span&gt;
&lt;span class="mh"&gt;0x00000000004009ad&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;93&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;sub&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;eax&lt;/span&gt;
&lt;span class="mh"&gt;0x00000000004009b0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;+&lt;/span&gt;&lt;span class="mi"&gt;96&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;:&lt;/span&gt;    &lt;span class="n"&gt;jne&lt;/span&gt;    &lt;span class="mh"&gt;0x4009a8&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;88&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¾ªç¯ä½“åœ¨+88ï½+96è¡Œï¼Œè€Œå¯¹variable1ä¸variable2çš„å–å€¼éƒ½æ”¾åœ¨äº†å¾ªç¯ä»¥å¤–ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼š &lt;br /&gt;
adcæ˜¯å¸¦è¿›ä½åŠ æ³•ï¼Œadc $0x0, %ebx =&amp;gt; %ebx = $0x0 + %ebx + CF  &lt;br /&gt;
cmpçš„ç»“æœæ­£æ˜¯æ”¾åœ¨CFï¼ˆå¤§äºè¡¨ç¤ºä¸ºæº¢å‡ºï¼‰ï¼ŒZFï¼ˆç›¸ç­‰è¡¨ç¤ºä¸º0ï¼‰ï¼ŒPFï¼ˆå°äºè¡¨ç¤ºä¸º-1,åˆ™ä½8ä½å…¨ä¸º1,æ•…æœ‰å¶æ•°ä¸ª1ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt; ä½ TMDåœ¨é€—æˆ‘ï¼Ÿï¼ &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­£æ˜¯è¿™ä¸ªé”™è¯¯ï¼Œå¯¼è‡´äº†æˆ‘ä»¬çš„ç»“æœè¦ä¸æ˜¯100%æ­£ç¡®ï¼Œè¦ä¸æ˜¯100%é”™è¯¯ã€‚&lt;/p&gt;
&lt;h4&gt;ç¼–è¯‘å™¨ä½ æ¶ˆåœä¼š â€”â€” volitile&lt;/h4&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;volatile&lt;/span&gt; &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;volatile&lt;/span&gt; &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;variable2_p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="cp"&gt;#define ITERATIONS 500000000LL &lt;/span&gt;&lt;span class="c1"&gt;// è°ƒå°ä¸€ä¸‹æ•°æ®è§„æ¨¡ï¼Œå› ä¸ºvolatileå¤ªæ…¢äº†_(:Ğ·ã€âˆ )_&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘å¾—å‡ºçš„æ¥çš„ç»“æœæ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;0 failures (0.0 percent of the time) in 9.6 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è€Œä½œè€…å¾—å‡ºçš„ç»“æœæ˜¯ï¼š
ï¼ˆæ—¶é—´ä¸Šçš„å·®å¼‚ä¸è®¡ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ•°æ®è§„æ¨¡ä¸ä¸€æ ·ï¼Œæˆ‘å®éªŒçš„æ¬¡æ•°è¦å¤šä¸€äº›ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;fish ) ./a.out
12462711 failures (24.9 percent of the time) in 3.7 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»ä½œè€…çš„ç»“æœæ¥çœ‹ï¼Œçœ‹èµ·æ¥æ•ˆæœå¥½äº†å¾ˆå¤šï¼Œè™½ç„¶æ…¢äº†30å¤šå€ï¼Œä½†æ˜¯ç»“æœå¹¶ä¸æ˜¯å…¨å¯¹å…¨é”™äº†ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä»æˆ‘çš„ç»“æœæ¥çœ‹ï¼Œvolatileçœ‹ä¼¼ç¥ä¸¹å¦™è¯ï¼Œè§£å†³äº†æ‰€æœ‰çš„é—®é¢˜ã€‚(both g++ and clang++)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®æœ¬é€—çš„äº†è§£ï¼Œå…¶åŸå› åœ¨äºä½“ç³»ç»“æ„çš„å·®å¼‚ï¼ˆéƒ½TMèµ–ä½“åˆ¶ï¼ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;volatileåªèƒ½ä¿è¯å¦‚ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;volatileå˜é‡çš„è®¿é—®ä¸ä¼šä¼˜åŒ–æˆå¯„å­˜å™¨è®¿é—®ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½å»è®¿é—®â€œå†…å­˜â€ï¼ˆè¿™ä¸ªå¼•å·ä¸€ä¼šå†è§£é‡Šï¼‰&lt;/li&gt;
&lt;li&gt;volatileå˜é‡é—´çš„è®¿é—®é¡ºåºä¸ä¼šè¢«ç¼–è¯‘å™¨ä¹±åº&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€Œå…¶ä»–çš„ä¸€åˆ‡ï¼Œvolatileå’Œç¼–è¯‘å™¨éƒ½ä¸ä¼šç»™å‡ºä»»ä½•ä¿è¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä¸åŒçš„CPUéƒ½æœ‰å…¶å†…éƒ¨çš„ç§æœ‰Cacheï¼ŒCPUçš„å†…å­˜è®¿é—®ï¼Œå¦‚æœå‘½ä¸­äº†Cacheï¼Œåˆ™ä¸ä¼šçœŸæ­£çš„è®¿é—®å†…å­˜ã€‚ä½†ç”±äºå…¶ç§æœ‰Cacheå¯¹äºå…¶å®ƒçš„CPUæ˜¯ä¸å¯è§çš„ï¼Œä½¿ç”¨volatileå°±åŸ‹ä¸‹çš„Bugçš„ç§å­ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œç¨‹åºè¿è¡Œçš„å¾ˆå¥½ï¼Œæ²¡æœ‰å‡ºç°Bugã€‚ä½†æ˜¯ï¼Œä¸€æ˜¯ç”±äºå¤šçº¿ç¨‹çš„Bugéƒ½æ˜¯subtleå’Œdelicateçš„ï¼Œæˆ‘ä¸èƒ½ä¿è¯åœ¨ä¸€ä¸ªéœ€è¦7x24å·¥ä½œçš„æœåŠ¡å™¨ç¨‹åºä¸­ï¼Œå®ƒä¸ä¼šå‡ºç°ä»»ä½•Bugï¼›äºŒæ˜¯è‡³å°‘æˆ‘ä»¬çš„ä»£ç æ˜¯&lt;strong&gt; not portable &lt;/strong&gt;çš„ï¼Œå¦‚æœæœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬ä»x86-64å¹³å°åˆ‡æ¢åˆ°äº†&lt;code&gt;PowerPC&lt;/code&gt;ï¼Ÿæˆ–æ˜¯&lt;code&gt;IA64&lt;/code&gt;ï¼Ÿæˆ‘ä»¬ä¸èƒ½ä¿è¯åœ¨è¿™äº›ä½“ç³»ç»“æ„ä¸Šï¼Œç¼–è¯‘å™¨å’ŒCPUèƒ½ä¸ºæˆ‘ä»¬æä¾›åŒæ ·çš„ä¿éšœã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æœ‰äººé«˜å£°ç–¾å‘¼ â€”â€” volatileä¸æ˜¯TMDç»™å¤šçº¿ç¨‹ç”¨çš„ï¼(maybe like a parrot)&lt;/p&gt;
&lt;h4&gt;CPUä½ ä¹Ÿæ¶ˆåœä¼šï¼&lt;/h4&gt;
&lt;p&gt;è™½ç„¶ï¼Œåœ¨ä¸Šé¢çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨åŒä¸€ä¸ªCPUä¸­ï¼Œç¨‹åºå’Œé¢„æœŸç›¸ç¬¦ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯ï¼ŒCPUä¸ä¼šä¹±åºæ‰§è¡Œä½ çš„ä»£ç ï¼ŒæŠŠä½ å‘æˆç‹—ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚CPUä¼šæ¯«ä¸è´¹åŠ›çš„æŠŠvar1++å’Œvar2++çš„é¡ºåºæ›´æ”¹ä¸€ä¸‹ï¼Œç›¸ä¿¡æˆ‘ï¼Œå®ƒä¸«çœŸçš„ä¼šè¿™ä¹ˆåšçš„ã€‚è‡³å°‘åœ¨ç°åœ¨ä¸»æµçš„CPUä¸Šæ˜¯ä¼šçš„ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆä¸è¿‡ç”±äºä¹±åºæ‰§è¡Œéœ€è¦æ›´é«˜çš„åŠŸè€—ï¼Œæ‰€ä»¥ARMå’ŒIntel Atomå–æ¶ˆäº†ä¹±åºæ‰§è¡Œï¼Œä¸è¿‡è°çŸ¥é“å“ªå¤©ä½ çš„ä»£ç å°±ä¼šè·‘åœ¨ARMé›†ç¾¤ä¸Šå‘¢ï¼Ÿå‡ åƒä¸ªæ‰‹æœºç»„æˆçš„æœºæŸœ233ï½ï¼‰&lt;/p&gt;
&lt;h4&gt;é€—æ¯”åˆ«ç”¨é”ï¼&lt;/h4&gt;
&lt;p&gt;å“å½“åŠ ä¸Šä¸€æŠŠå¤§é”æ€»æ˜¯è§£å†³é—®é¢˜çš„æœ€ç»ˆæ–¹æ¡ˆã€‚ä½†æ˜¯ä½ é€ å—ï¼Ÿæ ¹æ®ä½œè€…çš„æµ‹è¯•ï¼ŒåŠ ä¸Šä¸€æŠŠmutexå¤§é”ä¼šè®©è¿™ä¸ªå°ç¨‹åºå‡æ…¢130å€ã€‚åŠ ä¸Šä¸€æŠŠspinlockå°é”ä¹Ÿä¼šè®©é€Ÿåº¦å‡æ…¢4å€ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæ¶ˆåœä¸€ä¸‹ï¼Œçœ‹çœ‹ä½œè€…æ¥ä¸‹æ¥æ€ä¹ˆè¯´ã€‚&lt;/p&gt;
&lt;h3&gt;å†…å­˜å±éšœ&lt;/h3&gt;
&lt;p&gt;å¤šCPUå¾€å¾€æ˜¯å„è¡Œå…¶æ˜¯çš„å…¸èŒƒï¼Œå®ƒä»¬ä¸ªäººç©ä¸ªäººçš„ï¼Œä»æ¥ä¸ç®¡è‡ªå·±çš„å…„å¼Ÿä»¬åœ¨åšä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ç§ä¸ç°å®çš„è§£å†³æ–¹æ³•ï¼Œä¸€æ˜¯æŠŠæ‰€æœ‰çº¿ç¨‹éƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªCPUä¸Šï¼ŒäºŒæ˜¯ç”¨ä¸€æŠŠå¤§é”å“å½“æŠŠç¨‹åºé”ä½ã€‚bad and slow ideas.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å®é™…ä¸Šï¼Œéœ€è¦åšçš„åªæ˜¯æš‚æ—¶åœæ­¢ç¼–è¯‘å™¨/CPUå¯¹æŸä¸€æ®µç¨‹åºä¸­å¯¹è¯»å†™æ•°æ®(load &amp;amp; store)çš„é‡æ’(reorder)ã€‚è¿™ç§æŠ€æœ¯å«åšå†…å­˜å±éšœ(memory barrier)ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(;;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;variable1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;barrier&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;variable2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;variable2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·æˆ‘ä»¬ä¿è¯äº†ï¼Œåœ¨var1++å¿…ç„¶æ—©äºvar2++ã€‚var2++åé¢ä¹Ÿå¯ä»¥åŠ ä¸€é“barrierï¼Œåªä¸è¿‡åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹ï¼Œæä¾›è¿™ç§ä¿è¯æ˜¯ä¸å¿…é¡»çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…åˆåšäº†ä¸€æ¬¡è¯•éªŒã€‚ï¼ˆä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆä¸åšï¼Œx86-64æŠŠæˆ‘åšå®éªŒçš„æœºä¼šéƒ½æ¯äº†ï¼Œå·®è¯„ï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;fish ) ./a.out
260 failures (0.0 percent of the time) in 0.9 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ¬¡ä¸”é”™è¯¯å‡å°‘äº†è®¸å¤šã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å†æŠŠè¯»çº¿ç¨‹å†™åŠ ä¸Šmemory barrier.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ITERATIONS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;v2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;variable2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;barrier&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;v1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;variable1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v2&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;failureCount&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;çœ‹çœ‹ç»“æœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;fish ) ./a.out
0 failures (0.0 percent of the time) in 4.2 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç»“æœæ­£ç¡®äº†å“¦ï½ï½&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœä½ å¯¹çº¿ç¨‹Açš„è¯»å†™é¡ºåºåšå‡ºè¦æ±‚ï¼Œå¿…ç„¶çš„ï¼Œä½ ä¹Ÿè¦å¯¹çº¿ç¨‹Bçš„é¡ºåºåšè¦æ±‚ï¼Œä»¥æ­¤ç±»æ¨ï¼Œçº¿ç¨‹Cï¼Œçº¿ç¨‹Dâ€¦â€¦&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œ&lt;strong&gt;Memory barriers always come in pairs, or triplets or more.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŒæ ·çš„ï¼Œçº¿ç¨‹é”ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œåªæœ‰å‚»æ¯”è‡ªå·±é”è‡ªå·±ã€‚ :)&lt;/p&gt;
&lt;h3&gt;CPUçš„ä¹±åºæ‰§è¡Œ&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°PowerPCæœ‰ä¸‰ç§å†…å­˜å±éšœï¼Œè€ŒDEC Alphaå¹³å°æœ‰æ›´å¤šã€‚è¿™æ„å‘³ç€ï¼ŒCPUä½¿ç”¨æ›´æ¿€è¿›çš„ç­–ç•¥æ¥é‡æ’æŒ‡ä»¤ï¼Œè€Œå¼ºåˆ¶é™åˆ¶å…¶é‡æ’çš„ä»£ä»·æ˜¯éå¸¸é«˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;è€Œx86å¹³å°åˆ™éå¸¸å®ˆåºï¼Œä½œè€…çŒœæµ‹å…¶åŸå› æ˜¯ç”±äºæ—©æœŸx86çš„æŒ‡ä»¤æŠ€æœ¯å¹¶éå®Œå–„ï¼Œè€Œåœ¨é‚£æ—¶å†…å­˜ä¸CPUçš„é€Ÿåº¦ä¸åƒç°åœ¨è¿™æ ·æ‚¬æ®Šï¼Œæ‰€ä»¥x86ä½¿ç”¨äº†&lt;code&gt;strongly ordered memory&lt;/code&gt;è€Œéåƒä¸Šé¢å‡ æ¬¾CPUä¸€æ ·çš„é‡‡ç”¨è¿‡å¤šçš„æŒ‡ä»¤é‡æ’åºã€‚å¦‚ä»Šï¼Œç”±äºx86èƒŒä¸Šäº†å‘å‰å…¼å®¹æ€§çš„åŒ…è¢±ï¼Œçœ‹ä¼¼æˆ‘ä»¬çš„"å¥½æ—¥å­"ä¸€ç›´ä¸ä¼šç»“æŸã€‚&lt;/p&gt;
&lt;p&gt;x86-64ï¼Œåšä¸ºx86çš„64ä½å‡çº§ç‰ˆï¼ŒåŒæ ·æ²¡æœ‰å®ç°&lt;code&gt;weakly ordered&lt;/code&gt;ï¼Œæˆ–è€…è¯´ï¼Œä¿ç•™äº†å®ç°&lt;code&gt;weakly ordered&lt;/code&gt;çš„æƒåˆ©ã€‚è€Œ&lt;code&gt;IA64&lt;/code&gt;å¹³å°ï¼Œå¦‚&lt;code&gt;Itanium&lt;/code&gt;ï¼Œåˆ™å®ç°äº†&lt;code&gt;weakly ordered&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…çŒœæµ‹x86_64ä¹‹æ‰€ä»¥ä¿å®ˆï¼Œæ˜¯ä¸ºäº†ä¸IA64å¹³å°å¯¹æŠ—ã€‚x86_64çš„å¯¹äºx86è‰¯å¥½çš„å…¼å®¹æ€§å¯ä»¥è®©ç¨‹åºå‘˜å¤šæ´»å‡ å¹´ï¼Œæ‰€ä»¥x86_64åœ¨å¸‚åœºçš„è¡¨ç°æ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…è¿˜è¡¨ç¤ºï¼Œè€Œè‹¹æœæ”¾å¼ƒIA64å¹³å°è½¬æŠ•x86-64å¤šå°‘æœ‰ä¸€äº›å¯æƒœï¼Œå› ä¸ºè‹¹æœå¹¶æ²¡æœ‰ç§»æ¤æ€§é—®é¢˜ï¼ŒPowerPCå·²ç»é€æ¸è¡°è½ï¼Œä¸ºä»€ä¹ˆä¸è¯•è¯•IA64å‘¢ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œæ ¹æ®Wikipediaï¼Œç°åœ¨æ”¯æŒIA64çš„æ“ä½œç³»ç»Ÿéå¸¸å°‘ï¼Œåªæœ‰WinNT Familyï¼ŒRed Hat Linuxï¼ŒDebian/Gentoo/Suseä»¥åŠå…¶å®ƒã€‚è€Œä»Windows Server 2008 R2ä¹‹åï¼ŒMicrosoftä¹Ÿè¡¨ç¤ºä¸å†æ”¯æŒItaniumã€‚æ‰€ä»¥ä»ç°åœ¨çœ‹æ¥ï¼ŒIA64å¹³å°ç›¸å¯¹x86/x64æ¥è¯´ï¼Œæ˜¯å¤±è´¥çš„ã€‚&lt;/p&gt;
&lt;h3&gt;åŒé‡æ£€æŸ¥é”&lt;/h3&gt;
&lt;p&gt;åˆåˆ°äº†ä¸€å¹´ä¸€åº¦çš„é’“é±¼æ—¶é—´ :)&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä¸‹çš„Obj-Cä»£ç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="nf"&gt;getSharedObject&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;id&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;LOCK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;sharedObject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="nb"&gt;self&lt;/span&gt; &lt;span class="n"&gt;alloc&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;UNLOCK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ˜¯éå¸¸ç»å…¸çš„ä¸€ç§DCLP(Double Checked Lock Pattern)çš„å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªçœ‹èµ·æ¥ä¸é”™ï¼Œä½†æ˜¯ä½ å·²ç»çŸ¥é“è¿™å¹¶ä¸é è°±äº†ã€‚å½“æˆ‘ä»¬åˆå§‹åŒ–æˆ‘ä»¬çš„å…±äº«å•ä¾‹ï¼Œå…ˆè¦å†ä¿®æ”¹ç±»å†…çš„æŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘ä¸€å—å£°æ˜å¥½çš„å†…å­˜ï¼Œå†åˆå§‹åŒ–ä¸€ä¸ªsharedObjectçš„instanceã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ï¼Œä½ æ˜¯çŸ¥é“çš„ï¼ŒCPUå’Œç¼–è¯‘å™¨ä¼šæŠŠä¸€åˆ‡éƒ½æç ¸ï¼Œå®ƒä»¬ä¼šä»¥ä»»æ„çš„é¡ºåºæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ï¼ŒåŒæ—¶å¤„ç†å™¨ä¹‹é—´äº’ç›¸ä¸é€šæ°”ï¼Œäºæ˜¯å°±ä¼šå‡ºç°å¦‚ä¸‹çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹Aä¸ºæŒ‡é’ˆå£°æ˜äº†ä¸€æ®µç©ºé—´ï¼Œä½†æ˜¯è¿˜æ²¡æ¥åŠåˆå§‹åŒ–è¿™ä¸ªinstanceï¼Œçº¿ç¨‹Aå°±è¢«æŒ‚èµ·äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åçº¿ç¨‹Bæ¥ç®¡ä¸€åˆ‡ï¼Œå‘ç°æŒ‡é’ˆæœ‰å€¼ï¼Œä¹‹åæ¬¢å¤©å–œåœ°çš„æ‹¿å»ç”¨ï¼Œå´åªå‘ç°å–å›çš„æ•°æ®æ˜¯undefinedã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±é€—äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æ ¹æ®ä¸Šé¢çš„æ–‡ç« ï¼Œä½ ä»¬åº”è¯¥çŸ¥é“æ€ä¹ˆå¤„ç†è¿™ä¸ªé—®é¢˜äº† â€”â€” ç”¨å†…å­˜å±éšœå•Šï¼&lt;/p&gt;
&lt;p&gt;p.s. å¦‚æœå¤§å®¶å¯¹obj-cä¸ç†Ÿæ‚‰çš„è¯ï¼Œå¯ä»¥çœ‹æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« ã€‚é‚£ç¯‡æ–‡ç« æ˜¯å…³äºScott Meyerså¤§ç¥å†™çš„ä¸€ç¯‡è®ºæ–‡ï¼Œä¸“é—¨ç”¨æ¥è®¨è®ºDCLPé—®é¢˜çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="nf"&gt;getSharedObject&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;id&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;LOCK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;id&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="nb"&gt;self&lt;/span&gt; &lt;span class="n"&gt;alloc&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="n"&gt;OSMemoryBarrier&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;sharedObject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;UNLOCK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;OSMemoryBarrier&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è€Œåœ¨ã€ŠC++ and the Perils of Double-Checked Lockingã€‹ä¸€æ–‡ä¸­ï¼ŒScott Meyerså’ŒAndrei Alexandrescuç»™å‡ºçš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pInstance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;// insert memory barrier&lt;/span&gt;
    &lt;span class="c1"&gt;// clear the cache to flush ``pInstance``&lt;/span&gt;
    &lt;span class="c1"&gt;// prevents &amp;quot;downwards migration&amp;quot; of Singletonâ€™s construction (by another thread);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;Lock&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pInstance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="c1"&gt;// insert memory barrier&lt;/span&gt;
            &lt;span class="c1"&gt;// prevent optimistic that eliminate the temporary variable ``tmp``&lt;/span&gt;
            &lt;span class="c1"&gt;// prevents &amp;quot;upwards migration&amp;quot; of pInstanceâ€™s initialization&lt;/span&gt;
            &lt;span class="n"&gt;pInstance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;  &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸¤ç§è§£å†³æ–¹æ¡ˆçš„memory barrieræ’å…¥çš„ä½ç½®ä¸åŒã€‚ä½†æ˜¯éƒ½ä¸èƒ½è¯´æ˜¯é”™çš„ã€‚å› ä¸ºä¸€ä¸ªæ˜¯ä¼ static instanceï¼Œä¸€ä¸ªæ˜¯ä¼ pointerã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®è¿˜æœ‰æ›´â€œæš´åŠ›â€çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥æ¥ä¸€æŠŠå¤§é”ï¼Œå“å½“æŠŠæ•´ä¸ªå‡½æ•°é”èµ·æ¥ï¼Œå¹¶ä¸”åœ¨æ¯ä¸€ä¸ªçº¿ç¨‹å†…ä¿ç•™ä¸€ä¸ª&lt;strong&gt;æœ¬çº¿ç¨‹ä¸“å±&lt;/strong&gt;æŒ‡å‘å•ä¾‹çš„æŒ‡é’ˆï¼ˆåšcacheï¼‰ã€‚è¿™æ ·Nä¸ªçº¿ç¨‹åªéœ€è¦è°ƒç”¨è¿™ä¸ªå‡½æ•°Næ¬¡ï¼Œçº¿ç¨‹ç«äº‰ä¹Ÿç›¸å¯¹å°‘å¾ˆå¤šã€‚å¹¶ä¸”æ ¹æ®Linuxä¸‹çš„futexæŠ€æœ¯ï¼Œæ— ç«äº‰ä¸‹çš„é”ç›¸å¯¹èŠ‚çœäº†ä¸å°‘èµ„æºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Lock&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pInstance&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;pInstance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Singleton&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pInstance&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;æˆ‘ä»¬çœŸè¦è¿™ä¹ˆåšå—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢çš„obj-cä»£ç ä¸­ï¼Œä¿è¯åŒé‡æ£€æŸ¥é”æ­£ç¡®çš„ï¼Œå…¶å®æ˜¯ç¬¬äºŒä¸ªå†…å­˜å±éšœã€‚ä½†æ˜¯ï¼Œåœ¨é‚£é‡Œï¼Œæˆ‘ä»¬éœ€è¦çš„å…¶å®æ˜¯ä¸€ä¸ª"data dependency barrier"ã€‚&lt;/p&gt;
&lt;p&gt;Linuxå†…æ ¸ä¸­ç»™å‡ºå¾ˆå¤šç»è¿‡ç²¾å¿ƒä¼˜åŒ–çš„å†…å­˜å±éšœï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨ã€‚ä¸è¿‡ï¼Œè¦åœ¨ä½¿ç”¨çš„æ—¶å€™å†™å¥½æ³¨é‡Šï¼Œä¸€æ˜¯ä¸ºäº†æœªæ¥çš„éªŒè¯ï¼ŒäºŒæ˜¯ä¸ºäº†è®°å½•è‡ªå·±å½“æ—¶çš„æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¯•ç«Ÿå¤šçº¿ç¨‹çš„æ“ä½œè¦å°å¿ƒå†å°å¿ƒï¼Œæˆ‘ä»¬éœ€è¦å……è¶³çš„ç†ç”±ï¼Œæ›´å¤šçš„å°å¿ƒæ¥åº”å¯¹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="nf"&gt;getSharedObject&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;id&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;LOCK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;id&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="nb"&gt;self&lt;/span&gt; &lt;span class="n"&gt;alloc&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="n"&gt;OSMemoryBarrier&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;sharedObject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;UNLOCK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="cm"&gt;/* data dependency memory barrier here */&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sharedObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä¸€åˆ‡éƒ½ç»“æŸäº†å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ˜¯çš„ã€‚ä¸è¿‡è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Mutex Tank" src="http://wizmann-tk-pic.u.qiniudn.com/barrier_tank.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤„ç†å™¨å’Œç¼–è¯‘å™¨å°±æ˜¯ä¸¤ä¸ªæƒ³ç©æ­»ä½ çš„å­™åˆ™ï¼Œå®ƒä»¬ä¼šæŠŠä½ çš„ä»£ç åˆ°å¤„ç§»åŠ¨ã€‚æ‰€ä»¥&lt;strong&gt;Be warned and wary!&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹çš„é”™è¯¯æ˜¯éå¸¸subtleå’Œdelicateçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆéš¾è®¾è®¡æµ‹è¯•ç”¨ä¾‹ï¼Œåªèƒ½æ— åŠ©çš„ç­‰ç€Bugè‡ªå·±æŠŠå¤´ä¼¸å‡ºæ¥ã€‚ï¼ˆæˆ‘å°±æ˜¯æƒ³èƒŒä¸‹æ¥é‚£ä¸¤ä¸ªå•è¯ï¼ï¼‰&lt;/li&gt;
&lt;li&gt;å› æ­¤ï¼Œåˆ«æŒ‡è´£QAäº†ï¼Œä»–ä»¬ä¹Ÿä¸æ˜¯æ•…æ„çš„ã€‚RDè¦å¯¹è‡ªå·±çš„ä»£ç è´Ÿè´£&lt;/li&gt;
&lt;li&gt;é”å¾ˆå®‰å…¨ï¼Œä½†æ˜¯ä¹Ÿå¾ˆé‡ã€‚å¦‚æœä½ è‡ªå·±ä¸€ä¸å°å¿ƒæŠŠè‡ªå·±é”èµ·æ¥çš„è¯(deadlock)ï¼Œå…¶å®ä¹Ÿä¸æ˜¯é‚£ä¹ˆå®‰å…¨ã€‚&lt;/li&gt;
&lt;li&gt;å†…å­˜å±éšœæ˜¯ä¸€ç§æ›´å¿«çš„ï¼Œä¸é˜»å¡çš„ï¼Œä¸ä¼šæ­»é”çš„ä¸€ç§é”çš„æ›¿ä»£ç‰©ã€‚å®ƒä»¬æ€»è¦èŠ±è´¹æ›´å¤šçš„å¿ƒæ€ï¼Œå¹¶ä¸”ä¹Ÿä¸æ˜¯åˆ°å¤„å¯ç”¨çš„é“¶å¼¹ã€‚ä½†æ˜¯å®ƒç¡®å®å¾ˆå¿«ï¼Œæœ‰æ›´å¥½çš„ä¼¸ç¼©æ€§ã€‚&lt;/li&gt;
&lt;li&gt;å†…å­˜å±éšœå¾€å¾€æ˜¯æˆå¯¹å‡ºç°çš„ã€‚äº†è§£ç¬¬äºŒä¸ªå†…å­˜å±éšœè¦å‡ºç°åœ¨å“ªé‡Œï¼Œæœ‰åŠ©äºä½ ç†è§£ä½ çš„ä»£ç ï¼Œå³ä½¿ä½ æ‰€ä½¿ç”¨çš„ä½“ç³»ç»“æ„ä¸éœ€è¦ç¬¬äºŒä¸ªå†…å­˜å±éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æ‰©å±•é˜…è¯»&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://www.kernel.org/doc/Documentation/memory-barriers.txt"&gt;LINUX KERNEL MEMORY BARRIERS&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.17.8112"&gt;Memory Consistency and Event Ordering in Scalable Shared-Memory Multiprocessors&lt;/a&gt;&lt;/p&gt;</summary><category term="cpp"></category><category term="memory-barrier"></category><category term="asm"></category><category term="multiprocess"></category><category term="multithread"></category><category term="thread"></category><category term="cocurrency"></category></entry><entry><title>Codeforces Round #242 (Div. 2) Tutorials and Solutions</title><link href="http://wizmann.tk/cf-242-div-2.html" rel="alternate"></link><updated>2014-04-30T17:39:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-04-30:cf-242-div-2.html</id><summary type="html">&lt;h2&gt;A. Squats&lt;/h2&gt;
&lt;p&gt;Trun &lt;code&gt;x =&amp;gt; X&lt;/code&gt; or &lt;code&gt;X =&amp;gt; x&lt;/code&gt; to make the number of 'x' is equal to the number of 'X'.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;hamsters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;

&lt;span class="n"&gt;sits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hamsters&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;stands&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hamsters&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sits&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;stands&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hamsters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sits&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;stands&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sits&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
        &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;x&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stands&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
        &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hamsters&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;hamsters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;swapcase&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hamsters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Megacity&lt;/h2&gt;
&lt;p&gt;Binary search.&lt;/p&gt;
&lt;p&gt;Find the minimal radius of the circle to contain as many city as we need to form a &lt;strong&gt;megacity&lt;/strong&gt;. But beware that you may get wrong answer if you take the lower bound of the binary search, and the answer may not exist if there no way to make a &lt;strong&gt;megacity&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; 
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;distance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;megacity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cities&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;
    &lt;span class="n"&gt;rem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;city&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;cities&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;distance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;city&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;rem&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;city&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;rem&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;

&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;cities&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;cities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;


&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2e6&lt;/span&gt;

&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mf"&gt;1e-7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;2.&lt;/span&gt;
    &lt;span class="c"&gt;#print mid&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;megacity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cities&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;megacity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cities&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Magic Formulas&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Magic Formula" src="http://wizmann-tk-pic.u.qiniudn.com/Magic-Formula.png" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;U = reduce(xor, p[1...n])
V[i] = reduce(xor, map(j % i, [for j in 1...n]))
Q = U ^ reduce(xor, V[1...n])
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;First of all, we can easily get the value of &lt;code&gt;U&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Secondly, as &lt;code&gt;n&lt;/code&gt; is up to &lt;code&gt;1e6&lt;/code&gt;. We have to reduce the calculation and the method will shown by code.&lt;/p&gt;
&lt;p&gt;At last, we xor them all together to get the final result.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000010&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;xorsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;xorsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;sum&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;xorsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;Q&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;div&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;rem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;div&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;Q&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;xorsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;Q&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;xorsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;rem&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Biathlon Track&lt;/h2&gt;
&lt;p&gt;Binary search again.&lt;/p&gt;
&lt;p&gt;I calculate the wrong time complexity and get many &lt;code&gt;TLE&lt;/code&gt;s using brute force algorithm.&lt;/p&gt;
&lt;p&gt;The idea is to fix the left-up point A, &lt;code&gt;(ax, ay)&lt;/code&gt;, and fix the y-axis of the right-buttom point B, &lt;code&gt;(bx, by)&lt;/code&gt;. And then, using binary search to get the x-axis of the B to get the nearest cost (aka "distance covering time") to the desired time &lt;code&gt;t&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The time complexity is &lt;code&gt;O(logn * n^3)&lt;/code&gt;. A bad ass code is below.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;DIRS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;INF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tu&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;td&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;NORTH&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;EAST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SOUTH&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;WEST&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;td&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;tu&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;count_time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NORTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NORTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SOUTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SOUTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;EAST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;EAST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;WEST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;WEST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_cost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NORTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NORTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SOUTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SOUTH&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;EAST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;EAST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;WEST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;costxy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;WEST&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d%d%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d%d%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;tu&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;td&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;land&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;count_time&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;INF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;rsax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsbx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsby&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ay&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ay&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ay&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;lbx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rbx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lbx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rbx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;lbx&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_cost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;lbx&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;rbx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_cost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="c1"&gt;// printf(&amp;quot;%d %d %d %d =&amp;gt; %d\n&amp;quot;, ay, ax, by, bx, cost);&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="c1"&gt;//print(ans);&lt;/span&gt;
                &lt;span class="n"&gt;rsax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;rsay&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ay&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;rsbx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bx&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;rsby&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="c1"&gt;//printf(&amp;quot;%d %d %d %d\n&amp;quot;, rsay + 1, rsax + 1, rsby + 1, rsbx + 1);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d %d %d %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsay&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsax&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsby&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rsbx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>Codeforces Round #240 (Div. 2) Tutorials and Solutions(incomplete and incorrect)</title><link href="http://wizmann.tk/cf-240-div-2.html" rel="alternate"></link><updated>2014-04-08T14:39:11+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-04-08:cf-240-div-2.html</id><summary type="html">&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;It has been months that I didn't participate in the contest on CF, now I'm back. :)&lt;/p&gt;
&lt;p&gt;This round of contest makes me confused that the problem B and C is a little bit too twisted, if you can't catch the vital point, you will get a lot of WAs in the end.&lt;/p&gt;
&lt;p&gt;Additionally, the problem D is too easy, just a simple DP and the time limit is too long for an unoptimized solution.&lt;/p&gt;
&lt;p&gt;And as usual, I have no idea to the problem E. :(&lt;/p&gt;
&lt;h2&gt;A. Mashmokh and Lights&lt;/h2&gt;
&lt;p&gt;The description is too long for a problem A, but it is as easy as it used to be.&lt;/p&gt;
&lt;p&gt;Just decalre an array to keep the records of who is the first to turn off the light.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;bs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
            &lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Mashmokh and Tokens&lt;/h2&gt;
&lt;p&gt;It is quite confused that Mashmokh just save the tokens for NOTHING?! I took it for granted that Mashmokh should save all the extra token for a final exchange. But I was wrong. The problem just asks for how many tokens is useless for the tokens-salary exchange everyday.&lt;/p&gt;
&lt;p&gt;Uh, so sad. If I was Mashmokh, I just give all my tokens to my boss as the saved tokens  would never counts.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Mashmokh and Numbers&lt;/h2&gt;
&lt;p&gt;You need a full-time QA for this problem because some of the scenarios will lead to hours of debuging. :(&lt;/p&gt;
&lt;p&gt;The  thought of the problem is easy enough, just print two numbers with the gcd equal to &lt;code&gt;g&lt;/code&gt; and a sequence of squential numbers with m pairs that each pair has a gcd equals to &lt;code&gt;1&lt;/code&gt;. At last, just make sure that &lt;code&gt;g + m == k&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;However, there are some &lt;strong&gt;special&lt;/strong&gt; test cases.&lt;/p&gt;
&lt;p&gt;n = 1, k = 0. 
You can pass this case if you print any positive number.                      &lt;/p&gt;
&lt;p&gt;n = 1, k - (n / 2) + 1 &amp;lt;= 0. 
It will lead to "-1".&lt;/p&gt;
&lt;p&gt;And the scenarios that the n is odd.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Mashmokh and ACM&lt;/h2&gt;
&lt;p&gt;A simple DP problem. The formula is quite easy.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;dp[k][i] = sum(dp[a0][i - 1] + dp[a1][i - 1] ... dp[ai][i - 1])
(k % ai == 0)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The time complexity is &lt;code&gt;m * n * (1 + 1/2 + 1/3 + ... 1/n)&lt;/code&gt;, and the sum of series &lt;code&gt;1 + 1/2 + ...&lt;/code&gt; is called harmonic number of n which approximately equals to &lt;code&gt;ln(n)&lt;/code&gt;. So the final time complexity is &lt;code&gt;m * n * ln(n)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Further, we can reuse the space of dp array to gain a better CPU cache optimizism.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;ctime&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;map&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout&amp;lt;&amp;lt;x&amp;lt;&amp;lt;endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin&amp;gt;&amp;gt;x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2048&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000007LL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
           &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
               &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
               &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;MOD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>"alloca" vs "placement new"</title><link href="http://wizmann.tk/alloca-vs-placement-new.html" rel="alternate"></link><updated>2014-04-07T21:08:59+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-04-07:alloca-vs-placement-new.html</id><summary type="html">&lt;h2&gt;WHAT?!&lt;/h2&gt;
&lt;p&gt;For most time, we use &lt;code&gt;malloc&lt;/code&gt; or &lt;code&gt;new&lt;/code&gt; for memory allocation, which will get it on &lt;em&gt;heap&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;However, access memory on &lt;em&gt;heap&lt;/em&gt; is not as effective as the memory on &lt;em&gt;stack&lt;/em&gt;, because the heap is "free-floating region of memory". To the contrary, memory on &lt;em&gt;stack&lt;/em&gt; is managed by CPU automacitally and tightly. As a result, the further of the &lt;em&gt;stack&lt;/em&gt; compared to &lt;em&gt;heap&lt;/em&gt; is that we can have a faster read/write speed due to the fact that &lt;em&gt;stack&lt;/em&gt; memory is more likely to optimized by &lt;strong&gt;CPU cache&lt;/strong&gt;, in addition, it only uses a single instruction to allocate or deallocate &lt;em&gt;stack&lt;/em&gt; memory. Just like this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;sub&lt;/span&gt; &lt;span class="n"&gt;esp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;allocate&lt;/span&gt;
&lt;span class="n"&gt;add&lt;/span&gt; &lt;span class="n"&gt;esp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;deallocate&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;alloca&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;alloca()&lt;/code&gt; function allocates memory from the &lt;em&gt;stack&lt;/em&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;alloca&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It's quite the same as the &lt;code&gt;malloc&lt;/code&gt; way. But we shouldn't free the memory allocated on the &lt;em&gt;stack&lt;/em&gt;; these memory will be automatically deallocated when you leave the function(&lt;strong&gt;not the code block&lt;/strong&gt;).&lt;/p&gt;
&lt;h2&gt;placement new&lt;/h2&gt;
&lt;p&gt;The placement new is one of the overloads of the &lt;code&gt;new&lt;/code&gt; functions; this new syntax can do something as the &lt;code&gt;alloca()&lt;/code&gt; function.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The placement new can be also used in some other scenarios but won't be mentioned here.&lt;/p&gt;
&lt;h2&gt;variable-length array&lt;/h2&gt;
&lt;p&gt;C90 and C++ both support the variable-length array which will be allocated on &lt;em&gt;stack&lt;/em&gt;, and it will be deallocted whhen you leave the &lt;strong&gt;clode block&lt;/strong&gt;, such as "if", "while", etc.&lt;/p&gt;
&lt;p&gt;This is much simplified, but be ware if you use both variable-length array and &lt;code&gt;alloca()&lt;/code&gt; in the same function, the deallocation of the array will also free anything more recenly allocated by alloca.&lt;/p&gt;
&lt;h2&gt;Defects&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Stack&lt;/em&gt; has its limitation. If the allocation on &lt;em&gt;stack&lt;/em&gt; causes &lt;strong&gt;stack overflow&lt;/strong&gt; error, then the behavior of the program is undefined.&lt;/p&gt;
&lt;p&gt;Further, the variable-length array and &lt;code&gt;alloca()&lt;/code&gt; are not included in &lt;em&gt;ANSI-C&lt;/em&gt; standard and therefore could limit portability.&lt;/p&gt;
&lt;p&gt;The Google C++ style guide encourage developers to use &lt;code&gt;scoped_ptr&lt;/code&gt; or &lt;code&gt;scopted_array&lt;/code&gt; instead of variable-length array and &lt;code&gt;alloca()&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Some experiment&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// compile with: g++ -std=c++0x -O2 -Wall -g -o &amp;quot;foo.cc&amp;quot; &amp;quot;foo&amp;quot;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="cp"&gt;#if defined(__i386__)&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="n"&gt;__inline__&lt;/span&gt; &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="nf"&gt;rdtsc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;__asm__&lt;/span&gt; &lt;span class="k"&gt;volatile&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.byte 0x0f, 0x31&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;=A&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="cp"&gt;#elif defined(__x86_64__)&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="n"&gt;__inline__&lt;/span&gt; &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="nf"&gt;rdtsc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;__asm__&lt;/span&gt; &lt;span class="n"&gt;__volatile__&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;rdtsc&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;=a&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;=d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="cp"&gt;#endif&lt;/span&gt;


&lt;span class="c1"&gt;//#define MEMORY_ON_HEAP&lt;/span&gt;
&lt;span class="c1"&gt;//#define MEMORY_ON_STACK&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;102400&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rdtsc&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="cp"&gt;#ifdef MEMORY_ON_HEAP &lt;/span&gt;&lt;span class="c1"&gt;// RDSTC: 20586280&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="cp"&gt;#endif&lt;/span&gt;

    &lt;span class="cp"&gt;#ifdef MEMORY_ON_STACK &lt;/span&gt;&lt;span class="c1"&gt;// RDSTC: 3660502&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;alloca&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="cp"&gt;#endif&lt;/span&gt;


    &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rdtsc&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can use &lt;code&gt;info register esp&lt;/code&gt; in gdb to inspect the &lt;em&gt;stack&lt;/em&gt; pointer before and after you call the allocation function or declare a variable-length array.&lt;/p&gt;</summary><category term="cpp"></category><category term="memory"></category><category term="stack"></category><category term="heap"></category><category term="allocate"></category><category term="alloca"></category><category term="c++"></category></entry><entry><title>Quartile and Normal Distribution</title><link href="http://wizmann.tk/quartile-and-normal-distribution.html" rel="alternate"></link><updated>2014-03-09T22:44:15+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-03-09:quartile-and-normal-distribution.html</id><summary type="html">&lt;h2&gt;What is Quartile?&lt;/h2&gt;
&lt;p&gt;Quartile is a concept of descriptive statics. The quartiles of a ranked data set are the three points that divide the data set into four equal groups, each group comprising a quarter of data.&lt;/p&gt;
&lt;h2&gt;Definitions&lt;/h2&gt;
&lt;h3&gt;first quartile (Q1)&lt;/h3&gt;
&lt;p&gt;First quartile, also known as lower quartile, splits off the lowest 25% of data.&lt;/p&gt;
&lt;h3&gt;second quartile (Q2)&lt;/h3&gt;
&lt;p&gt;Second quartile is the median of the data set, cuts data set in half.&lt;/p&gt;
&lt;h3&gt;third quartile (Q3)&lt;/h3&gt;
&lt;p&gt;Third quartile, known as upper quartile, splits off the highest 25% data.&lt;/p&gt;
&lt;p&gt;The different between &lt;em&gt;Q1&lt;/em&gt; and &lt;em&gt;Q3&lt;/em&gt; is called the InterQuartile Range(IQR).&lt;/p&gt;
&lt;h2&gt;Box-and-Whisker-plot and Quartile&lt;/h2&gt;
&lt;p&gt;A box-and-whisker-plot is a convenient way of graphically depicting groups of numerical data through their quartiles.&lt;/p&gt;
&lt;p&gt;The buttom and top of the box is always Q1 and Q3, and the band in the box is always Q2(the median). And the ends of the whiskers can be presented in several different ways.&lt;/p&gt;
&lt;h2&gt;Tukey Boxplot&lt;/h2&gt;
&lt;p&gt;Tukey boxplot defines two type of whiskers, which are called &lt;em&gt;inner fence&lt;/em&gt; and &lt;em&gt;outer fence&lt;/em&gt;. The value of &lt;em&gt;inner fence&lt;/em&gt; is &lt;code&gt;Q1 - 1.5 * IQR&lt;/code&gt; and &lt;code&gt;Q3 + 1.5 * IQR&lt;/code&gt;. At the same time, the value of &lt;em&gt;outer fence&lt;/em&gt; is &lt;code&gt;Q1 + 3 * IQR&lt;/code&gt; and &lt;code&gt;Q3 + 3 * IQR&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The data outside the fence is called the &lt;em&gt;suspected outliers&lt;/em&gt; and &lt;em&gt;outliners&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;If the data happens to be normally distributed, &lt;code&gt;IQR = 1.35Ïƒ&lt;/code&gt;. It means that only 0.52% of the set of data should be out of the &lt;em&gt;inner fence&lt;/em&gt; and  hardly any of the data should be out of the &lt;em&gt;outer fence&lt;/em&gt;. As a result, if a data is considered as a &lt;em&gt;outliners&lt;/em&gt;, it is largely an exception.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Boxplot and Normal Distribution" src="http://wizmann-tk-pic.u.qiniudn.com/Boxplot.png" /&gt;&lt;/p&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/Boxplot"&gt;Box plot - Wikipedia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.physics.csbsju.edu/stats/box2.html"&gt;Box Plot: Display of Distribution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.wasu.com.cn/fwyzc/wasubzhzl/201207/P020140102519718744101.pdf"&gt;Tables for statistical distributions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="quartile"></category><category term="normal-distribution"></category></entry><entry><title>ç ´è§£èŠ‚æ“çš„ä¸‹é™</title><link href="http://wizmann.tk/moujiecao.html" rel="alternate"></link><updated>2014-02-25T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-02-25:moujiecao.html</id><summary type="html">&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;img alt="èŠ‚æ“ç²¾é€‰" src="http://wizmann-tk-pic.u.qiniudn.com/blog-jiecao-icon.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://jiecao.fm/"&gt;èŠ‚æ“ç²¾é€‰&lt;/a&gt;æ˜¯ä¸€ä¸ª&lt;strong&gt;æ²¡æœ‰ä¸‹é™&lt;/strong&gt;çš„æ–‡å­—å›¾ç‰‡èšåˆç±»ç§»åŠ¨åº”ç”¨ï¼Œç°åœ¨æ”¯æŒAndroid/iOSç§»åŠ¨å¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="ç•Œé¢" src="http://wizmann-tk-pic.u.qiniudn.com/blog-jiecao-ui.png" /&gt;&lt;/p&gt;
&lt;p&gt;æœ¬äººæ˜¯ä¸€ä¸ªéå¸¸æ‡’çš„äººï¼Œæœ‰ç”µè„‘å°±ä¸æƒ³ç¢°æ‰‹æœºã€‚ã€‚ã€‚äºæ˜¯èŒç”Ÿäº†ä¸€ä¸ªåœ¨PCç«¯ä½¿ç”¨è¿™ä¸ªåº”ç”¨çš„æƒ³æ³•ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2&gt;HowTo&lt;/h2&gt;
&lt;p&gt;ä»ç•Œé¢ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªAppçš„é€»è¾‘å…¶å®æ¯”è¾ƒç®€å•ã€‚é‡è¦çš„éƒ¨åˆ†æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è·å–CSé€šä¿¡åè®®&lt;strong&gt;ï¼ˆæœ€é‡è¦ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¢‘é“é—´åˆ‡æ¢ï¼ˆç²¾é€‰ - çƒ­é—¨ - éŸ³é¢‘- é˜…è¯»ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å±•ç¤ºæŸä¸€æ¡ç²¾é€‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æŸä¸€æ¡ç²¾é€‰ä¸­æ’­æ”¾è¯­éŸ³&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;è·å–é€šä¿¡åè®®&lt;/h2&gt;
&lt;p&gt;èŠ‚æ“è¿˜æ˜¯éå¸¸è‰¯å¿ƒçš„ï¼å¹¶æ²¡æœ‰åœ¨åå°æ•°æ®é€šä¿¡ä¸­è¿›è¡Œä»»ä½•åŠ å¯†çš„æªæ–½ã€‚&lt;/p&gt;
&lt;p&gt;æŠ“åŒ…å·¥å…·æˆ‘ä½¿ç”¨çš„æ˜¯åœ¨Windowsç¯å¢ƒä¸‹çš„&lt;a href="http://www.telerik.com/fiddler"&gt;Fiddler&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå·¥å…·å¯ä»¥å»ºç«‹ä¸€ä¸ªHTTPä»£ç†ï¼Œæ‰‹æœºé€šè¿‡ä»£ç†ä¸Šç½‘ï¼Œåœ¨ç”µè„‘ä¸Šå°±å¯ä»¥æˆªè·æ‰€æœ‰çš„æ•°æ®åŒ…è¿›è¡Œåˆ†æã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Linuxä¸‹ï¼Œå¯ä»¥ä½¿ç”¨TinyProxy + Wiresharkè¿›è¡ŒæŠ“åŒ…ï¼Œä¸è¿‡é…ç½®å°éº»çƒ¦ã€‚ä¸è¿‡æˆ‘ä¸€ç›´æ˜¯åœ¨Windowsä¸‹æŠ“åŒ…ï¼Œç„¶ååœ¨Linuxä¸‹åšåˆ†æå’Œå¼€å‘çš„ã€‚=ã€‚=ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å›¾å°±ä¸ä¸Šäº†ï¼Œå¦‚æœå¤§å®¶æœ‰å…´è¶£è‡ªå·±æ¥æçš„è¯ï¼Œå¯ä»¥æŠ“æ¥è¯•è¯•ã€‚&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ä»HTTPåŒ…ä¸­çš„&lt;code&gt;Content-type&lt;/code&gt;å­—æ®µä¸­ï¼Œå‘ç°äº†æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ â€”â€” &lt;code&gt;application/xprotobuf&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å»ï¼çœŸè‰¯å¿ƒï½&lt;/p&gt;
&lt;h3&gt;Protobufç®€ä»‹&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Protocol Buffers are a way of encoding structured data in an efficient yet extensible format. Google uses Protocol Buffers for almost all of its internal RPC protocols and file formats.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼ŒProtobufæ˜¯ä¸€ä¸ªç”¨äºæ•°æ®ä¼ è¾“çš„DSLï¼ˆDomain Specific Languageï¼‰ã€‚Protobufæä¾›äº†ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œå¼€å‘è€…åªéœ€è¦å£°æ˜éœ€è¦ä¼ è¾“çš„æ•°æ®å­—ä¹‰ï¼Œå°±å¯ä»¥è‡ªåŠ¨ç¼–è¯‘å‡ºé€‚ç”¨å¤šç§è¯­è¨€çš„ä¼ è¾“ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;Protobufå®˜æ–¹æ”¯æŒC++, Java, å’Œ Pythonã€‚ç¬¬ä¸‰æ–¹å¼€å‘è€…è¿˜æä¾›äº†æ›´å¤šè¯­è¨€çš„æ”¯æŒã€‚åœ¨æˆ‘çš„å¼€å‘ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†&lt;code&gt;dcodeIO-ProtoBuf.js&lt;/code&gt;ï¼Œä¸€ä¸ªå¼€æºçš„JSçš„Protobufåº“ï¼Œæœ‰å…´è¶£çš„è¯å¯ä»¥ä»Githubä¸­è·å–ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;message Person {
  required int32 id = 1;
  required string name = 2;
  optional string email = 3;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ç ´è§£ProtobufæŠ¥æ–‡&lt;/h3&gt;
&lt;p&gt;ç ´è§£ProtobufæŠ¥æ–‡å…¶å®å°±æ˜¯ç”¨&lt;code&gt;æ˜æ–‡æ”»å‡»&lt;/code&gt;è·å–Protobufçš„ä¼ è¾“æ•°æ®å®šä¹‰ã€‚ç„¶åæˆ‘ä»¬ç”Ÿæˆæ¥å—è¿™ä¸ªæŠ¥æ–‡çš„Protobufä»£ç ï¼Œå°±å¯ä»¥è§£æç›¸åº”çš„æŠ¥æ–‡äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§ç®€å•çš„ï¼Œä¸€ç§éš¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å½“ç„¶è¦ä»é€¼æ ¼é«˜çš„å›°éš¾æ–¹æ³•å¼€å§‹è®²ã€‚&lt;/p&gt;
&lt;h4&gt;A hard way to crack protobuf&lt;/h4&gt;
&lt;p&gt;é‡ç‚¹å‚è€ƒï¼š&lt;a href="http://www.cnblogs.com/shitouer/archive/2013/04/12/google-protocol-buffers-encoding.html"&gt;Google Protocol Buffers ç¼–ç (Encoding)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶æ€æƒ³å°±æ˜¯æ‰¾åˆ°Protobufçš„ç¼–ç è§„å¾‹ï¼Œç„¶åä¸€ä¸ªå­—æ®µä¸€ä¸ªå­—æ®µçš„åæ¨ï¼Œä»è€Œæ‰¾åˆ°å®Œæ•´çš„æ•°æ®å®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼ŒProtobufåˆæœ‰ä¸€ä¸ªå¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œå³å¦‚æœæˆ‘ä»¬çš„æ•°æ®å®šä¹‰æ˜¯åŸæ•°æ®å®šä¹‰çš„å­é›†ï¼ŒåŒæ ·å¯ä»¥è§£æå‡ºå­é›†ä¸­çš„æ‰€æœ‰å­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°é‡è¦çš„å‡ ä¸ªå­—æ®µæ¥æå°±å¯ä»¥äº†ã€‚ç ´è§£è¿‡ç¨‹æ¯”è¾ƒæ— è¶£ï¼Œä¸€ä¸ªä½ä¸€ä¸ªä½çš„æ£€æŸ¥ï¼Œæ— è„‘æ¨ã€‚&lt;/p&gt;
&lt;h4&gt;An easy way to crack protobuf&lt;/h4&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬å¯ä»¥è½»æ¾çš„æåˆ°èŠ‚æ“çš„ApkåŒ…ï¼Œåˆç”±äºApkåŒ…æ˜¯å¯ä»¥&lt;strong&gt;åç¼–è¯‘&lt;/strong&gt;çš„ï¼&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥çœ‹ä»£ç è·å¾—Protobufçš„æ•°æ®å®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ‰å«çœŸæ— è„‘ã€‚&lt;/p&gt;
&lt;p&gt;åç¼–è¯‘æˆ‘ä½¿ç”¨çš„æ˜¯&lt;a href="https://code.google.com/p/dex2jar/"&gt;dex2jar&lt;/a&gt;å’Œ&lt;a href="http://jd.benow.ca/"&gt;jdgui&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¿™ä¸¤ä¸ªå·¥å…·éƒ½æœ‰å…¶å±€é™æ€§ï¼Œä½†æ˜¯æè¿™ä¸ªä¸€ä¸ªAppè¿˜æ˜¯è½»è½»æ¾æ¾ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å°±è·å¾—äº†ä¸€ä¸ªå®Œæ•´çš„æ•°æ®å®šä¹‰ã€‚ä½†æ˜¯ç”±äºè¿˜æ˜¯è¦ç»™&lt;a href="http://weibo.com/121100059"&gt;ç¾ä¸½çš„CEOå§å§&lt;/a&gt;ä¸€ç‚¹é¢å­çš„ï½&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å°±ä¸å…¬å¼€äº†ï½ä¸Šä¸€ä¸ªé«˜æ¸…æœ‰ç å¤§å›¾ï½&lt;/p&gt;
&lt;p&gt;&lt;img alt="protobuf" src="http://wizmann-tk-pic.u.qiniudn.com/blog-jiecao-protobuf.png" /&gt;&lt;/p&gt;
&lt;h2&gt;å…³äºå¼€å‘&lt;/h2&gt;
&lt;p&gt;æ— å›¾æ— JJï¼Œå…ˆä¸Šä¸€å¼ æ•ˆæœå›¾ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ˜¯ä¸ªäººå¼€å‘ï¼Œæ‰€ä»¥ç•Œé¢æ¯”è¾ƒç²—ç³™ã€‚å¦‚æœæœ‰å‰ç«¯ç¥ç‰›ï¼Œå¯ä»¥åšå‡ºæ›´ç‚«çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯æ‰‹æœºçš„dpiæ¯”ç”µè„‘å±å¹•çš„è¦é«˜ä¸€äº›ï¼ˆç”¨retinaå±å¹•çš„åœŸè±ªä»¬é€€æ•£ï¼‰ï¼Œæ‰€ä»¥åŒæ ·å¤§å°çš„â€œçª—å£â€ï¼Œç”µè„‘çš„æ˜¾ç¤ºä¼šç²—ç³™å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="èŠ‚æ“App" src="http://wizmann-tk-pic.u.qiniudn.com/blog-jiecao-app-ui.png" /&gt;&lt;/p&gt;
&lt;h3&gt;åº”ç”¨è½½ä½“&lt;/h3&gt;
&lt;p&gt;ç”±äºæ‹‰å–æ•°æ®çš„æ“ä½œæ˜¯HTTP POSTã€‚å› ä¸ºæµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ï¼Œæˆ‘ä»¬ä¸èƒ½è·¨åŸŸPOSTã€‚æ‰€ä»¥æˆ‘ä½¿ç”¨äº†Chromeæµè§ˆå™¨ä¸­çš„Appæ’ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;Chromeä¸ºAppæ’ä»¶æä¾›äº†ç›¸å¯¹å®½æ¾çš„å®‰å…¨ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥è·¨åŸŸPOSTï¼Œå¯ä»¥è·å¾—å›¾åƒï¼Œå¯ä»¥ä¿®æ”¹ä¸€ä¸ªwebviewé‡Œé¢çš„ä»£ç ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªChromeAppåŸºæœ¬è§†ä¸ºä¸€ä¸ªæœ¬åœ°åº”ç”¨ï¼Œæ”¾åˆ°æ¡Œé¢ä¸Šæˆ–è€…å¯åŠ¨æ ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="å¯åŠ¨å™¨" src="http://wizmann-tk-pic.u.qiniudn.com/blog-jiecao-chrome-app-launcher.png" /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ç”¨çš„æ˜¯Xubuntuï¼Œåœ¨å…¶å®ƒç³»ç»Ÿä¸Šï¼Œå¦‚Winã€MacOSä»¥åŠå…¶å®ƒä¸åŒçš„Linuxå‘è¡Œç‰ˆï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;h3&gt;æ€»ä½“è§„åˆ’&lt;/h3&gt;
&lt;p&gt;ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸€ä¸ªé¡µé¢ä¸»è¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªæ˜¯Logoï¼Œä¸€ä¸ª&lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt;æ ‡ç­¾ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªæŒ‰é’®ç»„ï¼Œç”¨æ¥åˆ‡æ¢ä¸‹é¢çš„å†…å®¹åˆ—è¡¨çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªæ˜¯å†…å®¹åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯¹åº”ç€ä¸€ç¯‡èŠ‚æ“æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ï¼Œæˆ‘é€‰ç”¨äº†MVCæ¨¡å¼æ¥è§£å†³ç•Œé¢é—®é¢˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;M - Model
æ¯ä¸€ä¸ªèŠ‚æ“æ–‡ç« ï¼Œå…¶ä¸­æœ‰&lt;code&gt;icon&lt;/code&gt;, &lt;code&gt;title&lt;/code&gt;, &lt;code&gt;channel&lt;/code&gt;, &lt;code&gt;subcribe_num&lt;/code&gt;å‡ ä¸ªå­—æ®µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;V - View
å‰ç«¯å±•ç¤º&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;C - Control
æ§åˆ¶å™¨ï¼Œåˆ‡æ¢é¢‘é“ã€åˆ·æ–°ä»¥åŠä¸‹ä¸€é¡µç­‰ä¸æœåŠ¡å™¨ç«¯äº¤äº’çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯´åˆ°å‰ç«¯MVCï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä¸è¯´åˆ°ä¸€ä¸ªJSæ¡†æ¶ â€”â€” AngularJSã€‚&lt;/p&gt;
&lt;h4&gt;AngularJS&lt;/h4&gt;
&lt;p&gt;&lt;img alt="AngularJS" src="http://wizmann-tk-pic.u.qiniudn.com/AngularJS-large.png" /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;AngularJSæ˜¯ä¸€æ¬¾å¼€æº JavaScriptå‡½å¼åº“ï¼Œç”±Googleç»´æŠ¤ï¼Œç”¨æ¥ååŠ©å•ä¸€é¡µé¢åº”ç”¨ç¨‹å¼è¿è¡Œçš„ã€‚å®ƒçš„ç›®æ ‡æ˜¯é€è¿‡MVCæ¨¡å¼ (MVC) åŠŸèƒ½å¢å¼ºåŸºäºæµè§ˆå™¨çš„åº”ç”¨ï¼Œä½¿å¼€å‘å’Œæµ‹è¯•å˜å¾—æ›´åŠ å®¹æ˜“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;AngularJSæ˜¯ä¸€ä¸ªè®¾è®¡éå¸¸å·§å¦™çš„JSæ¡†æ¶ã€‚ç”±äºæˆ‘æ˜¯å‰ç«¯æ–‡ç›²ï¼Œæ‰€ä»¥åªä½¿ç”¨äº†å…¶ä¸­æœ€åŸºç¡€çš„éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨AngularJSä¸Šé¢æˆ‘ä¹Ÿä¸æƒ³å¤šè¯´ä»€ä¹ˆï¼Œå› ä¸ºæ¯”è¾ƒèœã€‚å¤§å®¶å¯ä»¥å‚è€ƒAngularJSçš„æ–‡æ¡£ä»¥åŠChrome Extensionçš„æ–‡æ¡£ã€‚Chrome Extensionå®˜æ–¹ç»™å‡ºçš„èŒƒä¾‹éƒ½æœ‰Javascript/AngularJSä¸¤ä¸ªç‰ˆæœ¬ï¼Œéå¸¸å€¼å¾—å­¦ä¹ ã€‚ï¼ˆäº²å„¿å­å°±æ˜¯ä¸ä¸€æ · ^_^)&lt;/p&gt;
&lt;h3&gt;å‰ç«¯æ¡†æ¶&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢è¯´è¿‡äº†ç”¨åšå‰ç«¯JSæ¡†æ¶çš„AngularJSã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå†è¯´ä¸€ä¸ªæˆ‘ä½¿ç”¨çš„å‰ç«¯CSSæ¡†æ¶ â€”â€” Bootstrap3ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·ï¼Œè¿™ä¸ªä¹Ÿä¸ç”¨å¤šè¯´ï¼Œå› ä¸ºåœ¨å¼€å‘è€…ä¸­ï¼ŒBootstrap2/3å·²ç»éå¸¸æµè¡Œäº†ï¼Œå¯ä»¥æå¤§çš„é™ä½å‰ç«¯å¼€å‘çš„é—¨æ§›ã€‚&lt;/p&gt;
&lt;h3&gt;å±•ç¤ºé€»è¾‘&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡é¦–é¡µçš„å±•ç¤ºé€»è¾‘ã€‚å½“ç”¨æˆ·ç‚¹å‡»é¦–é¡µçš„ä¸€æ¡è®°å½•æ—¶ï¼Œæˆ‘ä»¬å°±è¦ä¸ºç”¨æˆ·å±•ç°ä¸€ç¯‡èŠ‚æ“æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;èŠ‚æ“æ–‡ç« åˆ†ä¸ºä¸¤ç§ï¼Œä¸€æ˜¯å›¾ç‰‡ï¼ŒäºŒæ˜¯éŸ³é¢‘ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºä¸Šé¢è¯´è¿‡çš„dpiå·®å¼‚çš„åŸå› ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¤§çš„æ–°çª—å£æ¥åšå±•ç°ã€‚äºæ˜¯æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;webview&lt;/code&gt;æ¥å±•ç¤ºæœåŠ¡å™¨ç«¯çš„æ–°é¡µé¢ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºæœåŠ¡å™¨ç«¯çš„é¡µé¢ä¸­æ²¡æœ‰å¯¹å£°éŸ³åšæ”¯æŒã€‚ç§»åŠ¨ç«¯Appä¸­çš„å£°éŸ³åœ°å€æ˜¯ä½¿ç”¨Protobufä¼ è¾“ï¼Œç„¶ååœ¨æœ¬åœ°æ’­æ”¾çš„ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹ï¼Œè·å¾—å£°éŸ³çš„çª—å£ä¸å±•ç¤ºé¡µé¢çš„çª—å£ä¸æ˜¯åŒä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªï¼š&lt;/p&gt;
&lt;h4&gt;ä½¿ç”¨å›è°ƒå‡½æ•°ä¼ å…¥å‚æ•°&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;chrome.app.window.create&lt;/code&gt;ä¸­å¯ä»¥ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œä¼ å…¥éŸ³é¢‘åœ°å€ã€‚ç„¶åæ–°çª—å£ä½¿ç”¨&lt;code&gt;&amp;lt;audio&amp;gt;&lt;/code&gt;æ ‡ç­¾è¿›è¡Œæ’­æ”¾ã€‚&lt;/p&gt;
&lt;h4&gt;JSæ³¨å…¥&lt;/h4&gt;
&lt;p&gt;ç”±äºè‰¯å¿ƒçš„èŠ‚æ“å¤§å¤§çš„å¥½ï¼Œåœ¨é¡µé¢ä¸­æä¾›äº†éŸ³é¢‘çš„æ’­æ”¾åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘webviewé‡Œç›´æ¥æ³¨å…¥ä¸€æ®µä»£ç ã€‚å…ˆæ˜¯åˆ›å»ºä¸€ä¸ªä¸å¯è§çš„&lt;code&gt;&amp;lt;audio&amp;gt;&lt;/code&gt;æ ‡ç­¾ï¼Œç„¶ååŠ å…¥ä¸€æ®µjsï¼Œæ’­æ”¾æœ¬é¡µé¢çš„éŸ³é¢‘ã€‚&lt;/p&gt;
&lt;h2&gt;æœªæ¥å¼€å‘æ‰“ç®—&lt;/h2&gt;
&lt;p&gt;èŠ‚æ“çš„é¡µé¢å±•ç¤ºæ˜¯æ£€æŸ¥&lt;code&gt;User-agent&lt;/code&gt;çš„ï¼Œå¯¹äºPCç«¯çš„é¡µé¢ï¼Œæ‰€æœ‰çš„æ¨èé“¾æ¥éƒ½æ˜¯æ— æ•ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰å¯èƒ½çš„è¯ï¼Œå¯ä»¥ä¿®æ”¹&lt;code&gt;webview&lt;/code&gt;çš„&lt;code&gt;User-agent&lt;/code&gt;ä¸ºAndroidè®¾å¤‡ï¼Œè¿™æ ·å°±èƒ½æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰å‰ç«¯ç¡®å®ä¹Ÿæ˜¯æ¯”è¾ƒä¸‘ã€‚ã€‚ã€‚&lt;del&gt;ä½†æ˜¯ä½ æ¥å’¬æˆ‘å‘€ï½&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;æœ€åæ˜¯æˆ‘æ²¡æœ‰Visaå¡ï¼Œæ‰€ä»¥æ²¡æ³•å‘å¸ƒè¿™ä¸ªAppã€‚ã€‚ã€‚æ‰€ä»¥ä¹ƒä»¬å“ªä¸ªåœŸè±ªæœ‰å¼€å‘è€…è´¦å·çš„ï¼Œå¯ä»¥æŠŠè¿™ä¸ªAppæèµ°å†å¼€å‘åšä¸ªå‘å¸ƒã€‚ä¹Ÿæ˜¯æ¯”è¾ƒå¥½çš„ï½&lt;/p&gt;
&lt;h2&gt;æ›´å¤šçš„åºŸè¯&lt;/h2&gt;
&lt;p&gt;æˆ‘åŸæ¥å’ŒåŒå­¦è®¨è®ºè¿‡ï¼Œæœ‰æ²¡æœ‰å¯èƒ½å¼€å‘å‡ºä¸€ä¸ªå«&lt;code&gt;AVM&lt;/code&gt;çš„ä¸œè¥¿ï¼ŒæŠŠAndroidåº”ç”¨è¿ç§»åˆ°PCç«¯æ¥ç”¨ï¼Œè¿™æ ·Linuxå°±ä¸è‡³äºä»€ä¹ˆåº”ç”¨éƒ½æ²¡æœ‰äº†ã€‚ä½†æ˜¯ç°åœ¨æˆ‘è¿˜æ²¡æœ‰çœ‹åˆ°é™¤äº†è¶…ä½æ•ˆç‡çš„è™šæ‹Ÿæœºä¹‹å¤–çš„å…¶å®ƒè§£æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡Googleæ­£åœ¨è¯•éªŒä¸€ç§å«&lt;a href="https://developers.google.com/native-client/dev/"&gt;NaCl&lt;/a&gt;çš„æŠ€æœ¯ï¼Œæ”¯æŒä¸€ä¸ªè½»é‡çš„è™šæ‹Ÿæœºï¼Œè¿è¡Œä¸€ä¸ªæœ¬åœ°åº”ç”¨å¹¶èƒ½ä¸å‰ç«¯å±•ç°äº¤äº’ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æƒ³ï¼Œå¦‚æœæœ‰ä¸€å¤©ï¼ŒNaClèƒ½ç»Ÿä¸€Androidä¸Chromeå¹³å°ï¼Œæˆä¸ºäº†æ™ºèƒ½ç»ˆç«¯å¼€å‘çš„ä¸»æµï¼Œé‚£ä¹ˆå¹³å°ä¸å¹³å°ä¹‹é—´çš„å·®å¼‚å°±æ›´å°äº†å§ã€‚ã€‚ã€‚&lt;/p&gt;</summary><category term="crack"></category><category term="android"></category><category term="app"></category><category term="chrome-extension"></category><category term="protobuf"></category><category term="angularjs"></category></entry><entry><title>GeoHashç®—æ³•</title><link href="http://wizmann.tk/geo-hash-algorithm.html" rel="alternate"></link><updated>2014-02-04T00:10:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-02-04:geo-hash-algorithm.html</id><summary type="html">&lt;h2&gt;GeoHash&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Geohash is a latitude/longitude geocode system invented by Gustavo Niemeyer when writing the web service at geohash.org, and put into the public domain. It is a hierarchical spatial data structure which subdivides space into buckets of grid shape.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç®€å•è¯´ï¼ŒGeoHashæ˜¯ä¸€ä¸ªå°†ç»çº¬åº¦ä¿¡æ¯ç¼–ç æˆä¸€ä¸ªstringçš„ç®—æ³•ã€‚ä»è€Œä¾¿äºå‚¨å­˜ã€æŸ¥æ‰¾ã€‚&lt;/p&gt;
&lt;h2&gt;GeoHashç®—æ³•çš„æ­¥éª¤&lt;/h2&gt;
&lt;p&gt;GeoHashå¯¹ç»åº¦çº¬åº¦åˆ†åˆ«ç¼–ç ï¼ŒåŸç†æ˜¯è¿­ä»£åšäºŒåˆ†ï¼Œè¿›è€Œé€¼è¿‘çœŸå®å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä»¥çº¬åº¦ä¸¾ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåœ°çƒçº¬åº¦åŒºé—´æ˜¯[-90,90]ï¼Œæ‰€ä»¥å–åŒºé—´ä¸­ç‚¹&lt;code&gt;pivot&lt;/code&gt;ã€‚å¦‚æœæŸåœ°ç‚¹Pçš„çº¬åº¦å¤§äº&lt;code&gt;pivot&lt;/code&gt;çš„å€¼ï¼Œåˆ™ç¼–ç çš„ç¬¬1ä½ä¸º&lt;code&gt;1&lt;/code&gt;ï¼Œåä¹‹ä¸º&lt;code&gt;0&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åç¼©å°èŒƒå›´ï¼Œè¿­ä»£Næ¬¡ã€‚å¾—åˆ°æœ€åçš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ç»åº¦çš„èŒƒå›´æ˜¯[-180, 180]ã€‚æˆ‘ä»¬é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ç»åº¦ç¼–ç ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åæˆ‘ä»¬æŠŠç»åº¦å’Œçº¬åº¦çš„ç¼–ç è¿›è¡Œäº¤é”™ç»„åˆï¼Œå¶æ•°ä½æ”¾ç»åº¦ï¼Œå¥‡æ•°ä½æ”¾çº¬åº¦ã€‚å¾—åˆ°æœ€åçš„GeoHashç¼–ç ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œç»çº¬åº¦&lt;code&gt;(57.64911,10.40744)&lt;/code&gt;å¯ä»¥ä½¿ç”¨base32ç¼–ç ä¸º &lt;code&gt;u4pruydqqvj&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2&gt;GeoHashç®—æ³•çš„ç”¨é€”&lt;/h2&gt;
&lt;p&gt;ç”±äºGeoHashä½¿ç”¨ç»çº¬åº¦äº¤é”™ç¼–ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨æŸä¸€ä¸ª&lt;b&gt;å‰è¾&lt;/b&gt;ï¼Œå°±å¯ä»¥åˆ’å®šä¸€ä¸ªç»çº¬åº¦èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="GeoHash-grid" src="http://wizmann-tk-pic.u.qiniudn.com/blog-geohash-grid.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å¯¹GeoHashç¼–ç è¿™ä¸€åˆ—è¿›è¡Œç´¢å¼•åŠ é€Ÿï¼Œåˆ™å¯ä»¥åœ¨è¾ƒå¿«çš„æ—¶é—´å†…æŸ¥æ‰¾åˆ°æŸä¸€ä¸ªèŒƒå›´å†…çš„æ‰€æœ‰gridï¼Œè¿›è€Œè·å¾—POIç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2&gt;GeoHashçš„å‹ç¼©æ€æƒ³&lt;/h2&gt;
&lt;p&gt;GeoHashçš„äº¤é”™ç¼–ç ä¸ºåŒºé—´æŸ¥æ‰¾æä¾›äº†éå†ã€‚è€Œå¯¹ç»çº¬åº¦çš„é€¼è¿‘ç¼–ç åˆ™æä¾›äº†éå¸¸å¥½çš„å‹ç¼©ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ˜“å¾—ï¼Œä¸€ä¸ªç‚¹ä½äº&lt;code&gt;pivot&lt;/code&gt;çš„å·¦å³/ä¸Šä¸‹çš„æœºç‡æ˜¯ç›¸åŒçš„ã€‚æ‰€ä»¥ç¼–ç çš„æ¯ä¸€ä½çš„ä¿¡æ¯é‡éƒ½æ˜¯&lt;code&gt;-logPr[s]&lt;/code&gt;=&amp;gt;&lt;code&gt;1bit&lt;/code&gt;ï¼Œè¾¾åˆ°äº†æ•°æ®å‹ç¼©çš„ä¸‹é™ã€‚&lt;/p&gt;
&lt;p&gt;åˆç”±äºäºŒåˆ†é€¼è¿‘çš„è‰¯å¥½æ€§èƒ½ï¼Œä½¿å¾—å‹ç¼©/è§£å‹ç¼©çš„é€Ÿåº¦å¯ä»¥è¾¾åˆ°æé™ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒPOIä¸å¯èƒ½å®Œå…¨å¹³å‡åˆ†å¸ƒï¼Œæ‰€ä»¥GeoHashçš„å‹ç¼©åªæ˜¯ä¸€ç§æ¥è¿‘æœ€ä¼˜è§£çš„æ–¹æ¡ˆã€‚ä½†æ˜¯ç”±äºäºŒåˆ†é€¼è¿‘æ³•å¸¦æ¥çš„å¯ç´¢å¼•æ€§ï¼ŒGeoHashç»å¯¹å¯ä»¥ç§°çš„ä¸Šæ˜¯ä¸€ä¸ªç²¾å¦™å®Œç¾çš„è®¾è®¡äº†ã€‚&lt;/p&gt;
&lt;h2&gt;åº”ç”¨ - æ‹‰å–ç›®æ ‡å‘¨å›´çš„POI&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ä¸€äº›LBSåº”ç”¨ä¸­ï¼Œç»å¸¸éœ€è¦æ‹‰å–æŸä¸€ç‚¹å‘¨å›´çš„POIã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬å°†POIå­˜å‚¨ä¸ºä¸€ä¸ª&lt;code&gt;pvlist&lt;/code&gt;æ˜ å°„ã€‚å¹¶ä¸”è·å¾—äº†æŸç‚¹çš„GeoHashå€¼ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå–å¾—å‘¨å›´çš„POIå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç†æƒ³çŠ¶æ€ä¸‹ï¼Œâ€œé™„è¿‘çš„POIâ€éƒ½æ˜¯åœ¨ä¸€ä¸ªä»¥æŸç‚¹ä¸ºåœ†å¿ƒçš„åœ†è¿›è¡ŒæŸ¥æ‰¾ã€‚ä½†æ˜¯ç”±äºGeoHashåˆ’åˆ†çš„èŒƒå›´æ˜¯ä¸€ä¸ªçŸ©å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª&lt;code&gt;3Ã—3&lt;/code&gt;çš„å¤§çŸ©å½¢æ¥æ›¿ä»£åœ†å½¢èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­&lt;code&gt;3Ã—3&lt;/code&gt;çŸ©å½¢ä¸­æœ€ä¸­é—´çš„çŸ©å½¢æ˜¯æˆ‘ä»¬ç¡®å®šçš„é‚£ä¸ªç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬æ ¹æ®ç»™å‡ºçš„åŠå¾„&lt;code&gt;r&lt;/code&gt;ç¡®å®šGeoHashçš„ç²¾ç¡®åº¦ã€‚ä½¿å¾—æˆ‘ä»¬çš„&lt;code&gt;3Ã—3&lt;/code&gt;å¤§çŸ©å½¢å¯ä»¥åŒ…å«ç†æƒ³çš„åœ†å½¢èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ä¸‹ä¸€æ­¥çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°æŸç‚¹GeoHashçš„&lt;strong&gt;8ä¸ª&lt;/strong&gt;ä¸´è¿‘çš„GeoHashã€‚&lt;/p&gt;
&lt;p&gt;ç”±ä¸Šæ–‡æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼ŒGeoHashçš„ç»çº¬åº¦æ˜¯åˆ†åˆ«ç¼–ç çš„ã€‚ä»¥ä¸€ä¸ª&lt;code&gt;4Ã—4&lt;/code&gt;çš„åœ°å›¾ä¸ºä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯åœ¨çº¬åº¦ä¸Šçš„åˆ’åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="çº¬åº¦" src="http://wizmann-tk-pic.u.qiniudn.com/blog-geohash-latitude-grid.png" /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œè¿ç»­çš„&lt;code&gt;GeoHash Grid&lt;/code&gt;çš„çº¬åº¦ç¼–ç ä¹Ÿæ˜¯è¿ç»­çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç»åº¦åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦&lt;code&gt;decode&lt;/code&gt;æˆ‘ä»¬çš„GeoHashç¼–ç ï¼Œå°†&lt;code&gt;longitude&lt;/code&gt;å’Œ&lt;code&gt;latitude&lt;/code&gt;ç¼–ç åˆ†åˆ«è¿›è¡Œ&lt;code&gt;-1/+1&lt;/code&gt;çš„æ“ä½œå°±å¯ä»¥è·å¾—&lt;strong&gt;é™„è¿‘çš„POI&lt;/strong&gt;çš„GeoHashç /å‰è¾äº†ã€‚&lt;/p&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;GeoHashçš„ä¸‰ä¸ªç‰¹æ€§ï¼Œ&lt;b&gt;å¯ç´¢å¼•&lt;/b&gt;ï¼Œ&lt;b&gt;å‹ç¼©&lt;/b&gt;ï¼Œ&lt;b&gt;ä¾¿äºå­˜å‚¨&lt;/b&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ï¼Œå¥½ä¹…ä¸å†™æ–‡äº†ã€‚&lt;/p&gt;
&lt;h2&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://book.douban.com/subject/11554138/"&gt;HBase in Action&lt;/a&gt;, Chpt. 8&lt;/li&gt;
&lt;li&gt;&lt;a href="http://book.douban.com/subject/3729518/"&gt;æ·±å…¥æœç´¢å¼•æ“&lt;/a&gt;, Chpt. 2&lt;/li&gt;
&lt;li&gt;&lt;a href="http://en.wikipedia.org/wiki/Geohash"&gt;GeoHash - Wikipedia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.cnblogs.com/LBSer/p/3310455.html"&gt;GeoHashæ ¸å¿ƒåŸç†è§£æ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://code.google.com/p/python-geohash/"&gt;python-geohash&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="GeoHash"></category><category term="POI"></category><category term="å‹ç¼©"></category><category term="ç´¢å¼•"></category></entry><entry><title>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç½‘ç«™çš„åœ°ç†ä¿¡æ¯</title><link href="http://wizmann.tk/find-the-geo-location-of-a-host.html" rel="alternate"></link><updated>2014-01-24T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-01-24:find-the-geo-location-of-a-host.html</id><summary type="html">&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;é¢è¯•é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œå¦‚ä½•åˆ¤æ–­è¿™ä¸ªç½‘ç«™çš„åœ°ç†ä¿¡æ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;æ–¹æ³•&lt;/h2&gt;
&lt;h3&gt;ä½¿ç”¨åå‘DNS&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬åªæœ‰ç½‘ç«™çš„IPåœ°å€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;strong&gt;åå‘DNS&lt;/strong&gt;æ¥è·å¾—è¿™ä¸ªIPåœ°å€å¯¹åº”çš„åŸŸåã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åå‘åŸŸåè§£æï¼ŒReverse DNSã€‚åå‘åŸŸåè§£æä¸é€šå¸¸çš„æ­£å‘åŸŸåè§£æç›¸åï¼Œæä¾›IPåœ°å€åˆ°åŸŸåçš„å¯¹åº”ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code&gt;dig -x&lt;/code&gt;æ¥è¿›è¡ŒæŸ¥è¯¢&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;dig -x 75.126.43.235

&lt;span class="p"&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.8.1-P1 &amp;lt;&amp;lt;&amp;gt;&amp;gt; -x 75.126.43.235
&lt;span class="p"&gt;;;&lt;/span&gt; global options: +cmd
&lt;span class="p"&gt;;;&lt;/span&gt; Got answer:
&lt;span class="p"&gt;;;&lt;/span&gt; -&amp;gt;&amp;gt;HEADER&lt;span class="s"&gt;&amp;lt;&amp;lt;- opco&lt;/span&gt;de: QUERY, status: NOERROR, id: 26688
&lt;span class="p"&gt;;;&lt;/span&gt; flags: qr rd ra&lt;span class="p"&gt;;&lt;/span&gt; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

&lt;span class="p"&gt;;;&lt;/span&gt; QUESTION SECTION:
&lt;span class="p"&gt;;&lt;/span&gt;235.43.126.75.in-addr.arpa.    IN  PTR

&lt;span class="p"&gt;;;&lt;/span&gt; ANSWER SECTION:
235.43.126.75.in-addr.arpa. &lt;span class="m"&gt;3518&lt;/span&gt; IN PTR 75.126.43.235-static.reverse.softlayer.com.

&lt;span class="p"&gt;;;&lt;/span&gt; Query &lt;span class="nb"&gt;time&lt;/span&gt;: &lt;span class="m"&gt;76&lt;/span&gt; msec
&lt;span class="p"&gt;;;&lt;/span&gt; SERVER: 8.8.4.4#53&lt;span class="o"&gt;(&lt;/span&gt;8.8.4.4&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; WHEN: Fri Jan &lt;span class="m"&gt;24&lt;/span&gt; 18:15:22 2014
&lt;span class="p"&gt;;;&lt;/span&gt; MSG SIZE  rcvd: 100
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä»æ¥ç»­å‡ºæ¥çš„åŸŸåä¸­ï¼Œè·å¾—ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚å…¬å¸å/æœºæ„åï¼Œä»¥åŠ&lt;code&gt;.cn&lt;/code&gt;, &lt;code&gt;.us&lt;/code&gt;ç­‰æœ‰å¯èƒ½æ ‡è¯†åœ°ç†ä½ç½®çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œåå‘DNSä¸ä¸€å®šæˆåŠŸã€‚&lt;/p&gt;
&lt;h2&gt;æŸ¥è¯¢DNS LOCä¿¡æ¯&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;In the Domain Name System, a LOC record (RFC 1876) is a means for expressing geographic location information for a domain name.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨&lt;code&gt;dig loc&lt;/code&gt;å‘½ä»¤æ¥æŸ¥è¯¢ä½ç½®ä¿¡æ¯ã€‚ï¼ˆä¸ä¸€å®šæˆåŠŸ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;dig loc SW1A2AA.find.me.uk

&lt;span class="p"&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.8.1-P1 &amp;lt;&amp;lt;&amp;gt;&amp;gt; loc SW1A2AA.find.me.uk
&lt;span class="p"&gt;;;&lt;/span&gt; global options: +cmd
&lt;span class="p"&gt;;;&lt;/span&gt; Got answer:
&lt;span class="p"&gt;;;&lt;/span&gt; -&amp;gt;&amp;gt;HEADER&lt;span class="s"&gt;&amp;lt;&amp;lt;- opco&lt;/span&gt;de: QUERY, status: NOERROR, id: 49682
&lt;span class="p"&gt;;;&lt;/span&gt; flags: qr rd ra&lt;span class="p"&gt;;&lt;/span&gt; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

&lt;span class="p"&gt;;;&lt;/span&gt; QUESTION SECTION:
&lt;span class="p"&gt;;&lt;/span&gt;SW1A2AA.find.me.uk.        IN  LOC

&lt;span class="p"&gt;;;&lt;/span&gt; ANSWER SECTION:
SW1A2AA.find.me.uk. &lt;span class="m"&gt;21600&lt;/span&gt;   IN  LOC &lt;span class="m"&gt;51&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt; 12.748 N &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;7&lt;/span&gt; 39.611 W 0.00m 0.00m 0.00m 0.00m

&lt;span class="p"&gt;;;&lt;/span&gt; Query &lt;span class="nb"&gt;time&lt;/span&gt;: &lt;span class="m"&gt;1232&lt;/span&gt; msec
&lt;span class="p"&gt;;;&lt;/span&gt; SERVER: 8.8.4.4#53&lt;span class="o"&gt;(&lt;/span&gt;8.8.4.4&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; WHEN: Fri Jan &lt;span class="m"&gt;24&lt;/span&gt; 18:21:44 2014
&lt;span class="p"&gt;;;&lt;/span&gt; MSG SIZE  rcvd: 64
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;éšä¾¿çœ‹çœ‹&lt;/h2&gt;
&lt;p&gt;æŸ¥çœ‹æˆ‘ä»¬è¦è°ƒæŸ¥çš„ç½‘ç«™ï¼Œæ‰¾å¯»å¯ç”¨çš„çº¿ç´¢ã€‚ï¼ˆå›§&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨whoisæœåŠ¡&lt;/h2&gt;
&lt;p&gt;http://whois.chinaz.com/sina.com&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŸŸåçš„æ³¨å†Œä¿¡æ¯ï¼Œå…¶ä¸­ä¹Ÿå¿…ç„¶é€éœ²äº†çº¿ç´¢ã€‚&lt;/p&gt;
&lt;h2&gt;tracerouteä¸whoisé…åˆä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;å¯ä»¥æ ¹æ®åŒ…çš„è½¬å‘çŠ¶å†µæ¥è·å¾—æœ€ç»ˆçš„åœ°ç†ä½ç½®&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨Time of day service&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;telnet www.bupt.edu.cn 13&lt;/code&gt;å¯ä»¥è·å¾—ä¸»æœºçš„å½“å‰æ—¶é—´ï¼Œä»è€Œåˆ¤æ–­ä¸»æœºæ‰€åœ¨çš„ç»åº¦ã€‚ï¼ˆä¸ä¸€å®šæˆåŠŸã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2&gt;å‚è€ƒé“¾æ¥&lt;/h2&gt;
&lt;p&gt;http://www.private.org.il/IP2geo.html&lt;/p&gt;
&lt;p&gt;http://www.ipgeo.com/&lt;/p&gt;</summary><category term="é¢è¯•"></category></entry><entry><title>Codeforces Round #223 (Div. 2) ä¸å®Œå…¨ä¸æ­£ç¡®é¢˜è§£</title><link href="http://wizmann.tk/cf-223-div-2.html" rel="alternate"></link><updated>2014-01-18T14:47:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-01-18:cf-223-div-2.html</id><summary type="html">&lt;p&gt;ç”±äºå¤§å·å·²ç»è¿›Div. 1äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„å‡ åœºDiv. 2éƒ½æ˜¯ç”¨å°å·åšçš„ã€‚&lt;/p&gt;
&lt;p&gt;ç­‰æœ‰å®åŠ›åˆ‡Dé¢˜äº†ï¼Œå†å»æ‰“ä¸€åŒºã€‚ï¼ˆå¼±&lt;/p&gt;
&lt;p&gt;äº‹æƒ…ä¸€ç›´å¾ˆå¤šï¼Œæ‰€ä»¥é¢˜è§£è½åäº†å¥½ä¹…æ‰å‘ã€‚&lt;/p&gt;
&lt;h2&gt;A. Sereja and Dima&lt;/h2&gt;
&lt;p&gt;çº¯æ¨¡æ‹Ÿï¼ŒPythonéšä¾¿æ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;pokers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pokers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pokers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
        &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;pokers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;pokers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;pokers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;pokers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. Sereja and Stairs&lt;/h2&gt;
&lt;p&gt;é¢˜ç›®è¦æ±‚å®ç°ä¸€ä¸ªæ•°ç»„ï¼Œä½¿å‰ä¸€åŠä¸ºé€’å¢ï¼Œåä¸€åŠä¸ºé€’å‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;a[1]â€‰&amp;lt;â€‰a[2]â€‰&amp;lt;â€‰...â€‰&amp;lt;â€‰a[iâ€‰-â€‰1]â€‰&amp;lt;â€‰a[i]â€‰&amp;gt;â€‰a[iâ€‰+â€‰1]â€‰&amp;gt;â€‰...â€‰&amp;gt;â€‰a[n - â€‰1]â€‰&amp;gt;â€‰a[n]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼ŒæŸä¸€ä¸ªæ•°&lt;code&gt;x&lt;/code&gt;åœ¨æ•°ç»„&lt;code&gt;a&lt;/code&gt;ä¸­æœ€å¤šå¯ä»¥å‡ºç°ä¸¤æ¬¡ï¼Œå…¶ä¸­ä¸€æ¬¡åœ¨å·¦è¾¹çš„åºåˆ—ï¼Œä¸€æ¬¡åœ¨å³è¾¹çš„åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å°±å¯¹ç»™å‡ºçš„æ•°ç»„&lt;code&gt;s&lt;/code&gt;è¿›è¡Œä¸€æ¬¡ç»Ÿè®¡ï¼Œæ‰¾å‡ºæ¯ä¸€ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶åˆ†åˆ«è®¨è®ºå‡ºç°ä¸€æ¬¡å’Œå‡ºç°ä¸¤æ¬¡çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5120&lt;/span&gt;

&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;cards&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="n"&gt;maxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;cards&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;maxi&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Sereja and Prefixes&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªç©ºåºåˆ—&lt;code&gt;A&lt;/code&gt;ï¼Œç„¶åè¿™ä¸ªåºåˆ—ä¸Šå¯ä»¥æœ‰ä¸¤ç§æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ˜¯&lt;code&gt;A.push_back(x)&lt;/code&gt;ï¼ŒäºŒæ˜¯&lt;code&gt;A.push_back_batch(A[0]...A[i])&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ“ä½œçš„æ¬¡æ•°æ˜¯&lt;code&gt;10^5&lt;/code&gt;ï¼Œäºæ˜¯æˆ‘ä»¬å°†åºåˆ—&lt;code&gt;A&lt;/code&gt;å­˜æˆä¸€ä¸ªå¦‚ä¸‹çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;a -&amp;gt; b -&amp;gt; c -&amp;gt; copy(0...i) -&amp;gt; d -&amp;gt; copy(0 ... j)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœè¯¢é—®çš„ä½ç½®&lt;code&gt;pos&lt;/code&gt;æ˜¯ä¸€ä¸ªæ•°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å›ç»“æœã€‚å¦‚æœè¯¢é—®çš„ä½ç½®&lt;code&gt;pos&lt;/code&gt;ä½äºä¸€ä¸ª&lt;code&gt;copy&lt;/code&gt;å—é‡Œé¢ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°ä¸€å®šä¼šåœ¨&lt;code&gt;A[0...i]&lt;/code&gt;ä¸­å‡ºç°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¤„ç†&lt;code&gt;pos&lt;/code&gt; -&amp;gt; &lt;code&gt;pos'&lt;/code&gt;ï¼Œä½¿&lt;code&gt;pos'&lt;/code&gt;ä½äº&lt;code&gt;A[0...i]&lt;/code&gt;åŒºé—´å†…ã€‚å¦‚æ­¤å¾ªç¯ï¼Œç›´åˆ°&lt;code&gt;pos&lt;/code&gt;æ˜¯ä¸€ä¸ªæ•°ä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè¿™é¢˜ç”¨çš„ç®—æ³•è²Œä¼¼ä¸æ˜¯æœ€å¿«çš„ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æ˜¯æœ€å¥½ç†è§£çš„ä¸€ç§ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸€ä¸ªå¤§æ ¹å †å¾ªç¯å–&lt;code&gt;query&lt;/code&gt;ä¸­æœ€å¤§çš„å€¼ï¼Œç„¶åè¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;map&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100010&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rep&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ist&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ist&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;prefix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;rep&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ist&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ist&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;prefix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;rep&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;

    &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;is_value&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;rep&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;iv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;iq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iv&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iq&lt;/span&gt;&lt;span class="p"&gt;){}&lt;/span&gt;

    &lt;span class="k"&gt;friend&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="n"&gt;priority_queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ask&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;is_value&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;ask&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;pq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%lld&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ask&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Sereja and Tree&lt;/h2&gt;
&lt;p&gt;æš´åŠ›ä¹±æï¼Œå› ä¸ºæ ‘çš„é«˜åº¦åªæœ‰7000ï¼Œæ‰€ä»¥æ€ä¹ˆæéƒ½å¤§æ¦‚èƒ½è¿‡ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆåšçš„äººå¥½å°‘ã€‚&lt;/p&gt;
&lt;p&gt;å¯èƒ½æ˜¯é¢˜ç›®è¡¨è¿°çš„ä¸å¤ªå¥½å§ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;map&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stack&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;set&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;7010&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;LINE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;501000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ival&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ir&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ival&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;LINE&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;LINE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;intersect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;LINE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ll&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;ins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;intersect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;ll&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;rr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tp&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;ins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;E. Sereja and Brackets&lt;/h2&gt;
&lt;p&gt;ä¸å‡ºæ„å¤–çš„åˆçœ‹é”™é¢˜äº†ã€‚ã€‚ã€‚_(:Ğ·ã€âˆ )_&lt;/p&gt;
&lt;p&gt;æœ€é•¿çš„æ‹¬å·åŒºé—´å±…ç„¶æ˜¯å¯ä»¥åœ¨ä¸­é—´åˆ é™¤ä¸€äº›æ‹¬å·çš„åŒºé—´ã€‚è¿™æ ·é¢˜ç›®å°±å˜æˆäº†ä¸€é“æ¯”è¾ƒç®€å•çš„&lt;code&gt;ç¦»çº¿åŒ–+æ ‘çŠ¶æ•°ç»„&lt;/code&gt;äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;map&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stack&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;ppair&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;iid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ir&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;

    &lt;span class="k"&gt;friend&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;lowbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;BIT&lt;/span&gt;&lt;span class="c1"&gt;//ç‚¹æ›´æ–°ï¼ŒåŒºé—´æŸ¥è¯¢&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;baum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;baum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;baum&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;baum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;lowbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;baum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;-=&lt;/span&gt;&lt;span class="n"&gt;lowbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="c1"&gt;//æŸ¥è¯¢åŒºé—´å’Œ&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;ss&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ss&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ss&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;(&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;)&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
    &lt;span class="n"&gt;BIT&lt;/span&gt; &lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;    

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ss&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ppair&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;iter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;iter&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;iter&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>ç”¨Misakaåšä¸ºpelicançš„Markdownè§£æå™¨</title><link href="http://wizmann.tk/misaka-pelican.html" rel="alternate"></link><updated>2014-01-09T14:55:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-01-09:misaka-pelican.html</id><summary type="html">&lt;h2&gt;ä¸ºå•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Pelicanå†…ç½®&lt;a href="http://pythonhosted.org/Markdown/"&gt;python-markdown&lt;/a&gt;åšä¸ºé»˜è®¤è§£æå™¨ï¼Œç”¨æ¥å°†ç”¨æˆ·çš„&lt;code&gt;Markdown&lt;/code&gt;æ ¼å¼çš„æ–‡ç« è½¬ä¸ºç½‘é¡µæ ¼å¼å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç„¶è€Œ&lt;/strong&gt;ï¼Œ&lt;code&gt;python-markdown&lt;/code&gt;æ¨¡å—çš„è§£æé€»è¾‘æœ‰ä¸¥é‡çš„Bugã€‚ä¾‹å¦‚ä¸€ä¸ª&lt;code&gt;æœªæ ‡æ˜è¯­è¨€çš„ä»£ç å—&lt;/code&gt;ä¼šè¢«æ ‡å‡ºå¾ˆå¤šè«åå¥‡å¦™çš„é”™è¯¯ï¼›è¿˜æœ‰&lt;code&gt;C++&lt;/code&gt;ä¸­çš„æŒ‡é’ˆç¬¦å·&lt;code&gt;*&lt;/code&gt;ä¼šè¢«è§£æä¸ºæ–œä½“çš„ç¬¦å·&lt;code&gt;*SomeText*&lt;/code&gt;ï¼Œåœ¨ä»£ç å—ä¸­ä¼šäº§ç”Ÿå¤§é‡å’Œè¯­æ³•é«˜äº®æ— å…³çš„æ–œä½“å­—ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç½‘ä¸Šå¯»æ‰¾äº†å¾ˆä¹…çš„ç­”æ¡ˆï¼Œç»ˆäºæ‰¾åˆ°äº†ä¸€ç¯‡&lt;a href="http://qiita.com/5t111111/items/4614b207f3942d05e55c"&gt;æ—¥æ–‡åšå®¢&lt;/a&gt;ï¼Œå…¶ä¸­è®²åˆ°äº†ä½¿ç”¨&lt;a href="http://misaka.61924.nl/"&gt;misaka&lt;/a&gt;æ¥æ›¿æ¢&lt;code&gt;python-markdown&lt;/code&gt;æ¥è§£ææ—¥å¿—ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸¤éš¾çš„Metadata&lt;/h2&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨äº†ä¸Šæ–‡æåˆ°çš„æ—¥å¿—ä¸­çš„æ–¹æ³•æ¥æ›¿æ¢è§£æå™¨ï¼Œæ•ˆæœæ‹”ç¾¤ï¼Œæ—¥å¿—ä¸­çš„è§£æé—®é¢˜å®Œå…¨è§£å†³äº†ã€‚ä½†æ˜¯æ—¥å¿—ä¸­çš„&lt;code&gt;Metadata&lt;/code&gt;å¹¶æ²¡æœ‰è¢«éšè—ï¼Œè€Œæ˜¯æ˜¾ç¤ºåœ¨äº†æ—¥å¿—çš„æœ€å‰é¢ï¼Œéå¸¸å½±å“å¿ƒæƒ…ï¼ˆå¼ºè¿«ç—‡ï¼Ÿï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘åˆ†æäº†è§£ææ¨¡å—çš„ä»£ç ã€‚åŸæ¥çš„è§£ææ¨¡å—ä½¿ç”¨äº†&lt;code&gt;python-markdown&lt;/code&gt;çš„ä¸€ä¸ªå¤„ç†&lt;code&gt;Metadata&lt;/code&gt;çš„&lt;a href="https://github.com/waylan/Python-Markdown/blob/master/markdown/extensions/meta.py"&gt;æ‰©å±•&lt;/a&gt;ï¼Œç”¨æ¥è§£æ&lt;code&gt;Metadata&lt;/code&gt;ï¼Œå¹¶ä»æ­£æ–‡ä¸­åˆ é™¤è¿™ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯&lt;code&gt;Misaka&lt;/code&gt;å¹¶ä¸æ”¯æŒè¿™ç§è¯­æ³•ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰å¤„ç†&lt;code&gt;Metadata&lt;/code&gt;çš„æ’ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘æƒ³å¯ä¸å¯ä»¥æŠŠè¿™ä¸¤ç§&lt;code&gt;Markdown&lt;/code&gt;è§£æå™¨çš„é•¿å¤„åˆå¹¶ä¸€ä¸‹ï¼Œä»è€Œå®ç°æœ€ç»ˆçš„ç›®æ ‡ã€‚&lt;/p&gt;
&lt;h2&gt;å°å°çš„æ”¹åŠ¨&lt;/h2&gt;
&lt;p&gt;ç¼–è¾‘&lt;code&gt;pelican&lt;/code&gt;çš„&lt;code&gt;readers.py&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆæˆ‘æ˜¯ç›´æ¥æ”¹çš„&lt;code&gt;/usr/local/lib/python2.7/dist-packages/pelican&lt;/code&gt;ä¸‹çš„æ–‡ä»¶ï¼Œä¸å¤ªä¼˜é›…ï¼Œä¸è¿‡è¿™ä¸ªæ”¹åŠ¨ä¹Ÿæ˜¯éå¸¸Dirtyçš„ï¼Œåªæ˜¯ç”¨æ¥è§£å†³é—®é¢˜ï¼‰&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¼•ç”¨&lt;code&gt;Misaka&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;markdown&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Markdown&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;misaka&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pygments&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;Markdown&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;  &lt;span class="c"&gt;# NOQA&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å†ä¿®æ”¹&lt;code&gt;class MarkdownReader&lt;/code&gt;ï¼Œæ”¹å˜è§£æé€»è¾‘&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Parse content and metadata of markdown files&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

        &lt;span class="c"&gt;#æå–Metadata&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_md&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Markdown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;extensions&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extensions&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;pelican_open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_md&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;metadata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_parse_metadata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_md&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c"&gt;#è‡ªå®šä¹‰Misakaè§£æå™¨&lt;/span&gt;
        &lt;span class="n"&gt;renderer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BleepRenderer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;misaka_md&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;misaka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Markdown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;renderer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="n"&gt;extensions&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;misaka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EXT_FENCED_CODE&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;misaka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EXT_NO_INTRA_EMPHASIS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;misaka_content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;misaka_md&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;misaka_content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;metadata&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„&lt;code&gt;Misaka&lt;/code&gt;è§£æå™¨ï¼Œç”¨æ¥å»é™¤&lt;code&gt;Metadata&lt;/code&gt;ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;è¿™æ®µä»£ç æ˜¯åŸºäºä¸Šæ–‡è¯´çš„é‚£ç¯‡æ—¥å¿—å’Œ&lt;code&gt;Misaka&lt;/code&gt;çš„å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰é—®é¢˜çš„è¯å¯ä»¥å»æŸ¥é˜…ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BleepRenderer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;misaka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HtmlRenderer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;misaka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SmartyPants&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c"&gt;#é¢„å¤„ç†å‡½æ•°&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;preprocess&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c"&gt;#ä½¿ç”¨ä¸€ä¸ªFakeClassæ¥éª—è¿‡å¯¹è±¡å…ƒç´ çš„æ£€æŸ¥&lt;/span&gt;
        &lt;span class="c"&gt;#åŒæ—¶æˆ‘ä»¬åªæ˜¯åˆ é™¤Metadataï¼Œå¹¶ä¸ä½¿ç”¨å®ƒï¼Œæ‰€ä»¥è¿™æ ·çš„ä¿®æ”¹æ˜¯å¯ä»¥æ¥å—çš„&lt;/span&gt;
        &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;FakeClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Meta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
        &lt;span class="c"&gt;#è°ƒç”¨Markdownçš„æ’ä»¶æ¥å¤„ç†Metadata&lt;/span&gt;
        &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;markdown&lt;/span&gt;
        &lt;span class="n"&gt;mp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;markdown&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extensions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MetaPreprocessor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;markdown&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FakeClass&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;lines&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c"&gt;#å‘Šè¯‰Misakaå¦‚ä½•å¤„ç†ä»£ç ï¼Œä½¿ç”¨pygmentsè¿›è¡Œé«˜äº®å¤„ç†&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;block_code&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;escape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;lexer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pygments&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lexers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_lexer_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stripall&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;formatter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pygments&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;formatters&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HtmlFormatter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pygments&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;highlight&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lexer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç»“è¯­&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªä¿®æ”¹çœŸTMD&lt;strong&gt;ç³™å¿«çŒ›&lt;/strong&gt;å•Šï¼&lt;/p&gt;
&lt;h2&gt;æ–‡ä»¶ä¸‹è½½&lt;/h2&gt;
&lt;p&gt;ä¿®æ”¹å¥½çš„&lt;code&gt;readers.py&lt;/code&gt;æ–‡ä»¶ï¼š
&lt;a href="https://s.yunio.com/_Lt!Lb"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;</summary><category term="markdown"></category><category term="misaka"></category><category term="pelican"></category><category term="ç³™å¿«çŒ›"></category><category term="metadata"></category></entry><entry><title>è¯»ä¹¦ - ã€ŠHead first è®¾è®¡æ¨¡å¼ã€‹</title><link href="http://wizmann.tk/read-head-first-design-pattern.html" rel="alternate"></link><updated>2014-01-03T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-01-03:read-head-first-design-pattern.html</id><summary type="html">&lt;p&gt;&lt;img alt="Head firstè®¾è®¡æ¨¡å¼" src="http://img5.douban.com/lpic/s2686916.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://book.douban.com/subject/2243615/"&gt;è±†ç“£è¯»ä¹¦&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¯»è¿™æœ¬ä¹¦&lt;/h2&gt;
&lt;p&gt;åœ¨é¢XXå®¶çš„æ—¶å€™ï¼Œè¢«é—®è¿‡ä¸€ä¸ªè®¾è®¡æ¨¡å¼é—®é¢˜ã€‚å½“æ—¶è¿é¢å‘å¯¹è±¡éƒ½æä¸æ‡‚ï¼Œæ›´ä¸ç”¨è¯´è®¾è®¡æ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯å…¥äº†â€œå››äººå¸®â€çš„&lt;a href="http://book.douban.com/subject/1052241/"&gt;è®¾è®¡æ¨¡å¼&lt;/a&gt;æ¥çœ‹ï¼Œè¢«é‡Œé¢çš„å†…å®¹å½»åº•ææ™•ã€‚ç„¶ååªèƒ½æ‰¾äº†è¿™æœ¬çœ‹èµ·æ¥å¾ˆå¨±ä¹åŒ–çš„ä¹¦æ¥è¯»ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æœ¬ä¹¦å¤§æ¦‚æœ‰600å¤šé¡µï¼Œæ¯”â€œå››äººå¸®â€ä¹¦åšå¾ˆå¤šã€‚ä¸€ä¸ªåŸå› æ˜¯è¿™æœ¬ä¹¦æ˜¯â€œèŒƒä¾‹é©±åŠ¨â€çš„ï¼ŒåŒ…å«å¾ˆå¤šâ€œé¡¹ç›®â€èƒŒæ™¯ä»‹ç»ï¼Œä»¥åŠå®ç°æ€è·¯ï¼›ç¬¬äºŒä¸ªåŸå› æ˜¯ï¼Œè¿™æœ¬ä¹¦çš„ç¤ºä¾‹ä»£ç ç”¨çš„æ˜¯&lt;strong&gt;Java&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆç¬‘ï¼Œä¸é»‘äº†å¥½å˜›ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¦è®¾è®¡æ¨¡å¼&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸–ç•Œå”¯ä¸€ä¸å˜çš„ï¼Œå°±æ˜¯å˜åŒ–&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ï¼ˆæ²¡æœ‰é€¼æ ¼çš„äººè¿åäººåè¨€éƒ½å¼•ç”¨ä¸å¥½ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä»£ç æ€»æ˜¯éœ€è¦ä¸æ–­çš„æ”¹å˜æ¥é€‚åº”ç°å®ä¸–ç•Œä¸­ä¸æ–­çš„å˜åŒ–ã€‚ï¼ˆçƒ§æ­»é‚£ä¸ªPMï¼ï¼‰&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦ä¸€ç§&lt;code&gt;å¯¹ä»£ç å½±å“æœ€å°&lt;/code&gt;çš„æ–¹å¼æ¥ä¿®æ”¹è½¯ä»¶ä»¥é€‚åº”å˜åŒ–ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„åŸå› ã€‚&lt;/p&gt;
&lt;h2&gt;â€œå†…éšçŸ¥è¯†â€&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è®¾è®¡æ¨¡å¼æœ‰äº†åå­—ï¼Œäººä»¬å°±å¯ä»¥è®¤è¯†åˆ°å®ƒçš„å­˜åœ¨ã€‚å¯¹äºæ²¡æœ‰åå­—çš„ä¸œè¥¿ï¼Œäººä»¬å‡ ä¹ä¸å¯èƒ½è®¤è¯†åˆ°å®ƒçš„å­˜åœ¨ï¼Œå¹¶å¯¹ä¹‹è¿›è¡Œè®¨è®ºã€‚è¿™ç§ä¸èƒ½ç”¨è¯­è¨€è¡¨è¾¾çš„çŸ¥è¯†æˆ‘ä»¬ç§°ä¹‹ä¸ºå†…éšçŸ¥è¯†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…¶å®æˆ‘ä»¬åœ¨å†™ç¨‹åºçš„æ—¶å€™ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ç”¨åˆ°äº†â€œè®¾è®¡æ¨¡å¼â€ï¼Œåªæ˜¯æˆ‘ä»¬æ²¡æœ‰æ„è¯†åˆ°è€Œå·²ã€‚&lt;/p&gt;
&lt;p&gt;è€Œè®¡ç®—æœºç§‘å­¦å®¶æ€»ç»“å‡ºäº†è®¾è®¡æ¨¡å¼ï¼Œä½¿å…¶ä»&lt;code&gt;å†…éšçŸ¥è¯†&lt;/code&gt;æˆ–&lt;code&gt;ç»éªŒè®º&lt;/code&gt;çš„èŒƒç•´ä¸­è„±ç¦»å‡ºæ¥ï¼Œæˆä¸ºçœŸæ­£å¯ä»¥è®¨è®ºã€å­¦ä¹ ã€è¿ç”¨çš„çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;h2&gt;è¯»ä¹¦å½“ä¸­çš„ç¼ºæ†¾&lt;/h2&gt;
&lt;p&gt;è¿˜æ˜¯ç”±äºä¸ªäººå·¥ç¨‹ä»£ç ç»éªŒä¸è¶³ï¼Œä¸èƒ½100%çš„ç†è§£è®¾è®¡æ¨¡å¼çš„çœŸè°›ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šæ¬¡åŠ¨æ‰‹å†™äº†ä¸€ä¸ª&lt;code&gt;çŠ¶æ€æ¨¡å¼&lt;/code&gt;çš„äº•å­—æ¸¸æˆï¼Œè¿˜æ˜¯å†™çš„æœ‰äº›åƒåŠ›çš„ã€‚ä¹Ÿè®¸åœ¨å·¥ä½œä¸­æˆ–æ—¶ä¸ªäººé¡¹ç›®ä¸­ï¼Œèƒ½å¤šå®è·µå§ã€‚&lt;/p&gt;
&lt;h2&gt;æ€ç»´å¯¼å›¾&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://wizmann-tk-pic.u.qiniudn.com/blog-design-pattern-mindmap.png"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;</summary><category term="è¯»ä¹¦"></category><category term="head-first"></category><category term="è®¾è®¡æ¨¡å¼"></category></entry><entry><title>åŒˆç‰™åˆ©ç®—æ³•</title><link href="http://wizmann.tk/hungary-algorithm.html" rel="alternate"></link><updated>2014-01-01T22:01:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2014-01-01:hungary-algorithm.html</id><summary type="html">&lt;h2&gt;æ¦‚å¿µ&lt;/h2&gt;
&lt;h3&gt;äº¤é”™è·¯&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;äº¤é”™è·¯ï¼šè®¾Pæ˜¯å›¾Gçš„ä¸€æ¡è·¯ï¼Œå¦‚æœPçš„ä»»æ„ä¸¤æ¡ç›¸é‚»çš„è¾¹ä¸€å®šæ˜¯ä¸€æ¡å±äºMè€Œå¦ä¸€æ¡ä¸å±äºMï¼Œå°±ç§°Pæ˜¯ä¸€æ¡äº¤é”™è·¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€šä¿—ç‚¹æ¥è¯´ï¼Œå°±æ˜¯æŠŠä¸€ä¸ªå›¾ä¸­çš„è·¯å¾„æŸ“æˆçº¢é»‘ä¸¤ç§ã€‚ç„¶åæ‰¾å‡ºä¸€æ¡è·¯ï¼Œä½¿è¿™æ¡è·¯&lt;strong&gt;çº¢é»‘äº¤é”™&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨ï¼šäº¤é”™è·¯æ˜¯æ— å‘å›¾ï¼Œå›¾ä¸­çš„ç®­å¤´åªæ˜¯ä¸ºäº†ä¾¿äºè§‚å¯Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ä¸‹å›¾ä¸­çš„ï¼š&lt;code&gt;(3) -&amp;gt; (2) -&amp;gt; (1)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="å›¾1" src="http://wizmann-tk-pic.u.qiniudn.com/blog-hungary-1.png" /&gt;&lt;/p&gt;
&lt;h3&gt;ä»ç«¯ç‚¹æ‰©å¼ äº¤é”™è·¯&lt;/h3&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªçº¢é»‘äº¤é”™è·¯&lt;code&gt;P&lt;/code&gt;ï¼Œå…¶ç«¯ç‚¹ä¸º&lt;code&gt;A&lt;/code&gt;å’Œ&lt;code&gt;B&lt;/code&gt;ï¼Œå…¶è·¯å¾„è¢«æ ‡è®°ä¸º&lt;code&gt;é»‘çº¢&lt;/code&gt;ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘&lt;code&gt;P&lt;/code&gt;ä¸­çš„ä¸€ä¸ªç«¯ç‚¹ï¼ˆå‡è®¾ä¸º&lt;code&gt;A&lt;/code&gt;ï¼‰åŠ å…¥ä¸€æ¡è¾¹&lt;code&gt;T&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æˆ‘ä»¬æœ‰&lt;code&gt;è¾¹T + äº¤é”™è·¯Pï¼ˆé»‘çº¢ï¼‰&lt;/code&gt;ã€‚å½“æˆ‘ä»¬å°†è¾¹&lt;code&gt;T&lt;/code&gt;æ ‡è®°ä¸º&lt;code&gt;é»‘è‰²&lt;/code&gt;æ—¶ï¼Œæˆ‘ä»¬å°±æ‰©å±•äº†äº¤é”™è·¯&lt;code&gt;P&lt;/code&gt;ã€‚
å¦‚æœæˆ‘ä»¬è¦ä¿æŒçº¢é»‘äº¤é”™è·¯çš„&lt;strong&gt;æ€§è´¨&lt;/strong&gt;ã€‚åˆ™æˆ‘ä»¬å¿…é¡»å°†è¾¹&lt;code&gt;T&lt;/code&gt;æ ‡è®°ä¸º&lt;code&gt;é»‘è‰²&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯&lt;code&gt;Pï¼ˆBRï¼‰ =&amp;gt; P'(BRB)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="å›¾2" src="http://wizmann-tk-pic.u.qiniudn.com/blog-hungary-2.png" /&gt;&lt;/p&gt;
&lt;h3&gt;åˆ†å‰²äº¤é”™è·¯&lt;/h3&gt;
&lt;p&gt;æ˜“å¾—ï¼Œåˆ†å‰²äº¤é”™è·¯ä¸ä¼šæ”¹å˜å®ƒçš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;h3&gt;æˆ‘ä»¬è¦çº¢è¿˜æ˜¯è¦é»‘&lt;/h3&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬ç¿»è½¬çº¢é»‘äº¤é”™è·¯çš„é¢œè‰²ï¼Œä¾‹å¦‚ä»&lt;code&gt;RBR =&amp;gt; BRB&lt;/code&gt;ï¼Œåˆ™æˆ‘ä»¬çš„äº¤é”™è·¯ä»ç„¶&lt;strong&gt;ä¿æŒåŸæ¥çš„æ€§è´¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç¿»è½¬é¢œè‰²æ˜¯å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;h2&gt;ç®—æ³•å®ç°&lt;/h2&gt;
&lt;h3&gt;åŒ¹é…&lt;/h3&gt;
&lt;p&gt;åŒˆç‰™åˆ©ç®—æ³•æ˜¯ç”¨æ¥æ±‚äºŒåˆ†å›¾æœ€å¤§åŒ¹é…çš„ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬äººä¸ºæ ‡è®°é›†åˆä¸­çš„ç‚¹ä¸º&lt;code&gt;å·¦é›†&lt;/code&gt;å’Œ&lt;code&gt;å³é›†&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3&gt;çº¢è‰²æ˜¯ç§å¥½é¢œè‰²&lt;/h3&gt;
&lt;p&gt;ç”±äº&lt;code&gt;çº¢é»‘äº¤é”™è·¯&lt;/code&gt;å¯ä»¥å®‰å…¨çš„ç¿»è½¬é¢œè‰²ã€‚æ‰€ä»¥æˆ‘ä»¬ä¿æŒäº¤é”™è·¯ä¸­&lt;strong&gt;çº¢è‰²è·¯å¤šäºé»‘è‰²è·¯&lt;/strong&gt;çš„æ€§è´¨ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬è¦æ±‚å‡ºæœ€å¤§åŒ¹é…ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾å®ŒæˆåŒ¹é…çš„è¾¹ä¸ºçº¢è‰²ã€‚&lt;/p&gt;
&lt;h3&gt;ä½ å¯ä»¥è¯æ˜ä½ çš„ç®—æ³•å—&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬é€‰å–å·¦é›†ç«¯ç‚¹&lt;code&gt;T&lt;/code&gt;åˆ°å›¾ä¸­ï¼Œæ­¤æ—¶å›¾ä¸­æœ‰&lt;code&gt;k&lt;/code&gt;æ¡è¾¹ä¸ç‚¹&lt;code&gt;T&lt;/code&gt;è¿æ¥ã€‚è¿™&lt;code&gt;k&lt;/code&gt;æ¡è¾¹åˆ†åˆ«ä¸º&lt;code&gt;p1...pk&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;é€‰å–p1...pkä¸­çš„ä»»ä¸€æ¡è¾¹px

å¦‚æœ å›¾ä¸­æ²¡æœ‰äº¤é”™è·¯ æˆ–è€… å›¾ä¸­æœ‰äº¤é”™è·¯ä½†pxçš„ç«¯ç‚¹ä¸åœ¨äº¤é”™è·¯ä¸­ ï¼š
    å°†pxæ ‡ä¸ºçº¢è‰²
    è¿”å›trueã€‚

å¦‚æœ å›¾ä¸­æœ‰äº¤é”™è·¯ï¼Œä¸”pxçš„ç«¯ç‚¹åœ¨äº¤é”™è·¯ä¸­ï¼š
    å¦‚æœ pxçš„å¦ä¸€ä¸ªç«¯ç‚¹æ˜¯äº¤é”™è·¯çš„å¤´/å°¾ç«¯ç‚¹ã€‚ï¼ˆé‡ç”³ï¼Œäº¤é”™è·¯æ˜¯æ— å‘çš„ï¼‰
        é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰©å±•äº¤é”™è·¯ã€‚pxæ ‡ä¸ºçº¢è‰²
        è¿”å›true
    å¦‚æœ pxçš„å¦ä¸€ä¸ªç«¯ç‚¹åœ¨äº¤é”™è·¯çš„ä¸­é—´ã€‚
        åˆ™æˆ‘ä»¬åœ¨æ­¤ç«¯ç‚¹åˆ†å‰²äº¤é”™è·¯ï¼Œå°†Tç‚¹åŠ å…¥æŸä¸€äº¤é”™è·¯ã€‚å¹¶ä¸”é€‰å–æ­¤äº¤é”™è·¯çš„ä¸€ä¸ªç«¯ç‚¹æ‰§è¡Œè¿™ä¸ªæ‰©å±•æ“ä½œ

å¦‚æœ pxä¸å­˜åœ¨ï¼š
    åˆ™è¿”å›falseï¼Œ æ´—æ´—ç¡äº†

æ‰€ä»¥æˆ‘ä»¬åœ¨æ¯ä¸€æ¬¡æ“ä½œä¹‹åï¼Œä¼šå¾—åˆ°ä¸€ä¸ªè¿”å›å€¼ã€‚å¦‚æœä¸ºtrueï¼Œåˆ™åŒ¹é…æ•°+1ã€‚åä¹‹åˆ™ä¸å˜ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;p.s. æˆ‘è§‰å¾—æˆ‘çš„è¯æ˜æˆ‘è‡ªå·±éƒ½TMDçœ‹ä¸æ‡‚ã€‚ã€‚ã€‚å¥½æŒ«è´¥ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//å·¦é›†ç«¯ç‚¹æ•°ï¼Œå³é›†ç«¯ç‚¹æ•°&lt;/span&gt;
&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="c1"&gt;// è¾¹é›†&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;inPath&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="c1"&gt;// æ˜¯å¦åœ¨äº¤é”™è·¯ä¸­&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="c1"&gt;// åªå­˜å‚¨é»‘è‰²è·¯å¾„&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;hungary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// æ€»æ•°æ ‡ä¸º0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inPath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inPath&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt; &lt;span class="c1"&gt;// æ–°åŠ å…¥çš„ç‚¹ä¸åœ¨ä»»ä½•äº¤é”™è·¯ä¸­&lt;/span&gt;
        &lt;span class="n"&gt;sum&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;deal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;deal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// éå†æ‰€æœ‰çš„è¾¹&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inPath&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// å¦‚æœç‚¹åœ¨äº¤é”™è·¯ä¸­ï¼Œpass&lt;/span&gt;
        &lt;span class="n"&gt;inPath&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="c1"&gt;// å¦‚æœæ‰¾åˆ°ä¸€ä¸ªä¸åœ¨äº¤é”™è·¯ä¸­çš„ç‚¹ï¼Œå°†å…¶åŠ å…¥äº¤é”™è·¯ï¼Œæ­¤è½®ç®—æ³•ç»“æŸ&lt;/span&gt;
        &lt;span class="c1"&gt;// å¦åˆ™ï¼Œåˆ†å‰²äº¤é”™è·¯ï¼Œä»ä¸‹ä¸€ä¸ªç‚¹é‡æ–°å¯»æ‰¾æ‰©å±•äº¤é”™è·¯çš„æ–¹æ³•ã€‚&lt;/span&gt;
        &lt;span class="c1"&gt;// æ–¹æ³•å­˜åœ¨åˆ™æ›´æ–°ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œä¸æ›´æ–°ã€‚&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;deal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;byvoid: &lt;a href="https://www.byvoid.com/blog/hungary"&gt;åŒˆç‰™åˆ©ç®—æ³•&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Matrix67: &lt;a href="http://www.matrix67.com/blog/archives/116"&gt;äºŒåˆ†å›¾æœ€å¤§åŒ¹é…çš„KÃ¶nigå®šç†åŠå…¶è¯æ˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;wikipedia: &lt;a href="http://zh.wikipedia.org/wiki/%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95"&gt;åŒˆç‰™åˆ©ç®—æ³•&lt;/a&gt;&lt;/p&gt;</summary><category term="algorithm"></category></entry><entry><title>Codeforces 3C - Tic-tac-toe</title><link href="http://wizmann.tk/cf-3c-tic-tac-toe.html" rel="alternate"></link><updated>2013-12-29T20:23:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-29:cf-3c-tic-tac-toe.html</id><summary type="html">&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://codeforces.com/problemset/problem/3/C"&gt;Tic-tac-toe&lt;/a&gt;æ˜¯æˆ‘å¾ˆä¹…ä¹‹å‰åœ¨CFä¸Šåšçš„ä¸€é“é¢˜ã€‚éå¸¸è€ƒç»†å¿ƒçš„æ¨¡æ‹Ÿé¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æœ‰åŒå­¦å’Œæˆ‘è®¨è®ºè¿‡ç±»ä¼¼çš„é—®é¢˜ã€‚äºæ˜¯æ‹¿å‡ºæ¥é‡æ–°åšä¸€éã€‚ç»ƒç»ƒæ‰‹ã€‚&lt;/p&gt;
&lt;h2&gt;åŸé¢˜åšæ³•&lt;/h2&gt;
&lt;p&gt;æ²¡æœ‰ä»»ä½•â€œç®—æ³•â€æˆåˆ†ã€‚çº¯æ¨¡æ‹Ÿã€‚&lt;/p&gt;
&lt;p&gt;åˆç”±äºæ•°æ®é‡å®åœ¨æ˜¯å¤ªå°ï¼ˆ3 Ã— 3çš„çŸ©é˜µï¼‰ï¼Œæ‰€ä»¥åªè¦æ˜¯æ€è·¯æ­£ç¡®ã€‚ä»£ç æ€ä¹ˆå†™éƒ½èƒ½è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯åœ¨è¿™é‡Œå°±ä¸èµ˜è¿°ã€‚æ‰‹å¿«çš„ä¼—ä½10åˆ†é’Ÿåˆ‡æ­¤é¢˜æ— å‹åŠ›ã€‚&lt;/p&gt;
&lt;h2&gt;What's new?&lt;/h2&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æ‰©å±•ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœè®©ä½ è®¾è®¡ä¸€ä¸ªTic-tac-toeçš„å¯¹æˆ˜ç³»ç»Ÿï¼ˆäººæœºå¯¹æˆ˜ã€äººäººå¯¹æˆ˜ç­‰ï¼‰ï¼Œä½ å°†å¦‚ä½•è®¾è®¡ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;the STATE pattern&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªå¯¹æˆ˜ç³»ç»Ÿå…¶å®å¯ä»¥ç”¨ä¸€ä¸ªçŠ¶æ€æœºæ¥è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="http://wizmann-tk-pic.u.qiniudn.com/blog-tick-tac-toe.png" src="http://wizmann-tk-pic.u.qiniudn.com/blog-tick-tac-toe.png" /&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬çš„å¯¹æˆ˜ç³»ç»Ÿä¹Ÿå¯ä»¥å†™æˆä¸€ä¸ªçŠ¶æ€æœºçš„æ¨¡å¼ã€‚&lt;/p&gt;
&lt;h2&gt;show me the CODE&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å£°æ˜ä¸€ä¸ª&lt;code&gt;State&lt;/code&gt;æ¥å£ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºTic-tac-toeæ¸¸æˆåªæœ‰ä¸¤ç§æ“ä½œç±»å‹ï¼š&lt;code&gt;P1 move&lt;/code&gt;å’Œ&lt;code&gt;P2 move&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬çš„æ¥å£å°±å¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;State&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;State&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;igame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;igame&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
&lt;span class="k"&gt;protected&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;Game&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;game&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;State&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é‚£ä¹ˆ&lt;code&gt;FirstState&lt;/code&gt;çš„å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;FirstState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;State&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;FirstState&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;FirstState&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;FIRST_WIN&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FIRST_WIN&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;DRAW&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DRAW&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;FirstState&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// P2ä¸èƒ½æ“ä½œ&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åŒç†ï¼Œ&lt;code&gt;SecondState&lt;/code&gt;çš„å®ç°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SecondState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;State&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; 
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SecondState&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SecondState&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// P1ä¸èƒ½æ“ä½œ&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SecondState&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;SECOND_WIN&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SECOND_WIN&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;DRAW&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DRAW&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;game&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¹äºç»“æŸçŠ¶æ€ï¼Œå› ä¸ºæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯éæ³•çš„ã€‚æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹å®ç°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;EndState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;State&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;FirstWinState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;EndState&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;FirstWinState&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SecondWinState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;EndState&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SecondWinState&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DrawState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;      &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;EndState&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;DrawState&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;IllegalState&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="n"&gt;EndState&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;virtual&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;IllegalState&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ°è¿™é‡Œï¼ŒçŠ¶æ€æœºé‡Œçš„æ‰€æœ‰çŠ¶æ€æˆ‘ä»¬éƒ½å·²ç»å£°æ˜å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¼€å§‹å®ç°&lt;code&gt;Game&lt;/code&gt;ç±»ã€‚å› ä¸ºæ˜¯ç¤ºä¾‹ä»£ç ï¼Œæ‰€ä»¥æœ‰çš„å‡½æ•°éƒ½å†…è”äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Game&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next_state&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;get_state&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;make_move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;player&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;next&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;second&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;State&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;state_ptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="n"&gt;FirstState&lt;/span&gt;      &lt;span class="n"&gt;firststate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;SecondState&lt;/span&gt;     &lt;span class="n"&gt;secondstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;FirstWinState&lt;/span&gt;   &lt;span class="n"&gt;firstwinstate&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;SecondWinState&lt;/span&gt;  &lt;span class="n"&gt;secondwinstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;DrawState&lt;/span&gt;       &lt;span class="n"&gt;drawstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;IllegalState&lt;/span&gt;    &lt;span class="n"&gt;illegalstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;firststate&lt;/span&gt;    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;secondstate&lt;/span&gt;   &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;firstwinstate&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; 
    &lt;span class="n"&gt;secondwinstate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;drawstate&lt;/span&gt;     &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;illegalstate&lt;/span&gt;  &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_game&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;// åœ¨å¼€å§‹çš„æ—¶å€™ï¼Œè¦P1å…ˆæ‰‹&lt;/span&gt;
    &lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;set_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next_state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;next_state&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next_state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DRAW&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;drawstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;firststate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;secondstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FIRST_WIN&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;firstwinstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SECOND_WIN&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;secondwinstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;illegalstate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;get_state&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;state_ptr&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;show_state&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;make_move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;player&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;player&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nl"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;Game&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;judge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// è¿™ä¸ªå‡½æ•°å†™çš„å¤ªå±äº†ï¼Œä¸å¿ç›´è§†&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;check_win&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// åŒä¸Šã€‚ã€‚ã€‚æ¨¡æ‹Ÿé¢˜å°±æ˜¯é‚£ä¹ˆæ¶å¿ƒã€‚ã€‚ã€‚_(:Ğ·ã€âˆ )_&lt;/span&gt;
&lt;span class="c1"&gt;// ä¹Ÿè®¸æˆ‘ä¼šæœ‰æœºä¼šé‡æ„ä¸€ä¸‹ã€‚ã€‚ã€‚&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;judge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// PASS&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;check_win&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;board&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;//nobody wins and the board is full&lt;/span&gt;
        &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;DRAW&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;FIRST&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b_cnt&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;a_cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;SECOND_WIN&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a_cnt&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;b_cnt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;FIRST_WIN&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// NO ELSE HERE;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="nl"&gt;FIRST&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;SECOND&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ€åè¡¥ä¸Šæˆ‘ä»¬çš„å¸¸é‡å£°æ˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ILLEGAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;DRAW&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;FIRST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SECOND&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;FIRST_WIN&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SECOND_WIN&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;how it works&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;çŠ¶æ€æ¨¡å¼ï¼š å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½è±¡ä¿®æ”¹äº†å®ƒçš„ç±»   &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;class Game&lt;/code&gt;ä¸­çš„&lt;code&gt;state_ptr&lt;/code&gt;æŒ‡é’ˆæ ‡ç¤ºäº†å½“ç„¶è‡ªåŠ¨æœºçš„çŠ¶æ€ã€‚ä»&lt;code&gt;class Game&lt;/code&gt;è°ƒç”¨&lt;code&gt;first&lt;/code&gt;å’Œ&lt;code&gt;second&lt;/code&gt;å‡½æ•°çš„è¡Œä¸ºè¢«å§”æ‰˜ç»™äº†å½“å‰çš„&lt;code&gt;State&lt;/code&gt;ï¼Œäº§ç”Ÿäº†ä¸åŒçš„åŠ¨ä½œã€‚&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™&lt;/h2&gt;
&lt;p&gt;ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†é‚£ä¸¤ä¸ªå†™çš„åƒå±ä¸€æ ·çš„å‡½æ•°ï¼Œæˆ‘ä»¬å†™äº†å¥½å¤šçœ‹èµ·æ¥&lt;strong&gt;æ— ç”¨&lt;/strong&gt;çš„ä»£ç ã€‚å¦‚æœç”¨åˆ«çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿè®¸åœ¨200è¡Œä¹‹å†…å°±å¯ä»¥å®Œæˆç°æœ‰çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸–ç•Œä¸Šå”¯ä¸€ä¸å˜çš„ï¼Œå°±æ˜¯ä¸€åˆ‡éƒ½åœ¨å˜&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½¿ç”¨&lt;strong&gt;çŠ¶æ€æ¨¡å¼&lt;/strong&gt;ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾çš„æ‰©å±•ç°æœ‰çš„çŠ¶æ€ã€‚å¹¶ä¸”ï¼Œå¯¹äºç±»çš„å†…éƒ¨åŠ¨ä½œæœ‰ä¸€ä¸ªè‰¯å¥½çš„å°è£…ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨æˆ‘ä»¬çš„çŠ¶æ€æœºæ—¶åªéœ€è¦æ ¹æ®éœ€è¦æ”¹å˜å®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸éœ€è¦çŸ¥é“å®ƒæ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;a href="http://book.douban.com/subject/21964984/"&gt;ã€Šé¢†åŸŸç‰¹å®šè¯­è¨€ã€‹&lt;/a&gt;ä¸€ä¹¦ä¸­ï¼Œå°±æœ‰ä½¿ç”¨çŠ¶æ€æ¨¡å¼æ„å»ºæ˜“äºè¢«é¢†åŸŸä¸“å®¶ç†è§£å’Œä½¿ç”¨çš„DSLã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆp.s. DSLæˆ‘äº†è§£ä¸å¤šï¼Œå¦‚æœç†è§£æœ‰åå·®ï¼Œè¯·è°…è§£ï¼‰&lt;/p&gt;
&lt;h2&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://codeforces.com/problemset/problem/3/C"&gt;Codeforces 3C - Tic-tac-toe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://book.douban.com/subject/2243615/"&gt;Head First è®¾è®¡æ¨¡å¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ä»£ç ä¸‹è½½&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://s.yunio.com/voeWtA"&gt;äº‘è¯ºç½‘ç›˜ - æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="è®¾è®¡æ¨¡å¼"></category></entry><entry><title>How to "Rotate Image"?</title><link href="http://wizmann.tk/how-to-rotate-image-leetcode.html" rel="alternate"></link><updated>2013-12-28T14:42:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-28:how-to-rotate-image-leetcode.html</id><summary type="html">&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åŸé¢˜&lt;a href="http://oj.leetcode.com/problems/rotate-image/"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Rotate Image&lt;/p&gt;
&lt;p&gt;You are given an n x n 2D matrix representing an image.&lt;/p&gt;
&lt;p&gt;Rotate the image by 90 degrees (clockwise).&lt;/p&gt;
&lt;p&gt;Follow up:&lt;/p&gt;
&lt;p&gt;Could you do this in-place?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¤ºæ„å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="rotate-image" src="http://wizmann-tk-pic.u.qiniudn.com/blog-rotate-image-leetcode.png" /&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼ŒçŸ©é˜µä¸­çš„æ•°å­—&lt;strong&gt;ä¸ä¸€å®š&lt;/strong&gt;æ˜¯è§„å¾‹çš„ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¦æå‡ºè¿™ä¸ªé—®é¢˜&lt;/h2&gt;
&lt;p&gt;è‡ªè§‰æ˜¯ä¸€ä¸ª&lt;strong&gt;ä¸èªæ˜&lt;/strong&gt;çš„äººï¼ˆåŒä½ã€‚ã€‚ã€‚&amp;lt;(=ï¼ _ï¼ ;=)?&amp;gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åˆ«äººä¸€ä¸‹å­å°±æƒ³æ˜ç™½çš„äº‹ï¼Œåœ¨æˆ‘è¿™é‡Œè¦è®¡ç®—å¥½å‡ ä¸ªæ¥å›ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åŠªåŠ›æƒ³æ‰¾åˆ°ä¸€ä¸ªæ€ç»´æ–¹æ³•å»å¼¥è¡¥è¿™ä¸ªä¸è¶³ã€‚&lt;/p&gt;
&lt;p&gt;å°±ä»¥è¿™é¢˜ä¸ºä¾‹ï¼Œå¦‚ä½•ä½¿ç”¨ç®€å•ã€ç›´æ¥çš„æ–¹æ³•ï¼Œè¿…é€Ÿæ­£ç¡®çš„æ‰¾å‡ºå˜åŒ–çš„æ˜ å°„è§„å¾‹ã€‚&lt;/p&gt;
&lt;h2&gt;åˆæ­¥æ€è·¯&lt;/h2&gt;
&lt;p&gt;ç”±äºä¸å¯ä»¥ä½¿ç”¨&lt;strong&gt;é¢å¤–çš„ç©ºé—´&lt;/strong&gt;ã€‚æ‰€ä»¥å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåæ ‡æ˜ å°„&lt;code&gt;f(x, y) =&amp;gt; (next_x, next_y)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¾ªç¯æ¥&lt;code&gt;swap&lt;/code&gt;çŸ©é˜µä¸­çš„å…ƒç´ ã€‚&lt;/p&gt;
&lt;h2&gt;é‡åˆ°é—®é¢˜&lt;/h2&gt;
&lt;p&gt;å¦‚ä½•ç¡®å®šæ˜ å°„&lt;code&gt;f(x, y)&lt;/code&gt;ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç”±äºæˆ‘çš„æ€ç»´ä¸èƒ½æ”¯æŒæˆ‘åœ¨å¤´è„‘ä¸­å½¢æˆæ­£ç¡®çš„å…¬å¼ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘æƒ³åˆ°ï¼Œå› ä¸ºæˆ‘ä»¬è¦æ±‚çš„å˜æ¢æ˜¯åœ¨äºŒç»´çŸ©é˜µä¸­çš„ç®€å•ç§»ä½ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åšå‡ºå¦‚ä¸‹ä¸€ä¸ªæ–¹ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;f(x, y) = (ax + by + c, dx + ey + f)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæ‰¾å‡ºç‰¹æ®Šç‚¹ï¼Œä»£å…¥æ–¹ç¨‹ä¸­ï¼Œæ±‚å‡º&lt;code&gt;a&lt;/code&gt;åˆ°&lt;code&gt;f&lt;/code&gt;å„è‡ªä»£è¡¨çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æ±‚å‡ºæ˜ å°„&lt;code&gt;f(x, y) =&amp;gt; (y, n - x)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å³å¯ä»¥åˆ†è§£ä¸ºï¼š&lt;code&gt;reverse_X(Matrix.T)&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;æ€è€ƒæ–¹å¼&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šçš„æ–¹æ³•æ˜¯æˆ‘å¤±è´¥äº†Næ¬¡ä¹‹åæ‰æƒ³åˆ°çš„ã€‚ï¼ˆå¼±ã€‚ã€‚ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘åˆæœ‰äº†è¿›ä¸€æ­¥çš„æ€è€ƒã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çš„æ€è€ƒæ–¹å¼æ˜¯ä¸æ˜¯æœ€ä½³çš„ã€‚å¦‚æœå¤§å®¶é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œä¼šç”¨ä»€ä¹ˆå·§å¦™çš„æ–¹æ³•å»æ€è€ƒï¼Œå»ä¼˜é›…çš„è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è¦è®°å¾—æˆ‘ä»¬çš„æ¡ä»¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çŸ©é˜µé¡ºæ—¶é’ˆæ—‹è½¬90åº¦&lt;/li&gt;
&lt;li&gt;in-placeå˜æ¢ï¼Œä¸å¾—ä½¿ç”¨é¢å¤–çš„ç©ºé—´&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¬¢è¿å¤§å®¶æå‡ºè‡ªå·±çš„çœ‹æ³•ã€‚ä»£ç è¯·è´´åˆ°&lt;a href="https://gist.github.com/"&gt;gist&lt;/a&gt;æˆ–&lt;a href="http://lpaste.net/"&gt;hpaste&lt;/a&gt;ç­‰ç½‘ç«™ä¸Šï¼Œä¸è¦æŠŠä»£ç ç›´æ¥å†™åˆ°è¯„è®ºä¸­ï¼Œæˆ‘ä¼šåŠæ—¶updateæœ¬æ–‡ï¼Œå±•ç¤ºå¤§å®¶çš„æƒ³æ³•ã€‚&lt;/p&gt;</summary><category term="Leetcode"></category><category term="algorithm"></category><category term="æ€ç»´"></category></entry><entry><title>Codeforces Round #221 (Div. 2)ä¸å®Œå…¨ä¸æ­£ç¡®é¢˜è§£</title><link href="http://wizmann.tk/cf-221-div-2.html" rel="alternate"></link><updated>2013-12-25T19:05:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-25:cf-221-div-2.html</id><summary type="html">&lt;h2&gt;A. Lever&lt;/h2&gt;
&lt;p&gt;æ°´é¢˜ï¼Œæ æ†åŸç†ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨&lt;code&gt;^&lt;/code&gt;æŠŠå­—ç¬¦ä¸²åˆ†å‰²å¼€ã€‚ç„¶ååˆ†åˆ«è®¡ç®—ä¸¤è¾¹çš„é‡é‡å³å¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#Result: Dec 24, 2013 6:04:41 PM    Wizmann  A - Lever   Python 2   Accepted     312 ms  4200 KB&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ss&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ss&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;

&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;^&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[::&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;right&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;balance&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;left&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;right&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;B. I.O.U.&lt;/h2&gt;
&lt;p&gt;æ°´é¢˜ï¼Œç®—å‡ºæ¯ä¸ªäººè´Ÿå€ºå’Œè´·å‡ºï¼ˆè¿™ä¸ªè¯çš„ç°å­¦çš„~ï¼‰çš„ç»å¯¹å€¼å·®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå†æ±‚å’Œé™¤2ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#Result: Dec 24, 2013 6:12:53 PM    Wizmann  B - I.O.U.  Python 2   Accepted     46 ms   0 KB&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;inv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;outv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;outv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;
    &lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;

&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;outv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c"&gt;#Trickï¼Œå¦‚æœres % 2 != 0çš„è¯ï¼Œæˆ‘çš„ç®—æ³•å°±æ˜¯å®Œå…¨é”™è¯¯çš„&lt;/span&gt;
    &lt;span class="c"&gt;#æ­¤æ—¶è¿”å›TLEè€Œä¸æ˜¯WA&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;C. Divisible by Seven&lt;/h2&gt;
&lt;p&gt;è„‘ç­‹æ€¥è½¬å¼¯ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡æ‰“è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºã€‚&lt;code&gt;permutation(1, 6, 8, 9) % 7 == [0 ... 6]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±æ­¤æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºå…¶å®ƒæ•°å­—æ’åˆ—å¦‚ä½•ï¼Œåªè¦åœ¨å…¶åé¢è¡¥ä¸Š&lt;code&gt;1, 6, 8, 9&lt;/code&gt;çš„ä¸€ä¸ªæ’åˆ—ã€‚å°±å¯ä»¥ä½¿å…¶æ¨¡7å¾—0ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåªæœ‰&lt;code&gt;1ï¼Œ6, 8, 9&lt;/code&gt;å’Œå¾ˆå¤š&lt;code&gt;0&lt;/code&gt;çš„æƒ…å†µã€‚æˆ‘ä»¬å°±æŠŠ&lt;code&gt;0&lt;/code&gt;æ”¾åœ¨&lt;code&gt;1, 6ï¼Œ8ï¼Œ9&lt;/code&gt;åé¢ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ¯”è¾ƒä¹±ã€‚ä¸è¿‡æ€è·¯å¾ˆæ˜æ˜¾:)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;//Result: Dec 24, 2013 7:48:42 PM   Wizmann  C - Divisible by Seven  GNU C++    Accepted     140 ms  1000 KB&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stack&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1001000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;EOF&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1869&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;%=&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;mod&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1869&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;6819&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;6918&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;6891&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8691&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1986&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8196&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;D. Maximum Submatrix 2&lt;/h2&gt;
&lt;p&gt;å…¶å®è¿™é¢˜ä¹Ÿåº”è¯¥æ˜¯æ°´é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ª&lt;code&gt;0/1&lt;/code&gt;çŸ©é˜µï¼Œå¯ä»¥åšè¡Œäº¤æ¢ï¼Œè®©ä½ æ±‚å‡ºäº¤æ¢åèƒ½è·å¾—çš„æœ€å¤§ç”±&lt;code&gt;1&lt;/code&gt;ç»„æˆçš„å­é˜µã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¢˜å’Œä¸¤ä¸ªé¢˜å¾ˆç›¸ä¼¼ï¼Œä¸€ä¸ªæ˜¯ç»å…¸çš„&lt;code&gt;æœ€å¤§å­é˜µå’Œ&lt;/code&gt;é—®é¢˜ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸å¤ªç»å…¸çš„&lt;code&gt;ç›´æ–¹å›¾ä¸­æœ€å¤§çŸ©å½¢&lt;/code&gt;é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå› ä¸ºåªæœ‰è¡Œå˜æ¢ï¼Œæ‰€ä»¥å¯¹åˆ—ä¸Šçš„&lt;code&gt;0/1&lt;/code&gt;åˆ†å¸ƒæ²¡æœ‰ä»»ä½•å½±å“ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥å¤„ç†å‡ºä»¥æŸåˆ—ä¸ºåŸºå‡†æ—¶ï¼ŒæŸè¡Œçš„æœ€å¤§å­é˜µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="å­é˜µ" src="http://wizmann-tk-pic.u.qiniudn.com/blog-cf221-div2-d.png" /&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬è®¡ç®—åˆ°ç¬¬äºŒåˆ—çš„æ—¶å€™ã€‚å¯ä»¥å¤„ç†å‡ºæ¯ä¸€è¡Œçš„æœ€å¤§å­é˜µã€‚ç”±äºæˆ‘ä»¬å¯ä»¥è¿›è¡Œè¡Œå˜æ¢ï¼Œäºæ˜¯æˆ‘ä»¬å°†æ¯è¡Œçš„æœ€å¤§å­é˜µè¿›è¡Œæ’åºã€‚ç„¶åéå†æ±‚å‡ºå½“å‰çš„æœ€å¤§å­é˜µï¼Œä»è€Œå¾—å‡ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç ç®€å•ã€‚ä¸è¿‡æœ‰æ€§èƒ½é—®é¢˜ã€‚æ²¡æœ‰å……åˆ†ä½¿ç”¨cacheï¼Œä¸è¿‡100+mså°±è¿‡äº†ï¼Œæ‡’å¾—ä¼˜åŒ–äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stack&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5120&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;E. Circling Round Treasures&lt;/h2&gt;
&lt;p&gt;èµ›åå­¦ä¹ æ¥çš„ä»£ç ã€‚çŠ¶å‹DPã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®æè¿°è¶…çº§å¤æ‚ï¼Œå…¶å®åœ¨é¢˜ç›®ä¸­å·²ç»æš—ç¤ºäº†åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ä»¥è¿™ä¸ªä»£ç å¤æ‚ç¨‹åº¦ï¼Œæ¯”èµ›æ—¶èƒ½åšå‡ºæ¥ä¹Ÿæ˜¯æ¯”è¾ƒç‰›çš„äººäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸æƒ³èµ˜è¿°è§£æ³•äº†ï¼Œåªè¯´ä¸€ä¸ªå…³é”®ç‚¹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Let's draw a ray that starts from point p and does not intersect other points of the table (such ray must exist).&lt;/p&gt;
&lt;p&gt;Let's count the number of segments of the polyline that intersect the painted ray. If this number is odd, we assume that point p (and consequently, the table cell) lie inside the polyline (path). Otherwise, we assume that it lies outside.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¢˜ç›®ä¸­ç»™å‡ºäº†åˆ¤æ–­ä¸€ä¸ªå®è—æ˜¯å¦åœ¨è·¯å¾„ä¸­çš„ä¸€ä¸ªåˆ¤æ–­ç®—æ³•ã€‚å³åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢ä¸­çš„ç»å…¸å°„çº¿æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è®°å½•æŸä¸€æ­¥æ˜¯å¦åœ¨æŸä¸ªå®è—çš„&lt;code&gt;å°„çº¿&lt;/code&gt;ä¸Šã€‚è€Œå°„çº¿çš„æ–¹å‘åˆ™å¯ä»¥è‡ªå®šã€‚ä»£ç ä¸­çš„å°„çº¿æ–¹å‘æ˜¯&lt;code&gt;+x&lt;/code&gt;æ–¹å‘ã€‚å¦‚æœæŸä¸€æ¡è¾¹ç»è¿‡äº†è¿™æ¡å°„çº¿ï¼Œåˆ™ä¿®æ”¹å½“å‰çŠ¶æ€ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;//Result: Dec 25, 2013 2:22:27 PM   Wizmann  E - Circling Round Treasures    GNU C++    Accepted    31 ms   1400 KB&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stack&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;queue&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;GOLD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;point&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;point&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;point&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;){}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;point&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;istatus&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;istatus&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bomb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;GOLD&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;GOLD&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;GOLD&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="n"&gt;point&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;bfs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;front&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nowst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;mx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; 
                    &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; 
                    &lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

            &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nowst&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;nst&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;nst&lt;/span&gt; &lt;span class="o"&gt;^=&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nst&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nst&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nst&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

            &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nst&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;nowst&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;gold&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bomb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;scanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;S&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;st&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;point&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;isdigit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                    &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;bomb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;maze&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;B&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;bomb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
                &lt;span class="n"&gt;bomb&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;bfs&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;gold&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visit&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æœ€åï¼Œç‚«è€€ä¸€ä¸‹&lt;/h2&gt;
&lt;p&gt;&lt;img alt="rank" src="http://wizmann-tk-pic.u.qiniudn.com/blog-cf221-div2-rank.png" /&gt;&lt;/p&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>è‡ªå·±åŠ¨æ‰‹æ­å»ºç¬¬ä¸‰æ–¹çš„Codeforces CDN</title><link href="http://wizmann.tk/third-party-codeforces-cdn.html" rel="alternate"></link><updated>2013-12-14T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-14:third-party-codeforces-cdn.html</id><summary type="html">&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æ ¡å›­ç½‘ä¸ŠCFé‚£å«ä¸€ä¸ªå¡ã€‚&lt;/p&gt;
&lt;p&gt;åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å› ä¸ºcodeforceså¤§é‡çš„ä½¿ç”¨äº†ajaxæŠ€æœ¯ï¼Œæ‰€ä»¥å¼•ç”¨äº†å¾ˆå¤šjs/cssæ–‡ä»¶ï¼Œå¹¶ä¸”å¼•ç”¨çš„ä½ç½®ä½äºé¡µé¢ä¹‹å‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±é€ æˆäº†ï¼Œæˆ‘ä»¬åœ¨ä¸ŠCFçš„æ—¶å€™ï¼Œå…¶å®é¡µé¢å†…å®¹å·²ç»è¯»å–å‡ºæ¥äº†ã€‚ä½†æ˜¯å› ä¸ºjs/cssæ–‡ä»¶æ²¡æœ‰åŠ è½½å®Œæˆï¼Œæ‰€ä»¥é¡µé¢è¿˜æ˜¯ä¸€ç‰‡ç©ºç™½ã€‚&lt;/p&gt;
&lt;h2&gt;è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;ç”±äºjs/css/imgæ–‡ä»¶éƒ½æ˜¯æ‰€è°“çš„&lt;code&gt;é™æ€&lt;/code&gt;æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¼“å­˜è¿™äº›æ–‡ä»¶åˆ°ä¸€ä¸ªè®¿é—®é€Ÿåº¦å¿«çš„ç½‘ç»œä¸Šæ¥ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯CDNæŠ€æœ¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CDNçš„å…¨ç§°æ˜¯Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚å…¶ç›®çš„æ˜¯é€šè¿‡åœ¨ç°æœ‰çš„Internetä¸­å¢åŠ ä¸€å±‚æ–°çš„ç½‘ç»œæ¶æ„ï¼Œå°†ç½‘ç«™çš„å†…å®¹å‘å¸ƒåˆ°æœ€æ¥è¿‘ç”¨æˆ·çš„ç½‘ç»œâ€œè¾¹ç¼˜â€ï¼Œä½¿ç”¨æˆ·å¯ä»¥å°±è¿‘å–å¾—æ‰€éœ€çš„å†…å®¹ï¼Œæé«˜ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å“åº”é€Ÿåº¦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½†æ˜¯ä¿„ç½—æ–¯äººé‚£è¾¹æ²¡æœ‰åšCDNï¼Œæˆ–è€…ä»–ä»¬çš„CDNè·ç¦»å¤©æœå®åœ¨æ˜¯å¤ªè¿œäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªå¥½æ‰‹åŠ¨ç¼“å­˜è¿™äº›é™æ€æ–‡ä»¶åˆ°ä¸ƒç‰›äº‘ä¸Šï¼Œä½¿ç”¨ä¸ƒç‰›çš„CDNæŠ€æœ¯æ¥åŠ é€Ÿæˆ‘ä»¬çš„è®¿é—®äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.qiniu.com/"&gt;ä¸ƒç‰›äº‘&lt;/a&gt;ä¸ºä¸ªäººç”¨æˆ·æä¾›äº†10Gå­˜å‚¨ç©ºé—´å’Œæ¯æœˆ10Gæµé‡ï¼Œè¿™å¯¹äºæˆ‘ä»¬ç¼“å­˜ä¸€ä¸ªç½‘ç«™çš„é™æ€æ–‡ä»¶æ¥è¯´ï¼Œå·²ç»è¶³å¯Œè£•äº†ã€‚æ ¹æ®æˆ‘ç°åœ¨çš„ä½¿ç”¨çŠ¶å†µï¼Œæ‰€æœ‰é™æ€æ–‡ä»¶åŠ åœ¨ä¸€èµ·å¤§æ¦‚åœ¨3Må·¦å³ï¼Œæ­å»ºè¿™æ ·ä¸€ä¸ªå…è´¹CDNå¯ä»¥ä¾›åå‡ ä¸ªäººä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;è®¾è®¡æ¶æ„&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;CSæ¨¡å¼&lt;/code&gt;æ¥å®Œæˆè¿™ä¸ªç½‘ç«™åŠ é€Ÿçš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Serverç«¯å½“ç„¶å°±æ˜¯ä¸ƒç‰›äº‘å•¦ã€‚å¤æ‚çš„ä»»åŠ¡éƒ½äº¤ç»™äº†å·¥ç¨‹å¸ˆä»¬å®Œæˆï¼Œæˆ‘ä»¬åªéœ€è¦å£°æ˜éœ€è¦ç¼“å­˜&lt;code&gt;codeforces.com&lt;/code&gt;çš„é™æ€æ–‡ä»¶å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;Clientç«¯ä½¿ç”¨çš„æ˜¯Chrome-extensionã€‚Chrome-extensionä½¿ç”¨&lt;code&gt;webRequest&lt;/code&gt;æ¥â€œåŠ«æŒâ€æˆ‘ä»¬çš„æµé‡ï¼Œå°†å…¶æŒ‡å‘æˆ‘ä»¬çš„ä¸ƒç‰›äº‘ç¼“å­˜ã€‚&lt;/p&gt;
&lt;h2&gt;Serverç«¯é…ç½®&lt;/h2&gt;
&lt;p&gt;éå¸¸ç®€å•çš„æ“ä½œã€‚è®¾ç½®ä¸€ä¸ªé•œåƒå­˜å‚¨å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="ä¸ƒç‰›äº‘è®¾ç½®" src="http://wizmann-tk-pic.u.qiniudn.com/blog-codeforces-cdn-qiniu-settings.png" /&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬è®°ä¸‹ä¸ƒç‰›äº‘ä¸ºæˆ‘ä»¬åˆ†é…çš„åŸŸåï¼Œä»¥å¤‡åç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;Clientç«¯é…ç½®&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä¸è¿‡ä¹Ÿæ˜¯å¾ˆè½»æ¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ–°å»ºä¸€ä¸ªå¼€å‘ç‰ˆçš„chrome-extensionã€‚ï¼ˆç”±äºæˆ‘æ²¡æœ‰å¼€å‘è€…è´¦å·ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯çº¿ä¸‹å¼€å‘ï¼Œæ”¾åˆ°githubä¸Šè®©å¤§å®¶æçš„ã€‚&lt;/p&gt;
&lt;p&gt;å†™&lt;code&gt;manifest.json&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Codeforce CDNåŠ é€Ÿ&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;version&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;0.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;description&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ä¸ªäººæ€§è¶£æ‰€è‡´ï¼Œä¸æ‰¿æ‹…ä»»ä½•å¯èƒ½çš„é£é™©&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;permissions&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;tabs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;http://*.codeforces.com/*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;http://*.codeforces.ru/*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;webRequestBlocking&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;webRequest&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;background&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nt"&gt;&amp;quot;scripts&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;codeforces_cdn.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;quot;browser_action&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:{&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;quot;default_title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Codeforce CDNåŠ é€Ÿ&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;quot;default_icon&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;icon.png&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;icons&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:{&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;quot;16&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;icon.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;quot;48&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;icon.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;quot;128&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;icon.png&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;manifest_version&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åå†™&lt;code&gt;background.js&lt;/code&gt;ï¼Œâ€œåŠ«æŒâ€å‘å¾€&lt;code&gt;work.codeforces.ru&lt;/code&gt;çš„æµé‡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;chrome&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;webRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onBeforeRequest&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;details&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;details&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;details&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://worker.codeforces.ru&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;details&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                    &lt;span class="s2"&gt;&amp;quot;http://worker.codeforces.ru&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="s2"&gt;&amp;quot;http://ä½ çš„ä¸ƒç‰›äº‘åŸŸå.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;redirectUrl&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;urls&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://worker.codeforces.ru/*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]},&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;blocking&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åå®‰è£…æ’ä»¶ï¼Œå°±å¯ä»¥å®Œç¾ä½¿ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®æˆ‘çš„å®éªŒï¼Œåœ¨æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜çš„æƒ…å†µä¸‹ã€‚åŠ é€Ÿå‰éœ€è¦3minçš„é¡µé¢å¤§æ¦‚ç°åœ¨åªéœ€è¦ä¸åˆ°10sã€‚&lt;/p&gt;
&lt;h2&gt;æ½œåœ¨é—®é¢˜ä»¥åŠä¸å®Œç¾çš„è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬æ˜¯ç¬¬ä¸‰æ–¹çš„å±±å¯¨CDNï¼Œæ‰€ä»¥å½“codeforces.comæ›´æ–°å®ƒçš„é™æ€æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆ·æ–°é™æ€æ–‡ä»¶çš„æœºåˆ¶ã€‚ä½†æ˜¯æˆ‘ä»¬åˆä¸èƒ½ç›‘æ§æ–‡ä»¶æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼Œæˆ‘æƒ³åˆ°çš„ä¸€ä¸ªä¸å®Œç¾çš„è§£å†³æ–¹æ¡ˆæ˜¯å®šæ—¶åˆ·æ–°ã€‚&lt;/p&gt;
&lt;p&gt;è¯¦ç»†æ¥è¯´ï¼Œå°±æ˜¯æ¯å‘¨æ‰¾ä¸€ä¸ªæ—¶é—´ï¼Œæ¸…ç©ºæˆ‘ä»¬çš„ç¼“å­˜ã€‚åœ¨ä¸‹ä¸€æ¬¡è®¿é—®çš„æ—¶å€™ï¼Œä¸ƒç‰›äº‘ä¼šè‡ªåŠ¨æ›¿æˆ‘ä»¬åˆ·æ–°æ‰€æœ‰çš„é™æ€æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ƒç‰›äº‘çš„python-sdkæä¾›äº†éå†/åˆ é™¤æ–‡ä»¶çš„æ–¹æ¡ˆï¼ˆæˆ‘åœ¨é‡Œé¢è¿˜æ‰¾åˆ°äº†ä¸€ä¸ªå°å°çš„Bugï¼‰ã€‚æˆ‘ä»¬åªéœ€è¦å®šæ—¶æ‰§è¡Œå®ƒå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä½¿ç”¨äº†BAE + bottle.py + niqiu-python-sdkçš„ç»„åˆã€‚åœ¨BAEä¸Šéƒ¨ç½²äº†ä¸€ä¸ªbottle.pyåº”ç”¨ï¼Œç„¶åä½¿ç”¨&lt;code&gt;cron&lt;/code&gt;å®šæ—¶æ‰§è¡Œåˆ·æ–°ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç &lt;/h2&gt;
&lt;p&gt;Github: &lt;a href="https://github.com/Wizmann/codeforces-cdn"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;</summary><category term="codeforces"></category><category term="chrome-extension"></category><category term="useless"></category></entry><entry><title>åœ¨Googleé¢è¯•ä¹‹åæƒ³åˆ°çš„</title><link href="http://wizmann.tk/after-google-interview.html" rel="alternate"></link><updated>2013-12-11T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-11:after-google-interview.html</id><summary type="html">&lt;p&gt;&lt;img alt="æ€ç»´å¯¼å›¾" src="http://wizmann-tk-pic.u.qiniudn.com/about-google-interview-tiny.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://wizmann-tk-pic.u.qiniudn.com/about-google-interview.png"&gt;æˆ³æˆ‘çœ‹é«˜æ¸…æ— ç å¤§å›¾&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œé¢è¯•è¿‡ç¨‹ä¸­æ²¡è¢«å“å°¿ä¹Ÿç®—æ˜¯æˆ‘å¿ƒç†æ¯”è¾ƒå¼ºå¤§å§ã€‚&lt;/p&gt;
&lt;p&gt;#å±Œä¸å¿ƒæ€#ã€‚ã€‚ã€‚&lt;/p&gt;</summary><category term="é—²èŠ"></category></entry><entry><title>Codeforces Round #218 (Div. 2)ä¸å®Œå…¨ä¸æ­£ç¡®é¢˜è§£</title><link href="http://wizmann.tk/cf-218-div-2.html" rel="alternate"></link><updated>2013-12-09T23:02:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-09:cf-218-div-2.html</id><summary type="html">&lt;h3&gt;A. K-Periodic Array&lt;/h3&gt;
&lt;p&gt;å°†Arrayåˆ‡ç‰‡ï¼Œç„¶åæŒ‰ä½ç»Ÿè®¡æŸä¸€ä½ä¸Š1çš„ä¸ªæ•°C(1)å’Œ2çš„ä¸ªæ•°C(2)ã€‚ç„¶ååœ¨è¿™ä¸€ä½ä¸Šçš„æ“ä½œæ•°å°±ä¸ºM = min(C(1), C(2))ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•é¢˜&lt;/p&gt;
&lt;h3&gt;B. Fox Dividing Cheese&lt;/h3&gt;
&lt;p&gt;å‚»é€¼æ‰é”™çš„é¢˜ï¼Œä¸å¹¸ä¸­æªã€‚&lt;/p&gt;
&lt;p&gt;ä¸æƒ³å¤šè¯´äº†ï¼Œç›´æ¥çœ‹ä»£ç å§ã€‚æ‰‹è´±ä¸æ˜¯ç—…ï¼Œè´±èµ·æ¥è¦äººå‘½ã€‚&lt;/p&gt;
&lt;h3&gt;C. Hamburgers&lt;/h3&gt;
&lt;p&gt;æ¨¡æ‹Ÿ + äºŒåˆ†ã€‚&lt;/p&gt;
&lt;p&gt;å’ŒCJLè¿˜è®¨è®ºè¿‡è¿™é¢˜çš„çº¯æ¨¡æ‹Ÿåšæ³•ï¼Œçœ‹äº†åŠå¤©ä»£ç æ²¡æ‰¾åˆ°é—®é¢˜ã€‚äºæ˜¯åˆšæ‰ç”¨Pythonè‡ªå·±å®ç°äº†ä¸€ä¸ªï¼Œåœ¨ä»£ç æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰WAï¼Œä½†æ˜¯Tåœ¨äº†22ç»„ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¿™é¢˜æœ€å¥½ä½¿ç”¨äºŒåˆ†ï¼Œå¦‚æœç”¨æ¨¡æ‹Ÿçš„è¯ï¼Œéœ€è¦è€ƒè™‘å„ç§æƒ…å†µã€‚ä»£ç è§ä¸‹ï¼Œç»†èŠ‚ä¸Šæ³¨æ„å°±å¥½ã€‚&lt;/p&gt;
&lt;h3&gt;D. Vessels&lt;/h3&gt;
&lt;p&gt;è¿™é¢˜å¾—å¥½å¥½è®²ä¸€ä¸‹ï½æ¯”èµ›æ—¶åšå‡ºæ¥äº†å¥½å¾—æ„ï½&lt;/p&gt;
&lt;p&gt;&lt;img alt="Vessels" src="http://wizmann-tk-pic.u.qiniudn.com/blog-cf-218-div-2-d-vessels.png" /&gt;&lt;/p&gt;
&lt;p&gt;é¢˜æ„æ˜¯ç»™å‡ºä¸€ç»„å±‚å±‚å çš„å®¹å™¨ï¼Œæ¯ä¸€ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±çš„å®¹é‡ã€‚ç„¶åæˆ‘ä»¬å‘æŸäº›å®¹å™¨é‡ŒçŒæ°´ï¼Œå¦‚æœæ°´çš„ä½“ç§¯è¶…è¿‡äº†æŸä¸ªå®¹å™¨çš„å®¹é‡ï¼Œåˆ™å‰©ä½™çš„æ°´æº¢å‡ºåˆ°ä¸‹ä¸€ä¸ªå®¹å™¨ä¸­ã€‚æœ€åä¸€ä¸ªå®¹å™¨æº¢å‡ºçš„æ°´ä¼šè½åˆ°åœ°é¢ä¸Šï¼Œæ‰€ä»¥å¿½ç•¥ä¸è®¡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæŸä¸€ä¸ªå®¹å™¨æ˜¯æ»¡çš„ï¼Œé‚£ä¹ˆå®ƒå°±å†ä¹Ÿä¸ä¼šç©ºä¸‹æ¥ï¼Œå¹¶ä¸”æµç»å®ƒçš„æ°´å…¨éƒ¨æº¢å‡ºç»™ä¸‹é¢çš„å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°ç»„è®°å½•å½“å‰å®¹å™¨æ³¨æ°´çš„æ—¶å€™ï¼Œæ°´ä¼šæµå‘å“ªä¸ªå®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåœ¨åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰å®¹å™¨éƒ½æ˜¯ç©ºçš„ã€‚æ‰€ä»¥&lt;code&gt;to[i] = i&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæŸå®¹å™¨ç”±äºæ³¨æ°´æ»¡æ‰äº†ï¼Œæˆ‘ä»¬å°±æŠŠæ³¨æ°´çš„æŒ‡å‘æŒ‡åˆ°&lt;code&gt;i + 1&lt;/code&gt;ï¼Œå°±æœ‰&lt;code&gt;to[i] = i + 1&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹æ¬¡åœ¨å‘å®¹å™¨iæ³¨æ°´çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥è¯¢&lt;code&gt;to[i]&lt;/code&gt;çš„å€¼ï¼Œå°±å¯ä»¥çŸ¥é“æ°´çš„æµå‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªå¹¶æŸ¥é›†é—®é¢˜ã€‚å¦‚æœiæ»¡äº†ï¼Œ&lt;code&gt;to[i] == i + 1&lt;/code&gt;ã€‚ä¸æ­¤åŒæ—¶ï¼Œi+1ä¹Ÿæ»¡äº†ï¼Œåˆ™&lt;code&gt;to[i + 1] == i + 2&lt;/code&gt;ã€‚ä»é¢˜æ„æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶&lt;code&gt;to[i] == to[i + 1] == i + 2&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å‡ ä¹å¯ä»¥æŠŠæ¯æ¬¡æ³¨æ°´çš„æµå‘çš„æŸ¥è¯¢ä¼˜åŒ–åˆ°&lt;code&gt;O(1)&lt;/code&gt;ã€‚å‰©ä¸‹çš„å°±æ˜¯åŸºæœ¬çš„åŠ å‡æ³•å’Œè¾“å…¥è¾“å‡ºæ“ä½œäº†ã€‚&lt;/p&gt;
&lt;h3&gt;E. Subway Innovation&lt;/h3&gt;
&lt;p&gt;æ¨å…¬å¼é¢˜ï¼Œä¸“æ²»æ™ºå•†ä¸å¤Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šä¸€ä»½åˆ«äººçš„é¢˜è§£ï¼Œæˆ‘ä¼°è®¡æ¨ä¸å‡ºæ¥äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Eé¢˜é¢˜è§£" src="http://wizmann-tk-pic.u.qiniudn.com/blog-cf-218-div-2-e.png" /&gt;&lt;/p&gt;
&lt;h3&gt;ä»¥ä¸‹æ˜¯ä»£ç &lt;/h3&gt;
&lt;h4&gt;A&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ll&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;twos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ll&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;twos&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;twos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;B&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;fractions&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;gcd&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;avail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;


&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gcd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;

&lt;span class="n"&gt;av&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;avail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;avail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;av&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;gv&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;av&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;gv&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;C&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;BUFFER&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;money&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="nf"&gt;calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0LL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="nf"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10000000000000LL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;calc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;money&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mid&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;half&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;BUFFER&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;money&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;B&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;S&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;C&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cost&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;money&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0LL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ans&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;D&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;200100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;find_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;find_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;pour&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;overflow&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;find_father&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="n"&gt;pour&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;overflow&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="nf"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;freopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;father&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="n"&gt;memset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vessel&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;pour&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;E&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;cstdio&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstring&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;cstdlib&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;iostream&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;algorithm&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;vector&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;set&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;using&lt;/span&gt; &lt;span class="k"&gt;namespace&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#define print(x) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; endl&lt;/span&gt;
&lt;span class="cp"&gt;#define input(x) cin &amp;gt;&amp;gt; x&lt;/span&gt;

&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(){}&lt;/span&gt;
    &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ipos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;inr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ipos&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;

    &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; 
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;300008&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;leftsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SIZE&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;nr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;station&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;leftsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;leftsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llint&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;leftsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;llint&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;leftsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;leftsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;station&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pos&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>ä½¿ç”¨æ–°ç±»å‹åˆ›å»ºæ›´äººæ€§åŒ–çš„ä»£ç </title><link href="http://wizmann.tk/humanity-code-with-new-classes.html" rel="alternate"></link><updated>2013-12-09T15:01:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-09:humanity-code-with-new-classes.html</id><summary type="html">&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« è®¨è®ºäº†å¦‚ä½•é€šè¿‡æ–°å»ºå¹¶éâ€å¿…è¦â€œçš„æ–°ç±»å‹ï¼Œæ¥äº§ç”Ÿæ›´äººæ€§åŒ–çš„C++ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;å…³é”®è¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RAII&lt;/li&gt;
&lt;li&gt;æ™ºèƒ½æŒ‡é’ˆ&lt;/li&gt;
&lt;li&gt;æ¥å£å‹å¥½&lt;/li&gt;
&lt;li&gt;æ¨¡æ¿&lt;/li&gt;
&lt;li&gt;æ¨¡æ¿ç‰¹åŒ–&lt;/li&gt;
&lt;li&gt;ä¾èµ–ç¼–è¯‘å™¨çš„ç¼ºçœè¡Œä¸º&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºC++çš„è‰ºæœ¯ï¼Œæˆ‘åªæ˜¯ä¸ªå…¥é—¨è€…ã€‚å¦‚æœæ–‡ç« ä¸­æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿å¤§å®¶æŒ‡å‡ºï¼Œæˆ‘ä¼šåŠæ—¶è¿›è¡Œä¿®æ”¹ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸€ä¸ªå‹å¥½çš„äº’æ–¥é”&lt;/h2&gt;
&lt;h3&gt;äº’æ–¥é”çš„å®šä¹‰&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;äº’æ–¥é”ï¼ˆè‹±è¯­ï¼šè‹±è¯­ï¼šMutual exclusionï¼Œç¼©å†™ Mutexï¼‰æ˜¯ä¸€ç§ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œé˜²æ­¢ä¸¤æ¡çº¿ç¨‹åŒæ—¶å¯¹åŒä¸€å…¬å…±èµ„æºï¼ˆæ¯”å¦‚å…¨å±€å˜é‡ï¼‰è¿›è¡Œè¯»å†™çš„æœºåˆ¶ã€‚è¯¥ç›®çš„é€šè¿‡å°†ä»£ç åˆ‡ç‰‡æˆä¸€ä¸ªä¸€ä¸ªçš„ä¸´ç•ŒåŒºåŸŸï¼ˆcritical sectionï¼‰è¾¾æˆã€‚ä¸´ç•ŒåŒºåŸŸæŒ‡çš„æ˜¯ä¸€å—å¯¹å…¬å…±èµ„æºè¿›è¡Œè®¿é—®çš„ä»£ç ï¼Œå¹¶éä¸€ç§æœºåˆ¶æˆ–æ˜¯ç®—æ³•ã€‚ä¸€ä¸ªç¨‹åºã€è¿›ç¨‹ã€çº¿ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªä¸´ç•ŒåŒºåŸŸï¼Œä½†æ˜¯å¹¶ä¸ä¸€å®šä¼šåº”ç”¨äº’æ–¥é”ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;å¦‚ä½•ä½¿ç”¨äº’æ–¥é”&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œåªåšæœ€ç®€å•çš„ç¤ºèŒƒã€‚å…·ä½“çš„ä½¿ç”¨æ–¹æ³•å’ŒåŸç†ä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´ä¹‹å†…ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;pthread.h&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyIntArray&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="c1"&gt;// ä¸€ä¸ªå‡æƒ³çš„æ•°ç»„ç±»å‹ï¼Œæ”¯æŒå¤šçº¿ç¨‹ä¸‹çš„Append Onlyæ“ä½œã€‚&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;MyIntArray&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;_vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="n"&gt;pthread_mutex_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;pthread_mutex_lock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="c1"&gt;//&lt;/span&gt;
        &lt;span class="c1"&gt;// åœ¨è¿™é‡Œåšä¸€äº›å·¥ä½œ, ä¾‹å¦‚æ‰“Logï¼ŒæŠ½é£ç­‰&lt;/span&gt;
        &lt;span class="c1"&gt;//&lt;/span&gt;
        &lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;push_back&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;pthread_mutex_unlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;pthread_mutex_t&lt;/span&gt; &lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;_vec&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä»£ç ä¸éœ€è¦å¤šè§£é‡Šï¼Œé€šè¿‡ä¸€ä¸ªé”æ¥ä¿è¯å¤šçº¿ç¨‹push_backå‡½æ•°çš„å¯é‡å…¥æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬éœ€è¦å¯¹ä»£ç çš„å®‰å…¨æ€§åšä¸€äº›è¯„ä¼°ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¦‚ä½•å¤„ç†ï¼Œå‡½æ•°åœ¨unlock mutexä¹‹å‰å¼‚å¸¸ç»“æŸçš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¹¶ä¸æ˜¯ä¸å¯èƒ½çš„ï¼Œä¾‹å¦‚&lt;code&gt;vec.push_back(v)&lt;/code&gt;æŠ›å‡ºäº†ä¸€ä¸ª&lt;code&gt;std::bad_alloc&lt;/code&gt;å¼‚å¸¸ã€‚æˆ–è€…åœ¨è¿™ä¹‹å‰å› ä¸ºä¸€äº›åŸå› ï¼Œå‡½æ•°åšå‡ºäº†&lt;code&gt;return -1&lt;/code&gt;çš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿè®¸æˆ‘ä»¬åœ¨é€»è¾‘ä¸Šå¯ä»¥æ¥å—è¿™äº›é”™è¯¯ï¼ˆæ¯”å¦‚åšå‡ºä¸€äº›å¤±è´¥å¤„ç†ï¼‰ã€‚ä½†æ˜¯ï¼Œå¯¹äºå› ä¸ºæˆ‘ä»¬æ²¡æœ‰unlockæˆ‘ä»¬çš„åŒæ­¥é”ï¼Œäºæ˜¯æ­»é”å°±äº§ç”Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæå¤§çš„éšæ‚£ï¼Œæ­»é”çš„å±å®³æˆ‘ä¹Ÿä¸ç”¨å¤šè¯´ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥é¿å…è¿™ç§å±€é¢ã€‚&lt;/p&gt;
&lt;h3&gt;ä¸€ä¸ªæ–°çš„Mutexç±»å‹&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;strong&gt;ææ„å‡½æ•°&lt;/strong&gt;çš„ç‰¹æ€§æ¥ç¼–å†™å¦‚ä¸‹çš„ç±»ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;pthread.h&amp;gt;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Mutex&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;Mutex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="kt"&gt;pthread_mutex_t&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i_mutex_ptr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i_mutex_ptr&lt;/span&gt;&lt;span class="p"&gt;){}&lt;/span&gt;

    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;pthread_mutex_lock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;Mutex&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;pthread_mutex_unlock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;Mutex&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="c1"&gt;// disable the empty construct funtion&lt;/span&gt;
    &lt;span class="kt"&gt;pthread_mutex_t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;_mutex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;OKï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç±»åšä¸ºåŒæ­¥é”çš„ç®¡ç†ç±»ï¼Œé‚£ä¹ˆï¼Œå¦‚æœå‡½æ•°ä¸­å‡ºç°äº†éé¢„æœŸçš„æƒ…å†µè€Œè·³å‡ºçš„æ—¶å€™ã€‚&lt;code&gt;Mutex&lt;/code&gt;ç±»å°±ä¼šè‡ªåŠ¨è°ƒç”¨è‡ªèº«çš„ææ„å‡½æ•°æ¥è§£é”ã€‚é¿å…äº†æ­»é”çš„å‘ç”Ÿã€‚&lt;/p&gt;
&lt;h3&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;pthread_mutex_t&lt;/code&gt;æ˜¯ä¸€ä¸ªç±»å‹ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸ªç±»å‹ä¹‹ä¸Šåˆæ–°å»ºäº†ä¸€ä¸ªæ–°çš„ç±»å‹æ¥è¿›è¡Œèµ„æºç®¡ç†ã€‚ä»¥æ­¤æ¥è·å¾—æ›´äººæ€§åŒ–ï¼Œæ›´å®‰å…¨ä»¥åŠæ›´å¯è¯»çš„ä»£ç ã€‚&lt;/p&gt;
&lt;h3&gt;æ‹“å±•é˜…è¯»&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.searchtb.com/2011/01/pthreads-mutex-vs-pthread-spinlock.html"&gt;Pthreads mutex vs Pthreads spinlock&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºmutexå’Œspinlockæœ‰ä¸€ä¸ªè¯¦ç»†çš„ä»‹ç»ï¼Œå¹¶ä¸”å¯¹æ¯”äº†è¿™ä¸¤ç§é”çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Effective C++ æ¡æ¬¾14&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šçš„ä¾‹å­æ¥æºäºæ­¤ï¼Œå¹¶ä¸”åšäº†ä¸€äº›ç®€åŒ–ã€‚&lt;/p&gt;
&lt;h2&gt;å¥æŸ„ç±»&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç”±äºC++æ²¡æœ‰è‡ªåŠ¨å†…å­˜å›æ”¶æœºåˆ¶ï¼Œæ‰€ä»¥å†…å­˜æ“ä½œéƒ½éœ€è¦ä»£ç ç¼–å†™è€…æ‰‹åŠ¨å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±é€ æˆäº†æ½œåœ¨çš„å†…å­˜æ³„éœ²é—®é¢˜ â€”â€”â€”â€” ä¸å°å¿ƒæ‰‹è´±æ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å°±å¼•å…¥äº†å¥æŸ„ç±»ï¼Œä¸€ç§ä½¿ç”¨&lt;strong&gt;å¼•ç”¨è®¡æ•°æ³•&lt;/strong&gt;æ¥ç®¡ç†å†…å­˜çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3&gt;ä¸€ä¸ªæ³›å‹å¥æŸ„ç±»&lt;/h3&gt;
&lt;p&gt;ä»£ç æ¥è‡ªã€ŠC++ Primer ç¬¬4ç‰ˆã€‹ï¼Œæœ‰å°å°çš„æ ¼å¼ä¸Šçš„æ”¹åŠ¨ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* generic handle class: Provides pointerlike behavior. Although&lt;/span&gt;
&lt;span class="cm"&gt;access through&lt;/span&gt;
&lt;span class="cm"&gt;* an unbound Handle is checked and throws a runtime_error exception.&lt;/span&gt;
&lt;span class="cm"&gt;* The object to which the Handle points is deleted when the last&lt;/span&gt;
&lt;span class="cm"&gt;Handle goes away.&lt;/span&gt;
&lt;span class="cm"&gt;* Users should allocate new objects of type T and bind them to a&lt;/span&gt;
&lt;span class="cm"&gt;Handle.&lt;/span&gt;
&lt;span class="cm"&gt;* Once an object is bound to a Handle,, the user must not delete&lt;/span&gt;
&lt;span class="cm"&gt;that object.&lt;/span&gt;
&lt;span class="cm"&gt;*/&lt;/span&gt;
&lt;span class="k"&gt;template&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Handle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;// unbound handle&lt;/span&gt;
    &lt;span class="n"&gt;Handle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="kt"&gt;size_t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// overloaded operators to support pointer behavior&lt;/span&gt;
    &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// copy control: normal pointer behavior, but last Handle deletes the object&lt;/span&gt;
    &lt;span class="n"&gt;Handle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Handle&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="o"&gt;++*&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;Handle&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;operator&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="n"&gt;Handle&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;Handle&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;rem_ref&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;// shared object&lt;/span&gt;
    &lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;// count of how many Handle spointto *ptr&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;rem_ref&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt; 
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;--*&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;ptr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;delete&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; 
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒHandleç±»ä¸­ä½¿ç”¨äº†&lt;code&gt;size_t *use&lt;/code&gt;ç”¨æ¥å¯¹äºå¯¹è±¡è¿›è¡Œå¼•ç”¨è®¡æ•°ã€‚å¦‚æœè®¡æ•°ä¸º0ï¼Œåˆ™Handleç±»ä¼šåˆ é™¤è‡ªèº«ã€‚ä¹Ÿè®¸æˆ‘ä»¬ä¼šå¿˜è®°é‡Šæ”¾å†…å­˜ï¼Œä½†æ˜¯ç¼–è¯‘å™¨ä¼šå¸®ä½ ç®¡ç†å¥½ä½ çš„å¯¹è±¡çš„ã€‚&lt;/p&gt;
&lt;h3&gt;å¥æŸ„ç±»çš„å¦ä¸€ä¸ªä¼˜ç‚¹&lt;/h3&gt;
&lt;p&gt;å¥æŸ„ç±»çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å¯ä»¥é™ä½æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å¥æŸ„ç±»å¯ä»¥å°†æ¥å£ä»å®ç°ä¸­åˆ†ç¦»ï¼Œä»è€Œåˆ†ç¦»ç¼–è¯‘ä¾èµ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª&lt;code&gt;Person&lt;/code&gt;ç±»ï¼Œåˆå£°æ˜äº†&lt;code&gt;PersonImpl&lt;/code&gt;å¥æŸ„ç±»ã€‚&lt;/p&gt;
&lt;p&gt;åˆ™æˆ‘ä»¬å¦‚æœä¿®æ”¹äº†&lt;code&gt;Person&lt;/code&gt;ç±»çš„å®ç°éƒ¨åˆ†ï¼Œå¹¶ä¸”ä¿æŒæ¥å£éƒ¨åˆ†ä¸å˜ã€‚åˆ™æˆ‘ä»¬åªéœ€è¦é‡æ–°ç¼–è¯‘å«å…¥&lt;code&gt;Person&lt;/code&gt;ç±»çš„æ–‡ä»¶ã€‚å«å…¥&lt;code&gt;PersonImpl&lt;/code&gt;ç±»çš„æ–‡ä»¶ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚&lt;/p&gt;
&lt;h3&gt;shared_ptr&lt;/h3&gt;
&lt;p&gt;shared_ptræ˜¯boostä¸­å¼•å…¥çš„æ–°ç±»å‹ï¼ŒåŸç†å’Œå¥æŸ„ç±»ç±»ä¼¼ï¼Œä½†æ˜¯åŠ å…¥äº†å¦‚ä¸‹ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹å®‰å…¨&lt;/li&gt;
&lt;li&gt;æ”¯æŒè‡ªå®šä¹‰ææ„æ“ä½œï¼ˆåˆ é™¤å™¨ï¼‰&lt;/li&gt;
&lt;li&gt;æœ‰ç°æˆçš„åº“ä¸ºå•¥ä¸ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ã€ŠEffective C++ã€‹ä¸€ä¹¦ä¸­ï¼Œä½œè€…å¯¹äº&lt;code&gt;shared_ptr&lt;/code&gt;å¤§ä¸ºæ¨å´‡ï¼Œç”¨äº†å¾ˆå¤§ç¯‡å¹…æ¥ä»‹ç»å®ƒçš„ç”¨æ³•ï¼Œåœ¨è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚&lt;/p&gt;
&lt;h3&gt;æ½œåœ¨é—®é¢˜&lt;/h3&gt;
&lt;p&gt;æœ‰å¤±æœ‰å¾—ï¼Œæˆ‘ä»¬åœ¨ä¸€å®šç¨‹åº¦ä¸Šæå‡äº†å†…å­˜å®‰å…¨æ€§çš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»ä»˜å‡ºä¸€å®šçš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…å­˜æ€§èƒ½é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä¸€ä¸ªå¥æŸ„ç±»æˆ–æ™ºèƒ½æŒ‡é’ˆä¸­ï¼Œä¸ä»…æœ‰æˆ‘ä»¬çš„å¯¹è±¡æŒ‡é’ˆï¼Œè€Œä¸”è¿˜ä¿å­˜ç€å¼•ç”¨è®¡æ•°ã€‚å¦‚æœæˆ‘ä»¬å¤„äºå†…å­˜æ•æ„Ÿçš„åœºæ™¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»è®¤çœŸçš„è€ƒè™‘æ”¶ç›Šå’Œä»£ä»·ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¡ç®—æ€§èƒ½é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬çš„å¥æŸ„ç±»éœ€è¦çº¿ç¨‹å®‰å…¨æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¿…é¡»è¦ä»˜å‡ºç›¸åº”çš„æ—¶é—´ä¸Šçš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;h3&gt;æ‹“å±•é˜…è¯»&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ã€ŠEffective C++ã€‹ç¬¬ä¸‰ç«  èµ„æºç®¡ç†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ã€ŠC++ Primerç¬¬å››ç‰ˆã€‹ 16.5 ä¸€ä¸ªæ³›å‹å¥æŸ„ç±»&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;é˜²æ­¢æ¥å£è¯¯ç”¨&lt;/h2&gt;
&lt;p&gt;Pythonæœ‰ä¸€ä¸ªéå¸¸å¥½çš„ç‰¹æ€§ï¼ˆä¹Ÿè®¸åˆ«çš„è¯­è¨€ä¹Ÿæœ‰ï¼‰ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pass_date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;pass_date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨å‡½æ•°çš„è°ƒç”¨ä¸­ï¼Œå¯ä»¥æ˜ç¡®å½¢å‚ä¸å®å‚çš„å¯¹åº”å…³ç³»ã€‚è¿™å°±å¯ä»¥ä»å¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†æ¥å£è¯¯ç”¨çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€Œåœ¨C++ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–°å»ºç±»å‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜ä»¥&lt;code&gt;pass_date&lt;/code&gt;è¿™ä¸ªå‡½æ•°ä¸ºä¾‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Year&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Month&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Day&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;explicit&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Date&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;pass_date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Year&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Month&lt;/span&gt; &lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Day&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// pass&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Date&lt;/span&gt; &lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psss_date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Year&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;Month&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;Day&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åç‰¹åŒ–ç±»ä¸­çš„æˆå‘˜å‡½æ•°&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•æ¥æºäºstackoverflowä¸Šçš„ä¸€ä¸ª&lt;a href="http://stackoverflow.com/questions/20147821/c-how-to-partial-specialization-a-template-function-in-a-template-class"&gt;é—®é¢˜&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ¯”è¾ƒæ¨å´‡ä¸‹é¢è¿™ä¸ªç­”æ¡ˆï¼Œè™½ç„¶å®ƒä¸æ˜¯è¢«é¡¶çš„æœ€å¤šçš„é‚£ä¸ªã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;template&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;ApplyNorm&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;pow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;pow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;pow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="c1"&gt;// Here specialize for 2&lt;/span&gt;
&lt;span class="k"&gt;template&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;ApplyNorm&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt; 
        &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;spec: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt; 
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;


&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;Vector3D&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;Vector3D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;Norm&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;typename&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;template&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; 
&lt;span class="n"&gt;Group&lt;/span&gt; &lt;span class="n"&gt;Vector3D&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;::&lt;/span&gt;&lt;span class="n"&gt;Norm&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ApplyNorm&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;::&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// use the helper...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// your code goes here&lt;/span&gt;
    &lt;span class="n"&gt;Vector3D&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Norm&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Norm&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®ƒä½¿ç”¨ä¸€ä¸ªæ–°ç±»&lt;code&gt;ApplyNorm&lt;/code&gt;å®ç°äº†ç±»æˆå‘˜å‡½æ•°çš„åç‰¹åŒ–ã€‚&lt;/p&gt;
&lt;h3&gt;æ‹“å±•é˜…è¯»&lt;/h3&gt;
&lt;p&gt;ã€ŠC++ Primerç¬¬4ç‰ˆã€‹ 16.6 æ¨¡æ¿ç‰¹åŒ–&lt;/p&gt;</summary><category term="cpp"></category></entry><entry><title>Yunfileä¸‹è½½ç ´è§£[åºŸå¼ƒ]</title><link href="http://wizmann.tk/yunfile-cracker.html" rel="alternate"></link><updated>2013-12-02T21:16:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-02:yunfile-cracker.html</id><summary type="html">&lt;h2&gt;åºŸå¼ƒåŸå› &lt;/h2&gt;
&lt;p&gt;å› ä¸ºYunfileç°åœ¨å¼€å§‹é™IP + æ— é™æŠ½é£ï¼Œæ‰€ä»¥æ’ä»¶å·²ç»åºŸå¼ƒä¸ç”¨äº†ã€‚ç°åœ¨ä¹Ÿæ²¡æ‰¾åˆ°è§£å†³æ–¹æ³•ã€‚\o&amp;lt;(=â•¯â–¡â•°=)&amp;gt;o&lt;/p&gt;
&lt;h2&gt;å•¥ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¤§å®¶éƒ½çŸ¥é“&lt;code&gt;Yunfile&lt;/code&gt;æ˜¯åšä»€ä¹ˆçš„å’©ï¼Ÿåæ­£æˆ‘æ˜¯ä¸çŸ¥é“ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¤©ä¸‹åˆæ— èŠï¼Œå†™äº†ä¸€ä¸ªyunfileä¸‹è½½çš„ç ´è§£æ’ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;åŠŸèƒ½ï¼š&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;éä¼šå‘˜è·³è¿‡ä¸‹è½½ç­‰å¾…çš„30sï¼ˆæˆ–è€…æ›´é•¿æ—¶é—´ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸‹è½½é¡µé¢ä¸ä¼šæŠ¥â€œå› é•¿æ—¶é—´æœªæ“ä½œï¼Œéœ€è¦é‡æ–°ä¸‹è½½â€çš„é”™è¯¯&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™é‡Œæ„Ÿè°¢&lt;strong&gt;luacloud&lt;/strong&gt;çš„&lt;a href="http://www.luacloud.com/2012/crack-yunfile-network-disk-30-wait-for-restrictions.html"&gt;åšæ–‡&lt;/a&gt;ï¼Œä¸ºæ’ä»¶çš„ç¼–å†™æä¾›äº†åŸå‹ã€‚&lt;/p&gt;
&lt;h2&gt;å…·ä½“åŠŸèƒ½å®ç°ï¼š&lt;/h2&gt;
&lt;h3&gt;è·³è¿‡ç­‰å¾…&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸Šé¢å¼•ç”¨çš„åšæ–‡é‡Œé¢æœ‰è¯´ï¼Œå°±æ˜¯å¼ºåˆ¶æ‰§è¡Œé¡µé¢ä¸­çš„jsï¼Œå®ç°è·³è½¬ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜åšäº†ä¸€ä¸ªDOMä¿®æ”¹ï¼Œå˜æˆç°åœ¨è¿™ç§å¾ˆæ¼‚æ¼‚çš„æ ·å­ï½ï½&lt;/p&gt;
&lt;p&gt;&lt;img alt="Yunfile-Craker-1" src="http://wizmann-tk-pic.u.qiniudn.com/yunfile-craker-1.png" /&gt;&lt;/p&gt;
&lt;h3&gt;å¿½ç•¥è¶…æ—¶é”™è¯¯&lt;/h3&gt;
&lt;p&gt;è¦†ç›–äº†ä¸‹è½½å‡½æ•°ï¼Œè·³è¿‡è¶…æ—¶åˆ¤æ–­ã€‚&lt;/p&gt;
&lt;h2&gt;ç°æœ‰é—®é¢˜&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œç‚¹å‡»ä¸‹è½½æŒ‰é’®ä¼šè¿”å›åˆ°ä¸‹è½½é¡µã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶æˆ‘ä»¬ä¸éœ€è¦å†ç­‰30säº†ï¼Œä½†æ˜¯è¿˜æ˜¯å¾ˆçƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿæœ‰æˆ‘æœ‰æœºä¼šä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3&gt;ä»£ç &lt;/h3&gt;
&lt;p&gt;ä»£ç åœ¨&lt;a href="https://github.com/Wizmann/Utils/tree/master/Chrome-extension/yunfile-cracker"&gt;è¿™é‡Œ&lt;/a&gt;å‘€ï½&lt;/p&gt;</summary><category term="åˆ›é€ åŠ›"></category><category term="Yunfile"></category><category term="Chrome-Extension"></category></entry><entry><title>Tick-tick</title><link href="http://wizmann.tk/tick-tick.html" rel="alternate"></link><updated>2013-12-02T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-12-02:tick-tick.html</id><summary type="html">&lt;p&gt;Go back to workï¼&lt;/p&gt;
&lt;p&gt;&lt;img alt="Big brother is watching you!" src="http://wizmann-tk-pic.u.qiniudn.com/blog-ticktick-big-brother.jpg" /&gt;&lt;/p&gt;


&lt;p&gt;&lt;audio src="http://wizmann-tk-pic.u.qiniudn.com/ticking.mp3" autoplay="autoplay" loop="loop"/&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®ç§‘å­¦ç ”ç©¶è¡¨æ˜ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šï¼Œåœ¨å·¥ä½œæ—¶é…ä¸Šå•è°ƒæœ‰èŠ‚å¥çš„èƒŒæ™¯éŸ³ï¼Œå¯ä»¥å¤§å¹…åº¦æé«˜æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆä¸Šé¢ä¸€æ¡æ˜¯æˆ‘çè¯´çš„ï¼‰&lt;/p&gt;
&lt;p&gt;æ¨èä¸€ä¸ªæ—¶é—´ç®¡ç†çš„Chromeæ’ä»¶ï¼Œç•ªèŒ„åœŸè±†ã€‚&lt;a href="http://www.douban.com/group/pomotodo/"&gt;æˆ³æˆ‘&lt;/a&gt;è¿›å…¥ç•ªèŒ„åœŸè±†è±†ç“£å°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;èƒŒæ™¯ä¸­çš„tick-tickçš„éŸ³æ•ˆå°±æ˜¯ä»æ’ä»¶ä¸­æå‡ºæ¥çš„ã€‚&lt;/p&gt;</summary><category term="é—²èŠ"></category><category term="åˆ›é€ åŠ›"></category></entry><entry><title>æ©Ÿå™¨å­¸ç¿’åŸºçŸ³ - PLAç®—æ³•åˆæ­¥</title><link href="http://wizmann.tk/ml-foundations-pla.html" rel="alternate"></link><updated>2013-11-29T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-29:ml-foundations-pla.html</id><summary type="html">&lt;h2&gt;ä»€ä¹ˆæ˜¯PLAç®—æ³•&lt;/h2&gt;
&lt;p&gt;PLA = Perceptrons Learning Alogrithm&lt;/p&gt;
&lt;p&gt;WikiPediaä¸Šæœ‰ä¸€ä¸ªå¤§æ¦‚çš„å†å²èƒŒæ™¯ä»‹ç»ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ„ŸçŸ¥æœºï¼ˆè‹±è¯­ï¼šPerceptronï¼‰æ˜¯Frank Rosenblattåœ¨1957å¹´å°±èŒäºCornellèˆªç©ºå®éªŒå®¤(Cornell Aeronautical Laboratory)æ—¶æ‰€å‘æ˜çš„ä¸€ç§äººå·¥ç¥ç»ç½‘ç»œã€‚å®ƒå¯ä»¥è¢«è§†ä¸ºä¸€ç§æœ€ç®€å•å½¢å¼çš„å‰é¦ˆå¼äººå·¥ç¥ç»ç½‘ç»œï¼Œæ˜¯ä¸€ç§äºŒå…ƒçº¿æ€§åˆ†ç±»å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;PLAç®—æ³•çš„åŸç†&lt;/h2&gt;
&lt;p&gt;&lt;img alt="æ„ŸçŸ¥æœºç¤ºæ„å›¾" src="http://wizmann-tk-pic.u.qiniudn.com/blog-perceptron-Ncell.png" /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹äºæ¯ç§è¾“å…¥å€¼(1 - D)ï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸ªæƒé‡ã€‚å½“å‰ç¥ç»å…ƒçš„æ€»æ¿€å‘å€¼(a)å°±ç­‰äºæ¯ç§è¾“å…¥å€¼(x)ä¹˜ä»¥æƒé‡(w)ä¹‹å’Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”±æ­¤æˆ‘ä»¬å°±å¯ä»¥æ¨å¯¼å‡ºå…¬å¼å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="neuron sum" src="http://wizmann-tk-pic.u.qiniudn.com/blog-perceptron-formula-1.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä¸ºè¿™ä¸ªâ€œç¥ç»å…ƒâ€çš„æ¿€å‘å€¼è®¾å®šä¸€ä¸ªé˜ˆå€¼&lt;code&gt;threshold&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;code&gt;a &amp;gt; threshold&lt;/code&gt;ï¼Œåˆ™åˆ¤å®šè¾“å…¥ä¸ºæ­£ä¾‹ã€‚
å¦‚æœ &lt;code&gt;a &amp;lt; threshold&lt;/code&gt;ï¼Œåˆ™åˆ¤å®šè¾“å…¥ä¸ºè´Ÿä¾‹ã€‚
å¯¹äº &lt;code&gt;a == threshold&lt;/code&gt;çš„æƒ…å†µï¼Œè®¤ä¸ºæ˜¯ç‰¹æ®Šæƒ…å†µï¼Œä¸äºˆè€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„æ„ŸçŸ¥å™¨åˆ†ç±»å™¨å°±å¯ä»¥å¾—åˆ°ä»¥ä¸‹å¼å­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="perceptron-formula-2" src="http://wizmann-tk-pic.u.qiniudn.com/blog-perceptron-formula-2.png" /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨æ•°æ®å‘é‡ä¸­åŠ å…¥äº†é˜ˆå€¼ï¼Œå¹¶æŠŠå¼å­ç»Ÿä¸€æˆå‘é‡ç§¯çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;h2&gt;PLAç®—æ³•çš„é”™è¯¯ä¿®æ­£&lt;/h2&gt;
&lt;p&gt;PLAç®—æ³•æ˜¯_é”™è¯¯é©±åŠ¨_çš„ç®—æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“æˆ‘ä»¬è®­ç»ƒè¿™ä¸ªç®—æ³•æ—¶ï¼Œåªè¦è¾“å‡ºå€¼æ˜¯æ­£ç¡®çš„ï¼Œè¿™ä¸ªç®—æ³•å°±ä¸ä¼šè¿›è¡Œä»»ä½•æ•°æ®çš„è°ƒæ•´ã€‚åä¹‹ï¼Œå½“è¾“å‡ºå€¼ä¸å®é™…å€¼å¼‚å·ï¼Œè¿™ä¸ªç®—æ³•å°±ä¼šè‡ªåŠ¨è°ƒæ•´å‚æ•°çš„æ¯”é‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="é”™è¯¯ä¿®æ­£" src="http://wizmann-tk-pic.u.qiniudn.com/blog-perceptron-update.png" /&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆå–ä¸€ä¸ªéšæœºå‘é‡&lt;code&gt;W&lt;/code&gt;ï¼Œä¸ç°æœ‰çš„æ•°æ®&lt;code&gt;X[i]&lt;/code&gt;åšç‚¹ä¹˜ï¼Œå–å¾—ç»“æœçš„ç¬¦å·ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç¬¦å·ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸçš„è¯ï¼Œåˆ™&lt;code&gt;continue&lt;/code&gt;ã€‚
å¦åˆ™å°±è¦å¯¹&lt;code&gt;W&lt;/code&gt;è¿›è¡Œä¿®æ­£ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ­£çš„æ–¹å¼æ˜¯&lt;code&gt;W += y * X[i]&lt;/code&gt;ï¼Œæ¯ä¸€æ¬¡ä¿®æ­£éƒ½æ˜¯å‡å°‘ç°æœ‰å‘é‡&lt;code&gt;W&lt;/code&gt;ä¸å‘é‡&lt;code&gt;y * X[i]&lt;/code&gt;çš„å¤¹è§’ï¼Œä»è€Œè°ƒæ•´ç­”æ¡ˆçš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;h2&gt;Naive PLA ä¸ Pocket PLA&lt;/h2&gt;
&lt;h3&gt;Naive PLA&lt;/h3&gt;
&lt;p&gt;Naive PLAç®—æ³•çš„æ€æƒ³å¾ˆç®€å•ã€‚ä¸€ç›´ä¿®æ­£å‘é‡&lt;code&gt;W&lt;/code&gt;ï¼Œç›´åˆ°å‘é‡&lt;code&gt;W&lt;/code&gt;æ»¡è¶³æ‰€æœ‰æ•°æ®ä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;naive_pla&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;iteration&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;iteration&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;false_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  
                &lt;span class="n"&gt;false_data&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
                &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;iter&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt; (&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt; / &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt;)&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iteration&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;false_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;false_data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Pocket PLA&lt;/h3&gt;
&lt;p&gt;Naive PLAçš„ä¸€å¤§é—®é¢˜å°±æ˜¯å¦‚æœæ•°æ®æœ‰æ‚éŸ³ï¼Œä¸èƒ½å®Œç¾çš„åˆ†ç±»çš„è¯ï¼Œç®—æ³•å°±ä¸ä¼šä¸­æ­¢ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¯¹äºæœ‰æ‚éŸ³çš„æ•°æ®ï¼Œæˆ‘ä»¬åªèƒ½æœŸæœ›æ‰¾åˆ°é”™è¯¯æœ€å°‘çš„ç»“æœã€‚ç„¶åè¿™æ˜¯ä¸€ä¸ª&lt;code&gt;NP Hard&lt;/code&gt;é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;Pocket PLAä¸€ä¸ªè´ªå¿ƒçš„è¿‘ä¼¼ç®—æ³•ã€‚å’ŒNaive PLAç®—æ³•ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;å˜é¡ºåºè¿­ä»£ä¸ºéšæœºè¿­ä»£ï¼Œå¦‚æœæ‰¾å‡ºé”™è¯¯ï¼Œåˆ™ä¿®æ­£ç»“æœã€‚åœ¨ä¿®æ­£è¿‡ç¨‹ä¸­ï¼Œè®°å½•çŠ¯é”™è¯¯æœ€å°‘çš„å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pocket_pla&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;limit&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c"&gt;###############&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_calc_false&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;
    &lt;span class="c"&gt;###############&lt;/span&gt;
    &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;least_false&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;_calc_false&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;limit&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datas&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;t_false&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;_calc_false&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

            &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;t_false&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;least_false&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;least_false&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t_false&lt;/span&gt;
                &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;least_false&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å‚è€ƒé“¾æ¥&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å‚è€ƒäº†&lt;a href="http://shaoxiongjiang.com/2013/03/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8-%E6%84%9F%E7%9F%A5%E5%99%A8-perceptron/"&gt;æœºå™¨å­¦ä¹ å…¥é—¨ - æ„ŸçŸ¥å™¨ (Perceptron)&lt;/a&gt;å’ŒWikipediaä¸Šé¢&lt;a href="http://zh.wikipedia.org/wiki/%E6%84%9F%E7%9F%A5%E5%99%A8"&gt;æ„ŸçŸ¥æœº&lt;/a&gt;çš„è¯æ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥åŠ&lt;a href="https://class.coursera.org/ntumlone-001/class"&gt;æ©Ÿå™¨å­¸ç¿’åŸºçŸ³ (Machine Learning Foundations)&lt;/a&gt;å…¬å¼€è¯¾çš„å¹»ç¯ç‰‡ã€‚&lt;/p&gt;
&lt;h2&gt;Updated&lt;/h2&gt;
&lt;p&gt;2013-12-8&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹äº†pocket-plaç®—æ³•ï¼Œæå‡äº†æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒäº†&lt;a href="https://class.coursera.org/ntumlone-001/forum/thread?thread_id=116#post-632"&gt;è¯¾ç¨‹è®ºå›&lt;/a&gt;çš„è®¨è®ºã€‚å¹¶ä¸”æ„Ÿè°¢Li TianyiåŒå­¦æŒ‡å‡ºæˆ‘çš„é—®é¢˜ã€‚&lt;/p&gt;</summary><category term="å…¬å¼€è¯¾"></category><category term="åˆ†ç±»å™¨"></category></entry><entry><title>Linuxå†…æ ¸ä¸­çš„å°‘é”é“¾è¡¨</title><link href="http://wizmann.tk/linux-lockless-llist.html" rel="alternate"></link><updated>2013-11-28T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-28:linux-lockless-llist.html</id><summary type="html">&lt;h1&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨stackexchangeä¸Šçœ‹åˆ°ä¸€ä¸ªé—®ç­”ï¼Œè®¨è®ºæˆ‘ä»¬å¸¸ç”¨çš„æ•°æ®ç»“æ„ä¸ç®—æ³•åœ¨å®é™…å·¥ç¨‹ä¸­çš„åº”ç”¨ã€‚(&lt;a href="http://cstheory.stackexchange.com/questions/19759/core-algorithms-deployed/19773#19773"&gt;æˆ³æˆ‘&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;æˆ‘æ‰“ç®—å€ŸåŠ©è¿™ä¸ªé—®ç­”ä¸­çš„å†…å®¹ï¼Œä»¥æˆ‘æ¯”è¾ƒç†Ÿæ‚‰çš„æ•°æ®ç»“æ„ä¸ç®—æ³•ä¸ºç´¢å¼•æ¥é˜…è¯»å¼€æºä»£ç ã€‚&lt;/p&gt;
&lt;h1&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h2&gt;Talk is cheap&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Lock-less NULL terminated single linked list&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="https://github.com/mirrors/linux-2.6/blob/master/include/linux/llist.h"&gt;linux-2.6/include/linux/llist.h&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/mirrors/linux-2.6/blob/master/lib/llist.c"&gt;linux-2.6/lib/llist.c&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;çŸ¥è¯†å‡†å¤‡&lt;/h2&gt;
&lt;h3&gt;volatile&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;volatileå…³é”®å­—å£°æ˜çš„å˜é‡æˆ–å¯¹è±¡é€šå¸¸æ‹¥æœ‰å’Œä¼˜åŒ–å’Œï¼ˆæˆ–ï¼‰å¤šçº¿ç¨‹ç›¸å…³çš„ç‰¹æ®Šå±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸ï¼Œvolatileå…³é”®å­—ç”¨æ¥é˜»æ­¢ï¼ˆä¼ªï¼‰ç¼–è¯‘å™¨å¯¹é‚£äº›å®ƒè®¤ä¸ºå˜é‡çš„å€¼ä¸èƒ½â€œè¢«ä»£ç æœ¬èº«â€æ”¹å˜çš„ä»£ç ä¸Šæ‰§è¡Œä»»ä½•ä¼˜åŒ–ã€‚ &lt;/p&gt;
&lt;p&gt;å¦‚æœä¸ä½¿ç”¨volatileå…³é”®å­—ï¼Œç¼–è¯‘å™¨å°†å‡è®¾å½“å‰ç¨‹åºæ˜¯ç³»ç»Ÿä¸­å”¯ä¸€èƒ½æ”¹å˜è¿™ä¸ªå€¼éƒ¨åˆ†ã€‚ ä¸ºäº†é˜»æ­¢ç¼–è¯‘å™¨åƒä¸Šé¢é‚£æ ·ä¼˜åŒ–ä»£ç ï¼Œéœ€è¦ä½¿ç”¨volatileå…³é”®å­—ã€‚&lt;/p&gt;
&lt;p&gt;From: http://zh.wikipedia.org/wiki/Volatile%E5%8F%98%E9%87%8F&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;typeof&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Another way to refer to the type of an expression is with typeof. The syntax of using of this keyword looks like sizeof, but the construct acts semantically like a type name defined with typedef. &lt;/p&gt;
&lt;p&gt;From: http://gcc.gnu.org/onlinedocs/gcc/Typeof.html&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;typeof&lt;/code&gt;å’Œ&lt;code&gt;sizeof&lt;/code&gt;ç±»ä¼¼ï¼Œsizeofæ±‚çš„æ˜¯å˜é‡/ç±»å‹çš„å¤§å°ï¼Œè€Œtypeofæ˜¯æ±‚å˜é‡/ç±»å‹çš„&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;typeofåœ¨#defineä¸­çš„åº”ç”¨å¾ˆå¤šï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#define max(a,b) \&lt;/span&gt;
&lt;span class="cp"&gt;   ({ typeof (a) _a = (a); \&lt;/span&gt;
&lt;span class="cp"&gt;       typeof (b) _b = (b); \&lt;/span&gt;
&lt;span class="cp"&gt;     _a &amp;gt; _b ? _a : _b; })&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;typeof(a)&lt;/code&gt;è·å¾—äº†&lt;code&gt;a&lt;/code&gt;çš„ç±»å‹ï¼Œå£°æ˜äº†ä¸€ä¸ªåŒç±»å‹çš„&lt;code&gt;_a&lt;/code&gt;å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;p.s. ä¸Šé¢æ˜¯ä¸€ä¸ªå®‰å…¨çš„ç”¨&lt;code&gt;#define&lt;/code&gt;å®ç°çš„&lt;code&gt;max&lt;/code&gt;å‡½æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;ACCESS_ONCE&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#define ACCESS_ONCE(x) (*(volatile typeof(x) *)&amp;amp;(x))ï¼›&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;ACCESS_ONCE&lt;/code&gt;ä½¿ç”¨äº†ä¸€ä¸ªç±»å‹è½¬æ¢ï¼Œä½¿ç”¨&lt;code&gt;volatile&lt;/code&gt;ä¿®é¥° &lt;code&gt;x&lt;/code&gt;ã€‚é¿å…ç¼–è¯‘å™¨ä¼˜åŒ–å¸¦æ¥çš„æ½œåœ¨å²ä¹‰ã€‚&lt;/p&gt;
&lt;h3&gt;cmpxchg&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;compare-and-swap (CAS) is an atomic instruction used in multithreading to achieve synchronization. &lt;/p&gt;
&lt;p&gt;It compares the contents of a memory location to a given value and, only if they are the same, modifies the contents of that memory location to a given new value. &lt;/p&gt;
&lt;p&gt;This is done as a single atomic operation. The atomicity guarantees that the new value is calculated based on up-to-date information; if the value had been updated by another thread in the meantime, the write would fail. &lt;/p&gt;
&lt;p&gt;The result of the operation must indicate whether it performed the substitution; this can be done either with a simple Boolean response (this variant is often called compare-and-set), or by returning the value read from the memory location (not the value written to it).&lt;/p&gt;
&lt;p&gt;...&lt;/p&gt;
&lt;p&gt;In the x86 (since 80486) and Itanium architectures this is implemented as the compare and exchange (CMPXCHG) instruction, though here the LOCK prefix should be there to make it really atomic.&lt;/p&gt;
&lt;p&gt;From: http://en.wikipedia.org/wiki/Compare-and-swap&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;cmpxchg&lt;/code&gt;æ˜¯åœ¨Intelå¹³å°ä¸Š&lt;code&gt;atomic compare-and-swap&lt;/code&gt;æ“ä½œçš„å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cmpxchg&lt;/code&gt;è¿˜è¢«ç”¨æ¥å®ç°&lt;code&gt;spinlock&lt;/code&gt;ï¼Œ&lt;a href="http://stackoverflow.com/questions/6935442/x86-spinlock-using-cmpxchg"&gt;æˆ³æˆ‘&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2&gt;Show me the code&lt;/h2&gt;
&lt;h3&gt;æ•°æ®ç±»å‹&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€ä¸ªç®€å•çš„ç±»å‹åŒ…è£¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;llist_head&lt;/code&gt;æ˜¯é“¾è¡¨å¤´ï¼Œè€Œ&lt;code&gt;llist_node&lt;/code&gt;æ˜¯é“¾è¡¨ä¸­&lt;strong&gt;é“¾&lt;/strong&gt;çš„éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h3&gt;åˆå§‹åŒ–&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#define LLIST_HEAD_INIT(name)        { NULL }&lt;/span&gt;
&lt;span class="cp"&gt;#define LLIST_HEAD(name)        struct llist_head name = LLIST_HEAD_INIT(name)&lt;/span&gt;

&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * init_llist_head - initialize lock-less list head&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        the head for your lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;init_llist_head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;é“¾è¡¨çš„éå†&lt;/h3&gt;
&lt;h4&gt;llist_entry&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_entry - get the struct of this entry&lt;/span&gt;
&lt;span class="cm"&gt; * @ptr:        the &amp;amp;struct llist_node pointer.&lt;/span&gt;
&lt;span class="cm"&gt; * @type:        the type of the struct this is embedded in.&lt;/span&gt;
&lt;span class="cm"&gt; * @member:        the name of the llist_node within the struct.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="cp"&gt;#define llist_entry(ptr, type, member)                \&lt;/span&gt;
&lt;span class="cp"&gt;        container_of(ptr, type, member)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å£°æ˜ä¸€ä¸ªé“¾è¡¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ&lt;code&gt;llist_node&lt;/code&gt;åŒ…å«åœ¨é“¾è¡¨èŠ‚ç‚¹ä¸­ï¼Œ&lt;code&gt;llist_head&lt;/code&gt;æ˜¯é“¾è¡¨å¤´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;llist_entry&lt;/code&gt;æ˜¯ä»é“¾è¡¨èŠ‚ç‚¹ä¸­çš„&lt;code&gt;llist_node&lt;/code&gt;æˆå‘˜å˜é‡è·å¾—é“¾è¡¨èŠ‚ç‚¹çš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;llist_entry&lt;/code&gt;å®æ˜¯ä»&lt;code&gt;container_of&lt;/code&gt;å®ç»§æ‰¿è€Œæ¥çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * container_of - cast a member of a structure out to the containing structure&lt;/span&gt;
&lt;span class="cm"&gt; * @ptr:        the pointer to the member.&lt;/span&gt;
&lt;span class="cm"&gt; * @type:        the type of the container struct this is embedded in.&lt;/span&gt;
&lt;span class="cm"&gt; * @member:        the name of the member within the struct.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="cp"&gt;#define container_of(ptr, type, member) ({                        \&lt;/span&gt;
&lt;span class="cp"&gt;        const typeof( ((type *)0)-&amp;gt;member ) *__mptr = (ptr);        \&lt;/span&gt;
&lt;span class="cp"&gt;        (type *)( (char *)__mptr - offsetof(type,member) );})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…·ä½“åŸç†å¯ä»¥å°å°å‚è€ƒä¸€ä¸‹&lt;a href="http://hi.baidu.com/holinux/item/af2e32c9dcbd3953ac00ef49"&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4&gt;for_each&lt;/h4&gt;
&lt;h5&gt;llist_for_each&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_for_each - iterate over some deleted entries of a lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; * @pos:        the &amp;amp;struct llist_node to use as a loop cursor&lt;/span&gt;
&lt;span class="cm"&gt; * @node:        the first entry of deleted list entries&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * In general, some entries of the lock-less list can be traversed&lt;/span&gt;
&lt;span class="cm"&gt; * safely only after being deleted from list, so start with an entry&lt;/span&gt;
&lt;span class="cm"&gt; * instead of list head.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * If being used on entries deleted from lock-less list directly, the&lt;/span&gt;
&lt;span class="cm"&gt; * traverse order is from the newest to the oldest added entry.  If&lt;/span&gt;
&lt;span class="cm"&gt; * you want to traverse from the oldest to the newest, you must&lt;/span&gt;
&lt;span class="cm"&gt; * reverse the order by yourself before traversing.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="cp"&gt;#define llist_for_each(pos, node)                        \&lt;/span&gt;
&lt;span class="cp"&gt;        for ((pos) = (node); pos; (pos) = (pos)-&amp;gt;next)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€ä¸ª&lt;code&gt;forå¾ªç¯&lt;/code&gt;ã€‚ç®€å•çš„å®ã€‚&lt;/p&gt;
&lt;h5&gt;llist_for_each_entry&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_for_each_entry - iterate over some deleted entries of lock-less list of given type&lt;/span&gt;
&lt;span class="cm"&gt; * @pos:        the type * to use as a loop cursor.&lt;/span&gt;
&lt;span class="cm"&gt; * @node:        the fist entry of deleted list entries.&lt;/span&gt;
&lt;span class="cm"&gt; * @member:        the name of the llist_node with the struct.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * In general, some entries of the lock-less list can be traversed&lt;/span&gt;
&lt;span class="cm"&gt; * safely only after being removed from list, so start with an entry&lt;/span&gt;
&lt;span class="cm"&gt; * instead of list head.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * If being used on entries deleted from lock-less list directly, the&lt;/span&gt;
&lt;span class="cm"&gt; * traverse order is from the newest to the oldest added entry.  If&lt;/span&gt;
&lt;span class="cm"&gt; * you want to traverse from the oldest to the newest, you must&lt;/span&gt;
&lt;span class="cm"&gt; * reverse the order by yourself before traversing.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="cp"&gt;#define llist_for_each_entry(pos, node, member)                                \&lt;/span&gt;
&lt;span class="cp"&gt;        for ((pos) = llist_entry((node), typeof(*(pos)), member);        \&lt;/span&gt;
&lt;span class="cp"&gt;             &amp;amp;(pos)-&amp;gt;member != NULL;                                        \&lt;/span&gt;
&lt;span class="cp"&gt;             (pos) = llist_entry((pos)-&amp;gt;member.next, typeof(*(pos)), member))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éå†é“¾è¡¨çš„ç±»ã€‚
ç”¨ä¼ªä»£ç æ¥è¡¨è¿°ä¸€ä¸‹å°±æ˜¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;for ((pos) = é“¾è¡¨èŠ‚ç‚¹;
        &amp;amp;(pos)-&amp;gt;nextæŒ‡é’ˆ != NULL; 
        (pos) = é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹) {
    // éå†æ“ä½œ
    pos.foo = bar;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;llist_for_each_entry_safe&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_for_each_entry_safe - iterate over some deleted entries of lock-less list of given type&lt;/span&gt;
&lt;span class="cm"&gt; *                               safe against removal of list entry&lt;/span&gt;
&lt;span class="cm"&gt; * @pos:        the type * to use as a loop cursor.&lt;/span&gt;
&lt;span class="cm"&gt; * @n:                another type * to use as temporary storage&lt;/span&gt;
&lt;span class="cm"&gt; * @node:        the first entry of deleted list entries.&lt;/span&gt;
&lt;span class="cm"&gt; * @member:        the name of the llist_node with the struct.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * In general, some entries of the lock-less list can be traversed&lt;/span&gt;
&lt;span class="cm"&gt; * safely only after being removed from list, so start with an entry&lt;/span&gt;
&lt;span class="cm"&gt; * instead of list head.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * If being used on entries deleted from lock-less list directly, the&lt;/span&gt;
&lt;span class="cm"&gt; * traverse order is from the newest to the oldest added entry.  If&lt;/span&gt;
&lt;span class="cm"&gt; * you want to traverse from the oldest to the newest, you must&lt;/span&gt;
&lt;span class="cm"&gt; * reverse the order by yourself before traversing.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="cp"&gt;#define llist_for_each_entry_safe(pos, n, node, member)                               \&lt;/span&gt;
&lt;span class="cp"&gt;        for (pos = llist_entry((node), typeof(*pos), member);                       \&lt;/span&gt;
&lt;span class="cp"&gt;             &amp;amp;pos-&amp;gt;member != NULL &amp;amp;&amp;amp;                                               \&lt;/span&gt;
&lt;span class="cp"&gt;                (n = llist_entry(pos-&amp;gt;member.next, typeof(*n), member), true); \&lt;/span&gt;
&lt;span class="cp"&gt;             pos = n)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;safe&lt;/code&gt;è¡¨ç¤ºå•é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æœ‰å¯èƒ½è¢«å¢åŠ /åˆ é™¤ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;(n = llist_entry(pos-&amp;gt;member.next, typeof(*n), member), true)&lt;/code&gt;å¯ä»¥ä¿æŒéå†çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;h6&gt;llist_next&lt;/h6&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;llist_next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;é“¾è¡¨å…ƒç´ çš„æ“ä½œ&lt;/h3&gt;
&lt;h5&gt;llist_add_batch&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_add_batch - add several linked entries in batch&lt;/span&gt;
&lt;span class="cm"&gt; * @new_first:        first entry in batch to be added&lt;/span&gt;
&lt;span class="cm"&gt; * @new_last:        last entry in batch to be added&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        the head for your lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Return whether list is empty before adding.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;llist_add_batch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;new_first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;new_last&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                     &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;new_last&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACCESS_ONCE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmpxchg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_first&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰¹é‡å¢åŠ å‘½ä»¤ï¼Œä½¿ç”¨&lt;code&gt;cmpxchg&lt;/code&gt;ä¿æŒçº¿ç¨‹å®‰å…¨ã€‚&lt;/p&gt;
&lt;h5&gt;llist_add&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_add - add a new entry&lt;/span&gt;
&lt;span class="cm"&gt; * @new:        new entry to be added&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        the head for your lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Returns true if the list was empty prior to adding this entry.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;llist_add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;llist_add_batch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;llist_empty&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_empty - tests whether a lock-less list is empty&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        the list to test&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Not guaranteed to be accurate or up to date.  Just a quick way to&lt;/span&gt;
&lt;span class="cm"&gt; * test whether the list is empty without deleting something from the&lt;/span&gt;
&lt;span class="cm"&gt; * list.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nf"&gt;llist_empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ACCESS_ONCE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨&lt;code&gt;ACCESS_ONCE&lt;/code&gt;é¿å…ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä¿æŒçº¿ç¨‹å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;h5&gt;llist_del_all&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_del_all - delete all entries from lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        the head of lock-less list to delete all entries&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * If list is empty, return NULL, otherwise, delete all entries and&lt;/span&gt;
&lt;span class="cm"&gt; * return the pointer to the first entry.  The order of entries&lt;/span&gt;
&lt;span class="cm"&gt; * deleted is from the newest to the oldest added one.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kr"&gt;inline&lt;/span&gt; &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;llist_del_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;xchg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;llist_del_first&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_del_first - delete the first entry of lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        the head for your lock-less list&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * If list is empty, return NULL, otherwise, return the first entry&lt;/span&gt;
&lt;span class="cm"&gt; * deleted, this is the newest added one.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Only one llist_del_first user can be used simultaneously with&lt;/span&gt;
&lt;span class="cm"&gt; * multiple llist_add users without lock.  Because otherwise&lt;/span&gt;
&lt;span class="cm"&gt; * llist_del_first, llist_add, llist_add (or llist_del_all, llist_add,&lt;/span&gt;
&lt;span class="cm"&gt; * llist_add) sequence in another user may change @head-&amp;gt;first-&amp;gt;next,&lt;/span&gt;
&lt;span class="cm"&gt; * but keep @head-&amp;gt;first.  If multiple consumers are needed, please&lt;/span&gt;
&lt;span class="cm"&gt; * use llist_del_all or use lock between consumers.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;llist_del_first&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_head&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;entry&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;old_entry&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(;;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;old_entry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cmpxchg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;old_entry&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;old_entry&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                        &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ é™¤ç¬¬ä¸€ä¸ªå€¼ã€‚åŒæ ·çš„æ— é”æ“ä½œã€‚&lt;/p&gt;
&lt;h5&gt;llist_reverse_order&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * llist_reverse_order - reverse order of a llist chain&lt;/span&gt;
&lt;span class="cm"&gt; * @head:        first item of the list to be reversed&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Reverse the order of a chain of llist entries and return the&lt;/span&gt;
&lt;span class="cm"&gt; * new first entry.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;llist_reverse_order&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;new_head&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;llist_node&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="n"&gt;new_head&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;new_head&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;EXPORT_SYMBOL_GPL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;llist_reverse_order&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚ä½•åè½¬ä¸€ä¸ªå•é“¾è¡¨&lt;/p&gt;
&lt;h2&gt;å°‘é”é“¾è¡¨æ˜¯å¦‚ä½•å®ç°çš„&lt;/h2&gt;
&lt;h3&gt;addå‡½æ•°ä¸­çš„åŸå­æ“ä½œ&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;new_last&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ACCESS_ONCE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmpxchg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_first&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­&lt;code&gt;cmpxchg&lt;/code&gt;çš„æ€§è´¨ç±»ä¼¼äºé”ã€‚ä¿è¯èµ‹å€¼æ˜¯æˆåŠŸçš„ä¸”æ˜¯æ˜¯åŸå­çš„ã€‚&lt;/p&gt;
&lt;h3&gt;del_firstä¸­çš„åŸå­æ“ä½œ&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cmpxchg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;old_entry&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;del_allä¸­çš„åŸå­æ“ä½œ&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;xchg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;å°‘é”é“¾è¡¨å¦‚ä½•å¤„ç†å¹¶å‘&lt;/h3&gt;
&lt;p&gt;åœ¨llist.hä¸­æœ‰å¦‚ä¸‹çš„æ³¨é‡Šè¡¨æ˜å¦‚æœä¸¤ç§æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œæ˜¯å¦éœ€è¦åŠ é¢å¤–çš„é”ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt; /*
 *           |   add    | del_first |  del_all
 * add       |    -     |     -     |     -
 * del_first |          |     L     |     L
 * del_all   |          |           |     -
 */
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;add&lt;/code&gt;æ“ä½œå’Œå¤´æŒ‡é’ˆæ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å’Œå…¶å®ƒæ“ä½œå¹¶è¡Œã€‚
&lt;code&gt;del_first&lt;/code&gt;ä¾èµ–äº&lt;code&gt;list-&amp;gt;first-&amp;gt;next&lt;/code&gt;åœ¨æ“ä½œæ—¶ä¸å˜åŒ–ã€‚
è€Œ&lt;code&gt;del_all&lt;/code&gt;åªå¯¹&lt;code&gt;list-&amp;gt;first&lt;/code&gt;çš„æŒ‡é’ˆè¿›è¡Œæ“ä½œã€‚æ‰€ä»¥æ˜¯å¯ä»¥å¹¶è¡Œçš„ã€‚&lt;/p&gt;
&lt;h3&gt;å°‘é”é“¾è¡¨å¦‚ä½•å¤„ç†éå†&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * The list entries deleted via llist_del_all can be traversed with&lt;/span&gt;
&lt;span class="cm"&gt; * traversing function such as llist_for_each etc.  But the list&lt;/span&gt;
&lt;span class="cm"&gt; * entries can not be traversed safely before deleted from the list.&lt;/span&gt;
&lt;span class="cm"&gt; * The order of deleted entries is from the newest to the oldest added&lt;/span&gt;
&lt;span class="cm"&gt; * one.  If you want to traverse from the oldest to the newest, you&lt;/span&gt;
&lt;span class="cm"&gt; * must reverse the order by yourself before traversing.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¤§æ¦‚æ„æ€æ˜¯è¯´åªæœ‰ä»åˆ—è¡¨ä¸Šåˆ é™¤ä¸‹æ¥çš„å…ƒç´ æ‰å¯ä»¥å®‰å…¨çš„éå†ã€‚ï¼ˆè¿™ç‚¹ç†è§£çš„ä¸æ·±å…¥ï¼‰&lt;/p&gt;
&lt;h2&gt;åè®°&lt;/h2&gt;
&lt;p&gt;æœ¬æ¥æ˜¯æƒ³æŠŠè¿™llistçš„ä»£ç çœ‹æ˜ç™½çš„ã€‚ä½†æ˜¯ï¼Œå¤§æ¦‚åªçœ‹æ‡‚äº†60%ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥åå¦‚æœæœ‰æ–°çš„æƒ³æ³•ï¼Œçœ‹åˆ°äº†æ–°çš„ä¸œè¥¿ï¼Œä¹Ÿè®¸ä¼šæœ‰ä¸å°‘æœ‰ç”¨çš„updateå§ã€‚ã€‚&lt;/p&gt;</summary><category term="linux"></category><category term="lock-less"></category><category term="é“¾è¡¨"></category><category term="å¹¶å‘ç¼–ç¨‹"></category></entry><entry><title>Codeforces Round #215 (Div. 2)ä¸å®Œå…¨ä¸æ­£ç¡®é¢˜è§£</title><link href="http://wizmann.tk/cf-215-div-2.html" rel="alternate"></link><updated>2013-11-27T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-27:cf-215-div-2.html</id><summary type="html">&lt;h3&gt;A. Sereja and Coat Rack&lt;/h3&gt;
&lt;p&gt;å‚»é€¼æ‰é”™çš„é¢˜ã€‚ä¸å¹¸ä¸­æªã€‚&lt;/p&gt;
&lt;p&gt;æ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚ç›´æ¥çœ‹ä»£ç å°±å¥½ã€‚&lt;/p&gt;
&lt;h3&gt;B. Sereja and Suffixes&lt;/h3&gt;
&lt;p&gt;å…³é”®æ€æƒ³åœ¨äºç»Ÿè®¡A[i...n-1]ä¸­æœ‰å¤šå°‘äº’ä¸ç›¸åŒçš„æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ç¦»çº¿æ€æƒ³ï¼ŒæŠŠæŸ¥è¯¢æŒ‰&lt;code&gt;greater&amp;lt;int&amp;gt;&lt;/code&gt;æ’åºï¼Œç„¶åä½¿ç”¨Hashè¡¨è¿›è¡Œç»Ÿè®¡ï¼Œç®€å•é¢˜ã€‚&lt;/p&gt;
&lt;h3&gt;C. Sereja and Algorithm&lt;/h3&gt;
&lt;p&gt;æ€è·¯é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å®¹æ˜“æƒ³åˆ°å¦‚æœå¯ä»¥äº¤æ¢ç›¸é‚»ä¸¤ä¸ªå­—æ¯çš„ä½ç½®ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—è¿™ä¸ªå­—ç¬¦ä¸²æ‰€æœ‰çš„æ’åˆ—ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç»Ÿè®¡å‡ºA[i...j]ä¸­x, y, zçš„ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè¿›è¡Œæ’åˆ—ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼Œç¨³å®šçš„æ’åˆ—ï¼ˆå³å¯ä»¥ä½¿ç®—æ³•åœä¸‹æ¥çš„æ’åˆ—ï¼‰åªæœ‰å¦‚ä¸‹å‡ ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;zy[xzy][xzy]...
xz[yxz][yxz]...
yx[zyx][zyx]...

//[]ä¸­çš„æ˜¯å¾ªç¯èŠ‚
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰€ä»¥åªéœ€è¦æ•°å­¦ä¸Šçš„ä¸€ç‚¹è®¡ç®—å°±å¯ç®—å‡ºæˆ‘ä»¬å¯ä¸å¯ä»¥ç”Ÿæˆä»¥ä¸Šçš„æ’åˆ—ã€‚&lt;/p&gt;
&lt;h3&gt;D. Sereja ans Anagrams&lt;/h3&gt;
&lt;p&gt;å‘é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªç®€å•çš„åŒç«¯é˜Ÿåˆ— + Hashè¡¨ç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;p&gt;å‘æœ‰ä¸¤å¤„ï¼Œä¸€æ˜¯æœ€åçš„ç»“æœéœ€è¦å»é‡ã€‚è¿™ä¸ªæ˜¯æˆ‘åšæ³•çš„é—®é¢˜ï¼Œç”¨ä¸€ä¸ªHashè¡¨åˆ¤é‡ï¼Œå¦‚æœqaæ»¡è¶³æ¡ä»¶ï¼Œåç»­å°±ä¸éœ€è¦æšä¸¾qaè¿™ä¸ªç‚¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;äºŒæ˜¯ä¸€äº›ä¸­é—´ç»“æœä¼šçˆ†intï¼Œæ‰€ä»¥è¦å®æ—¶ä¼°è®¡æ•°æ®è§„æ¨¡ã€‚&lt;/p&gt;
&lt;h2&gt;E. Sereja and the Arrangement of Numbers&lt;/h2&gt;
&lt;p&gt;æ¬§æ‹‰è·¯å¾„ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆç§‘æ™®ä¸€ä¸‹ã€‚ï¼ˆå¥½å§ï¼Œå…¶å®å¤§å®¶éƒ½çŸ¥é“ï¼Œåªæœ‰æˆ‘å¿˜è®°äº†ã€‚ã€‚ã€‚ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªç»™å®šçš„è¿é€šå›¾ï¼Œæ€æ ·åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç€ä¸€ä¸ªæ°å¥½åŒ…å«äº†æ‰€æœ‰çš„è¾¹ï¼Œå¹¶ä¸”æ²¡æœ‰é‡å¤çš„è·¯å¾„ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸€ç¬”ç”»é—®é¢˜ã€‚ç”¨å›¾è®ºçš„æœ¯è¯­æ¥è¯´ï¼Œå°±æ˜¯åˆ¤æ–­è¿™ä¸ªå›¾æ˜¯å¦æ˜¯ä¸€ä¸ªèƒ½å¤Ÿéå†å®Œæ‰€æœ‰çš„è¾¹è€Œæ²¡æœ‰é‡å¤ã€‚è¿™æ ·çš„å›¾ç°ç§°ä¸ºæ¬§æ‹‰å›¾ã€‚è¿™æ—¶éå†çš„è·¯å¾„ç§°ä½œæ¬§æ‹‰è·¯å¾„ï¼ˆä¸€ä¸ªç¯æˆ–è€…ä¸€æ¡é“¾ï¼‰ï¼Œå¦‚æœè·¯å¾„é—­åˆï¼ˆä¸€ä¸ªåœˆï¼‰ï¼Œåˆ™ç§°ä¸ºæ¬§æ‹‰å›è·¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬æ¥ç®€åŒ–ä¸€ä¸‹é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬æœ‰kä¸ªnumbersï¼Œè‹¥è¦ç”Ÿæˆä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„åºåˆ—ã€‚åˆ™è¿™kä¸ªæ•°å­—çš„ç›¸é‚»å…³ç³»å¿…ç„¶èƒ½æ„æˆä¸€ä¸ªæ¬§æ‹‰è·¯å¾„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿é€šçš„æ— å‘å›¾ G æœ‰æ¬§æ‹‰è·¯å¾„çš„å……è¦æ¡ä»¶æ˜¯ï¼šGä¸­å¥‡é¡¶ç‚¹ï¼ˆè¿æ¥çš„è¾¹æ•°é‡ä¸ºå¥‡æ•°çš„é¡¶ç‚¹ï¼‰çš„æ•°ç›®ç­‰äº0æˆ–è€…2ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å®¹æ˜“æ±‚å‡ºåœ¨æœ‰kä¸ªç‚¹æ—¶ï¼Œå›¾ä¸­åº”è¯¥æœ‰å¤šå°‘æ¡è¾¹ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬çš„åºåˆ—åº”è¯¥æœ‰å¤šé•¿ã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°æˆ‘ä»¬çš„é—®é¢˜ä¸Šæ¥ï¼Œæˆ‘ä»¬é™å®šäº†åºåˆ—çš„é•¿åº¦ï¼Œæ‰€ä»¥å›¾ä¸­è¾¹çš„æ•°ç›®ä¹Ÿæœ‰äº†é™åˆ¶ã€‚äºæ˜¯æˆ‘ä»¬ç”±è¾¹æ•°ä½¿ç”¨äºŒåˆ†æšä¸¾åæ¨ç‚¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åé€‰å–ä»·æ ¼æœ€é«˜çš„tä¸ªç‚¹æ•°ï¼Œå¹¶ç®—å‡ºæ€»èŠ±è´¹ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒè‡ª&lt;a href="http://codeforces.com/blog/entry/9728"&gt;liyishuai&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;ä»£ç &lt;/h3&gt;
&lt;p&gt;ä»…ä¾›å‚è€ƒï¼š&lt;a href="https://github.com/Wizmann/ACM-ICPC/tree/master/Codeforces/Codeforces%20Round%20%23216%20(Div.%202)"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;</summary><category term="codeforces"></category><category term="algorithm"></category><category term="ç®—æ³•"></category><category term="é¢˜è§£"></category></entry><entry><title>CSE351 - Lab 1: Manipulating Bits Using C</title><link href="http://wizmann.tk/cse351-lab1.html" rel="alternate"></link><updated>2013-11-27T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-27:cse351-lab1.html</id><summary type="html">&lt;p&gt;ä»Šå¤©åšäº†CSE351 - Lab1ï¼Œæ·±æ·±çš„æ„Ÿè§‰å›½å¤–çš„è®¡ç®—æœºæ•™å­¦çˆ†äº†æˆ‘æ ¡ä¸€æ¡è¡—ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯å‰è¨€ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3&gt;bitAnd &amp;amp; bitOr&lt;/h3&gt;
&lt;p&gt;å¾·æ‘©æ ¹å®šç†çš„åº”ç”¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * bitAnd - x&amp;amp;y using only ~ and | &lt;/span&gt;
&lt;span class="cm"&gt; *   Example: bitAnd(6, 5) = 4&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ~ |&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 8&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 1&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;bitAnd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * bitOr - x|y using only ~ and &amp;amp; &lt;/span&gt;
&lt;span class="cm"&gt; *   Example: bitOr(6, 5) = 7&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ~ &amp;amp;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 8&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 1&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;bitOr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;isTmax&lt;/h3&gt;
&lt;p&gt;å› ä¸º&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Tmax == INT_MAX == 0x7fff ffff&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;=&amp;gt; &lt;code&gt;INT_MAX + INT_MAX + 2 == 0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åˆå› ä¸º&lt;code&gt;-1 == 0xffff ffff&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;=&amp;gt; &lt;code&gt;-1 + -1 + 2 = 0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬è¿˜è¦åŠ ä¸€æ¡åˆ¤æ–­æ˜¯å¦æ˜¯-1çš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * isTmax - returns 1 if x is the maximum, two&amp;#39;s complement number,&lt;/span&gt;
&lt;span class="cm"&gt; *     and 0 otherwise &lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | +&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 10&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 1&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;isTmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;isZero&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * isZero - returns 1 if x == 0, and 0 otherwise &lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: isZero(5) = 0, isZero(0) = 1&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 2&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 1&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;isZero&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;fitsBits&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * fitsBits - return 1 if x can be represented as an &lt;/span&gt;
&lt;span class="cm"&gt; *  n-bit, two&amp;#39;s complement integer.&lt;/span&gt;
&lt;span class="cm"&gt; *   1 &amp;lt;= n &amp;lt;= 32&lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: fitsBits(5,3) = 0, fitsBits(-4,3) = 1&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 15&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 2&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;fitsBits&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;shift&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// equal to 32 - n&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;getByte&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * getByte - Extract byte n from word x&lt;/span&gt;
&lt;span class="cm"&gt; *   Bytes numbered from 0 (LSB) to 3 (MSB)&lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: getByte(0x12345678,1) = 0x56&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 6&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 2&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;getByte&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0xFF&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0xFF&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;isNegative&lt;/h3&gt;
&lt;p&gt;æ‰¾åˆ°ç¬¦å·ä½&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * isNegative - return 1 if x &amp;lt; 0, return 0 otherwise &lt;/span&gt;
&lt;span class="cm"&gt; *   Example: isNegative(-1) = 1.&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 6&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 2&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;isNegative&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;!!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;addOK&lt;/h3&gt;
&lt;p&gt;å¦‚æœaå’ŒbåŒå·ï¼Œä¸”a + bä¸aå¼‚å·ï¼Œåˆ™ä¸å¯ä»¥åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * addOK - Determine if can compute x+y without overflow&lt;/span&gt;
&lt;span class="cm"&gt; *   Example: addOK(0x80000000,0x80000000) = 0,&lt;/span&gt;
&lt;span class="cm"&gt; *            addOK(0x80000000,0x70000000) = 1, &lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 20&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 3&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;addOK&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;  &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sx&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;sy&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sx&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;isGreater&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * isGreater - if x &amp;gt; y  then return 1, else return 0 &lt;/span&gt;
&lt;span class="cm"&gt; *   Example: isGreater(4,5) = 0, isGreater(5,4) = 1&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 24&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 3&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;isGreater&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x_minus_y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;sminus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(((&lt;/span&gt;&lt;span class="n"&gt;x_minus_y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;x_minus_y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sx&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;sy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;sminus&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;sx&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="n"&gt;sy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;sx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;replaceByte&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * replaceByte(x,n,c) - Replace byte n in x with c&lt;/span&gt;
&lt;span class="cm"&gt; *   Bytes numbered from 0 (LSB) to 3 (MSB)&lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: replaceByte(0x12345678,1,0xab) = 0x1234ab78&lt;/span&gt;
&lt;span class="cm"&gt; *   You can assume 0 &amp;lt;= n &amp;lt;= 3 and 0 &amp;lt;= c &amp;lt;= 255&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 10&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 3&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;replaceByte&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="mh"&gt;0xFF&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;rotateLeft&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * rotateLeft - Rotate x to the left by n&lt;/span&gt;
&lt;span class="cm"&gt; *   Can assume that 0 &amp;lt;= n &amp;lt;= 31&lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: rotateLeft(0x87654321,4) = 0x76543218&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 25&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 3 &lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;rotateLeft&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;bitCount&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯ä»&lt;a href="http://stackoverflow.com/a/3815253/2927439"&gt;stackoverflow&lt;/a&gt;ä¸Šæ‰¾æ¥çš„ç­”æ¡ˆï¼Œå¾ˆå‰å®³ï¼Œä¸è¿‡è¿˜æ²¡çœ‹æ˜ç™½ä¸ºå•¥ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * bitCount - returns count of number of 1&amp;#39;s in word&lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: bitCount(5) = 2, bitCount(7) = 3&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 40&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 4&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;bitCount&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x55555555&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x55555555&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x33333333&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x33333333&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x0F0F0F0F&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x0F0F0F0F&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x00FF00FF&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x00FF00FF&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x0000FFFF&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mh"&gt;0x0000FFFF&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;isNonZero&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;(~x + 1) == -x&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;=&amp;gt; &lt;code&gt;x | -x&lt;/code&gt;çš„ç¬¦å·ä½ä¸ºè´Ÿ&lt;/p&gt;
&lt;p&gt;å¯¹äºç‰¹æ®Šæ•°æ®&lt;code&gt;INT_MIN&lt;/code&gt;ä¹Ÿå¯ä»¥å¤„ç†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* &lt;/span&gt;
&lt;span class="cm"&gt; * isNonZero - Check whether x is nonzero using&lt;/span&gt;
&lt;span class="cm"&gt; *              the legal operators except !&lt;/span&gt;
&lt;span class="cm"&gt; *   Examples: isNonZero(3) = 1, isNonZero(0) = 0&lt;/span&gt;
&lt;span class="cm"&gt; *   Legal ops: ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="cm"&gt; *   Max ops: 10&lt;/span&gt;
&lt;span class="cm"&gt; *   Rating: 4 &lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;isNonZero&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="CSE351"></category><category term="å…¬å¼€è¯¾"></category></entry><entry><title>CSE 351 - Hardware/Software Interface</title><link href="http://wizmann.tk/Washington-University-CSE351.html" rel="alternate"></link><updated>2013-11-26T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-26:Washington-University-CSE351.html</id><summary type="html">&lt;p&gt;å¼€ä¸€é—¨å…¬å¼€è¯¾ï¼ŒWashington Universityçš„Hardware/Software Interfaceã€‚&lt;/p&gt;
&lt;p&gt;ä¼ è¯´æ˜¯å¾ˆä¸é”™çš„è®¡ç®—æœºç§‘å­¦å…¬å¼€è¯¾ã€‚ä½¿ç”¨&lt;a href="http://book.douban.com/subject/5333562/"&gt;æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ&lt;/a&gt;åšæ•™æï¼Œæ­£å¥½æ˜¯æˆ‘è¦è¯»çš„ä¹¦ï¼Œæ‰€ä»¥é¡ºä¾¿å¬å¬è¯¾ã€‚&lt;/p&gt;
&lt;p&gt;è±†ç“£ä¸Šæœ‰äººå†™äº†&lt;a href="http://book.douban.com/review/6093947/"&gt;æ¨è&lt;/a&gt;ï¼Œè§‚ç‚¹æ˜¯è¿™è¯¾è™½ç„¶ä¸é”™ï¼Œä½†æ˜¯æ¯”è¾ƒæµ…ã€‚æ ¹æ®æˆ‘ç°åœ¨çš„ç†è§£æ¥è¯´ï¼Œç¡®å®æ¯”è¾ƒæµ…ï¼Œå¦‚æœæœ‰ä¸é”™çš„é«˜çº§è¯­è¨€ç¼–ç¨‹åŸºç¡€ï¼ˆC/C++/Java/Pascalç­‰ï¼Œè„šæœ¬å°±ç®—äº†ï¼‰ï¼Œå¾ˆå¤šä¸œè¥¿å¯ä»¥é€Ÿæ¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çš„ä¸€äº›æ—¥å¿—ä¼šæ˜¯è¿™é—¨è¯¾çš„ä½œä¸šã€å®éªŒå’Œæ„Ÿæƒ³ã€‚ç°åœ¨å…ˆæŒ–ä¸ªå‘ã€‚æ…¢æ…¢å¡«ä¸Šã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;è¯¾ç¨‹è§†é¢‘ï¼š&lt;a href="http://pan.baidu.com/wap/link?&amp;amp;shareid=3687486382&amp;amp;uk=2919707929&amp;amp;third=0&amp;amp;page=1"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯¾ç¨‹ä¸»é¡µï¼š&lt;a href="https://courses.cs.washington.edu/courses/cse351/13su/index.html"&gt;æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;</summary><category term="å…¬å¼€è¯¾"></category><category term="è®¡ç®—æœºç§‘å­¦"></category><category term="CSE351"></category></entry><entry><title>ä½¿ç”¨pipå’Œvirtuanenv</title><link href="http://wizmann.tk/using-pip-and-virtualenv.html" rel="alternate"></link><updated>2013-11-25T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-25:using-pip-and-virtualenv.html</id><summary type="html">&lt;p&gt;è®©æˆ‘ä»¬ä»ä¸€ä¸ªæ— èŠçš„å°æ®µå­å¼€å§‹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;"Whatâ€™s pip?"&lt;/p&gt;
&lt;p&gt;"A python package manager"&lt;/p&gt;
&lt;p&gt;"How do I install it?"&lt;/p&gt;
&lt;p&gt;"easy_install pip"&lt;/p&gt;
&lt;p&gt;"Whatâ€™s easy_install?"&lt;/p&gt;
&lt;p&gt;"A python package manager"&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;pipå’Œeasy_installéƒ½æ˜¯pythonçš„åŒ…ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºrubyçš„gemä»¥åŠnodejsçš„npmã€‚&lt;/p&gt;
&lt;p&gt;è€Œpipæ˜¯easy_installçš„å‡çº§ç‰ˆï¼Œåœ¨è¿™ä¸ª&lt;a href="http://www.pip-installer.org/en/1.0.2/#pip-compared-to-easy-install"&gt;é¡µé¢&lt;/a&gt;ä¸­æåˆ°äº†pipå¯¹äºeasy_installçš„å‡çº§ã€‚å…¶ä¸­æåˆ°äº†ä¸€ç‚¹éå¸¸é‡è¦ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;pip is complementary with virtualenv, and it is encouraged that you use virtualenv to isolate your installation.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæœ‰åŒå­¦ä¸ç†Ÿæ‚‰virtualenvï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªå°å°çš„ä»‹ç»ã€‚ï¼ˆä»¥ä¸‹ç¿»è¯‘æ¥è‡ªï¼š&lt;a href="http://blogs.360.cn/blog/how-360-uses-python-1-virtualenv/"&gt;æˆ³æˆ‘&lt;/a&gt;ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;virtualenv æ˜¯ä¸€ä¸ªåˆ›å»ºéš”ç¦»çš„Pythonç¯å¢ƒçš„å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;virtualenvè¦è§£å†³çš„æ ¹æœ¬é—®é¢˜æ˜¯åº“çš„ç‰ˆæœ¬å’Œä¾èµ–ï¼Œä»¥åŠæƒé™é—®é¢˜ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦LibFooçš„ç‰ˆæœ¬1ï¼Œè€Œå¦ä¸€ä¸ªç¨‹åºéœ€è¦ç‰ˆæœ¬2ï¼Œå¦‚ä½•åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªåº”ç”¨ç¨‹åºå‘¢ï¼Ÿå¦‚æœå°†æ‰€æœ‰çš„åº“éƒ½å®‰è£…åœ¨ /usr/lib/python2.7/site-packagesï¼ˆæˆ–è€…ä½ çš„ç³»ç»Ÿçš„æ ‡å‡†åŒ…å®‰è£…è·¯å¾„ï¼‰ï¼Œéå¸¸å®¹æ˜“å‡ºç°å°†ä¸è¯¥å‡çº§çš„åº“å‡çº§çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œåœ¨ä¸€å°å…±äº«çš„æœºå™¨ä¸Šï¼Œå¦‚æœæ²¡æœ‰å…¨å±€çš„ site-packages ç›®å½•çš„æƒé™ï¼ˆä¾‹å¦‚ä¸€ä¸ªå…±äº«çš„ä¸»æœºï¼‰ï¼Œå¦‚ä½•å®‰è£…Pythonåº“å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå°±æ˜¯è¯¥ç”¨åˆ°virtualenvçš„åœ°æ–¹ã€‚å®ƒèƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„å®‰è£…ç›®å½•ï¼Œå½¢æˆä¸€ä¸ªç‹¬ç«‹çš„ç¯å¢ƒï¼Œä¸ä¼šå½±å“å…¶ä»–çš„virtualenvç¯å¢ƒï¼Œç”šè‡³å¯ä»¥ä¸å—å…¨å±€çš„site-packageså½“ä¸­å®‰è£…çš„åŒ…çš„å½±å“&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”±äºvirtualenvçš„ä»¥ä¸Šä¼˜ç‚¹ã€‚æˆ‘ä»¬ä½¿ç”¨pipä¸virtualenvé…åˆï¼Œå¯ä»¥å¾ˆè½»æ¾ä¿è¯çº¿ä¸Šçº¿ä¸‹è¿è¡Œç¯å¢ƒä¸€è‡´ï¼Œå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸€ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨çº¿ä¸‹å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨&lt;code&gt;virtualenv env&lt;/code&gt;åˆ›å»ºä¸€ä¸ªPythonè™šæ‹Ÿç¯å¢ƒã€‚å¹¶ä½¿ç”¨&lt;code&gt;source env/bin/activate&lt;/code&gt;æ¿€æ´»ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…æˆ‘ä»¬éœ€è¦çš„åŒ…ã€‚æ­¤æ—¶æˆ‘ä»¬çš„ç¯å¢ƒä¸å…¨å±€å®Œå…¨éš”ç¦»ï¼Œæ‰€æœ‰Pythonè¿è¡Œç¯å¢ƒåªä»¥æ¥äºç°æœ‰çš„è™šæ‹Ÿç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨éƒ¨ç½²æœåŠ¡æ—¶ï¼Œæ‹·è´æ•´ä¸ªè™šæ‹Ÿç¯å¢ƒå¿…ç„¶æ˜¯ä¸æ˜æ™ºçš„é€‰æ‹©ã€‚æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;pip freeze &amp;gt; requirements.txt&lt;/code&gt;å°†æœ¬ç¯å¢ƒçš„ä¾èµ–å†™å…¥&lt;code&gt;requirements.txt&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶ååœ¨çº¿ä¸Šæ–°å»º&lt;code&gt;env_online&lt;/code&gt;ï¼Œæ¿€æ´»ä¹‹ã€‚å¹¶è°ƒç”¨&lt;code&gt;pip install -r requirements.txt&lt;/code&gt;ï¼Œæ­¤æ—¶çº¿ä¸ŠæœåŠ¡å™¨ä¼šä¸‹è½½æ‰€æœ‰ä¾èµ–åŒ…ã€‚åœ¨å®‰è£…ç»“æŸåï¼Œæˆ‘ä»¬å°±å…‹éš†äº†çº¿ä¸‹çš„ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœçº¿ä¸ŠæœåŠ¡å™¨æ²¡æœ‰è¿æ¥å¤–ç½‘ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¦»çº¿æ–¹æ³•å®‰è£…éœ€è¦çš„åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip bundle env.pybundle -r requirements.txt&lt;/code&gt;ä¼šé‡æ–°ä¸‹è½½æ‰€æœ‰ä¾èµ–çš„åŒ…ï¼Œå¹¶å†™å…¥&lt;code&gt;env.pybundle&lt;/code&gt;ã€‚ç„¶åæˆ‘ä»¬å°†å…¶ä¸Šä¼ åˆ°çº¿ä¸Šï¼Œä½¿ç”¨&lt;code&gt;pip install env.pybundle&lt;/code&gt;å®‰è£…å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯pipå’Œvirtualenvé…åˆä½¿ç”¨ä¸€äº›æŠ€å·§ã€‚å‚è€ƒè‡ªï¼š&lt;a href="http://blog.csdn.net/tulip527/article/details/8478093"&gt;æˆ³æˆ‘&lt;/a&gt;ã€‚&lt;/p&gt;</summary><category term="python"></category></entry><entry><title>Hello World</title><link href="http://wizmann.tk/hello-world.html" rel="alternate"></link><updated>2013-11-24T00:00:00+08:00</updated><author><name>Wizmann</name></author><id>tag:wizmann.tk,2013-11-24:hello-world.html</id><summary type="html">&lt;p&gt;æ‰“ç®—æŠŠåšå®¢è¿åˆ°è¿™é‡Œæ¥äº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Hello World&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="é—²èŠ"></category></entry></feed>